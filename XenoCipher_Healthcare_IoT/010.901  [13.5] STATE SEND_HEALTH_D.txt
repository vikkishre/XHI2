22:59:12.497 > [221.4] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:12.503 > ERROR state - attempting recovery
22:59:12.506 > [RETRY] Attempting to send health data (Max retries: 3)
22:59:12.511 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
22:59:12.517 > Generated health data: HR-63 SPO2-95 STEPS-1138
22:59:12.520 > [ESP32] MsgKeys: lfsrSeed=0x20EE5D98 tnk[0..3]=E743D10B trn[0..3]=57AD7DE8
22:59:12.528 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313133384D50
22:59:12.533 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313133384D50000000000000
22:59:12.541 > [ESP32][LFSR] Initializing - Seed: 0x20EE5D98 SeedBe: 0x985DEE20 ChaosKey[0..3]: E743D10B InitialTap: 0x0029 State: 0x20EE5D98
22:59:12.553 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
22:59:12.560 > 3_After_LFSR (32): D00FC3164A41794B5C182A438E96261C AC9605D1C6ADAF92FCDA44FFBC8A5267
22:59:12.567 > [ESP32][LFSR] Keystream (first 16 bytes): 985DEE2079612A1B132A077ABBB67548
22:59:12.575 > [ESP32][TINKERBELL] Input (first 16 bytes): D00FC3164A41794B5C182A438E96261C Nonce: 0x00000002 Buffer size: 32 bytes
22:59:12.583 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: E743D10B
22:59:12.595 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 2D3C4E73457667837B3F3684AE4ECD7B
22:59:12.603 > 4_After_Tinkerbell (32): FD338D650F371EC827271CC720D8EB67 91442F98699F0FF4B2B09814989A1765 
22:59:12.611 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 2D3C4E73457667837B3F3684AE4ECD7B
22:59:12.619 > 5_After_Transposition (32): FD33C81E2F9820D8272767EB1CC7699F 9144F40F8D65989AB2B0651798140F37 
22:59:12.627 > [ESP32] === HMAC DEBUG INFO ===
22:59:12.631 > [ESP32] HMAC Key being used: F657B95E8C711D87EDF6F188B5248545E6EB3DB4755CFCB23B760310F710514C        
22:59:12.639 > [ESP32] HMAC Input length: 44 bytes
22:59:12.641 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002FD33C81E2F9820D8272767EB1CC7699F9144F40F
22:59:12.650 > [ESP32] Nonce: 0x00000002
22:59:12.652 > [ESP32] Packet size before HMAC: 60
22:59:12.656 > [ESP32] Computed HMAC Tag: 9AB932E751C659E727078929D2203852
22:59:12.661 > [ESP32] === END HMAC DEBUG ===
22:59:12.664 > 6_Final_Packet (60): 810218001800040800000002FD33C81E 2F9820D8272767EB1CC7699F9144F40F ...
22:59:12.673 > [RETRY] Attempt 1/3 (nonce: 2)
22:59:12.675 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:12.678 > Sending pipeline data to server (560 bytes)
22:59:12.869 > [HTTP] Response code: 400
22:59:12.869 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:12.874 > [HTTP] Request failed with code: 400
22:59:12.878 > [RETRY] Send failed, waiting 100 ms before retry
22:59:12.974 > [RETRY] Attempt 2/3 (nonce: 2)
22:59:12.974 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:12.979 > Sending pipeline data to server (560 bytes)
22:59:13.143 > [HTTP] Response code: 400
22:59:13.143 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:13.149 > [HTTP] Request failed with code: 400
22:59:13.151 > [RETRY] Send failed, waiting 200 ms before retry
22:59:13.349 > [RETRY] Attempt 3/3 (nonce: 2)
22:59:13.349 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:13.354 > Sending pipeline data to server (560 bytes)
22:59:13.620 > [HTTP] Response code: 400
22:59:13.620 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:13.627 > [HTTP] Request failed with code: 400
22:59:13.629 > [RETRY] All retry attempts failed - rolled back nonce to 1
22:59:13.635 > [RETRY] Consecutive failures: 4
22:59:13.638 > ✗ Auto-recovery failed - restarting key exchange
22:59:15.735 > [WebSocket] Disconnected!
22:59:15.735 > [224.7] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED     
22:59:15.743 > ✓ Public key loaded from NVS
22:59:15.840 > [224.8] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:15.940 > [224.9] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:15.948 > Generating fresh master key from entropy...
22:59:15.955 > Generated master key (32): B61908B68C02FEAF7DA05AE448200BB7 704D5F8BB35DD8B21D720674223FAF77
22:59:15.961 > Using reduced master key (byte % 3) for NTRU encryption only
22:59:15.972 > NTRU encrypted master key (502): 0079000700080073006A000200610066 00380007007D0018000F001A000B0006 ...
22:59:15.980 > POST http://10.45.98.115:8081/master-key
22:59:16.129 > ✓ Master key exchange completed
22:59:16.231 > [225.2] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:16.240 > Loading master key from NVS and deriving symmetric keys...
22:59:16.242 > Loaded master key from NVS (32): B61908B68C02FEAF7DA05AE448200BB7 704D5F8BB35DD8B21D720674223FAF77 
22:59:16.253 > Derived HMAC key (32): 3F4DD0A02FC15AFA419D9EEFAF96E771 6315CBF27583EA525B5FBBB1D99CC0AF
22:59:16.258 > Derived Tinkerbell key (16): F8D40D5902C42AEF41575D842AD7978C 
22:59:16.264 > Derived Transposition key (16): EEBC0B20A72C44F9CDF39209E2C58300
22:59:16.272 > ✓ Symmetric keys derived successfully
22:59:16.275 > Nonce tracker reset - new session started
22:59:16.772 > Waiting for server to process master key...
22:59:16.775 > ✓ Symmetric keys ready - starting health data transmission
22:59:16.872 > [225.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:16.973 > [225.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:17.073 > [226.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:17.173 > [226.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:17.273 > [226.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:17.373 > [226.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:17.473 > [226.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:17.573 > [226.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:17.673 > [226.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:17.773 > [226.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:17.873 > [226.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:17.972 > [226.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:18.073 > [227.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:18.173 > [227.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:18.273 > [227.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:18.373 > [227.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:18.473 > [227.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:18.573 > [227.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:18.673 > [227.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:18.773 > [227.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:18.873 > [227.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:18.973 > [227.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:19.073 > [228.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:19.173 > [228.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:19.274 > [228.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:19.373 > [228.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:19.473 > [228.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:19.574 > [228.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:19.672 > [228.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:19.773 > [228.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:19.873 > [228.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:19.973 > [228.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:20.073 > [229.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:20.173 > [229.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:20.273 > [229.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:20.374 > [229.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:20.473 > [229.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:20.573 > [229.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:20.674 > [229.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:25.779 > [234.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:25.879 > [WebSocket] Disconnected!
22:59:25.879 > [234.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED     
22:59:25.979 > [234.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:26.079 > [235.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:26.180 > [235.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:26.279 > [235.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:26.380 > [235.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:26.480 > [235.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:26.580 > [235.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:26.679 > [235.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:26.780 > [235.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:26.788 > Generated health data: HR-63 SPO2-95 STEPS-1205
22:59:26.791 > [RETRY] Attempting to send health data (Max retries: 3)
22:59:26.797 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
22:59:26.802 > Generated health data: HR-67 SPO2-95 STEPS-1222
22:59:26.804 > [ESP32] MsgKeys: lfsrSeed=0xB240DBEA tnk[0..3]=F08F97BE trn[0..3]=3AD0A07C
22:59:26.810 > 1_After_Salt (26): 48522D36372053504F322D3935205354 4550532D313232324D50
22:59:26.819 > 2_After_Padding (32): 48522D36372053504F322D3935205354 4550532D313232324D50000000000000
22:59:26.827 > [ESP32][LFSR] Initializing - Seed: 0xB240DBEA SeedBe: 0xEADB40B2 ChaosKey[0..3]: F08F97BE InitialTap: 0x0029 State: 0xB240DBEA
22:59:26.835 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3935205354 Buffer size: 32 bytes
22:59:26.843 > 3_After_LFSR (32): A2896D84E5D56A2C1023FC81589FB99B DE2CB06584517A7B14ED21AC3B77573E
22:59:26.852 > [ESP32][LFSR] Keystream (first 16 bytes): EADB40B2D2F5397C5F11D1B86DBFEACF
22:59:26.857 > [ESP32][TINKERBELL] Input (first 16 bytes): A2896D84E5D56A2C1023FC81589FB99B Nonce: 0x00000001 Buffer size: 32 bytes
22:59:26.869 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: F08F97BE
22:59:26.880 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 00B75AA19864292335A854C05A7166EE
22:59:26.888 > 4_After_Tinkerbell (32): A23E37257DB1430F258BA84102EEDF75 159E79374A87609BD3F81A94AC782106 
22:59:26.896 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 00B75AA19864292335A854C05A7166EE
22:59:26.902 > 5_After_Transposition (32): 433E15A80225EE75DF8BA2374A41B10F 609E25797D37879B21D30694F8AC781A 
22:59:26.910 > [ESP32] === HMAC DEBUG INFO ===
22:59:26.913 > [ESP32] HMAC Key being used: 3F4DD0A02FC15AFA419D9EEFAF96E7716315CBF27583EA525B5FBBB1D99CC0AF        
22:59:26.921 > [ESP32] HMAC Input length: 44 bytes
22:59:26.924 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001433E15A80225EE75DF8BA2374A41B10F609E2579
22:59:26.935 > [ESP32] Nonce: 0x00000001
22:59:26.935 > [ESP32] Packet size before HMAC: 60
22:59:26.941 > [ESP32] Computed HMAC Tag: 1D70FC6EBE860368AFB802013B9DEC06
22:59:26.946 > [ESP32] === END HMAC DEBUG ===
22:59:26.946 > 6_Final_Packet (60): 810218001800040800000001433E15A8 0225EE75DF8BA2374A41B10F609E2579 ...
22:59:26.955 > [RETRY] Attempt 1/3 (nonce: 1)
22:59:26.958 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:26.964 > Sending pipeline data to server (560 bytes)
22:59:27.131 > [HTTP] Response code: 400
22:59:27.132 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:27.137 > [HTTP] Request failed with code: 400
22:59:27.140 > [RETRY] Send failed, waiting 100 ms before retry
22:59:27.237 > [RETRY] Attempt 2/3 (nonce: 1)
22:59:27.237 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:27.242 > Sending pipeline data to server (560 bytes)
22:59:27.385 > [HTTP] Response code: 400
22:59:27.387 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:27.392 > [HTTP] Request failed with code: 400
22:59:27.410 > [RETRY] Send failed, waiting 200 ms before retry
22:59:27.590 > [RETRY] Attempt 3/3 (nonce: 1)
22:59:27.590 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:27.595 > Sending pipeline data to server (560 bytes)
22:59:27.907 > [HTTP] Response code: 400
22:59:27.907 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:27.912 > [HTTP] Request failed with code: 400
22:59:27.915 > [RETRY] All retry attempts failed - rolled back nonce to 0
22:59:27.921 > [RETRY] Consecutive failures: 5
22:59:27.923 > [EMERGENCY] Triggering emergency reset!
22:59:27.926 > [CRYPTO] Resetting cryptographic state
22:59:27.932 > [CRYPTO] Crypto state reset complete
22:59:27.934 > [CRYPTO] Packet counter: 4
22:59:27.937 > [EMERGENCY] Emergency reset complete
22:59:27.940 > Health data send failed (retry count: 1/3)
22:59:28.043 > [237.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:28.052 > Generated health data: HR-63 SPO2-95 STEPS-1211
22:59:28.054 > [RETRY] Attempting to send health data (Max retries: 3)
22:59:28.059 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
22:59:28.065 > Generated health data: HR-63 SPO2-95 STEPS-1211
22:59:28.068 > [ESP32] MsgKeys: lfsrSeed=0xB240DBEA tnk[0..3]=F08F97BE trn[0..3]=3AD0A07C
22:59:28.074 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313231314D50
22:59:28.082 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313231314D50000000000000
22:59:28.090 > [ESP32][LFSR] Initializing - Seed: 0xB240DBEA SeedBe: 0xEADB40B2 ChaosKey[0..3]: F08F97BE InitialTap: 0x0029 State: 0xB240DBEA
22:59:28.099 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
22:59:28.107 > 3_After_LFSR (32): A2896D84E1D56A2C1023FC81589FB99B DE2CB0658451797814ED21AC3B77573E
22:59:28.115 > [ESP32][LFSR] Keystream (first 16 bytes): EADB40B2D2F5397C5F11D1B86DBFEACF
22:59:28.121 > [ESP32][TINKERBELL] Input (first 16 bytes): A2896D84E1D56A2C1023FC81589FB99B Nonce: 0x00000001 Buffer size: 32 bytes
22:59:28.131 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: F08F97BE
22:59:28.143 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 00B75AA19864292335A854C05A7166EE
22:59:28.151 > 4_After_Tinkerbell (32): A23E372579B1430F258BA84102EEDF75 159E79374A876398D3F81A94AC782106 
22:59:28.160 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 00B75AA19864292335A854C05A7166EE
22:59:28.166 > 5_After_Transposition (32): 433E15A80225EE75DF8BA2374A41B10F 639E25797937879821D30694F8AC781A 
22:59:28.173 > [ESP32] === HMAC DEBUG INFO ===
22:59:28.176 > [ESP32] HMAC Key being used: 3F4DD0A02FC15AFA419D9EEFAF96E7716315CBF27583EA525B5FBBB1D99CC0AF
22:59:28.185 > [ESP32] HMAC Input length: 44 bytes
22:59:28.188 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001433E15A80225EE75DF8BA2374A41B10F639E2579
22:59:28.198 > [ESP32] Nonce: 0x00000001
22:59:28.198 > [ESP32] Packet size before HMAC: 60
22:59:28.204 > [ESP32] Computed HMAC Tag: 292A3E5200AEBE360CAD102F3B93340A
22:59:28.210 > [ESP32] === END HMAC DEBUG ===
22:59:28.210 > 6_Final_Packet (60): 810218001800040800000001433E15A8 0225EE75DF8BA2374A41B10F639E2579 ...
22:59:28.218 > [RETRY] Attempt 1/3 (nonce: 1)
22:59:28.221 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:28.227 > Sending pipeline data to server (560 bytes)
22:59:28.386 > [HTTP] Response code: 400
22:59:28.386 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:28.391 > [HTTP] Request failed with code: 400
22:59:28.394 > [RETRY] Send failed, waiting 100 ms before retry
22:59:28.489 > [RETRY] Attempt 2/3 (nonce: 1)
22:59:28.489 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:28.495 > Sending pipeline data to server (560 bytes)
22:59:28.638 > [HTTP] Response code: 400
22:59:28.638 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:28.643 > [HTTP] Request failed with code: 400
22:59:28.647 > [RETRY] Send failed, waiting 200 ms before retry
22:59:28.842 > [RETRY] Attempt 3/3 (nonce: 1)
22:59:28.842 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:28.848 > Sending pipeline data to server (560 bytes)
22:59:29.141 > [HTTP] Response code: 400
22:59:29.141 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:29.146 > [HTTP] Request failed with code: 400
22:59:29.149 > [RETRY] All retry attempts failed - rolled back nonce to 0
22:59:29.154 > [RETRY] Consecutive failures: 1
22:59:29.157 > Health data send failed (retry count: 2/3)
22:59:29.256 > [238.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:29.264 > Generated health data: HR-63 SPO2-95 STEPS-1214
22:59:29.267 > [RETRY] Attempting to send health data (Max retries: 3)
22:59:29.272 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
22:59:29.278 > Generated health data: HR-63 SPO2-95 STEPS-1213
22:59:29.281 > [ESP32] MsgKeys: lfsrSeed=0xB240DBEA tnk[0..3]=F08F97BE trn[0..3]=3AD0A07C
22:59:29.287 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313231334D50
22:59:29.296 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313231334D50000000000000
22:59:29.304 > [ESP32][LFSR] Initializing - Seed: 0xB240DBEA SeedBe: 0xEADB40B2 ChaosKey[0..3]: F08F97BE InitialTap: 0x0029 State: 0xB240DBEA
22:59:29.312 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
22:59:29.320 > 3_After_LFSR (32): A2896D84E1D56A2C1023FC81589FB99B DE2CB0658451797A14ED21AC3B77573E 
22:59:29.328 > [ESP32][LFSR] Keystream (first 16 bytes): EADB40B2D2F5397C5F11D1B86DBFEACF
22:59:29.333 > [ESP32][TINKERBELL] Input (first 16 bytes): A2896D84E1D56A2C1023FC81589FB99B Nonce: 0x00000001 Buffer size: 32 bytes
22:59:29.345 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: F08F97BE
22:59:29.356 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 00B75AA19864292335A854C05A7166EE
22:59:29.364 > 4_After_Tinkerbell (32): A23E372579B1430F258BA84102EEDF75 159E79374A87639AD3F81A94AC782106 
22:59:29.373 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 00B75AA19864292335A854C05A7166EE
22:59:29.378 > 5_After_Transposition (32): 433E15A80225EE75DF8BA2374A41B10F 639E25797937879A21D30694F8AC781A 
22:59:29.386 > [ESP32] === HMAC DEBUG INFO ===
22:59:29.389 > [ESP32] HMAC Key being used: 3F4DD0A02FC15AFA419D9EEFAF96E7716315CBF27583EA525B5FBBB1D99CC0AF        
22:59:29.398 > [ESP32] HMAC Input length: 44 bytes
22:59:29.401 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001433E15A80225EE75DF8BA2374A41B10F639E2579
22:59:29.412 > [ESP32] Nonce: 0x00000001
22:59:29.412 > [ESP32] Packet size before HMAC: 60
22:59:29.418 > [ESP32] Computed HMAC Tag: AB4857E4CFC8B8885B116196AE96E1C9
22:59:29.423 > [ESP32] === END HMAC DEBUG ===
22:59:29.423 > 6_Final_Packet (60): 810218001800040800000001433E15A8 0225EE75DF8BA2374A41B10F639E2579 ...
22:59:29.431 > [RETRY] Attempt 1/3 (nonce: 1)
22:59:29.434 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:29.440 > Sending pipeline data to server (560 bytes)
22:59:29.645 > [HTTP] Response code: 400
22:59:29.645 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:29.651 > [HTTP] Request failed with code: 400
22:59:29.653 > [RETRY] Send failed, waiting 100 ms before retry
22:59:29.748 > [RETRY] Attempt 2/3 (nonce: 1)
22:59:29.748 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:29.754 > Sending pipeline data to server (560 bytes)
22:59:29.926 > [HTTP] Response code: 400
22:59:29.926 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:29.932 > [HTTP] Request failed with code: 400
22:59:29.935 > [RETRY] Send failed, waiting 200 ms before retry
22:59:30.130 > [RETRY] Attempt 3/3 (nonce: 1)
22:59:30.131 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:30.136 > Sending pipeline data to server (560 bytes)
22:59:30.400 > [HTTP] Response code: 400
22:59:30.400 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:30.406 > [HTTP] Request failed with code: 400
22:59:30.407 > [RETRY] All retry attempts failed - rolled back nonce to 0
22:59:30.413 > [RETRY] Consecutive failures: 2
22:59:30.416 > Health data send failed (retry count: 3/3)
22:59:30.419 > Health data transmission failed after max retries
22:59:30.524 > [239.5] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:30.531 > ERROR state - attempting recovery
22:59:30.533 > [RETRY] Attempting to send health data (Max retries: 3)
22:59:30.539 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
22:59:30.545 > Generated health data: HR-63 SPO2-95 STEPS-1236
22:59:30.548 > [ESP32] MsgKeys: lfsrSeed=0xB240DBEA tnk[0..3]=F08F97BE trn[0..3]=3AD0A07C
22:59:30.555 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313233364D50
22:59:30.561 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313233364D50000000000000 
22:59:30.569 > [ESP32][LFSR] Initializing - Seed: 0xB240DBEA SeedBe: 0xEADB40B2 ChaosKey[0..3]: F08F97BE InitialTap: 0x0029 State: 0xB240DBEA
22:59:30.580 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
22:59:30.588 > 3_After_LFSR (32): A2896D84E1D56A2C1023FC81589FB99B DE2CB06584517B7F14ED21AC3B77573E
22:59:30.594 > [ESP32][LFSR] Keystream (first 16 bytes): EADB40B2D2F5397C5F11D1B86DBFEACF
22:59:30.603 > [ESP32][TINKERBELL] Input (first 16 bytes): A2896D84E1D56A2C1023FC81589FB99B Nonce: 0x00000001 Buffer size: 32 bytes
22:59:30.611 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: F08F97BE
22:59:30.623 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 00B75AA19864292335A854C05A7166EE
22:59:30.631 > 4_After_Tinkerbell (32): A23E372579B1430F258BA84102EEDF75 159E79374A87619FD3F81A94AC782106
22:59:30.639 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 00B75AA19864292335A854C05A7166EE
22:59:30.647 > 5_After_Transposition (32): 433E15A80225EE75DF8BA2374A41B10F 619E25797937879F21D30694F8AC781A        
22:59:30.656 > [ESP32] === HMAC DEBUG INFO ===
22:59:30.659 > [ESP32] HMAC Key being used: 3F4DD0A02FC15AFA419D9EEFAF96E7716315CBF27583EA525B5FBBB1D99CC0AF
22:59:30.667 > [ESP32] HMAC Input length: 44 bytes
22:59:30.670 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001433E15A80225EE75DF8BA2374A41B10F619E2579
22:59:30.678 > [ESP32] Nonce: 0x00000001
22:59:30.681 > [ESP32] Packet size before HMAC: 60
22:59:30.683 > [ESP32] Computed HMAC Tag: 0E94EB46125410EE2FAC64521443FBAB
22:59:30.689 > [ESP32] === END HMAC DEBUG ===
22:59:30.692 > 6_Final_Packet (60): 810218001800040800000001433E15A8 0225EE75DF8BA2374A41B10F619E2579 ...
22:59:30.700 > [RETRY] Attempt 1/3 (nonce: 1)
22:59:30.703 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:30.705 > Sending pipeline data to server (560 bytes)
22:59:30.901 > [HTTP] Response code: 400
22:59:30.901 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:30.906 > [HTTP] Request failed with code: 400
22:59:30.909 > [RETRY] Send failed, waiting 100 ms before retry
22:59:31.006 > [RETRY] Attempt 2/3 (nonce: 1)
22:59:31.006 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:31.011 > Sending pipeline data to server (560 bytes)
22:59:31.155 > [HTTP] Response code: 400
22:59:31.155 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:31.161 > [HTTP] Request failed with code: 400
22:59:31.163 > [RETRY] Send failed, waiting 200 ms before retry
22:59:31.359 > [RETRY] Attempt 3/3 (nonce: 1)
22:59:31.359 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:31.364 > Sending pipeline data to server (560 bytes)
22:59:31.654 > [HTTP] Response code: 400
22:59:31.655 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:31.661 > [HTTP] Request failed with code: 400
22:59:31.663 > [RETRY] All retry attempts failed - rolled back nonce to 0
22:59:31.669 > [RETRY] Consecutive failures: 3
22:59:31.671 > ✗ Auto-recovery failed - restarting key exchange
22:59:38.775 > [247.7] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:38.783 > ✓ Public key loaded from NVS
22:59:38.879 > [WebSocket] Disconnected!
22:59:38.879 > [247.8] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:38.979 > [247.9] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:38.987 > Generating fresh master key from entropy...
22:59:38.994 > Generated master key (32): 549F16C0A30EF21DE8258FE2DCF934DD 20BBBC1C2D2FF074211DEA1DDC47C7E2 
22:59:39.000 > Using reduced master key (byte % 3) for NTRU encryption only
22:59:39.011 > NTRU encrypted master key (502): 00770006000700710069000200610067 00370007007F001900100018000A0008 ...
22:59:39.019 > POST http://10.45.98.115:8081/master-key
22:59:39.162 > ✓ Master key exchange completed
22:59:39.264 > [248.2] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:39.272 > Loading master key from NVS and deriving symmetric keys...
22:59:39.275 > Loaded master key from NVS (32): 549F16C0A30EF21DE8258FE2DCF934DD 20BBBC1C2D2FF074211DEA1DDC47C7E2 
22:59:39.287 > Derived HMAC key (32): E6BAFB889F97E249D1DF2A4E083BA0DD 81B1568E097725E4A5329667915C0C23 
22:59:39.292 > Derived Tinkerbell key (16): F3AE8F9B416D2E90EB6B98CDA54A95A4
22:59:39.298 > Derived Transposition key (16): E66427C9FBDE5128BBCD00C7989020FE
22:59:39.306 > ✓ Symmetric keys derived successfully
22:59:39.308 > Nonce tracker reset - new session started
22:59:39.805 > Waiting for server to process master key...
22:59:39.808 > ✓ Symmetric keys ready - starting health data transmission
22:59:39.906 > [248.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:40.006 > [248.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:40.106 > [249.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:40.206 > [249.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:40.306 > [249.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:40.406 > [249.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:40.506 > [249.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:40.606 > [249.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:40.706 > [249.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:40.806 > [249.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:40.906 > [249.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:41.006 > [249.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:41.107 > [250.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:41.206 > [250.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:41.306 > [250.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:41.406 > [250.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:41.506 > [250.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:41.607 > [250.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:41.706 > [250.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:41.806 > [250.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:41.906 > [250.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:42.006 > [250.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:42.106 > [251.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:42.206 > [251.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:42.306 > [251.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:42.406 > [251.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:42.506 > [251.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:42.606 > [251.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:42.706 > [251.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:42.806 > [251.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:42.906 > [251.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:43.006 > [251.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:43.106 > [252.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:43.206 > [252.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:43.306 > [252.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:43.406 > [252.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:43.506 > [252.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:43.606 > [252.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:43.706 > [252.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:43.806 > [252.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:48.912 > [257.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:49.012 > [WebSocket] Disconnected!
22:59:49.013 > [257.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED     
22:59:49.114 > [258.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:49.213 > [258.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:49.313 > [258.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:49.413 > [258.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:49.513 > [258.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:49.613 > [258.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:49.714 > [258.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:49.813 > [258.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:49.821 > Generated health data: HR-64 SPO2-95 STEPS-1329
22:59:49.824 > [RETRY] Attempting to send health data (Max retries: 3)
22:59:49.829 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
22:59:49.835 > Generated health data: HR-64 SPO2-95 STEPS-1297
22:59:49.838 > [ESP32] MsgKeys: lfsrSeed=0xF61BB0B1 tnk[0..3]=D3A0D3C9 trn[0..3]=088B58E9
22:59:49.844 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313239374D50
22:59:49.852 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313239374D50000000000000
22:59:49.860 > [ESP32][LFSR] Initializing - Seed: 0xF61BB0B1 SeedBe: 0xB1B01BF6 ChaosKey[0..3]: D3A0D3C9 InitialTap: 0x0029 State: 0xF61BB0B1
22:59:49.869 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
22:59:49.877 > 3_After_LFSR (32): F9E236C052BC0418ACCF34434C4FB514 EC736E41E703218B2A757558C029CC90 
22:59:49.884 > [ESP32][LFSR] Keystream (first 16 bytes): B1B01BF6669C5748E3FD197A796FE640
22:59:49.891 > [ESP32][TINKERBELL] Input (first 16 bytes): F9E236C052BC0418ACCF34434C4FB514 Nonce: 0x00000001 Buffer size: 32 bytes
22:59:49.902 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: D3A0D3C9
22:59:49.913 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 6F0FE880B411A8C5AAA6BD90D83A09AD
22:59:49.921 > 4_After_Tinkerbell (32): 96EDDE40E6ADACDD066989D39475BCB9 A2DB7504F6D40798207558BB77D10355 
22:59:49.930 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 6F0FE880B411A8C5AAA6BD90D83A09AD
22:59:49.935 > 5_After_Transposition (32): F6D4079877D10355066989D3E6ADACDD 04DBA27558BB20759475BCB996EDDE40 
22:59:49.943 > [ESP32] === HMAC DEBUG INFO ===
22:59:49.947 > [ESP32] HMAC Key being used: E6BAFB889F97E249D1DF2A4E083BA0DD81B1568E097725E4A5329667915C0C23        
22:59:49.954 > [ESP32] HMAC Input length: 44 bytes
22:59:49.958 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001F6D4079877D10355066989D3E6ADACDD04DBA275
22:59:49.968 > [ESP32] Nonce: 0x00000001
22:59:49.968 > [ESP32] Packet size before HMAC: 60
22:59:49.974 > [ESP32] Computed HMAC Tag: C70D43047B467F5CEF550CC851A2F66E
22:59:49.979 > [ESP32] === END HMAC DEBUG ===
22:59:49.979 > 6_Final_Packet (60): 810218001800040800000001F6D40798 77D10355066989D3E6ADACDD04DBA275 ...
22:59:49.988 > [RETRY] Attempt 1/3 (nonce: 1)
22:59:49.991 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:49.997 > Sending pipeline data to server (560 bytes)
22:59:50.157 > [HTTP] Response code: 400
22:59:50.157 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:50.163 > [HTTP] Request failed with code: 400
22:59:50.166 > [RETRY] Send failed, waiting 100 ms before retry
22:59:50.262 > [RETRY] Attempt 2/3 (nonce: 1)
22:59:50.263 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:50.268 > Sending pipeline data to server (560 bytes)
22:59:50.413 > [HTTP] Response code: 400
22:59:50.413 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:50.418 > [HTTP] Request failed with code: 400
22:59:50.421 > [RETRY] Send failed, waiting 200 ms before retry
22:59:50.617 > [RETRY] Attempt 3/3 (nonce: 1)
22:59:50.617 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:50.622 > Sending pipeline data to server (560 bytes)
22:59:50.916 > [HTTP] Response code: 400
22:59:50.916 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:50.922 > [HTTP] Request failed with code: 400
22:59:50.924 > [RETRY] All retry attempts failed - rolled back nonce to 0
22:59:50.930 > [RETRY] Consecutive failures: 4
22:59:50.933 > Health data send failed (retry count: 1/3)
22:59:51.032 > [260.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:51.040 > Generated health data: HR-64 SPO2-95 STEPS-1311
22:59:51.043 > [RETRY] Attempting to send health data (Max retries: 3)
22:59:51.048 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
22:59:51.053 > Generated health data: HR-64 SPO2-95 STEPS-1334
22:59:51.056 > [ESP32] MsgKeys: lfsrSeed=0xF61BB0B1 tnk[0..3]=D3A0D3C9 trn[0..3]=088B58E9
22:59:51.062 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313333344D50
22:59:51.071 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313333344D50000000000000
22:59:51.079 > [ESP32][LFSR] Initializing - Seed: 0xF61BB0B1 SeedBe: 0xB1B01BF6 ChaosKey[0..3]: D3A0D3C9 InitialTap: 0x0029 State: 0xF61BB0B1
22:59:51.087 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
22:59:51.095 > 3_After_LFSR (32): F9E236C052BC0418ACCF34434C4FB514 EC736E41E7022B882A757558C029CC90
22:59:51.104 > [ESP32][LFSR] Keystream (first 16 bytes): B1B01BF6669C5748E3FD197A796FE640
22:59:51.109 > [ESP32][TINKERBELL] Input (first 16 bytes): F9E236C052BC0418ACCF34434C4FB514 Nonce: 0x00000001 Buffer size: 32 bytes
22:59:51.121 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: D3A0D3C9
22:59:51.131 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 6F0FE880B411A8C5AAA6BD90D83A09AD
22:59:51.139 > 4_After_Tinkerbell (32): 96EDDE40E6ADACDD066989D39475BCB9 A2DB7504F6D50D9B207558BB77D10355 
22:59:51.148 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 6F0FE880B411A8C5AAA6BD90D83A09AD
22:59:51.153 > 5_After_Transposition (32): F6D50D9B77D10355066989D3E6ADACDD 04DBA27558BB20759475BCB996EDDE40 
22:59:51.161 > [ESP32] === HMAC DEBUG INFO ===
22:59:51.164 > [ESP32] HMAC Key being used: E6BAFB889F97E249D1DF2A4E083BA0DD81B1568E097725E4A5329667915C0C23
22:59:51.172 > [ESP32] HMAC Input length: 44 bytes
22:59:51.176 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001F6D50D9B77D10355066989D3E6ADACDD04DBA275
22:59:51.187 > [ESP32] Nonce: 0x00000001
22:59:51.187 > [ESP32] Packet size before HMAC: 60
22:59:51.192 > [ESP32] Computed HMAC Tag: AC7907F14444F78B00F34ABF97F73B99
22:59:51.198 > [ESP32] === END HMAC DEBUG ===
22:59:51.198 > 6_Final_Packet (60): 810218001800040800000001F6D50D9B 77D10355066989D3E6ADACDD04DBA275 ...
22:59:51.207 > [RETRY] Attempt 1/3 (nonce: 1)
22:59:51.210 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:51.216 > Sending pipeline data to server (560 bytes)
22:59:51.418 > [HTTP] Response code: 400
22:59:51.419 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:51.425 > [HTTP] Request failed with code: 400
22:59:51.427 > [RETRY] Send failed, waiting 100 ms before retry
22:59:51.523 > [RETRY] Attempt 2/3 (nonce: 1)
22:59:51.523 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:51.528 > Sending pipeline data to server (560 bytes)
22:59:51.666 > [HTTP] Response code: 400
22:59:51.667 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:51.672 > [HTTP] Request failed with code: 400
22:59:51.675 > [RETRY] Send failed, waiting 200 ms before retry
22:59:51.870 > [RETRY] Attempt 3/3 (nonce: 1)
22:59:51.870 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:51.876 > Sending pipeline data to server (560 bytes)
22:59:52.172 > [HTTP] Response code: 400
22:59:52.172 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:52.178 > [HTTP] Request failed with code: 400
22:59:52.181 > [RETRY] All retry attempts failed - rolled back nonce to 0
22:59:52.186 > [RETRY] Consecutive failures: 5
22:59:52.189 > [EMERGENCY] Triggering emergency reset!
22:59:52.192 > [CRYPTO] Resetting cryptographic state
22:59:52.197 > [CRYPTO] Crypto state reset complete
22:59:52.200 > [CRYPTO] Packet counter: 5
22:59:52.203 > [EMERGENCY] Emergency reset complete
22:59:52.205 > Health data send failed (retry count: 2/3)
22:59:52.309 > [261.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:52.316 > Generated health data: HR-64 SPO2-95 STEPS-1305
22:59:52.319 > [RETRY] Attempting to send health data (Max retries: 3)
22:59:52.325 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
22:59:52.331 > Generated health data: HR-66 SPO2-95 STEPS-1309
22:59:52.333 > [ESP32] MsgKeys: lfsrSeed=0xF61BB0B1 tnk[0..3]=D3A0D3C9 trn[0..3]=088B58E9
22:59:52.339 > 1_After_Salt (26): 48522D36362053504F322D3935205354 4550532D313330394D50
22:59:52.347 > 2_After_Padding (32): 48522D36362053504F322D3935205354 4550532D313330394D50000000000000
22:59:52.355 > [ESP32][LFSR] Initializing - Seed: 0xF61BB0B1 SeedBe: 0xB1B01BF6 ChaosKey[0..3]: D3A0D3C9 InitialTap: 0x0029 State: 0xF61BB0B1
22:59:52.364 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3935205354 Buffer size: 32 bytes
22:59:52.372 > 3_After_LFSR (32): F9E236C050BC0418ACCF34434C4FB514 EC736E41E70228852A757558C029CC90
22:59:52.381 > [ESP32][LFSR] Keystream (first 16 bytes): B1B01BF6669C5748E3FD197A796FE640
22:59:52.386 > [ESP32][TINKERBELL] Input (first 16 bytes): F9E236C050BC0418ACCF34434C4FB514 Nonce: 0x00000001 Buffer size: 32 bytes
22:59:52.397 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: D3A0D3C9
22:59:52.408 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 6F0FE880B411A8C5AAA6BD90D83A09AD
22:59:52.416 > 4_After_Tinkerbell (32): 96EDDE40E4ADACDD066989D39475BCB9 A2DB7504F6D50E96207558BB77D10355 
22:59:52.425 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 6F0FE880B411A8C5AAA6BD90D83A09AD
22:59:52.431 > 5_After_Transposition (32): F6D50E9677D10355066989D3E4ADACDD 04DBA27558BB20759475BCB996EDDE40 
22:59:52.439 > [ESP32] === HMAC DEBUG INFO ===
22:59:52.442 > [ESP32] HMAC Key being used: E6BAFB889F97E249D1DF2A4E083BA0DD81B1568E097725E4A5329667915C0C23        
22:59:52.450 > [ESP32] HMAC Input length: 44 bytes
22:59:52.453 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001F6D50E9677D10355066989D3E4ADACDD04DBA275
22:59:52.464 > [ESP32] Nonce: 0x00000001
22:59:52.464 > [ESP32] Packet size before HMAC: 60
22:59:52.469 > [ESP32] Computed HMAC Tag: 5506F3EAB855036DF5FF6A0FF0165C1B
22:59:52.475 > [ESP32] === END HMAC DEBUG ===
22:59:52.475 > 6_Final_Packet (60): 810218001800040800000001F6D50E96 77D10355066989D3E4ADACDD04DBA275 ...
22:59:52.483 > [RETRY] Attempt 1/3 (nonce: 1)
22:59:52.486 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:52.492 > Sending pipeline data to server (560 bytes)
22:59:52.677 > [HTTP] Response code: 400
22:59:52.677 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:52.683 > [HTTP] Request failed with code: 400
22:59:52.685 > [RETRY] Send failed, waiting 100 ms before retry
22:59:52.782 > [RETRY] Attempt 2/3 (nonce: 1)
22:59:52.782 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:52.788 > Sending pipeline data to server (560 bytes)
22:59:52.951 > [HTTP] Response code: 400
22:59:52.951 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:52.957 > [HTTP] Request failed with code: 400
22:59:52.960 > [RETRY] Send failed, waiting 200 ms before retry
22:59:53.156 > [RETRY] Attempt 3/3 (nonce: 1)
22:59:53.156 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:53.161 > Sending pipeline data to server (560 bytes)
22:59:53.425 > [HTTP] Response code: 400
22:59:53.425 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:53.430 > [HTTP] Request failed with code: 400
22:59:53.433 > [RETRY] All retry attempts failed - rolled back nonce to 0
22:59:53.438 > [RETRY] Consecutive failures: 1
22:59:53.441 > Health data send failed (retry count: 3/3)
22:59:53.444 > Health data transmission failed after max retries
22:59:53.551 > [262.5] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
22:59:53.556 > ERROR state - attempting recovery
22:59:53.559 > [RETRY] Attempting to send health data (Max retries: 3)
22:59:53.565 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
22:59:53.570 > Generated health data: HR-64 SPO2-95 STEPS-1316
22:59:53.573 > [ESP32] MsgKeys: lfsrSeed=0xF61BB0B1 tnk[0..3]=D3A0D3C9 trn[0..3]=088B58E9
22:59:53.581 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313331364D50
22:59:53.587 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313331364D50000000000000
22:59:53.595 > [ESP32][LFSR] Initializing - Seed: 0xF61BB0B1 SeedBe: 0xB1B01BF6 ChaosKey[0..3]: D3A0D3C9 InitialTap: 0x0029 State: 0xF61BB0B1
22:59:53.606 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
22:59:53.614 > 3_After_LFSR (32): F9E236C052BC0418ACCF34434C4FB514 EC736E41E702298A2A757558C029CC90
22:59:53.620 > [ESP32][LFSR] Keystream (first 16 bytes): B1B01BF6669C5748E3FD197A796FE640
22:59:53.628 > [ESP32][TINKERBELL] Input (first 16 bytes): F9E236C052BC0418ACCF34434C4FB514 Nonce: 0x00000001 Buffer size: 32 bytes
22:59:53.637 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: D3A0D3C9
22:59:53.648 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 6F0FE880B411A8C5AAA6BD90D83A09AD
22:59:53.655 > 4_After_Tinkerbell (32): 96EDDE40E6ADACDD066989D39475BCB9 A2DB7504F6D50F99207558BB77D10355 
22:59:53.665 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 6F0FE880B411A8C5AAA6BD90D83A09AD
22:59:53.673 > 5_After_Transposition (32): F6D50F9977D10355066989D3E6ADACDD 04DBA27558BB20759475BCB996EDDE40 
22:59:53.681 > [ESP32] === HMAC DEBUG INFO ===
22:59:53.684 > [ESP32] HMAC Key being used: E6BAFB889F97E249D1DF2A4E083BA0DD81B1568E097725E4A5329667915C0C23        
22:59:53.692 > [ESP32] HMAC Input length: 44 bytes
22:59:53.695 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001F6D50F9977D10355066989D3E6ADACDD04DBA275
22:59:53.703 > [ESP32] Nonce: 0x00000001
22:59:53.706 > [ESP32] Packet size before HMAC: 60
22:59:53.709 > [ESP32] Computed HMAC Tag: 5BA7121BB83C7DFF1C19192ADF1C31F2
22:59:53.715 > [ESP32] === END HMAC DEBUG ===
22:59:53.717 > 6_Final_Packet (60): 810218001800040800000001F6D50F99 77D10355066989D3E6ADACDD04DBA275 ...
22:59:53.726 > [RETRY] Attempt 1/3 (nonce: 1)
22:59:53.728 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:53.731 > Sending pipeline data to server (560 bytes)
22:59:53.933 > [HTTP] Response code: 400
22:59:53.933 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:53.937 > [HTTP] Request failed with code: 400
22:59:53.941 > [RETRY] Send failed, waiting 100 ms before retry
22:59:54.037 > [RETRY] Attempt 2/3 (nonce: 1)
22:59:54.037 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:54.043 > Sending pipeline data to server (560 bytes)
22:59:54.180 > [HTTP] Response code: 400
22:59:54.180 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:54.184 > [HTTP] Request failed with code: 400
22:59:54.187 > [RETRY] Send failed, waiting 200 ms before retry
22:59:54.384 > [RETRY] Attempt 3/3 (nonce: 1)
22:59:54.384 > POST http://10.45.98.115:8081/health-data with pipeline data
22:59:54.390 > Sending pipeline data to server (560 bytes)
22:59:54.682 > [HTTP] Response code: 400
22:59:54.683 > [HTTP] Error response: {"error":"Decryption failed"}
22:59:54.687 > [HTTP] Request failed with code: 400
22:59:54.690 > [RETRY] All retry attempts failed - rolled back nonce to 0
22:59:54.695 > [RETRY] Consecutive failures: 2
22:59:54.699 > ✗ Auto-recovery failed - restarting key exchange
23:00:01.801 > [270.7] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:01.810 > ✓ Public key loaded from NVS
23:00:01.905 > [WebSocket] Disconnected!
23:00:01.905 > [270.8] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:02.006 > [270.9] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:02.015 > Generating fresh master key from entropy...
23:00:02.021 > Generated master key (32): 10B90794E4EC3017C1A7A004D0F94925 415959F817DA8C9EB54A33E0BA014C1D 
23:00:02.028 > Using reduced master key (byte % 3) for NTRU encryption only
23:00:02.038 > NTRU encrypted master key (502): 007800080007007200680002005F0067 00370008007E001900100018000A0007 ...
23:00:02.047 > POST http://10.45.98.115:8081/master-key
23:00:02.187 > ✓ Master key exchange completed
23:00:02.289 > [271.2] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:02.297 > Loading master key from NVS and deriving symmetric keys...
23:00:02.299 > Loaded master key from NVS (32): 10B90794E4EC3017C1A7A004D0F94925 415959F817DA8C9EB54A33E0BA014C1D 
23:00:02.311 > Derived HMAC key (32): F152C31D3F3F68AD80A142197882CC94 3F92600315AB2CB67BA8C19BC7F93B4E
23:00:02.317 > Derived Tinkerbell key (16): C77532B26E5CDBEC03ACBF8A86AE7A8C 
23:00:02.322 > Derived Transposition key (16): AEED70940C206C85E1DE21670C366F5A
23:00:02.330 > ✓ Symmetric keys derived successfully
23:00:02.333 > Nonce tracker reset - new session started
23:00:02.829 > Waiting for server to process master key...
23:00:02.832 > ✓ Symmetric keys ready - starting health data transmission
23:00:02.930 > [271.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:03.031 > [272.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:03.131 > [272.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:03.231 > [272.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:03.331 > [272.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:03.431 > [272.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:03.530 > [272.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:03.631 > [272.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:03.731 > [272.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:03.830 > [272.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:03.930 > [272.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:04.031 > [273.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:04.131 > [273.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:04.231 > [273.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:04.331 > [273.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:04.431 > [273.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:04.531 > [273.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:04.631 > [273.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:04.730 > [273.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:04.830 > [273.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:04.931 > [273.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:05.031 > [274.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:05.131 > [274.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:05.231 > [274.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:05.330 > [274.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:05.430 > [274.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:05.531 > [274.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:05.630 > [274.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:05.731 > [274.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:05.830 > [274.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:05.931 > [274.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:06.031 > [275.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:06.131 > [275.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:06.230 > [275.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:06.330 > [275.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:06.430 > [275.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:06.531 > [275.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:06.630 > [275.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:06.730 > [275.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:06.830 > [275.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:11.936 > [280.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:12.037 > [WebSocket] Disconnected!
23:00:12.037 > [281.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED     
23:00:12.138 > [281.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:12.237 > [281.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:12.337 > [281.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:12.437 > [281.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:12.537 > [281.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:12.638 > [281.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:12.738 > [281.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:12.837 > [281.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: DISCONNECTED
23:00:12.846 > Generated health data: HR-64 SPO2-95 STEPS-1450
23:00:12.849 > [RETRY] Attempting to send health data (Max retries: 3)
23:00:12.854 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:00:12.860 > Generated health data: HR-64 SPO2-95 STEPS-1420
23:00:12.862 > [ESP32] MsgKeys: lfsrSeed=0x71F5C803 tnk[0..3]=502BB276 trn[0..3]=B72B7D7B
23:00:12.868 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313432304D50
23:00:12.876 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313432304D50000000000000
23:00:12.884 > [ESP32][LFSR] Initializing - Seed: 0x71F5C803 SeedBe: 0x03C8F571 ChaosKey[0..3]: 502BB276 InitialTap: 0x0029 State: 0x71F5C803
23:00:12.892 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
23:00:12.901 > 3_After_LFSR (32): 4B9AD847BBDCE72C2FC6B9ADA258CA2B E9435CD76897186636FFE8A6498295FE
23:00:12.909 > [ESP32][LFSR] Keystream (first 16 bytes): 03C8F5718FFCB47C60F494949778997F
23:00:12.915 > [ESP32][TINKERBELL] Input (first 16 bytes): 4B9AD847BBDCE72C2FC6B9ADA258CA2B Nonce: 0x00000001 Buffer size: 32 bytes
23:00:12.926 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 502BB276
23:00:12.937 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 8A551D7CB4C2700BAE753978BF292FAA
23:00:12.945 > 4_After_Tinkerbell (32): C1CFC53B0F1E972781B380D51D71E581 0881227402868F0155A5DAE4071DCF49
23:00:12.954 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 8A551D7CB4C2700BAE753978BF292FAA
23:00:12.960 > 5_After_Transposition (32): C1CFC53B1DCF490781B380D51E97270F 0881227471E5811D55A5DAE4868F0102 
23:00:12.967 > [ESP32] === HMAC DEBUG INFO ===
23:00:12.970 > [ESP32] HMAC Key being used: F152C31D3F3F68AD80A142197882CC943F92600315AB2CB67BA8C19BC7F93B4E
23:00:12.978 > [ESP32] HMAC Input length: 44 bytes
23:00:12.981 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001C1CFC53B1DCF490781B380D51E97270F08812274
23:00:12.993 > [ESP32] Nonce: 0x00000001
23:00:12.993 > [ESP32] Packet size before HMAC: 60
23:00:12.998 > [ESP32] Computed HMAC Tag: 7857AA89AFEF0958619409F1563CDE46
23:00:13.004 > [ESP32] === END HMAC DEBUG ===
23:00:13.004 > 6_Final_Packet (60): 810218001800040800000001C1CFC53B 1DCF490781B380D51E97270F08812274 ...
23:00:13.012 > [RETRY] Attempt 1/3 (nonce: 1)
23:00:13.015 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:13.024 > Sending pipeline data to server (560 bytes)
23:00:13.191 > [HTTP] Response code: 200
23:00:13.191 > [HTTP] Response: {"status":"OK:DECRYPTED"}
23:00:13.196 > [RETRY] Health data sent successfully!
23:00:13.199 > ✓ Health data #6 sent successfully
23:00:13.296 > [282.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:13.396 > [282.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:13.496 > [282.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:13.596 > [282.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:13.696 > [282.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:13.796 > [282.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:13.896 > [282.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:13.997 > [282.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:14.096 > [283.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:14.196 > [283.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:14.296 > [283.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:14.396 > [283.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:14.496 > [283.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:14.596 > [283.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:14.696 > [283.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:14.796 > [283.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:14.896 > [283.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:14.996 > [283.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:15.096 > [284.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:15.196 > [284.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:15.296 > [284.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:15.396 > [284.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:15.497 > [284.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:15.597 > [284.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:15.696 > [284.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:15.796 > [284.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:15.896 > [284.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:15.996 > [284.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:16.096 > [285.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:16.196 > [285.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:16.296 > [285.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:16.396 > [285.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:16.496 > [285.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:16.596 > [285.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:16.697 > [285.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:16.797 > [285.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:16.897 > [285.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:16.997 > [285.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:22.100 > [291.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:22.201 > [WebSocket] Disconnected!
23:00:22.201 > [291.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED     
23:00:22.302 > [291.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:22.402 > [291.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:22.502 > [291.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:22.602 > [291.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:22.702 > [291.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:22.802 > [291.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:22.902 > [291.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:23.002 > [291.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:23.102 > [292.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:23.202 > [292.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:23.210 > Generated health data: HR-64 SPO2-95 STEPS-1509
23:00:23.213 > [RETRY] Attempting to send health data (Max retries: 3)
23:00:23.219 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
23:00:23.224 > Generated health data: HR-64 SPO2-95 STEPS-1504
23:00:23.227 > [ESP32] MsgKeys: lfsrSeed=0x88873800 tnk[0..3]=3306649D trn[0..3]=E4118DBC
23:00:23.232 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313530344D50
23:00:23.241 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313530344D50000000000000
23:00:23.249 > [ESP32][LFSR] Initializing - Seed: 0x88873800 SeedBe: 0x00388788 ChaosKey[0..3]: 3306649D InitialTap: 0x0029 State: 0x88873800
23:00:23.257 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
23:00:23.266 > 3_After_LFSR (32): 486AAABEE36ED3DD808C29DCACCAD0D0 433DD9695EF61824397802C74E6A5DEC
23:00:23.274 > [ESP32][LFSR] Keystream (first 16 bytes): 00388788D74E808DCFBE04E599EA8384
23:00:23.280 > [ESP32][TINKERBELL] Input (first 16 bytes): 486AAABEE36ED3DD808C29DCACCAD0D0 Nonce: 0x00000002 Buffer size: 32 bytes
23:00:23.290 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 3306649D
23:00:23.302 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): CBB0B7A05DFF5EF1BB53D19314404696
23:00:23.310 > 4_After_Tinkerbell (32): 83DA1D1EBE918D2C3BDFF84FB88A9646 809B38C29F89496E4168900AD06CBD3E
23:00:23.318 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): CBB0B7A05DFF5EF1BB53D19314404696
23:00:23.324 > 5_After_Transposition (32): C238F84F91BE6CD04696900A2C8D9F89 B88ADF3B416883DA809B1D1E6E493EBD 
23:00:23.333 > [ESP32] === HMAC DEBUG INFO ===
23:00:23.335 > [ESP32] HMAC Key being used: F152C31D3F3F68AD80A142197882CC943F92600315AB2CB67BA8C19BC7F93B4E
23:00:23.344 > [ESP32] HMAC Input length: 44 bytes
23:00:23.347 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002C238F84F91BE6CD04696900A2C8D9F89B88ADF3B
23:00:23.357 > [ESP32] Nonce: 0x00000002
23:00:23.357 > [ESP32] Packet size before HMAC: 60
23:00:23.363 > [ESP32] Computed HMAC Tag: 9557DFB509AFF78AA0F1E9EB31AE439A
23:00:23.369 > [ESP32] === END HMAC DEBUG ===
23:00:23.369 > 6_Final_Packet (60): 810218001800040800000002C238F84F 91BE6CD04696900A2C8D9F89B88ADF3B ...
23:00:23.377 > [RETRY] Attempt 1/3 (nonce: 2)
23:00:23.380 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:23.386 > Sending pipeline data to server (560 bytes)
23:00:23.696 > [HTTP] Response code: 400
23:00:23.696 > [HTTP] Error response: {"error":"Decryption failed"}
23:00:23.702 > [HTTP] Request failed with code: 400
23:00:23.704 > [RETRY] Send failed, waiting 100 ms before retry
23:00:23.802 > [RETRY] Attempt 2/3 (nonce: 2)
23:00:23.802 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:23.808 > Sending pipeline data to server (560 bytes)
23:00:23.950 > [HTTP] Response code: 400
23:00:23.950 > [HTTP] Error response: {"error":"Decryption failed"}
23:00:23.955 > [HTTP] Request failed with code: 400
23:00:23.958 > [RETRY] Send failed, waiting 200 ms before retry
23:00:24.154 > [RETRY] Attempt 3/3 (nonce: 2)
23:00:24.154 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:24.160 > Sending pipeline data to server (560 bytes)
23:00:24.448 > [HTTP] Response code: 400
23:00:24.448 > [HTTP] Error response: {"error":"Decryption failed"}
23:00:24.453 > [HTTP] Request failed with code: 400
23:00:24.456 > [RETRY] All retry attempts failed - rolled back nonce to 1
23:00:24.462 > [RETRY] Consecutive failures: 1
23:00:24.464 > Health data send failed (retry count: 1/3)
23:00:24.563 > [293.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:24.572 > Generated health data: HR-64 SPO2-95 STEPS-1491
23:00:24.574 > [RETRY] Attempting to send health data (Max retries: 3)
23:00:24.580 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
23:00:24.585 > Generated health data: HR-64 SPO2-95 STEPS-1467
23:00:24.588 > [ESP32] MsgKeys: lfsrSeed=0x88873800 tnk[0..3]=3306649D trn[0..3]=E4118DBC
23:00:24.594 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313436374D50
23:00:24.602 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313436374D50000000000000
23:00:24.610 > [ESP32][LFSR] Initializing - Seed: 0x88873800 SeedBe: 0x00388788 ChaosKey[0..3]: 3306649D InitialTap: 0x0029 State: 0x88873800
23:00:24.619 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
23:00:24.627 > 3_After_LFSR (32): 486AAABEE36ED3DD808C29DCACCAD0D0 433DD9695EF71E27397802C74E6A5DEC
23:00:24.635 > [ESP32][LFSR] Keystream (first 16 bytes): 00388788D74E808DCFBE04E599EA8384
23:00:24.641 > [ESP32][TINKERBELL] Input (first 16 bytes): 486AAABEE36ED3DD808C29DCACCAD0D0 Nonce: 0x00000002 Buffer size: 32 bytes
23:00:24.653 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 3306649D
23:00:24.663 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): CBB0B7A05DFF5EF1BB53D19314404696
23:00:24.672 > 4_After_Tinkerbell (32): 83DA1D1EBE918D2C3BDFF84FB88A9646 809B38C29F884F6D4168900AD06CBD3E 
23:00:24.680 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): CBB0B7A05DFF5EF1BB53D19314404696
23:00:24.686 > 5_After_Transposition (32): C238F84F91BE6CD04696900A2C8D9F88 B88ADF3B416883DA809B1D1E6D4F3EBD 
23:00:24.694 > [ESP32] === HMAC DEBUG INFO ===
23:00:24.697 > [ESP32] HMAC Key being used: F152C31D3F3F68AD80A142197882CC943F92600315AB2CB67BA8C19BC7F93B4E
23:00:24.705 > [ESP32] HMAC Input length: 44 bytes
23:00:24.708 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002C238F84F91BE6CD04696900A2C8D9F88B88ADF3B
23:00:24.719 > [ESP32] Nonce: 0x00000002
23:00:24.719 > [ESP32] Packet size before HMAC: 60
23:00:24.725 > [ESP32] Computed HMAC Tag: 59568EFDEC29064EC3EED35A0E4A9A82
23:00:24.730 > [ESP32] === END HMAC DEBUG ===
23:00:24.730 > 6_Final_Packet (60): 810218001800040800000002C238F84F 91BE6CD04696900A2C8D9F88B88ADF3B ...
23:00:24.738 > [RETRY] Attempt 1/3 (nonce: 2)
23:00:24.741 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:24.747 > Sending pipeline data to server (560 bytes)
23:00:25.039 > [HTTP] Response code: 400
23:00:25.039 > [HTTP] Error response: {"error":"Decryption failed"}
23:00:25.043 > [HTTP] Request failed with code: 400
23:00:25.046 > [RETRY] Send failed, waiting 100 ms before retry
23:00:25.143 > [RETRY] Attempt 2/3 (nonce: 2)
23:00:25.143 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:25.148 > Sending pipeline data to server (560 bytes)
23:00:25.451 > [HTTP] Response code: 400
23:00:25.451 > [HTTP] Error response: {"error":"Decryption failed"}
23:00:25.457 > [HTTP] Request failed with code: 400
23:00:25.459 > [RETRY] Send failed, waiting 200 ms before retry
23:00:25.654 > [RETRY] Attempt 3/3 (nonce: 2)
23:00:25.655 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:25.660 > Sending pipeline data to server (560 bytes)
23:00:25.958 > [HTTP] Response code: 400
23:00:25.958 > [HTTP] Error response: {"error":"Decryption failed"}
23:00:25.964 > [HTTP] Request failed with code: 400
23:00:25.967 > [RETRY] All retry attempts failed - rolled back nonce to 1
23:00:25.972 > [RETRY] Consecutive failures: 2
23:00:25.975 > Health data send failed (retry count: 2/3)
23:00:26.073 > [295.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:26.082 > Generated health data: HR-64 SPO2-95 STEPS-1480
23:00:26.085 > [RETRY] Attempting to send health data (Max retries: 3)
23:00:26.090 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
23:00:26.096 > Generated health data: HR-64 SPO2-95 STEPS-1504
23:00:26.099 > [ESP32] MsgKeys: lfsrSeed=0x88873800 tnk[0..3]=3306649D trn[0..3]=E4118DBC
23:00:26.104 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313530344D50
23:00:26.113 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313530344D50000000000000
23:00:26.121 > [ESP32][LFSR] Initializing - Seed: 0x88873800 SeedBe: 0x00388788 ChaosKey[0..3]: 3306649D InitialTap: 0x0029 State: 0x88873800
23:00:26.129 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
23:00:26.137 > 3_After_LFSR (32): 486AAABEE36ED3DD808C29DCACCAD0D0 433DD9695EF61824397802C74E6A5DEC 
23:00:26.146 > [ESP32][LFSR] Keystream (first 16 bytes): 00388788D74E808DCFBE04E599EA8384
23:00:26.151 > [ESP32][TINKERBELL] Input (first 16 bytes): 486AAABEE36ED3DD808C29DCACCAD0D0 Nonce: 0x00000002 Buffer size: 32 bytes
23:00:26.162 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 3306649D
23:00:26.173 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): CBB0B7A05DFF5EF1BB53D19314404696
23:00:26.181 > 4_After_Tinkerbell (32): 83DA1D1EBE918D2C3BDFF84FB88A9646 809B38C29F89496E4168900AD06CBD3E 
23:00:26.190 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): CBB0B7A05DFF5EF1BB53D19314404696
23:00:26.195 > 5_After_Transposition (32): C238F84F91BE6CD04696900A2C8D9F89 B88ADF3B416883DA809B1D1E6E493EBD 
23:00:26.204 > [ESP32] === HMAC DEBUG INFO ===
23:00:26.207 > [ESP32] HMAC Key being used: F152C31D3F3F68AD80A142197882CC943F92600315AB2CB67BA8C19BC7F93B4E        
23:00:26.215 > [ESP32] HMAC Input length: 44 bytes
23:00:26.218 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002C238F84F91BE6CD04696900A2C8D9F89B88ADF3B
23:00:26.229 > [ESP32] Nonce: 0x00000002
23:00:26.229 > [ESP32] Packet size before HMAC: 60
23:00:26.235 > [ESP32] Computed HMAC Tag: 9557DFB509AFF78AA0F1E9EB31AE439A
23:00:26.240 > [ESP32] === END HMAC DEBUG ===
23:00:26.240 > 6_Final_Packet (60): 810218001800040800000002C238F84F 91BE6CD04696900A2C8D9F89B88ADF3B ...
23:00:26.249 > [RETRY] Attempt 1/3 (nonce: 2)
23:00:26.251 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:26.258 > Sending pipeline data to server (560 bytes)
23:00:26.458 > [HTTP] Response code: 400
23:00:26.458 > [HTTP] Error response: {"error":"Decryption failed"}
23:00:26.463 > [HTTP] Request failed with code: 400
23:00:26.465 > [RETRY] Send failed, waiting 100 ms before retry
23:00:26.562 > [RETRY] Attempt 2/3 (nonce: 2)
23:00:26.562 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:26.567 > Sending pipeline data to server (560 bytes)
23:00:26.747 > [HTTP] Response code: 400
23:00:26.747 > [HTTP] Error response: {"error":"Decryption failed"}
23:00:26.753 > [HTTP] Request failed with code: 400
23:00:26.755 > [RETRY] Send failed, waiting 200 ms before retry
23:00:26.951 > [RETRY] Attempt 3/3 (nonce: 2)
23:00:26.951 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:26.956 > Sending pipeline data to server (560 bytes)
23:00:27.212 > [HTTP] Response code: 400
23:00:27.212 > [HTTP] Error response: {"error":"Decryption failed"}
23:00:27.217 > [HTTP] Request failed with code: 400
23:00:27.220 > [RETRY] All retry attempts failed - rolled back nonce to 1
23:00:27.226 > [RETRY] Consecutive failures: 3
23:00:27.228 > Health data send failed (retry count: 3/3)
23:00:27.231 > Health data transmission failed after max retries
23:00:32.342 > [301.3] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:32.348 > ERROR state - attempting recovery
23:00:32.350 > [RETRY] Attempting to send health data (Max retries: 3)
23:00:32.355 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
23:00:32.362 > Generated health data: HR-65 SPO2-96 STEPS-1548
23:00:32.364 > [ESP32] MsgKeys: lfsrSeed=0x88873800 tnk[0..3]=3306649D trn[0..3]=E4118DBC
23:00:32.372 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313534384D50
23:00:32.378 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313534384D50000000000000 
23:00:32.386 > [ESP32][LFSR] Initializing - Seed: 0x88873800 SeedBe: 0x00388788 ChaosKey[0..3]: 3306649D InitialTap: 0x0029 State: 0x88873800
23:00:32.397 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
23:00:32.406 > 3_After_LFSR (32): 486AAABEE26ED3DD808C29DCAFCAD0D0 433DD9695EF61C28397802C74E6A5DEC
23:00:32.412 > [ESP32][LFSR] Keystream (first 16 bytes): 00388788D74E808DCFBE04E599EA8384
23:00:32.420 > [ESP32][TINKERBELL] Input (first 16 bytes): 486AAABEE26ED3DD808C29DCAFCAD0D0 Nonce: 0x00000002 Buffer size: 32 bytes
23:00:32.428 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 3306649D
23:00:32.439 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): CBB0B7A05DFF5EF1BB53D19314404696
23:00:32.448 > 4_After_Tinkerbell (32): 83DA1D1EBF918D2C3BDFF84FBB8A9646 809B38C29F894D624168900AD06CBD3E
23:00:32.456 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): CBB0B7A05DFF5EF1BB53D19314404696
23:00:32.464 > 5_After_Transposition (32): C238F84F91BF6CD04696900A2C8D9F89 BB8ADF3B416883DA809B1D1E624D3EBD        
23:00:32.473 > [ESP32] === HMAC DEBUG INFO ===
23:00:32.476 > [ESP32] HMAC Key being used: F152C31D3F3F68AD80A142197882CC943F92600315AB2CB67BA8C19BC7F93B4E        
23:00:32.484 > [ESP32] HMAC Input length: 44 bytes
23:00:32.487 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002C238F84F91BF6CD04696900A2C8D9F89BB8ADF3B
23:00:32.495 > [ESP32] Nonce: 0x00000002
23:00:32.498 > [ESP32] Packet size before HMAC: 60
23:00:32.500 > [ESP32] Computed HMAC Tag: 30CF5A35F57AB4ADB81B95C02A08C98B
23:00:32.506 > [ESP32] === END HMAC DEBUG ===
23:00:32.509 > 6_Final_Packet (60): 810218001800040800000002C238F84F 91BF6CD04696900A2C8D9F89BB8ADF3B ...
23:00:32.517 > [RETRY] Attempt 1/3 (nonce: 2)
23:00:32.519 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:32.522 > Sending pipeline data to server (560 bytes)
23:00:32.966 > [HTTP] Response code: 400
23:00:32.966 > [HTTP] Error response: {"error":"Decryption failed"}
23:00:32.971 > [HTTP] Request failed with code: 400
23:00:32.974 > [RETRY] Send failed, waiting 100 ms before retry
23:00:33.069 > [RETRY] Attempt 2/3 (nonce: 2)
23:00:33.069 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:33.075 > Sending pipeline data to server (560 bytes)
23:00:33.236 > [HTTP] Response code: 400
23:00:33.237 > [HTTP] Error response: {"error":"Decryption failed"}
23:00:33.242 > [HTTP] Request failed with code: 400
23:00:33.246 > [RETRY] Send failed, waiting 200 ms before retry
23:00:33.442 > [RETRY] Attempt 3/3 (nonce: 2)
23:00:33.442 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:33.448 > Sending pipeline data to server (560 bytes)
23:00:33.720 > [HTTP] Response code: 400
23:00:33.720 > [HTTP] Error response: {"error":"Decryption failed"}
23:00:33.726 > [HTTP] Request failed with code: 400
23:00:33.728 > [RETRY] All retry attempts failed - rolled back nonce to 1
23:00:33.735 > [RETRY] Consecutive failures: 4
23:00:33.737 > ✗ Auto-recovery failed - restarting key exchange
23:00:35.835 > [WebSocket] Disconnected!

23:00:46.377 > [315.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:46.477 > [315.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:46.578 > [315.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:46.677 > [315.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:46.777 > [315.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:46.877 > [315.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: DISCONNECTED
23:00:46.886 > Generated health data: HR-65 SPO2-96 STEPS-1621
23:00:46.889 > [RETRY] Attempting to send health data (Max retries: 3)
23:00:46.894 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:00:46.899 > Generated health data: HR-65 SPO2-96 STEPS-1593
23:00:46.902 > [ESP32] MsgKeys: lfsrSeed=0x4E3A2394 tnk[0..3]=CD5308F5 trn[0..3]=35FFA203
23:00:46.908 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313539334D50
23:00:46.916 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313539334D50000000000000
23:00:46.924 > [ESP32][LFSR] Initializing - Seed: 0x4E3A2394 SeedBe: 0x94233A4E ChaosKey[0..3]: CD5308F5 InitialTap: 0x0029 State: 0x4E3A2394
23:00:46.933 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
23:00:46.941 > 3_After_LFSR (32): DC7117783B0085A580ED94CFAEAD1D7A 0A4F84626AE035076753D3E9645F0592
23:00:46.949 > [ESP32][LFSR] Keystream (first 16 bytes): 94233A4E0E20D6F5CFDFB9F6988D4E2E
23:00:46.955 > [ESP32][TINKERBELL] Input (first 16 bytes): DC7117783B0085A580ED94CFAEAD1D7A Nonce: 0x00000001 Buffer size: 32 bytes
23:00:46.966 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: CD5308F5
23:00:46.977 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9C9F4B33BE4C4BC543142200F0C33AC6
23:00:46.986 > 4_After_Tinkerbell (32): 40EE5C4B854CCE60C3F9B6CF5E6E27BC 32FC96BC431CE293EC1F859919FA56AB
23:00:46.994 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9C9F4B33BE4C4BC543142200F0C33AC6
23:00:46.999 > 5_After_Transposition (32): 32FC96BC931CE243EC1F8599ABFA5619 CFB6F9C3854CCE604B5CEE405E6E27BC 
23:00:47.008 > [ESP32] === HMAC DEBUG INFO ===
23:00:47.010 > [ESP32] HMAC Key being used: ED3CD94EF54418546B107A8C24919791758729974E8224F1D43F0F5AE48B7461
23:00:47.019 > [ESP32] HMAC Input length: 44 bytes
23:00:47.022 > [ESP32] HMAC Input (first 32 bytes): 81021800180004080000000132FC96BC931CE243EC1F8599ABFA5619CFB6F9C3
23:00:47.032 > [ESP32] Nonce: 0x00000001
23:00:47.032 > [ESP32] Packet size before HMAC: 60
23:00:47.038 > [ESP32] Computed HMAC Tag: 775F577D529B83D6419288900ED9C5CE
23:00:47.044 > [ESP32] === END HMAC DEBUG ===
23:00:47.044 > 6_Final_Packet (60): 81021800180004080000000132FC96BC 931CE243EC1F8599ABFA5619CFB6F9C3 ...
23:00:47.052 > [RETRY] Attempt 1/3 (nonce: 1)
23:00:47.055 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:47.062 > Sending pipeline data to server (560 bytes)
23:00:47.223 > [HTTP] Response code: 200
23:00:47.223 > [HTTP] Response: {"status":"OK:DECRYPTED"}
23:00:47.229 > [RETRY] Health data sent successfully!
23:00:47.231 > ✓ Health data #7 sent successfully
23:00:47.328 > [316.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:47.428 > [316.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:47.529 > [316.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:47.628 > [316.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:47.729 > [316.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:47.829 > [316.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:47.929 > [316.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:48.029 > [317.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:48.128 > [317.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:48.229 > [317.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:48.329 > [317.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:48.429 > [317.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:48.529 > [317.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:48.629 > [317.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:48.728 > [317.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:48.829 > [317.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:48.928 > [317.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:49.028 > [318.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:49.128 > [318.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:49.228 > [318.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:49.329 > [318.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:49.428 > [318.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:49.528 > [318.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:49.629 > [318.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:49.728 > [318.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:49.828 > [318.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:49.929 > [318.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:50.028 > [319.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:50.129 > [319.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:50.228 > [319.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:50.329 > [319.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:50.428 > [319.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:50.529 > [319.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:50.629 > [319.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:50.729 > [319.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:50.829 > [319.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:50.929 > [319.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:56.034 > [325.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:56.134 > [WebSocket] Disconnected!
23:00:56.134 > [325.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED     
23:00:56.235 > [325.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:56.334 > [325.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:56.434 > [325.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:56.535 > [325.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:56.635 > [325.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:56.736 > [325.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:56.834 > [325.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:56.935 > [325.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:57.035 > [326.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:57.135 > [326.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:57.235 > [326.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: DISCONNECTED
23:00:57.243 > Generated health data: HR-65 SPO2-96 STEPS-1652
23:00:57.246 > [RETRY] Attempting to send health data (Max retries: 3)
23:00:57.252 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
23:00:57.257 > Generated health data: HR-65 SPO2-96 STEPS-1678
23:00:57.260 > [ESP32] MsgKeys: lfsrSeed=0xC7D0F304 tnk[0..3]=EFCD8848 trn[0..3]=2ACE60BB
23:00:57.265 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313637384D50
23:00:57.273 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313637384D50000000000000 
23:00:57.282 > [ESP32][LFSR] Initializing - Seed: 0xC7D0F304 SeedBe: 0x04F3D0C7 ChaosKey[0..3]: EFCD8848 InitialTap: 0x0029 State: 0xC7D0F304
23:00:57.291 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
23:00:57.299 > 3_After_LFSR (32): 4CA1FDF1BD666633FE9E04A8572A678D 7E15619A7F4E2686765717BC5A37D5D9
23:00:57.307 > [ESP32][LFSR] Keystream (first 16 bytes): 04F3D0C788463563B1AC2991610A34D9
23:00:57.313 > [ESP32][TINKERBELL] Input (first 16 bytes): 4CA1FDF1BD666633FE9E04A8572A678D Nonce: 0x00000002 Buffer size: 32 bytes
23:00:57.324 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: EFCD8848
23:00:57.335 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): BD46AA33E09916F7CC16FCE728E59583
23:00:57.343 > 4_After_Tinkerbell (32): F1E757C25DFF70C43288F84F7FCFF20E 545F011981DBC4C0DC980641E1F06EF0
23:00:57.352 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): BD46AA33E09916F7CC16FCE728E59583
23:00:57.357 > 5_After_Transposition (32): F1E757C25DFFF20E3288F84F7FCF70C4 545F011981DBC4C0DC9806F0E1416EF0        
23:00:57.366 > [ESP32] === HMAC DEBUG INFO ===
23:00:57.368 > [ESP32] HMAC Key being used: ED3CD94EF54418546B107A8C24919791758729974E8224F1D43F0F5AE48B7461
23:00:57.377 > [ESP32] HMAC Input length: 44 bytes
23:00:57.379 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002F1E757C25DFFF20E3288F84F7FCF70C4545F0119
23:00:57.391 > [ESP32] Nonce: 0x00000002
23:00:57.391 > [ESP32] Packet size before HMAC: 60
23:00:57.396 > [ESP32] Computed HMAC Tag: EB12E171B846C4839A437940183FAC6C
23:00:57.402 > [ESP32] === END HMAC DEBUG ===
23:00:57.402 > 6_Final_Packet (60): 810218001800040800000002F1E757C2 5DFFF20E3288F84F7FCF70C4545F0119 ...
23:00:57.409 > [RETRY] Attempt 1/3 (nonce: 2)
23:00:57.412 > POST http://10.45.98.115:8081/health-data with pipeline data
23:00:57.419 > Sending pipeline data to server (560 bytes)
23:00:57.731 > [HTTP] Response code: 200
23:00:57.731 > [HTTP] Response: {"status":"OK:DECRYPTED"}
23:00:57.737 > [RETRY] Health data sent successfully!
23:00:57.740 > ✓ Health data #8 sent successfully
23:00:57.837 > [326.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:57.937 > [326.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:58.037 > [327.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:58.138 > [327.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:58.237 > [327.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:58.337 > [327.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:58.437 > [327.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:58.537 > [327.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:58.637 > [327.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:58.737 > [327.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:58.837 > [327.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:58.937 > [327.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:59.037 > [328.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:59.137 > [328.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:59.237 > [328.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:59.337 > [328.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:59.437 > [328.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:59.537 > [328.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:59.636 > [328.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:59.737 > [328.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:59.837 > [328.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:00:59.937 > [328.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:00.038 > [329.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:00.137 > [329.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:00.237 > [329.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:00.337 > [329.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:00.437 > [329.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:00.537 > [329.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:00.637 > [329.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:00.737 > [329.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:00.837 > [329.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:00.937 > [329.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:01.037 > [330.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:06.142 > [335.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:06.242 > [WebSocket] Disconnected!
23:01:06.242 > [335.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED     
23:01:06.343 > [335.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:06.443 > [335.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:06.543 > [335.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:06.642 > [335.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:06.743 > [335.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:06.843 > [335.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:06.943 > [335.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:07.043 > [336.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:07.142 > [336.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:07.242 > [336.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:07.343 > [336.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:07.442 > [336.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:07.542 > [336.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:07.642 > [336.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:07.743 > [336.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:07.751 > Generated health data: HR-65 SPO2-96 STEPS-1711
23:01:07.754 > [RETRY] Attempting to send health data (Max retries: 3)
23:01:07.759 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
23:01:07.765 > Generated health data: HR-65 SPO2-96 STEPS-1682
23:01:07.768 > [ESP32] MsgKeys: lfsrSeed=0xD94D2964 tnk[0..3]=02C6580D trn[0..3]=14F58412
23:01:07.773 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313638324D50
23:01:07.782 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313638324D50000000000000
23:01:07.790 > [ESP32][LFSR] Initializing - Seed: 0xD94D2964 SeedBe: 0x64294DD9 ChaosKey[0..3]: 02C6580D InitialTap: 0x0029 State: 0xD94D2964
23:01:07.798 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
23:01:07.806 > 3_After_LFSR (32): 2C7B60EF86BD8115A3AEAE52FF7E9E7F 90A2631DB1DC814EC139BDF4E2D904E7 
23:01:07.815 > [ESP32][LFSR] Keystream (first 16 bytes): 64294DD9B39DD245EC9C836BC95ECD2B
23:01:07.820 > [ESP32][TINKERBELL] Input (first 16 bytes): 2C7B60EF86BD8115A3AEAE52FF7E9E7F Nonce: 0x00000003 Buffer size: 32 bytes
23:01:07.831 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 02C6580D
23:01:07.843 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B54A81B0FDF5450288EB8348EF6EF986
23:01:07.851 > 4_After_Tinkerbell (32): 9931E15F7B48C4172B452D1A101067F9 C286B11132A835C55501118B813EA4AF
23:01:07.860 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B54A81B0FDF5450288EB8348EF6EF986
23:01:07.865 > 5_After_Transposition (32): 118B2D1A813E7B48A832319911B117C4 67F955015FE1C286C535452B1010AFA4        
23:01:07.873 > [ESP32] === HMAC DEBUG INFO ===
23:01:07.876 > [ESP32] HMAC Key being used: ED3CD94EF54418546B107A8C24919791758729974E8224F1D43F0F5AE48B7461        
23:01:07.884 > [ESP32] HMAC Input length: 44 bytes
23:01:07.887 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000003118B2D1A813E7B48A832319911B117C467F95501
23:01:07.898 > [ESP32] Nonce: 0x00000003
23:01:07.898 > [ESP32] Packet size before HMAC: 60
23:01:07.904 > [ESP32] Computed HMAC Tag: 8E8CA1B861E7AFD8FE026B35C616AE81
23:01:07.909 > [ESP32] === END HMAC DEBUG ===
23:01:07.909 > 6_Final_Packet (60): 810218001800040800000003118B2D1A 813E7B48A832319911B117C467F95501 ...
23:01:07.917 > [RETRY] Attempt 1/3 (nonce: 3)
23:01:07.920 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:07.940 > Sending pipeline data to server (560 bytes)
23:01:08.234 > [HTTP] Response code: 400
23:01:08.234 > [HTTP] Error response: {"error":"Decryption failed"}
23:01:08.240 > [HTTP] Request failed with code: 400
23:01:08.243 > [RETRY] Send failed, waiting 100 ms before retry
23:01:08.339 > [RETRY] Attempt 2/3 (nonce: 3)
23:01:08.339 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:08.345 > Sending pipeline data to server (560 bytes)
23:01:08.507 > [HTTP] Response code: 400
23:01:08.508 > [HTTP] Error response: {"error":"Decryption failed"}
23:01:08.513 > [HTTP] Request failed with code: 400
23:01:08.515 > [RETRY] Send failed, waiting 200 ms before retry
23:01:08.712 > [RETRY] Attempt 3/3 (nonce: 3)
23:01:08.712 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:08.716 > Sending pipeline data to server (560 bytes)
23:01:08.987 > [HTTP] Response code: 400
23:01:08.987 > [HTTP] Error response: {"error":"Decryption failed"}
23:01:08.993 > [HTTP] Request failed with code: 400
23:01:08.994 > [RETRY] All retry attempts failed - rolled back nonce to 2
23:01:09.000 > [RETRY] Consecutive failures: 1
23:01:09.003 > Health data send failed (retry count: 1/3)
23:01:09.102 > [338.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:09.111 > Generated health data: HR-65 SPO2-96 STEPS-1736
23:01:09.113 > [RETRY] Attempting to send health data (Max retries: 3)
23:01:09.118 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
23:01:09.124 > Generated health data: HR-65 SPO2-96 STEPS-1725
23:01:09.127 > [ESP32] MsgKeys: lfsrSeed=0xD94D2964 tnk[0..3]=02C6580D trn[0..3]=14F58412
23:01:09.133 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313732354D50
23:01:09.141 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313732354D50000000000000
23:01:09.150 > [ESP32][LFSR] Initializing - Seed: 0xD94D2964 SeedBe: 0x64294DD9 ChaosKey[0..3]: 02C6580D InitialTap: 0x0029 State: 0xD94D2964
23:01:09.158 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
23:01:09.166 > 3_After_LFSR (32): 2C7B60EF86BD8115A3AEAE52FF7E9E7F 90A2631DB1DD8B49C139BDF4E2D904E7
23:01:09.174 > [ESP32][LFSR] Keystream (first 16 bytes): 64294DD9B39DD245EC9C836BC95ECD2B
23:01:09.180 > [ESP32][TINKERBELL] Input (first 16 bytes): 2C7B60EF86BD8115A3AEAE52FF7E9E7F Nonce: 0x00000003 Buffer size: 32 bytes
23:01:09.190 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 02C6580D
23:01:09.202 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B54A81B0FDF5450288EB8348EF6EF986
23:01:09.210 > 4_After_Tinkerbell (32): 9931E15F7B48C4172B452D1A101067F9 C286B11132A93FC25501118B813EA4AF 
23:01:09.219 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B54A81B0FDF5450288EB8348EF6EF986
23:01:09.225 > 5_After_Transposition (32): 118B2D1A813E7B48A932319911B117C4 67F955015FE1C286C23F452B1010AFA4 
23:01:09.233 > [ESP32] === HMAC DEBUG INFO ===
23:01:09.235 > [ESP32] HMAC Key being used: ED3CD94EF54418546B107A8C24919791758729974E8224F1D43F0F5AE48B7461
23:01:09.243 > [ESP32] HMAC Input length: 44 bytes
23:01:09.247 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000003118B2D1A813E7B48A932319911B117C467F95501
23:01:09.258 > [ESP32] Nonce: 0x00000003
23:01:09.258 > [ESP32] Packet size before HMAC: 60
23:01:09.264 > [ESP32] Computed HMAC Tag: 0E6CE798FFACF71C39667A62E836C75B
23:01:09.269 > [ESP32] === END HMAC DEBUG ===
23:01:09.269 > 6_Final_Packet (60): 810218001800040800000003118B2D1A 813E7B48A932319911B117C467F95501 ...
23:01:09.277 > [RETRY] Attempt 1/3 (nonce: 3)
23:01:09.280 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:09.286 > Sending pipeline data to server (560 bytes)
23:01:09.509 > [HTTP] Response code: 400
23:01:09.509 > [HTTP] Error response: {"error":"Decryption failed"}
23:01:09.515 > [HTTP] Request failed with code: 400
23:01:09.517 > [RETRY] Send failed, waiting 100 ms before retry
23:01:09.614 > [RETRY] Attempt 2/3 (nonce: 3)
23:01:09.614 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:09.619 > Sending pipeline data to server (560 bytes)
23:01:09.742 > [HTTP] Response code: 400
23:01:09.742 > [HTTP] Error response: {"error":"Decryption failed"}
23:01:09.748 > [HTTP] Request failed with code: 400
23:01:09.750 > [RETRY] Send failed, waiting 200 ms before retry
23:01:09.947 > [RETRY] Attempt 3/3 (nonce: 3)
23:01:09.947 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:09.952 > Sending pipeline data to server (560 bytes)
23:01:10.248 > [HTTP] Response code: 400
23:01:10.248 > [HTTP] Error response: {"error":"Decryption failed"}
23:01:10.254 > [HTTP] Request failed with code: 400
23:01:10.256 > [RETRY] All retry attempts failed - rolled back nonce to 2
23:01:10.262 > [RETRY] Consecutive failures: 2
23:01:10.265 > Health data send failed (retry count: 2/3)
23:01:10.363 > [339.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:10.371 > Generated health data: HR-65 SPO2-96 STEPS-1736
23:01:10.374 > [RETRY] Attempting to send health data (Max retries: 3)
23:01:10.380 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
23:01:10.385 > Generated health data: HR-65 SPO2-96 STEPS-1732
23:01:10.388 > [ESP32] MsgKeys: lfsrSeed=0xD94D2964 tnk[0..3]=02C6580D trn[0..3]=14F58412
23:01:10.393 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313733324D50
23:01:10.402 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313733324D50000000000000
23:01:10.411 > [ESP32][LFSR] Initializing - Seed: 0xD94D2964 SeedBe: 0x64294DD9 ChaosKey[0..3]: 02C6580D InitialTap: 0x0029 State: 0xD94D2964
23:01:10.418 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
23:01:10.427 > 3_After_LFSR (32): 2C7B60EF86BD8115A3AEAE52FF7E9E7F 90A2631DB1DD8A4EC139BDF4E2D904E7
23:01:10.435 > [ESP32][LFSR] Keystream (first 16 bytes): 64294DD9B39DD245EC9C836BC95ECD2B
23:01:10.441 > [ESP32][TINKERBELL] Input (first 16 bytes): 2C7B60EF86BD8115A3AEAE52FF7E9E7F Nonce: 0x00000003 Buffer size: 32 bytes
23:01:10.452 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 02C6580D
23:01:10.463 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B54A81B0FDF5450288EB8348EF6EF986
23:01:10.471 > 4_After_Tinkerbell (32): 9931E15F7B48C4172B452D1A101067F9 C286B11132A93EC55501118B813EA4AF 
23:01:10.480 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B54A81B0FDF5450288EB8348EF6EF986
23:01:10.486 > 5_After_Transposition (32): 118B2D1A813E7B48A932319911B117C4 67F955015FE1C286C53E452B1010AFA4 
23:01:10.493 > [ESP32] === HMAC DEBUG INFO ===
23:01:10.497 > [ESP32] HMAC Key being used: ED3CD94EF54418546B107A8C24919791758729974E8224F1D43F0F5AE48B7461
23:01:10.505 > [ESP32] HMAC Input length: 44 bytes
23:01:10.508 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000003118B2D1A813E7B48A932319911B117C467F95501
23:01:10.519 > [ESP32] Nonce: 0x00000003
23:01:10.519 > [ESP32] Packet size before HMAC: 60
23:01:10.524 > [ESP32] Computed HMAC Tag: 9F2CAD090447DA3510C1335F78C14167
23:01:10.530 > [ESP32] === END HMAC DEBUG ===
23:01:10.530 > 6_Final_Packet (60): 810218001800040800000003118B2D1A 813E7B48A932319911B117C467F95501 ...
23:01:10.538 > [RETRY] Attempt 1/3 (nonce: 3)
23:01:10.541 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:10.547 > Sending pipeline data to server (560 bytes)
23:01:10.748 > [HTTP] Response code: 400
23:01:10.748 > [HTTP] Error response: {"error":"Decryption failed"}
23:01:10.754 > [HTTP] Request failed with code: 400
23:01:10.757 > [RETRY] Send failed, waiting 100 ms before retry
23:01:10.853 > [RETRY] Attempt 2/3 (nonce: 3)
23:01:10.853 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:10.858 > Sending pipeline data to server (560 bytes)
23:01:10.998 > [HTTP] Response code: 400
23:01:10.998 > [HTTP] Error response: {"error":"Decryption failed"}
23:01:11.003 > [HTTP] Request failed with code: 400
23:01:11.006 > [RETRY] Send failed, waiting 200 ms before retry
23:01:11.201 > [RETRY] Attempt 3/3 (nonce: 3)
23:01:11.202 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:11.206 > Sending pipeline data to server (560 bytes)
23:01:11.503 > [HTTP] Response code: 400
23:01:11.503 > [HTTP] Error response: {"error":"Decryption failed"}
23:01:11.508 > [HTTP] Request failed with code: 400
23:01:11.512 > [RETRY] All retry attempts failed - rolled back nonce to 2
23:01:11.517 > [RETRY] Consecutive failures: 3
23:01:11.520 > Health data send failed (retry count: 3/3)
23:01:11.522 > Health data transmission failed after max retries
23:01:16.634 > [345.6] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:16.639 > ERROR state - attempting recovery
23:01:16.642 > [RETRY] Attempting to send health data (Max retries: 3)
23:01:16.647 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
23:01:16.653 > Generated health data: HR-65 SPO2-96 STEPS-1773
23:01:16.656 > [ESP32] MsgKeys: lfsrSeed=0xD94D2964 tnk[0..3]=02C6580D trn[0..3]=14F58412
23:01:16.664 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313737334D50
23:01:16.670 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313737334D50000000000000 
23:01:16.678 > [ESP32][LFSR] Initializing - Seed: 0xD94D2964 SeedBe: 0x64294DD9 ChaosKey[0..3]: 02C6580D InitialTap: 0x0029 State: 0xD94D2964
23:01:16.689 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
23:01:16.698 > 3_After_LFSR (32): 2C7B60EF86BD8115A3AEAE52FF7E9E7F 90A2631DB1DD8E4FC139BDF4E2D904E7
23:01:16.702 > [ESP32][LFSR] Keystream (first 16 bytes): 64294DD9B39DD245EC9C836BC95ECD2B
23:01:16.711 > [ESP32][TINKERBELL] Input (first 16 bytes): 2C7B60EF86BD8115A3AEAE52FF7E9E7F Nonce: 0x00000003 Buffer size: 32 bytes
23:01:16.720 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 02C6580D
23:01:16.731 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B54A81B0FDF5450288EB8348EF6EF986
23:01:16.739 > 4_After_Tinkerbell (32): 9931E15F7B48C4172B452D1A101067F9 C286B11132A93AC45501118B813EA4AF 
23:01:16.748 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B54A81B0FDF5450288EB8348EF6EF986
23:01:16.756 > 5_After_Transposition (32): 118B2D1A813E7B48A932319911B117C4 67F955015FE1C286C43A452B1010AFA4        
23:01:16.764 > [ESP32] === HMAC DEBUG INFO ===
23:01:16.766 > [ESP32] HMAC Key being used: ED3CD94EF54418546B107A8C24919791758729974E8224F1D43F0F5AE48B7461
23:01:16.776 > [ESP32] HMAC Input length: 44 bytes
23:01:16.779 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000003118B2D1A813E7B48A932319911B117C467F95501
23:01:16.786 > [ESP32] Nonce: 0x00000003
23:01:16.789 > [ESP32] Packet size before HMAC: 60
23:01:16.792 > [ESP32] Computed HMAC Tag: 7C6D078E2ECE810123BDBC7E891DB2FF
23:01:16.798 > [ESP32] === END HMAC DEBUG ===
23:01:16.800 > 6_Final_Packet (60): 810218001800040800000003118B2D1A 813E7B48A932319911B117C467F95501 ...
23:01:16.809 > [RETRY] Attempt 1/3 (nonce: 3)
23:01:16.811 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:16.815 > Sending pipeline data to server (560 bytes)
23:01:17.009 > [HTTP] Response code: 400
23:01:17.009 > [HTTP] Error response: {"error":"Decryption failed"}
23:01:17.014 > [HTTP] Request failed with code: 400
23:01:17.017 > [RETRY] Send failed, waiting 100 ms before retry
23:01:17.113 > [RETRY] Attempt 2/3 (nonce: 3)
23:01:17.113 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:17.117 > Sending pipeline data to server (560 bytes)
23:01:17.302 > [HTTP] Response code: 400
23:01:17.302 > [HTTP] Error response: {"error":"Decryption failed"}
23:01:17.308 > [HTTP] Request failed with code: 400
23:01:17.310 > [RETRY] Send failed, waiting 200 ms before retry
23:01:17.508 > [RETRY] Attempt 3/3 (nonce: 3)
23:01:17.508 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:17.513 > Sending pipeline data to server (560 bytes)
23:01:17.766 > [HTTP] Response code: 400
23:01:17.766 > [HTTP] Error response: {"error":"Decryption failed"}
23:01:17.771 > [HTTP] Request failed with code: 400
23:01:17.774 > [RETRY] All retry attempts failed - rolled back nonce to 2
23:01:17.780 > [RETRY] Consecutive failures: 4
23:01:17.783 > ✗ Auto-recovery failed - restarting key exchange
23:01:19.881 > [WebSocket] Disconnected!
23:01:19.881 > [348.8] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED     
23:01:19.888 > ✓ Public key loaded from NVS
23:01:19.985 > [348.9] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:20.086 > [349.0] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:20.094 > Generating fresh master key from entropy...
23:01:20.101 > Generated master key (32): 8A89A5F799613A4A26DF4F9AA91184E5 063FC5585617824665BBCA9E07B407D4 
23:01:20.107 > Using reduced master key (byte % 3) for NTRU encryption only
23:01:20.117 > NTRU encrypted master key (502): 00770008000600720068000100600067 00380007007E00190010001A00090007 ...
23:01:20.126 > POST http://10.45.98.115:8081/master-key
23:01:20.265 > ✓ Master key exchange completed
23:01:20.367 > [349.3] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:20.375 > Loading master key from NVS and deriving symmetric keys...
23:01:20.378 > Loaded master key from NVS (32): 8A89A5F799613A4A26DF4F9AA91184E5 063FC5585617824665BBCA9E07B407D4 
23:01:20.390 > Derived HMAC key (32): C1C21B85763FEA08F74AA08815BEF076 95D3E44E093F0920AB4822EB77BE1085
23:01:20.395 > Derived Tinkerbell key (16): E8AF1D9D55B259B59CE0DFFA14670190
23:01:20.401 > Derived Transposition key (16): B506A6E4301FC6A477F9DBE90EDE403E 
23:01:20.409 > ✓ Symmetric keys derived successfully
23:01:20.412 > Nonce tracker reset - new session started
23:01:20.908 > Waiting for server to process master key...
23:01:20.911 > ✓ Symmetric keys ready - starting health data transmission
23:01:21.008 > [349.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:21.109 > [350.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:21.209 > [350.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:21.310 > [350.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:21.410 > [350.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:21.510 > [350.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:21.609 > [350.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:21.710 > [350.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:21.809 > [350.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:21.909 > [350.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:22.009 > [350.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:22.109 > [351.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:22.210 > [351.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:22.309 > [351.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:22.409 > [351.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:22.510 > [351.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:22.610 > [351.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:22.709 > [351.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:22.809 > [351.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:22.909 > [351.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:23.009 > [351.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:23.109 > [352.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:23.210 > [352.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:23.310 > [352.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:23.410 > [352.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:23.509 > [352.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:23.610 > [352.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:23.710 > [352.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:23.809 > [352.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:23.909 > [352.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:24.009 > [352.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:24.109 > [353.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:24.209 > [353.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:24.310 > [353.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:24.410 > [353.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:24.510 > [353.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:24.609 > [353.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:24.709 > [353.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:24.810 > [353.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:29.915 > [358.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:30.016 > [WebSocket] Disconnected!
23:01:30.016 > [358.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED     
23:01:30.116 > [359.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:30.216 > [359.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:30.316 > [359.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:30.416 > [359.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:30.516 > [359.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:30.616 > [359.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:30.716 > [359.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:30.816 > [359.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:30.916 > [359.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: DISCONNECTED
23:01:30.924 > Generated health data: HR-65 SPO2-96 STEPS-1797
23:01:30.927 > [RETRY] Attempting to send health data (Max retries: 3)
23:01:30.932 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:01:30.938 > Generated health data: HR-65 SPO2-96 STEPS-1832
23:01:30.941 > [ESP32] MsgKeys: lfsrSeed=0xFC25456F tnk[0..3]=886CE64F trn[0..3]=3B168470
23:01:30.946 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313833324D50
23:01:30.955 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313833324D50000000000000
23:01:30.964 > [ESP32][LFSR] Initializing - Seed: 0xFC25456F SeedBe: 0x6F4525FC ChaosKey[0..3]: 886CE64F InitialTap: 0x0029 State: 0xFC25456F
23:01:30.972 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
23:01:30.980 > 3_After_LFSR (32): 271708CA432A481F16697B93AD33CE93 2C8144EA336E41A5E929D07D36444C28
23:01:30.988 > [ESP32][LFSR] Keystream (first 16 bytes): 6F4525FC760A1B4F595B56AA9B139DC7
23:01:30.994 > [ESP32][TINKERBELL] Input (first 16 bytes): 271708CA432A481F16697B93AD33CE93 Nonce: 0x00000001 Buffer size: 32 bytes
23:01:31.005 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 886CE64F
23:01:31.016 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 3FA2AC2BBEE155CA56B6643459A32ED2
23:01:31.025 > 4_After_Tinkerbell (32): 18B5A4E1FDCB1DD540DF1FA7F490E041 31AE2DFCA0C4D2263B788FB4371EDE03
23:01:31.033 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 3FA2AC2BBEE155CA56B6643459A32ED2
23:01:31.038 > 5_After_Transposition (32): FCA0C418B5A41DD5B4371E40DF1FE041 E1FDCB3B788FD226A7F49031AE2DDE03 
23:01:31.046 > [ESP32] === HMAC DEBUG INFO ===
23:01:31.049 > [ESP32] HMAC Key being used: C1C21B85763FEA08F74AA08815BEF07695D3E44E093F0920AB4822EB77BE1085
23:01:31.058 > [ESP32] HMAC Input length: 44 bytes
23:01:31.060 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001FCA0C418B5A41DD5B4371E40DF1FE041E1FDCB3B
23:01:31.072 > [ESP32] Nonce: 0x00000001
23:01:31.072 > [ESP32] Packet size before HMAC: 60
23:01:31.077 > [ESP32] Computed HMAC Tag: ED7B69E8AD0464FC7916D4E8DA4DB1DB
23:01:31.082 > [ESP32] === END HMAC DEBUG ===
23:01:31.082 > 6_Final_Packet (60): 810218001800040800000001FCA0C418 B5A41DD5B4371E40DF1FE041E1FDCB3B ...
23:01:31.091 > [RETRY] Attempt 1/3 (nonce: 1)
23:01:31.093 > POST http://10.45.98.115:8081/health-data with pipeline data
23:01:31.100 > Sending pipeline data to server (560 bytes)
23:01:31.269 > [HTTP] Response code: 200
23:01:31.269 > [HTTP] Response: {"status":"OK:DECRYPTED"}
23:01:31.274 > [RETRY] Health data sent successfully!
23:01:31.277 > ✓ Health data #9 sent successfully
23:01:31.373 > [360.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:01:31.474 > [360.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:01:31.574 > [360.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:01:31.674 > [360.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:01:31.774 > [360.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:01:31.874 > [360.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:01:31.974 > [360.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:01:32.074 > [361.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:01:32.174 > [361.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:01:32.274 > [361.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:01:32.374 > [361.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:01:32.474 > [361.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:01:32.574 > [361.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: 

23:02:31.163 > Sending pipeline data to server (560 bytes)
23:02:31.357 > [HTTP] Response code: 400
23:02:31.358 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:31.363 > [HTTP] Request failed with code: 400
23:02:31.366 > [RETRY] Send failed, waiting 100 ms before retry
23:02:31.461 > [RETRY] Attempt 2/3 (nonce: 1)
23:02:31.461 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:31.467 > Sending pipeline data to server (560 bytes)
23:02:31.600 > [HTTP] Response code: 400
23:02:31.600 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:31.606 > [HTTP] Request failed with code: 400
23:02:31.608 > [RETRY] Send failed, waiting 200 ms before retry
23:02:31.805 > [RETRY] Attempt 3/3 (nonce: 1)
23:02:31.805 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:31.810 > Sending pipeline data to server (560 bytes)
23:02:32.097 > [HTTP] Response code: 400
23:02:32.097 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:32.102 > [HTTP] Request failed with code: 400
23:02:32.104 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:02:32.110 > [RETRY] Consecutive failures: 1
23:02:32.113 > Health data send failed (retry count: 3/3)
23:02:32.116 > Health data transmission failed after max retries
23:02:32.221 > [421.2] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:32.227 > ERROR state - attempting recovery
23:02:32.230 > [RETRY] Attempting to send health data (Max retries: 3)
23:02:32.235 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:02:32.241 > Generated health data: HR-67 SPO2-96 STEPS-2122
23:02:32.244 > [ESP32] MsgKeys: lfsrSeed=0x2C823E0A tnk[0..3]=DCCE7BB9 trn[0..3]=C8D2A3D5
23:02:32.252 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D323132324D50
23:02:32.258 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D323132324D50000000000000
23:02:32.266 > [ESP32][LFSR] Initializing - Seed: 0x2C823E0A SeedBe: 0x0A3E822C ChaosKey[0..3]: DCCE7BB9 InitialTap: 0x0029 State: 0x2C823E0A
23:02:32.277 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
23:02:32.286 > 3_After_LFSR (32): 426CAF1AFCE7DD0AB7F8C9BF5156C676 AAE360B346B2D7CA8E56CDE165BC0C27
23:02:32.291 > [ESP32][LFSR] Keystream (first 16 bytes): 0A3E822CCBC78E5AF8CAE48667769522
23:02:32.299 > [ESP32][TINKERBELL] Input (first 16 bytes): 426CAF1AFCE7DD0AB7F8C9BF5156C676 Nonce: 0x00000001 Buffer size: 32 bytes
23:02:32.307 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: DCCE7BB9
23:02:32.319 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 3EBB1287547404DCC91B2AEF84EF1CE0
23:02:32.327 > 4_After_Tinkerbell (32): 7CD7BD9DA893D9D67EE3E350D5B9DA96 AFFFD5C4F0AD09D9E3C1FE2F10C81A4C 
23:02:32.335 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 3EBB1287547404DCC91B2AEF84EF1CE0
23:02:32.344 > 5_After_Transposition (32): C4F0AD7CD7BD09D9E37EE32F10C8D6D9 C1FEE39DA8931A4CB9D550AFFFD5DA96 
23:02:32.352 > [ESP32] === HMAC DEBUG INFO ===
23:02:32.355 > [ESP32] HMAC Key being used: D15F69AB90A54E8BD6C627B6A6224BAD447DE45AC970CFEAB8070DE6ED55EEEE        
23:02:32.364 > [ESP32] HMAC Input length: 44 bytes
23:02:32.366 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001C4F0AD7CD7BD09D9E37EE32F10C8D6D9C1FEE39D
23:02:32.374 > [ESP32] Nonce: 0x00000001
23:02:32.377 > [ESP32] Packet size before HMAC: 60
23:02:32.380 > [ESP32] Computed HMAC Tag: AB14B0E7B6862E46EF73177B1D38ED8F
23:02:32.386 > [ESP32] === END HMAC DEBUG ===
23:02:32.388 > 6_Final_Packet (60): 810218001800040800000001C4F0AD7C D7BD09D9E37EE32F10C8D6D9C1FEE39D ...
23:02:32.397 > [RETRY] Attempt 1/3 (nonce: 1)
23:02:32.400 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:32.402 > Sending pipeline data to server (560 bytes)
23:02:32.598 > [HTTP] Response code: 400
23:02:32.598 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:32.604 > [HTTP] Request failed with code: 400
23:02:32.607 > [RETRY] Send failed, waiting 100 ms before retry
23:02:32.702 > [RETRY] Attempt 2/3 (nonce: 1)
23:02:32.702 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:32.708 > Sending pipeline data to server (560 bytes)
23:02:32.852 > [HTTP] Response code: 400
23:02:32.852 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:32.857 > [HTTP] Request failed with code: 400
23:02:32.860 > [RETRY] Send failed, waiting 200 ms before retry
23:02:33.056 > [RETRY] Attempt 3/3 (nonce: 1)
23:02:33.056 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:33.061 > Sending pipeline data to server (560 bytes)
23:02:33.368 > [HTTP] Response code: 400
23:02:33.368 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:33.374 > [HTTP] Request failed with code: 400
23:02:33.377 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:02:33.382 > [RETRY] Consecutive failures: 2
23:02:33.385 > ✗ Auto-recovery failed - restarting key exchange
23:02:40.488 > [429.4] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:40.496 > ✓ Public key loaded from NVS
23:02:40.592 > [WebSocket] Disconnected!
23:02:40.592 > [429.5] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED  
23:02:40.692 > [429.6] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:40.701 > Generating fresh master key from entropy...
23:02:40.707 > Generated master key (32): 52111E2FCCAFFE0C1E8028C4B4E3F6E5 036BCF1A191CC0D1FE0F01E83181A4AA 
23:02:40.717 > Using reduced master key (byte % 3) for NTRU encryption only
23:02:40.725 > NTRU encrypted master key (502): 00780008000600730068000100610065 00360008007E0019000F001A00090007 ...
23:02:40.733 > POST http://10.45.98.115:8081/master-key
23:02:40.858 > ✓ Master key exchange completed
23:02:40.960 > [429.9] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:40.968 > Loading master key from NVS and deriving symmetric keys...
23:02:40.971 > Loaded master key from NVS (32): 52111E2FCCAFFE0C1E8028C4B4E3F6E5 036BCF1A191CC0D1FE0F01E83181A4AA 
23:02:40.982 > Derived HMAC key (32): 54861F1763C595E7ACB6248A21AA28EC E9BA77FDD420773E710F1FE16ECF00C6 
23:02:40.987 > Derived Tinkerbell key (16): C1364D3AE5E5075C608747D8BD82E6F3
23:02:40.993 > Derived Transposition key (16): 0DC85A4785465D205570822048AE8563
23:02:41.002 > ✓ Symmetric keys derived successfully
23:02:41.004 > Nonce tracker reset - new session started
23:02:41.501 > Waiting for server to process master key...
23:02:41.504 > ✓ Symmetric keys ready - starting health data transmission
23:02:41.602 > [430.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:41.702 > [430.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:41.802 > [430.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:41.902 > [430.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:42.002 > [430.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:42.102 > [431.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:42.202 > [431.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:42.302 > [431.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:42.402 > [431.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:42.502 > [431.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:42.602 > [431.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:42.702 > [431.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:42.802 > [431.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:42.902 > [431.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:43.002 > [431.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:43.102 > [432.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:43.202 > [432.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:43.302 > [432.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:43.402 > [432.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:43.502 > [432.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:43.602 > [432.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:43.702 > [432.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:43.802 > [432.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:43.902 > [432.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:44.002 > [432.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:44.102 > [433.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:44.201 > [433.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:44.302 > [433.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:44.402 > [433.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:44.502 > [433.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:44.602 > [433.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:44.702 > [433.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:44.802 > [433.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:44.902 > [433.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:45.002 > [433.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:45.102 > [434.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:45.201 > [434.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:45.302 > [434.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:45.402 > [434.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:45.502 > [434.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:50.608 > [439.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:50.708 > [WebSocket] Disconnected!
23:02:50.708 > [439.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED     
23:02:50.809 > [439.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:50.909 > [439.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:51.009 > [439.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:51.108 > [440.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:51.209 > [440.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:51.309 > [440.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:51.409 > [440.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:51.509 > [440.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:51.517 > Generated health data: HR-67 SPO2-96 STEPS-2204
23:02:51.520 > [RETRY] Attempting to send health data (Max retries: 3)
23:02:51.525 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:02:51.531 > Generated health data: HR-67 SPO2-96 STEPS-2209
23:02:51.534 > [ESP32] MsgKeys: lfsrSeed=0xF6EDECC8 tnk[0..3]=61691321 trn[0..3]=9C2D7CF2
23:02:51.539 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D323230394D50
23:02:51.548 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D323230394D50000000000000
23:02:51.556 > [ESP32][LFSR] Initializing - Seed: 0xF6EDECC8 SeedBe: 0xC8ECEDF6 ChaosKey[0..3]: 61691321 InitialTap: 0x0029 State: 0xF6EDECC8
23:02:51.564 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
23:02:51.572 > 3_After_LFSR (32): 80BEC0C0C17FA89F96E7CAFE124A06DB 74B5EA4D04624EDDED18C488CED94E5B 
23:02:51.580 > [ESP32][LFSR] Keystream (first 16 bytes): C8ECEDF6F65FFBCFD9D5E7C7246A558F
23:02:51.587 > [ESP32][TINKERBELL] Input (first 16 bytes): 80BEC0C0C17FA89F96E7CAFE124A06DB Nonce: 0x00000001 Buffer size: 32 bytes
23:02:51.598 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 61691321
23:02:51.609 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 962CFED721C6DE6BD503A580F3E9A37D
23:02:51.617 > 4_After_Tinkerbell (32): 16923E17E0B976F443E46F7EE1A3A5A6 3C44A2A7FADD3AE36A2769E7D911F593
23:02:51.625 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 962CFED721C6DE6BD503A580F3E9A37D
23:02:51.631 > 5_After_Transposition (32): 76F4E7699216FADDA2A7A5A67E6F3E17 E443443CE0B96A273AE3E1A311D9F593 
23:02:51.639 > [ESP32] === HMAC DEBUG INFO ===
23:02:51.642 > [ESP32] HMAC Key being used: 54861F1763C595E7ACB6248A21AA28ECE9BA77FDD420773E710F1FE16ECF00C6        
23:02:51.650 > [ESP32] HMAC Input length: 44 bytes
23:02:51.653 > [ESP32] HMAC Input (first 32 bytes): 81021800180004080000000176F4E7699216FADDA2A7A5A67E6F3E17E443443C
23:02:51.664 > [ESP32] Nonce: 0x00000001
23:02:51.664 > [ESP32] Packet size before HMAC: 60
23:02:51.670 > [ESP32] Computed HMAC Tag: 07F8AE53821711A5313E6B32707A6CB9
23:02:51.675 > [ESP32] === END HMAC DEBUG ===
23:02:51.675 > 6_Final_Packet (60): 81021800180004080000000176F4E769 9216FADDA2A7A5A67E6F3E17E443443C ...
23:02:51.683 > [RETRY] Attempt 1/3 (nonce: 1)
23:02:51.686 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:51.693 > Sending pipeline data to server (560 bytes)
23:02:51.860 > [HTTP] Response code: 400
23:02:51.860 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:51.866 > [HTTP] Request failed with code: 400
23:02:51.868 > [RETRY] Send failed, waiting 100 ms before retry
23:02:51.964 > [RETRY] Attempt 2/3 (nonce: 1)
23:02:51.964 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:51.970 > Sending pipeline data to server (560 bytes)
23:02:52.115 > [HTTP] Response code: 400
23:02:52.115 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:52.120 > [HTTP] Request failed with code: 400
23:02:52.123 > [RETRY] Send failed, waiting 200 ms before retry
23:02:52.318 > [RETRY] Attempt 3/3 (nonce: 1)
23:02:52.319 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:52.324 > Sending pipeline data to server (560 bytes)
23:02:52.632 > [HTTP] Response code: 400
23:02:52.632 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:52.637 > [HTTP] Request failed with code: 400
23:02:52.641 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:02:52.646 > [RETRY] Consecutive failures: 3
23:02:52.649 > Health data send failed (retry count: 1/3)
23:02:52.746 > [441.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:52.755 > Generated health data: HR-67 SPO2-96 STEPS-2245
23:02:52.757 > [RETRY] Attempting to send health data (Max retries: 3)
23:02:52.763 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:02:52.769 > Generated health data: HR-67 SPO2-96 STEPS-2243
23:02:52.771 > [ESP32] MsgKeys: lfsrSeed=0xF6EDECC8 tnk[0..3]=61691321 trn[0..3]=9C2D7CF2
23:02:52.777 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D323234334D50
23:02:52.785 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D323234334D50000000000000
23:02:52.794 > [ESP32][LFSR] Initializing - Seed: 0xF6EDECC8 SeedBe: 0xC8ECEDF6 ChaosKey[0..3]: 61691321 InitialTap: 0x0029 State: 0xF6EDECC8
23:02:52.802 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
23:02:52.810 > 3_After_LFSR (32): 80BEC0C0C17FA89F96E7CAFE124A06DB 74B5EA4D04624AD7ED18C488CED94E5B
23:02:52.819 > [ESP32][LFSR] Keystream (first 16 bytes): C8ECEDF6F65FFBCFD9D5E7C7246A558F
23:02:52.824 > [ESP32][TINKERBELL] Input (first 16 bytes): 80BEC0C0C17FA89F96E7CAFE124A06DB Nonce: 0x00000001 Buffer size: 32 bytes
23:02:52.835 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 61691321
23:02:52.846 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 962CFED721C6DE6BD503A580F3E9A37D
23:02:52.855 > 4_After_Tinkerbell (32): 16923E17E0B976F443E46F7EE1A3A5A6 3C44A2A7FADD3EE96A2769E7D911F593
23:02:52.863 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 962CFED721C6DE6BD503A580F3E9A37D
23:02:52.868 > 5_After_Transposition (32): 76F4E7699216FADDA2A7A5A67E6F3E17 E443443CE0B96A273EE9E1A311D9F593 
23:02:52.877 > [ESP32] === HMAC DEBUG INFO ===
23:02:52.879 > [ESP32] HMAC Key being used: 54861F1763C595E7ACB6248A21AA28ECE9BA77FDD420773E710F1FE16ECF00C6
23:02:52.887 > [ESP32] HMAC Input length: 44 bytes
23:02:52.890 > [ESP32] HMAC Input (first 32 bytes): 81021800180004080000000176F4E7699216FADDA2A7A5A67E6F3E17E443443C
23:02:52.902 > [ESP32] Nonce: 0x00000001
23:02:52.902 > [ESP32] Packet size before HMAC: 60
23:02:52.907 > [ESP32] Computed HMAC Tag: 6BB565585CB600A50CF243779104F6F7
23:02:52.913 > [ESP32] === END HMAC DEBUG ===
23:02:52.913 > 6_Final_Packet (60): 81021800180004080000000176F4E769 9216FADDA2A7A5A67E6F3E17E443443C ...
23:02:52.921 > [RETRY] Attempt 1/3 (nonce: 1)
23:02:52.924 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:52.930 > Sending pipeline data to server (560 bytes)
23:02:53.118 > [HTTP] Response code: 400
23:02:53.118 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:53.124 > [HTTP] Request failed with code: 400
23:02:53.126 > [RETRY] Send failed, waiting 100 ms before retry
23:02:53.222 > [RETRY] Attempt 2/3 (nonce: 1)
23:02:53.222 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:53.227 > Sending pipeline data to server (560 bytes)
23:02:53.371 > [HTTP] Response code: 400
23:02:53.371 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:53.376 > [HTTP] Request failed with code: 400
23:02:53.379 > [RETRY] Send failed, waiting 200 ms before retry
23:02:53.575 > [RETRY] Attempt 3/3 (nonce: 1)
23:02:53.575 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:53.580 > Sending pipeline data to server (560 bytes)
23:02:53.870 > [HTTP] Response code: 400
23:02:53.870 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:53.875 > [HTTP] Request failed with code: 400
23:02:53.878 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:02:53.883 > [RETRY] Consecutive failures: 4
23:02:53.887 > Health data send failed (retry count: 2/3)
23:02:53.985 > [442.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:53.993 > Generated health data: HR-67 SPO2-96 STEPS-2258
23:02:53.996 > [RETRY] Attempting to send health data (Max retries: 3)
23:02:54.002 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:02:54.008 > Generated health data: HR-71 SPO2-96 STEPS-2248
23:02:54.010 > [ESP32] MsgKeys: lfsrSeed=0xF6EDECC8 tnk[0..3]=61691321 trn[0..3]=9C2D7CF2
23:02:54.016 > 1_After_Salt (26): 48522D37312053504F322D3936205354 4550532D323234384D50
23:02:54.024 > 2_After_Padding (32): 48522D37312053504F322D3936205354 4550532D323234384D50000000000000 
23:02:54.032 > [ESP32][LFSR] Initializing - Seed: 0xF6EDECC8 SeedBe: 0xC8ECEDF6 ChaosKey[0..3]: 61691321 InitialTap: 0x0029 State: 0xF6EDECC8
23:02:54.041 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3936205354 Buffer size: 32 bytes
23:02:54.049 > 3_After_LFSR (32): 80BEC0C1C77FA89F96E7CAFE124A06DB 74B5EA4D04624ADCED18C488CED94E5B 
23:02:54.057 > [ESP32][LFSR] Keystream (first 16 bytes): C8ECEDF6F65FFBCFD9D5E7C7246A558F
23:02:54.062 > [ESP32][TINKERBELL] Input (first 16 bytes): 80BEC0C1C77FA89F96E7CAFE124A06DB Nonce: 0x00000001 Buffer size: 32 bytes
23:02:54.074 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 61691321
23:02:54.085 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 962CFED721C6DE6BD503A580F3E9A37D
23:02:54.094 > 4_After_Tinkerbell (32): 16923E16E6B976F443E46F7EE1A3A5A6 3C44A2A7FADD3EE26A2769E7D911F593
23:02:54.102 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 962CFED721C6DE6BD503A580F3E9A37D
23:02:54.108 > 5_After_Transposition (32): 76F4E7699216FADDA2A7A5A67E6F3E16 E443443CE6B96A273EE2E1A311D9F593        
23:02:54.116 > [ESP32] === HMAC DEBUG INFO ===
23:02:54.118 > [ESP32] HMAC Key being used: 54861F1763C595E7ACB6248A21AA28ECE9BA77FDD420773E710F1FE16ECF00C6
23:02:54.126 > [ESP32] HMAC Input length: 44 bytes
23:02:54.129 > [ESP32] HMAC Input (first 32 bytes): 81021800180004080000000176F4E7699216FADDA2A7A5A67E6F3E16E443443C
23:02:54.140 > [ESP32] Nonce: 0x00000001
23:02:54.140 > [ESP32] Packet size before HMAC: 60
23:02:54.146 > [ESP32] Computed HMAC Tag: ECC4B14CB1B4A552ED57CE857D9089FC
23:02:54.152 > [ESP32] === END HMAC DEBUG ===
23:02:54.152 > 6_Final_Packet (60): 81021800180004080000000176F4E769 9216FADDA2A7A5A67E6F3E16E443443C ...
23:02:54.160 > [RETRY] Attempt 1/3 (nonce: 1)
23:02:54.163 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:54.170 > Sending pipeline data to server (560 bytes)
23:02:54.397 > [HTTP] Response code: 400
23:02:54.397 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:54.402 > [HTTP] Request failed with code: 400
23:02:54.404 > [RETRY] Send failed, waiting 100 ms before retry
23:02:54.501 > [RETRY] Attempt 2/3 (nonce: 1)
23:02:54.501 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:54.505 > Sending pipeline data to server (560 bytes)
23:02:54.633 > [HTTP] Response code: 400
23:02:54.633 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:54.639 > [HTTP] Request failed with code: 400
23:02:54.641 > [RETRY] Send failed, waiting 200 ms before retry
23:02:54.838 > [RETRY] Attempt 3/3 (nonce: 1)
23:02:54.838 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:54.844 > Sending pipeline data to server (560 bytes)
23:02:55.128 > [HTTP] Response code: 400
23:02:55.128 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:55.135 > [HTTP] Request failed with code: 400
23:02:55.137 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:02:55.143 > [RETRY] Consecutive failures: 5
23:02:55.145 > [EMERGENCY] Triggering emergency reset!
23:02:55.148 > [CRYPTO] Resetting cryptographic state
23:02:55.153 > [CRYPTO] Crypto state reset complete
23:02:55.157 > [CRYPTO] Packet counter: 8
23:02:55.159 > [EMERGENCY] Emergency reset complete
23:02:55.161 > Health data send failed (retry count: 3/3)
23:02:55.164 > Health data transmission failed after max retries
23:02:55.266 > [444.2] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:02:55.271 > ERROR state - attempting recovery
23:02:55.273 > [RETRY] Attempting to send health data (Max retries: 3)
23:02:55.279 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:02:55.285 > Generated health data: HR-67 SPO2-96 STEPS-2233
23:02:55.288 > [ESP32] MsgKeys: lfsrSeed=0xF6EDECC8 tnk[0..3]=61691321 trn[0..3]=9C2D7CF2
23:02:55.295 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D323233334D50
23:02:55.300 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D323233334D50000000000000 
23:02:55.310 > [ESP32][LFSR] Initializing - Seed: 0xF6EDECC8 SeedBe: 0xC8ECEDF6 ChaosKey[0..3]: 61691321 InitialTap: 0x0029 State: 0xF6EDECC8
23:02:55.321 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
23:02:55.329 > 3_After_LFSR (32): 80BEC0C0C17FA89F96E7CAFE124A06DB 74B5EA4D04624DD7ED18C488CED94E5B
23:02:55.334 > [ESP32][LFSR] Keystream (first 16 bytes): C8ECEDF6F65FFBCFD9D5E7C7246A558F
23:02:55.343 > [ESP32][TINKERBELL] Input (first 16 bytes): 80BEC0C0C17FA89F96E7CAFE124A06DB Nonce: 0x00000001 Buffer size: 32 bytes
23:02:55.351 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 61691321
23:02:55.362 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 962CFED721C6DE6BD503A580F3E9A37D
23:02:55.371 > 4_After_Tinkerbell (32): 16923E17E0B976F443E46F7EE1A3A5A6 3C44A2A7FADD39E96A2769E7D911F593
23:02:55.379 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 962CFED721C6DE6BD503A580F3E9A37D
23:02:55.387 > 5_After_Transposition (32): 76F4E7699216FADDA2A7A5A67E6F3E17 E443443CE0B96A2739E9E1A311D9F593        
23:02:55.395 > [ESP32] === HMAC DEBUG INFO ===
23:02:55.399 > [ESP32] HMAC Key being used: 54861F1763C595E7ACB6248A21AA28ECE9BA77FDD420773E710F1FE16ECF00C6
23:02:55.407 > [ESP32] HMAC Input length: 44 bytes
23:02:55.409 > [ESP32] HMAC Input (first 32 bytes): 81021800180004080000000176F4E7699216FADDA2A7A5A67E6F3E17E443443C
23:02:55.418 > [ESP32] Nonce: 0x00000001
23:02:55.421 > [ESP32] Packet size before HMAC: 60
23:02:55.424 > [ESP32] Computed HMAC Tag: 334E1CD1028C6654C4C95D6D3423E4C7
23:02:55.429 > [ESP32] === END HMAC DEBUG ===
23:02:55.432 > 6_Final_Packet (60): 81021800180004080000000176F4E769 9216FADDA2A7A5A67E6F3E17E443443C ...
23:02:55.440 > [RETRY] Attempt 1/3 (nonce: 1)
23:02:55.443 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:55.446 > Sending pipeline data to server (560 bytes)
23:02:55.640 > [HTTP] Response code: 400
23:02:55.641 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:55.645 > [HTTP] Request failed with code: 400
23:02:55.649 > [RETRY] Send failed, waiting 100 ms before retry
23:02:55.744 > [RETRY] Attempt 2/3 (nonce: 1)
23:02:55.744 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:55.749 > Sending pipeline data to server (560 bytes)
23:02:55.881 > [HTTP] Response code: 400
23:02:55.882 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:55.887 > [HTTP] Request failed with code: 400
23:02:55.890 > [RETRY] Send failed, waiting 200 ms before retry
23:02:56.086 > [RETRY] Attempt 3/3 (nonce: 1)
23:02:56.086 > POST http://10.45.98.115:8081/health-data with pipeline data
23:02:56.092 > Sending pipeline data to server (560 bytes)
23:02:56.405 > [HTTP] Response code: 400
23:02:56.405 > [HTTP] Error response: {"error":"Decryption failed"}
23:02:56.410 > [HTTP] Request failed with code: 400
23:02:56.413 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:02:56.418 > [RETRY] Consecutive failures: 1
23:02:56.421 > ✗ Auto-recovery failed - restarting key exchange

STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:38.333 > Generated health data: HR-68 SPO2-96 STEPS-2440
23:03:38.336 > [RETRY] Attempting to send health data (Max retries: 3)
23:03:38.341 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:03:38.347 > Generated health data: HR-68 SPO2-96 STEPS-2463
23:03:38.349 > [ESP32] MsgKeys: lfsrSeed=0x5FB3EFC9 tnk[0..3]=84216994 trn[0..3]=F5E2DD55
23:03:38.355 > 1_After_Salt (26): 48522D36382053504F322D3936205354 4550532D323436334D50
23:03:38.363 > 2_After_Padding (32): 48522D36382053504F322D3936205354 4550532D323436334D50000000000000
23:03:38.372 > [ESP32][LFSR] Initializing - Seed: 0x5FB3EFC9 SeedBe: 0xC9EFB35F ChaosKey[0..3]: 84216994 InitialTap: 0x0029 State: 0x5FB3EFC9
23:03:38.380 > [ESP32][LFSR] Input (first 16 bytes): 48522D36382053504F322D3936205354 Buffer size: 32 bytes
23:03:38.389 > 3_After_LFSR (32): 81BD9E696632E2CEC9DD30607054C549 5A32B9A3BA5FE6BC403F716084F5A258 
23:03:38.397 > [ESP32][LFSR] Keystream (first 16 bytes): C9EFB35F5E12B19E86EF1D594674961D
23:03:38.402 > [ESP32][TINKERBELL] Input (first 16 bytes): 81BD9E696632E2CEC9DD30607054C549 Nonce: 0x00000001 Buffer size: 32 bytes
23:03:38.413 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 84216994
23:03:38.424 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 5242E4AD3925CEB24A108A94F0F52EA9
23:03:38.433 > 4_After_Tinkerbell (32): D3FF7AC45F172C7C83CDBAF480A1EBE0 34BE951BB2EAD12AD4D9F526898366D4
23:03:38.441 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 5242E4AD3925CEB24A108A94F0F52EA9
23:03:38.446 > 5_After_Transposition (32): D3FF7A8326892C7C83CDBAEA1BB2EBE0 F480A134BE952AD1C45F17D4D9F5D466        
23:03:38.455 > [ESP32] === HMAC DEBUG INFO ===
23:03:38.457 > [ESP32] HMAC Key being used: A9C6AE99761D044EAFE427E22329ADCAFBA94A004B669E065E7D556F00D6FE68        
23:03:38.465 > [ESP32] HMAC Input length: 44 bytes
23:03:38.468 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001D3FF7A8326892C7C83CDBAEA1BB2EBE0F480A134
23:03:38.480 > [ESP32] Nonce: 0x00000001
23:03:38.480 > [ESP32] Packet size before HMAC: 60
23:03:38.485 > [ESP32] Computed HMAC Tag: D2A1C1AE894FF75C7058B7C366A3C52B
23:03:38.491 > [ESP32] === END HMAC DEBUG ===
23:03:38.491 > 6_Final_Packet (60): 810218001800040800000001D3FF7A83 26892C7C83CDBAEA1BB2EBE0F480A134 ...
23:03:38.499 > [RETRY] Attempt 1/3 (nonce: 1)
23:03:38.502 > POST http://10.45.98.115:8081/health-data with pipeline data
23:03:38.508 > Sending pipeline data to server (560 bytes)
23:03:38.690 > [HTTP] Response code: 400
23:03:38.691 > [HTTP] Error response: {"error":"Decryption failed"}
23:03:38.697 > [HTTP] Request failed with code: 400
23:03:38.699 > [RETRY] Send failed, waiting 100 ms before retry
23:03:38.795 > [RETRY] Attempt 2/3 (nonce: 1)
23:03:38.795 > POST http://10.45.98.115:8081/health-data with pipeline data
23:03:38.800 > Sending pipeline data to server (560 bytes)
23:03:38.929 > [HTTP] Response code: 400
23:03:38.929 > [HTTP] Error response: {"error":"Decryption failed"}
23:03:38.935 > [HTTP] Request failed with code: 400
23:03:38.937 > [RETRY] Send failed, waiting 200 ms before retry
23:03:39.133 > [RETRY] Attempt 3/3 (nonce: 1)
23:03:39.133 > POST http://10.45.98.115:8081/health-data with pipeline data
23:03:39.139 > Sending pipeline data to server (560 bytes)
23:03:39.425 > [HTTP] Response code: 400
23:03:39.425 > [HTTP] Error response: {"error":"Decryption failed"}
23:03:39.430 > [HTTP] Request failed with code: 400
23:03:39.433 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:03:39.438 > [RETRY] Consecutive failures: 1
23:03:39.441 > Health data send failed (retry count: 1/3)
23:03:39.539 > [488.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:39.547 > Generated health data: HR-68 SPO2-96 STEPS-2478
23:03:39.550 > [RETRY] Attempting to send health data (Max retries: 3)
23:03:39.555 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:03:39.561 > Generated health data: HR-68 SPO2-96 STEPS-2445
23:03:39.564 > [ESP32] MsgKeys: lfsrSeed=0x5FB3EFC9 tnk[0..3]=84216994 trn[0..3]=F5E2DD55
23:03:39.569 > 1_After_Salt (26): 48522D36382053504F322D3936205354 4550532D323434354D50
23:03:39.578 > 2_After_Padding (32): 48522D36382053504F322D3936205354 4550532D323434354D50000000000000
23:03:39.586 > [ESP32][LFSR] Initializing - Seed: 0x5FB3EFC9 SeedBe: 0xC9EFB35F ChaosKey[0..3]: 84216994 InitialTap: 0x0029 State: 0x5FB3EFC9
23:03:39.595 > [ESP32][LFSR] Input (first 16 bytes): 48522D36382053504F322D3936205354 Buffer size: 32 bytes
23:03:39.603 > 3_After_LFSR (32): 81BD9E696632E2CEC9DD30607054C549 5A32B9A3BA5FE4BA403F716084F5A258 
23:03:39.611 > [ESP32][LFSR] Keystream (first 16 bytes): C9EFB35F5E12B19E86EF1D594674961D
23:03:39.616 > [ESP32][TINKERBELL] Input (first 16 bytes): 81BD9E696632E2CEC9DD30607054C549 Nonce: 0x00000001 Buffer size: 32 bytes
23:03:39.628 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 84216994
23:03:39.639 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 5242E4AD3925CEB24A108A94F0F52EA9
23:03:39.647 > 4_After_Tinkerbell (32): D3FF7AC45F172C7C83CDBAF480A1EBE0 34BE951BB2EAD32CD4D9F526898366D4 
23:03:39.656 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 5242E4AD3925CEB24A108A94F0F52EA9
23:03:39.661 > 5_After_Transposition (32): D3FF7A8326892C7C83CDBAEA1BB2EBE0 F480A134BE952CD3C45F17D4D9F5D466 
23:03:39.669 > [ESP32] === HMAC DEBUG INFO ===
23:03:39.672 > [ESP32] HMAC Key being used: A9C6AE99761D044EAFE427E22329ADCAFBA94A004B669E065E7D556F00D6FE68        
23:03:39.681 > [ESP32] HMAC Input length: 44 bytes
23:03:39.683 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001D3FF7A8326892C7C83CDBAEA1BB2EBE0F480A134
23:03:39.694 > [ESP32] Nonce: 0x00000001
23:03:39.694 > [ESP32] Packet size before HMAC: 60
23:03:39.700 > [ESP32] Computed HMAC Tag: C0A0ED2D81AA3A6E2D7E1A721DC6A561
23:03:39.705 > [ESP32] === END HMAC DEBUG ===
23:03:39.705 > 6_Final_Packet (60): 810218001800040800000001D3FF7A83 26892C7C83CDBAEA1BB2EBE0F480A134 ...
23:03:39.714 > [RETRY] Attempt 1/3 (nonce: 1)
23:03:39.717 > POST http://10.45.98.115:8081/health-data with pipeline data
23:03:39.723 > Sending pipeline data to server (560 bytes)
23:03:39.930 > [HTTP] Response code: 400
23:03:39.930 > [HTTP] Error response: {"error":"Decryption failed"}
23:03:39.935 > [HTTP] Request failed with code: 400
23:03:39.938 > [RETRY] Send failed, waiting 100 ms before retry
23:03:40.033 > [RETRY] Attempt 2/3 (nonce: 1)
23:03:40.033 > POST http://10.45.98.115:8081/health-data with pipeline data
23:03:40.038 > Sending pipeline data to server (560 bytes)
23:03:40.178 > [HTTP] Response code: 400
23:03:40.178 > [HTTP] Error response: {"error":"Decryption failed"}
23:03:40.183 > [HTTP] Request failed with code: 400
23:03:40.186 > [RETRY] Send failed, waiting 200 ms before retry
23:03:40.381 > [RETRY] Attempt 3/3 (nonce: 1)
23:03:40.381 > POST http://10.45.98.115:8081/health-data with pipeline data
23:03:40.386 > Sending pipeline data to server (560 bytes)
23:03:40.701 > [HTTP] Response code: 400
23:03:40.701 > [HTTP] Error response: {"error":"Decryption failed"}
23:03:40.706 > [HTTP] Request failed with code: 400
23:03:40.709 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:03:40.715 > [RETRY] Consecutive failures: 2
23:03:40.717 > Health data send failed (retry count: 2/3)
23:03:40.816 > [489.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:40.825 > Generated health data: HR-68 SPO2-96 STEPS-2472
23:03:40.827 > [RETRY] Attempting to send health data (Max retries: 3)
23:03:40.833 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:03:40.838 > Generated health data: HR-68 SPO2-96 STEPS-2487
23:03:40.841 > [ESP32] MsgKeys: lfsrSeed=0x5FB3EFC9 tnk[0..3]=84216994 trn[0..3]=F5E2DD55
23:03:40.846 > 1_After_Salt (26): 48522D36382053504F322D3936205354 4550532D323438374D50
23:03:40.855 > 2_After_Padding (32): 48522D36382053504F322D3936205354 4550532D323438374D50000000000000
23:03:40.863 > [ESP32][LFSR] Initializing - Seed: 0x5FB3EFC9 SeedBe: 0xC9EFB35F ChaosKey[0..3]: 84216994 InitialTap: 0x0029 State: 0x5FB3EFC9
23:03:40.872 > [ESP32][LFSR] Input (first 16 bytes): 48522D36382053504F322D3936205354 Buffer size: 32 bytes
23:03:40.880 > 3_After_LFSR (32): 81BD9E696632E2CEC9DD30607054C549 5A32B9A3BA5FE8B8403F716084F5A258 
23:03:40.888 > [ESP32][LFSR] Keystream (first 16 bytes): C9EFB35F5E12B19E86EF1D594674961D
23:03:40.893 > [ESP32][TINKERBELL] Input (first 16 bytes): 81BD9E696632E2CEC9DD30607054C549 Nonce: 0x00000001 Buffer size: 32 bytes
23:03:40.904 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 84216994
23:03:40.915 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 5242E4AD3925CEB24A108A94F0F52EA9
23:03:40.924 > 4_After_Tinkerbell (32): D3FF7AC45F172C7C83CDBAF480A1EBE0 34BE951BB2EADF2ED4D9F526898366D4
23:03:40.932 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 5242E4AD3925CEB24A108A94F0F52EA9
23:03:40.938 > 5_After_Transposition (32): D3FF7A8326892C7C83CDBAEA1BB2EBE0 F480A134BE952EDFC45F17D4D9F5D466        
23:03:40.946 > [ESP32] === HMAC DEBUG INFO ===
23:03:40.949 > [ESP32] HMAC Key being used: A9C6AE99761D044EAFE427E22329ADCAFBA94A004B669E065E7D556F00D6FE68        
23:03:40.957 > [ESP32] HMAC Input length: 44 bytes
23:03:40.960 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001D3FF7A8326892C7C83CDBAEA1BB2EBE0F480A134
23:03:40.971 > [ESP32] Nonce: 0x00000001
23:03:40.971 > [ESP32] Packet size before HMAC: 60
23:03:40.977 > [ESP32] Computed HMAC Tag: BA334596B73E319F2BDE65879A763415
23:03:40.982 > [ESP32] === END HMAC DEBUG ===
23:03:40.983 > 6_Final_Packet (60): 810218001800040800000001D3FF7A83 26892C7C83CDBAEA1BB2EBE0F480A134 ...
23:03:40.991 > [RETRY] Attempt 1/3 (nonce: 1)
23:03:40.994 > POST http://10.45.98.115:8081/health-data with pipeline data
23:03:41.000 > Sending pipeline data to server (560 bytes)
23:03:41.186 > [HTTP] Response code: 400
23:03:41.186 > [HTTP] Error response: {"error":"Decryption failed"}
23:03:41.192 > [HTTP] Request failed with code: 400
23:03:41.195 > [RETRY] Send failed, waiting 100 ms before retry
23:03:41.291 > [RETRY] Attempt 2/3 (nonce: 1)
23:03:41.292 > POST http://10.45.98.115:8081/health-data with pipeline data
23:03:41.296 > Sending pipeline data to server (560 bytes)
23:03:41.437 > [HTTP] Response code: 400
23:03:41.458 > [HTTP] Error response: {"error":"Decryption failed"}
23:03:41.458 > [HTTP] Request failed with code: 400
23:03:41.458 > [RETRY] Send failed, waiting 200 ms before retry
23:03:41.641 > [RETRY] Attempt 3/3 (nonce: 1)
23:03:41.641 > POST http://10.45.98.115:8081/health-data with pipeline data
23:03:41.647 > Sending pipeline data to server (560 bytes)
23:03:41.936 > [HTTP] Response code: 400
23:03:41.936 > [HTTP] Error response: {"error":"Decryption failed"}
23:03:41.942 > [HTTP] Request failed with code: 400
23:03:41.944 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:03:41.950 > [RETRY] Consecutive failures: 3
23:03:41.952 > Health data send failed (retry count: 3/3)
23:03:41.955 > Health data transmission failed after max retries
23:03:42.062 > [491.0] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:42.068 > ERROR state - attempting recovery
23:03:42.070 > [RETRY] Attempting to send health data (Max retries: 3)
23:03:42.076 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:03:42.081 > Generated health data: HR-68 SPO2-96 STEPS-2483
23:03:42.084 > [ESP32] MsgKeys: lfsrSeed=0x5FB3EFC9 tnk[0..3]=84216994 trn[0..3]=F5E2DD55
23:03:42.092 > 1_After_Salt (26): 48522D36382053504F322D3936205354 4550532D323438334D50
23:03:42.098 > 2_After_Padding (32): 48522D36382053504F322D3936205354 4550532D323438334D50000000000000
23:03:42.106 > [ESP32][LFSR] Initializing - Seed: 0x5FB3EFC9 SeedBe: 0xC9EFB35F ChaosKey[0..3]: 84216994 InitialTap: 0x0029 State: 0x5FB3EFC9
23:03:42.118 > [ESP32][LFSR] Input (first 16 bytes): 48522D36382053504F322D3936205354 Buffer size: 32 bytes
23:03:42.126 > 3_After_LFSR (32): 81BD9E696632E2CEC9DD30607054C549 5A32B9A3BA5FE8BC403F716084F5A258 
23:03:42.132 > [ESP32][LFSR] Keystream (first 16 bytes): C9EFB35F5E12B19E86EF1D594674961D
23:03:42.139 > [ESP32][TINKERBELL] Input (first 16 bytes): 81BD9E696632E2CEC9DD30607054C549 Nonce: 0x00000001 Buffer size: 32 bytes
23:03:42.148 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 84216994
23:03:42.159 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 5242E4AD3925CEB24A108A94F0F52EA9
23:03:42.167 > 4_After_Tinkerbell (32): D3FF7AC45F172C7C83CDBAF480A1EBE0 34BE951BB2EADF2AD4D9F526898366D4
23:03:42.175 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 5242E4AD3925CEB24A108A94F0F52EA9
23:03:42.184 > 5_After_Transposition (32): D3FF7A8326892C7C83CDBAEA1BB2EBE0 F480A134BE952ADFC45F17D4D9F5D466        
23:03:42.192 > [ESP32] === HMAC DEBUG INFO ===
23:03:42.194 > [ESP32] HMAC Key being used: A9C6AE99761D044EAFE427E22329ADCAFBA94A004B669E065E7D556F00D6FE68        
23:03:42.203 > [ESP32] HMAC Input length: 44 bytes
23:03:42.206 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001D3FF7A8326892C7C83CDBAEA1BB2EBE0F480A134
23:03:42.215 > [ESP32] Nonce: 0x00000001
23:03:42.217 > [ESP32] Packet size before HMAC: 60
23:03:42.220 > [ESP32] Computed HMAC Tag: 4641BFEA497C084DD43F8E32B03B7A0A
23:03:42.226 > [ESP32] === END HMAC DEBUG ===
23:03:42.229 > 6_Final_Packet (60): 810218001800040800000001D3FF7A83 26892C7C83CDBAEA1BB2EBE0F480A134 ...
23:03:42.236 > [RETRY] Attempt 1/3 (nonce: 1)
23:03:42.240 > POST http://10.45.98.115:8081/health-data with pipeline data
23:03:42.242 > Sending pipeline data to server (560 bytes)
23:03:42.437 > [HTTP] Response code: 400
23:03:42.437 > [HTTP] Error response: {"error":"Decryption failed"}
23:03:42.443 > [HTTP] Request failed with code: 400
23:03:42.445 > [RETRY] Send failed, waiting 100 ms before retry
23:03:42.542 > [RETRY] Attempt 2/3 (nonce: 1)
23:03:42.542 > POST http://10.45.98.115:8081/health-data with pipeline data
23:03:42.546 > Sending pipeline data to server (560 bytes)
23:03:42.708 > [HTTP] Response code: 400
23:03:42.708 > [HTTP] Error response: {"error":"Decryption failed"}
23:03:42.715 > [HTTP] Request failed with code: 400
23:03:42.717 > [RETRY] Send failed, waiting 200 ms before retry
23:03:42.913 > [RETRY] Attempt 3/3 (nonce: 1)
23:03:42.913 > POST http://10.45.98.115:8081/health-data with pipeline data
23:03:42.918 > Sending pipeline data to server (560 bytes)
23:03:43.195 > [HTTP] Response code: 400
23:03:43.195 > [HTTP] Error response: {"error":"Decryption failed"}
23:03:43.200 > [HTTP] Request failed with code: 400
23:03:43.204 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:03:43.210 > [RETRY] Consecutive failures: 4
23:03:43.213 > ✗ Auto-recovery failed - restarting key exchange
23:03:50.316 > [499.2] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:50.323 > ✓ Public key loaded from NVS
23:03:50.419 > [WebSocket] Disconnected!
23:03:50.419 > [499.4] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED  
23:03:50.519 > [499.5] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:50.529 > Generating fresh master key from entropy...
23:03:50.535 > Generated master key (32): 262ED4739B281F25AFB22E0717BDB31D 92175DCA9C163177C631458C4F1B8D4E
23:03:50.541 > Using reduced master key (byte % 3) for NTRU encryption only
23:03:50.552 > NTRU encrypted master key (502): 0079000700080072006A000100600066 00370007007E001900110018000B0008 ...
23:03:50.560 > POST http://10.45.98.115:8081/master-key
23:03:50.917 > ✓ Master key exchange completed
23:03:51.019 > [500.0] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:51.027 > Loading master key from NVS and deriving symmetric keys...
23:03:51.030 > Loaded master key from NVS (32): 262ED4739B281F25AFB22E0717BDB31D 92175DCA9C163177C631458C4F1B8D4E   
23:03:51.041 > Derived HMAC key (32): E8F587DDEBB3281F72FE1C28380FCCBF FAFBDA4FB5E3D0324072452EC4775704 
23:03:51.047 > Derived Tinkerbell key (16): 13341416956F0DB2D1E48922F70E011F
23:03:51.052 > Derived Transposition key (16): 038A0FB6BE9440AC9F619EC4B7096917
23:03:51.060 > ✓ Symmetric keys derived successfully
23:03:51.063 > Nonce tracker reset - new session started
23:03:51.559 > Waiting for server to process master key...
23:03:51.563 > ✓ Symmetric keys ready - starting health data transmission
23:03:51.660 > [500.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:51.761 > [500.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:51.861 > [500.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:51.961 > [500.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:52.061 > [501.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:52.161 > [501.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:52.261 > [501.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:52.361 > [501.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:52.460 > [501.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:52.561 > [501.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:52.661 > [501.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:52.761 > [501.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:52.861 > [501.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:52.961 > [501.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:53.062 > [502.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:53.161 > [502.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:53.260 > [502.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:53.361 > [502.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:53.461 > [502.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:53.561 > [502.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:53.661 > [502.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:53.761 > [502.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:53.861 > [502.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:53.961 > [502.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:54.060 > [503.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:54.160 > [503.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:54.260 > [503.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:54.360 > [503.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:54.461 > [503.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:54.560 > [503.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:54.660 > [503.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:54.760 > [503.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:54.861 > [503.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:54.961 > [503.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:55.061 > [504.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:55.161 > [504.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:55.261 > [504.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:03:55.361 > [504.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:04:00.467 > [509.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:04:00.567 > [WebSocket] Disconnected!
23:04:00.567 > [509.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED     
23:04:00.668 > [509.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:04:00.768 > [509.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:04:00.868 > [509.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:04:00.968 > [509.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:04:01.067 > [510.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:04:01.168 > [510.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:04:01.268 > [510.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:04:01.368 > [510.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:04:01.468 > [510.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:04:01.568 > [510.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: DISCONNECTED
23:04:01.576 > Generated health data: HR-68 SPO2-96 STEPS-2598
23:04:01.579 > [RETRY] Attempting to send health data (Max retries: 3)
23:04:01.585 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:04:01.590 > Generated health data: HR-71 SPO2-96 STEPS-2574
23:04:01.593 > [ESP32] MsgKeys: lfsrSeed=0xF285983E tnk[0..3]=98B3C7CD trn[0..3]=EBAAF281
23:04:01.598 > 1_After_Salt (26): 48522D37312053504F322D3936205354 4550532D323537344D50
23:04:01.607 > 2_After_Padding (32): 48522D37312053504F322D3936205354 4550532D323537344D50000000000000
23:04:01.614 > [ESP32][LFSR] Initializing - Seed: 0xF285983E SeedBe: 0x3E9885F2 ChaosKey[0..3]: 98B3C7CD InitialTap: 0x0029 State: 0xF285983E
23:04:01.623 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3936205354 Buffer size: 32 bytes
23:04:01.631 > 3_After_LFSR (32): 76CAA8C5D4FF3E3F6D6FEFA9585F1296 07ABF90F1F107184C0C1E1588CD09F88
23:04:01.640 > [ESP32][LFSR] Keystream (first 16 bytes): 3E9885F2E5DF6D6F225DC2906E7F41C2
23:04:01.645 > [ESP32][TINKERBELL] Input (first 16 bytes): 76CAA8C5D4FF3E3F6D6FEFA9585F1296 Nonce: 0x00000001 Buffer size: 32 bytes
23:04:01.657 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 98B3C7CD
23:04:01.667 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 97F049CD28DFCAA7172B42A6F1B554C6
23:04:01.676 > 4_After_Tinkerbell (32): E13AE108FC20F4987A44AD0FA9EA4650 0A7C3FBC9114BF6ED7B9EF50B6ADB705 
23:04:01.684 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 97F049CD28DFCAA7172B42A6F1B554C6
23:04:01.690 > 5_After_Transposition (32): A90FEAE1E13AB705FC0820AD7A44BF6E 91BC143F0A7C4650B650ADEFD7B9F498 
23:04:01.698 > [ESP32] === HMAC DEBUG INFO ===
23:04:01.701 > [ESP32] HMAC Key being used: E8F587DDEBB3281F72FE1C28380FCCBFFAFBDA4FB5E3D0324072452EC4775704
23:04:01.709 > [ESP32] HMAC Input length: 44 bytes
23:04:01.712 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001A90FEAE1E13AB705FC0820AD7A44BF6E91BC143F
23:04:01.723 > [ESP32] Nonce: 0x00000001
23:04:01.723 > [ESP32] Packet size before HMAC: 60
23:04:01.729 > [ESP32] Computed HMAC Tag: 9197A3C99971636F6701B5FD413629FC
23:04:01.734 > [ESP32] === END HMAC DEBUG ===
23:04:01.735 > 6_Final_Packet (60): 810218001800040800000001A90FEAE1 E13AB705FC0820AD7A44BF6E91BC143F ...
23:04:01.742 > [RETRY] Attempt 1/3 (nonce: 1)
23:04:01.745 > POST http://10.45.98.115:8081/health-data with pipeline data
23:04:01.752 > Sending pipeline data to server (560 bytes)
23:04:01.964 > [HTTP] Response code: 200
23:04:01.964 > [HTTP] Response: {"status":"OK:DECRYPTED"}
23:04:01.969 > [RETRY] Health data sent successfully!
23:04:01.972 > ✓ Health data #10 sent successfully
23:04:02.068 > [511.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: DISCONNECTED
23:04:02.169 > [511.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: DISCONNECTED
23:04:02.269 > [511.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: DISCONNECTED
23:04:02.368 > [511.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: DISCONNECTED
23:04:02.469 > [511.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: DISCONNECTED
23:04:02.569 > [511.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: DISCONNECTED

23:04:58.282 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): AFB3B04F21EBA905F6F46B5DA97B6D1C
23:04:58.288 > 5_After_Transposition (32): 404A138C4B85E026B357DF6A67F21AAC 4A74D283EC283D750032F5F063A1F80D 
23:04:58.295 > [ESP32] === HMAC DEBUG INFO ===
23:04:58.298 > [ESP32] HMAC Key being used: FFA8C952E061ADC72AB31EDC5145DC26D1F57845074BF87807BF5DE73CE622F0        
23:04:58.307 > [ESP32] HMAC Input length: 44 bytes
23:04:58.310 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001404A138C4B85E026B357DF6A67F21AAC4A74D283
23:04:58.320 > [ESP32] Nonce: 0x00000001
23:04:58.324 > [ESP32] Packet size before HMAC: 60
23:04:58.326 > [ESP32] Computed HMAC Tag: 5BE0A0017E9EF876AECB0A44580E16AD
23:04:58.332 > [ESP32] === END HMAC DEBUG ===
23:04:58.335 > 6_Final_Packet (60): 810218001800040800000001404A138C 4B85E026B357DF6A67F21AAC4A74D283 ...
23:04:58.340 > [RETRY] Attempt 1/3 (nonce: 1)
23:04:58.343 > POST http://10.45.98.115:8081/health-data with pipeline data
23:04:58.348 > Sending pipeline data to server (560 bytes)
23:04:58.517 > [HTTP] Response code: 200
23:04:58.517 > [HTTP] Response: {"status":"OK:DECRYPTED"}
23:04:58.521 > [RETRY] Health data sent successfully!
23:04:58.524 > ✓ Health data #11 sent successfully
23:04:58.622 > [567.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:58.721 > [567.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:58.821 > [567.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:58.922 > [567.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:59.022 > [568.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:59.122 > [568.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:59.222 > [568.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:59.322 > [568.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:59.422 > [568.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:59.522 > [568.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:59.622 > [568.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:59.721 > [568.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:59.822 > [568.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:04:59.921 > [568.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:00.022 > [569.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:00.122 > [569.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:00.221 > [569.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:00.322 > [569.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:00.421 > [569.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:00.521 > [569.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:00.621 > [569.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:00.722 > [569.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:00.822 > [569.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:00.922 > [569.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:01.022 > [570.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:01.121 > [570.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:01.222 > [570.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:01.322 > [570.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:01.422 > [570.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:01.521 > [570.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:01.622 > [570.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:01.722 > [570.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:01.822 > [570.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:01.921 > [570.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:02.022 > [571.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:02.122 > [571.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:02.222 > [571.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:02.321 > [571.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:07.428 > [576.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:07.528 > [WebSocket] Disconnected!
23:05:07.528 > [576.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED    
23:05:07.629 > [576.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:07.728 > [576.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:07.829 > [576.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:07.929 > [576.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:08.029 > [577.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:08.129 > [577.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:08.229 > [577.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:08.329 > [577.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:08.429 > [577.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:08.529 > [577.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: DISCONNECTED
23:05:08.537 > Generated health data: HR-69 SPO2-96 STEPS-2919
23:05:08.540 > [RETRY] Attempting to send health data (Max retries: 3)
23:05:08.545 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
23:05:08.550 > Generated health data: HR-69 SPO2-96 STEPS-2898
23:05:08.554 > [ESP32] MsgKeys: lfsrSeed=0xCEA6D90B tnk[0..3]=3F707D10 trn[0..3]=921E3782
23:05:08.560 > 1_After_Salt (26): 48522D36392053504F322D3936205354 4550532D323839384D50
23:05:08.567 > 2_After_Padding (32): 48522D36392053504F322D3936205354 4550532D323839384D50000000000000 
23:05:08.576 > [ESP32][LFSR] Initializing - Seed: 0xCEA6D90B SeedBe: 0x0BD9A6CE ChaosKey[0..3]: 3F707D10 InitialTap: 0x0029 State: 0xCEA6D90B
23:05:08.587 > [ESP32][LFSR] Input (first 16 bytes): 48522D36392053504F322D3936205354 Buffer size: 32 bytes
23:05:08.592 > 3_After_LFSR (32): 438B8BF8FA8881E1B3CAE24D04F34B0F 071834ED99685E7AF7C0386811AED61B 
23:05:08.601 > [ESP32][LFSR] Keystream (first 16 bytes): 0BD9A6CEC3A8D2B1FCF8CF7432D3185B
23:05:08.609 > [ESP32][TINKERBELL] Input (first 16 bytes): 438B8BF8FA8881E1B3CAE24D04F34B0F Nonce: 0x00000002 Buffer size: 32 bytes
23:05:08.617 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 3F707D10
23:05:08.629 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 73B5D6C4F44711FBFA40963679F18D40
23:05:08.637 > 4_After_Tinkerbell (32): 303E5D3C0ECF901A498A747B7D02C64F 4DFFDA267B125B11BC4DA1A168739068
23:05:08.646 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 73B5D6C4F44711FBFA40963679F18D40
23:05:08.651 > 5_After_Transposition (32): 4DFFDA267B121A90498A747B7D02115B 303E5D3C0ECF4FC6BC4DA1A168739068        
23:05:08.659 > [ESP32] === HMAC DEBUG INFO ===
23:05:08.662 > [ESP32] HMAC Key being used: FFA8C952E061ADC72AB31EDC5145DC26D1F57845074BF87807BF5DE73CE622F0        
23:05:08.670 > [ESP32] HMAC Input length: 44 bytes
23:05:08.673 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000024DFFDA267B121A90498A747B7D02115B303E5D3C
23:05:08.685 > [ESP32] Nonce: 0x00000002
23:05:08.687 > [ESP32] Packet size before HMAC: 60
23:05:08.690 > [ESP32] Computed HMAC Tag: 615FABFDD7CD3DE8124FD7190A289E46
23:05:08.695 > [ESP32] === END HMAC DEBUG ===
23:05:08.698 > 6_Final_Packet (60): 8102180018000408000000024DFFDA26 7B121A90498A747B7D02115B303E5D3C ...
23:05:08.704 > [RETRY] Attempt 1/3 (nonce: 2)
23:05:08.706 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:08.713 > Sending pipeline data to server (560 bytes)
23:05:09.018 > [HTTP] Response code: 200
23:05:09.018 > [HTTP] Response: {"status":"OK:DECRYPTED"}
23:05:09.024 > [RETRY] Health data sent successfully!
23:05:09.026 > ✓ Health data #12 sent successfully
23:05:09.123 > [578.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:09.224 > [578.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:09.324 > [578.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:09.424 > [578.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:09.524 > [578.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:09.623 > [578.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:09.723 > [578.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:09.823 > [578.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:09.924 > [578.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:10.024 > [579.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:10.124 > [579.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:10.224 > [579.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:10.324 > [579.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:10.423 > [579.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:10.524 > [579.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:10.624 > [579.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:10.724 > [579.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:10.823 > [579.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:10.923 > [579.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:11.024 > [580.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:11.124 > [580.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:11.224 > [580.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:11.323 > [580.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:11.424 > [580.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:11.523 > [580.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:11.623 > [580.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:11.724 > [580.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:11.823 > [580.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:11.923 > [580.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:12.024 > [581.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:12.124 > [581.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:12.224 > [581.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:12.324 > [581.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:12.423 > [581.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:12.524 > [581.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:17.629 > [586.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:17.730 > [WebSocket] Disconnected!
23:05:17.730 > [586.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED    
23:05:17.831 > [586.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:17.930 > [586.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:18.030 > [587.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:18.131 > [587.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:18.230 > [587.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:18.331 > [587.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:18.430 > [587.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:18.530 > [587.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:18.631 > [587.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:18.730 > [587.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:18.831 > [587.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:18.931 > [587.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:19.031 > [588.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: DISCONNECTED
23:05:19.039 > Generated health data: HR-69 SPO2-96 STEPS-2976
23:05:19.042 > [RETRY] Attempting to send health data (Max retries: 3)
23:05:19.047 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
23:05:19.053 > Generated health data: HR-69 SPO2-96 STEPS-2962
23:05:19.055 > [ESP32] MsgKeys: lfsrSeed=0x6BF7D344 tnk[0..3]=1033632F trn[0..3]=56DA8CD6
23:05:19.061 > 1_After_Salt (26): 48522D36392053504F322D3936205354 4550532D323936324D50
23:05:19.070 > 2_After_Padding (32): 48522D36392053504F322D3936205354 4550532D323936324D50000000000000
23:05:19.078 > [ESP32][LFSR] Initializing - Seed: 0x6BF7D344 SeedBe: 0x44D3F76B ChaosKey[0..3]: 1033632F InitialTap: 0x0029 State: 0x6BF7D344
23:05:19.088 > [ESP32][LFSR] Input (first 16 bytes): 48522D36392053504F322D3936205354 Buffer size: 32 bytes
23:05:19.094 > 3_After_LFSR (32): 0C81DA5DC72D4D1C07EC7A7F12DB300E C9162EB6771FF4E114BBB4A590528C5A 
23:05:19.102 > [ESP32][LFSR] Keystream (first 16 bytes): 44D3F76BFE0D1E4C48DE574624FB635A
23:05:19.111 > [ESP32][TINKERBELL] Input (first 16 bytes): 0C81DA5DC72D4D1C07EC7A7F12DB300E Nonce: 0x00000003 Buffer size: 32 bytes
23:05:19.119 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 1033632F
23:05:19.130 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 6E73C7501685F3062D04C688AB3B0BBC
23:05:19.139 > 4_After_Tinkerbell (32): 62F21D0DD1A8BE1A2AE8BCF7B9E03BB2 498B7E9E3BCD5EFA70CF79C955678F42 
23:05:19.147 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 6E73C7501685F3062D04C688AB3B0BBC
23:05:19.152 > 5_After_Transposition (32): 8B7E49A80DD1FA5EF21D62E0F7B9B23B E8BC2ACD9E3B1ABE6755C979CF708F42 
23:05:19.161 > [ESP32] === HMAC DEBUG INFO ===
23:05:19.164 > [ESP32] HMAC Key being used: FFA8C952E061ADC72AB31EDC5145DC26D1F57845074BF87807BF5DE73CE622F0        
23:05:19.172 > [ESP32] HMAC Input length: 44 bytes
23:05:19.175 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000038B7E49A80DD1FA5EF21D62E0F7B9B23BE8BC2ACD
23:05:19.186 > [ESP32] Nonce: 0x00000003
23:05:19.189 > [ESP32] Packet size before HMAC: 60
23:05:19.192 > [ESP32] Computed HMAC Tag: B64C00501C21AE74A78BB645AEF81393
23:05:19.197 > [ESP32] === END HMAC DEBUG ===
23:05:19.199 > 6_Final_Packet (60): 8102180018000408000000038B7E49A8 0DD1FA5EF21D62E0F7B9B23BE8BC2ACD ...
23:05:19.206 > [RETRY] Attempt 1/3 (nonce: 3)
23:05:19.208 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:19.215 > Sending pipeline data to server (560 bytes)
23:05:19.537 > [HTTP] Response code: 200
23:05:19.537 > [HTTP] Response: {"status":"OK:DECRYPTED"}
23:05:19.543 > [RETRY] Health data sent successfully!
23:05:19.546 > ✓ Health data #13 sent successfully
23:05:19.643 > [588.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:19.744 > [588.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:19.843 > [588.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:19.943 > [588.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:20.044 > [589.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:20.143 > [589.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:20.243 > [589.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:20.344 > [589.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:20.443 > [589.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:20.543 > [589.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:20.643 > [589.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:20.743 > [589.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:20.843 > [589.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:20.943 > [589.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:21.043 > [590.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:21.143 > [590.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:21.243 > [590.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:21.343 > [590.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:21.443 > [590.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:21.543 > [590.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:21.643 > [590.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:21.743 > [590.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:21.844 > [590.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:21.943 > [590.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:22.044 > [591.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:22.143 > [591.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:22.244 > [591.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:22.344 > [591.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:22.444 > [591.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:22.543 > [591.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:22.643 > [591.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:27.748 > [596.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:27.848 > [WebSocket] Disconnected!
23:05:27.848 > [596.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED    
23:05:27.949 > [596.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:28.049 > [597.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:28.149 > [597.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:28.249 > [597.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:28.349 > [597.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:28.449 > [597.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:28.550 > [597.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:28.649 > [597.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:28.749 > [597.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:28.849 > [597.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:28.950 > [597.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:29.050 > [598.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:29.150 > [598.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:29.250 > [598.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:29.350 > [598.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:29.450 > [598.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:29.549 > [598.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:29.557 > Generated health data: HR-69 SPO2-96 STEPS-2998
23:05:29.560 > [RETRY] Attempting to send health data (Max retries: 3)
23:05:29.565 > [RETRY] Using nonce 4 for all retry attempts (saved: 3)
23:05:29.571 > Generated health data: HR-69 SPO2-96 STEPS-3016
23:05:29.574 > [ESP32] MsgKeys: lfsrSeed=0x672D3901 tnk[0..3]=416BD0C6 trn[0..3]=25B95A9A
23:05:29.580 > 1_After_Salt (26): 48522D36392053504F322D3936205354 4550532D333031364D50
23:05:29.588 > 2_After_Padding (32): 48522D36392053504F322D3936205354 4550532D333031364D50000000000000
23:05:29.595 > [ESP32][LFSR] Initializing - Seed: 0x672D3901 SeedBe: 0x01392D67 ChaosKey[0..3]: 416BD0C6 InitialTap: 0x0029 State: 0x672D3901
23:05:29.607 > [ESP32][LFSR] Input (first 16 bytes): 48522D36392053504F322D3936205354 Buffer size: 32 bytes
23:05:29.612 > 3_After_LFSR (32): 496B0051638F144ECBFFEE4FB51299C1 9270B8EC5608E22C69B97A8D4C855CF2 
23:05:29.621 > [ESP32][LFSR] Keystream (first 16 bytes): 01392D675AAF471E84CDC3768332CA95
23:05:29.630 > [ESP32][TINKERBELL] Input (first 16 bytes): 496B0051638F144ECBFFEE4FB51299C1 Nonce: 0x00000004 Buffer size: 32 bytes
23:05:29.638 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000004 Counter: 0 (must start at 0) Key[0..3]: 416BD0C6
23:05:29.649 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9EC7E80F8D109470B704E6E2D63747BD
23:05:29.658 > 4_After_Tinkerbell (32): D7ACE85EEE9F803E7CFB08AD6325DE7C FC33FD77ADA9726AE8DB21F8C8FA848C 
23:05:29.665 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9EC7E80F8D109470B704E6E2D63747BD
23:05:29.671 > 5_After_Transposition (32): E8DB6325D7AC803EFC33EE9F7CFBDE7C 8C84E85EA9AD21F86A7208ADFAC8FD77 
23:05:29.680 > [ESP32] === HMAC DEBUG INFO ===
23:05:29.682 > [ESP32] HMAC Key being used: FFA8C952E061ADC72AB31EDC5145DC26D1F57845074BF87807BF5DE73CE622F0        
23:05:29.690 > [ESP32] HMAC Input length: 44 bytes
23:05:29.693 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000004E8DB6325D7AC803EFC33EE9F7CFBDE7C8C84E85E
23:05:29.705 > [ESP32] Nonce: 0x00000004
23:05:29.708 > [ESP32] Packet size before HMAC: 60
23:05:29.710 > [ESP32] Computed HMAC Tag: 8474FFDD416191D01E22CDBB617BE13B
23:05:29.715 > [ESP32] === END HMAC DEBUG ===
23:05:29.718 > 6_Final_Packet (60): 810218001800040800000004E8DB6325 D7AC803EFC33EE9F7CFBDE7C8C84E85E ...
23:05:29.724 > [RETRY] Attempt 1/3 (nonce: 4)
23:05:29.727 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:29.733 > Sending pipeline data to server (560 bytes)
23:05:30.025 > [HTTP] Response code: 400
23:05:30.026 > [HTTP] Error response: {"error":"Decryption failed"}
23:05:30.031 > [HTTP] Request failed with code: 400
23:05:30.033 > [RETRY] Send failed, waiting 100 ms before retry
23:05:30.129 > [RETRY] Attempt 2/3 (nonce: 4)
23:05:30.129 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:30.134 > Sending pipeline data to server (560 bytes)
23:05:30.278 > [HTTP] Response code: 400
23:05:30.278 > [HTTP] Error response: {"error":"Decryption failed"}
23:05:30.283 > [HTTP] Request failed with code: 400
23:05:30.286 > [RETRY] Send failed, waiting 200 ms before retry
23:05:30.482 > [RETRY] Attempt 3/3 (nonce: 4)
23:05:30.482 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:30.487 > Sending pipeline data to server (560 bytes)
23:05:30.800 > [HTTP] Response code: 400
23:05:30.802 > [HTTP] Error response: {"error":"Decryption failed"}
23:05:30.807 > [HTTP] Request failed with code: 400
23:05:30.810 > [RETRY] All retry attempts failed - rolled back nonce to 3
23:05:30.815 > [RETRY] Consecutive failures: 1
23:05:30.818 > Health data send failed (retry count: 1/3)
23:05:30.917 > [599.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:30.925 > Generated health data: HR-69 SPO2-96 STEPS-3017
23:05:30.927 > [RETRY] Attempting to send health data (Max retries: 3)
23:05:30.933 > [RETRY] Using nonce 4 for all retry attempts (saved: 3)
23:05:30.939 > Generated health data: HR-69 SPO2-96 STEPS-3007
23:05:30.942 > [ESP32] MsgKeys: lfsrSeed=0x672D3901 tnk[0..3]=416BD0C6 trn[0..3]=25B95A9A
23:05:30.947 > 1_After_Salt (26): 48522D36392053504F322D3936205354 4550532D333030374D50
23:05:30.955 > 2_After_Padding (32): 48522D36392053504F322D3936205354 4550532D333030374D50000000000000 
23:05:30.963 > [ESP32][LFSR] Initializing - Seed: 0x672D3901 SeedBe: 0x01392D67 ChaosKey[0..3]: 416BD0C6 InitialTap: 0x0029 State: 0x672D3901
23:05:30.975 > [ESP32][LFSR] Input (first 16 bytes): 48522D36392053504F322D3936205354 Buffer size: 32 bytes
23:05:30.980 > 3_After_LFSR (32): 496B0051638F144ECBFFEE4FB51299C1 9270B8EC5608E32D69B97A8D4C855CF2 
23:05:30.989 > [ESP32][LFSR] Keystream (first 16 bytes): 01392D675AAF471E84CDC3768332CA95
23:05:30.996 > [ESP32][TINKERBELL] Input (first 16 bytes): 496B0051638F144ECBFFEE4FB51299C1 Nonce: 0x00000004 Buffer size: 32 bytes
23:05:31.005 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000004 Counter: 0 (must start at 0) Key[0..3]: 416BD0C6
23:05:31.017 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9EC7E80F8D109470B704E6E2D63747BD
23:05:31.024 > 4_After_Tinkerbell (32): D7ACE85EEE9F803E7CFB08AD6325DE7C FC33FD77ADA9736BE8DB21F8C8FA848C
23:05:31.033 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9EC7E80F8D109470B704E6E2D63747BD
23:05:31.038 > 5_After_Transposition (32): E8DB6325D7AC803EFC33EE9F7CFBDE7C 8C84E85EA9AD21F86B7308ADFAC8FD77        
23:05:31.047 > [ESP32] === HMAC DEBUG INFO ===
23:05:31.050 > [ESP32] HMAC Key being used: FFA8C952E061ADC72AB31EDC5145DC26D1F57845074BF87807BF5DE73CE622F0        
23:05:31.058 > [ESP32] HMAC Input length: 44 bytes
23:05:31.061 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000004E8DB6325D7AC803EFC33EE9F7CFBDE7C8C84E85E
23:05:31.072 > [ESP32] Nonce: 0x00000004
23:05:31.075 > [ESP32] Packet size before HMAC: 60
23:05:31.078 > [ESP32] Computed HMAC Tag: 792CFBA015B16D3B6B7BF7640D93D8C1
23:05:31.083 > [ESP32] === END HMAC DEBUG ===
23:05:31.086 > 6_Final_Packet (60): 810218001800040800000004E8DB6325 D7AC803EFC33EE9F7CFBDE7C8C84E85E ...
23:05:31.091 > [RETRY] Attempt 1/3 (nonce: 4)
23:05:31.094 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:31.101 > Sending pipeline data to server (560 bytes)
23:05:31.279 > [HTTP] Response code: 400
23:05:31.279 > [HTTP] Error response: {"error":"Decryption failed"}
23:05:31.284 > [HTTP] Request failed with code: 400
23:05:31.286 > [RETRY] Send failed, waiting 100 ms before retry
23:05:31.383 > [RETRY] Attempt 2/3 (nonce: 4)
23:05:31.383 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:31.389 > Sending pipeline data to server (560 bytes)
23:05:31.531 > [HTTP] Response code: 400
23:05:31.531 > [HTTP] Error response: {"error":"Decryption failed"}
23:05:31.536 > [HTTP] Request failed with code: 400
23:05:31.539 > [RETRY] Send failed, waiting 200 ms before retry
23:05:31.735 > [RETRY] Attempt 3/3 (nonce: 4)
23:05:31.735 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:31.740 > Sending pipeline data to server (560 bytes)
23:05:32.036 > [HTTP] Response code: 400
23:05:32.036 > [HTTP] Error response: {"error":"Decryption failed"}
23:05:32.041 > [HTTP] Request failed with code: 400
23:05:32.045 > [RETRY] All retry attempts failed - rolled back nonce to 3
23:05:32.050 > [RETRY] Consecutive failures: 2
23:05:32.052 > Health data send failed (retry count: 2/3)
23:05:32.151 > [601.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:32.159 > Generated health data: HR-70 SPO2-97 STEPS-3021
23:05:32.162 > [RETRY] Attempting to send health data (Max retries: 3)
23:05:32.168 > [RETRY] Using nonce 4 for all retry attempts (saved: 3)
23:05:32.173 > Generated health data: HR-70 SPO2-97 STEPS-3043
23:05:32.176 > [ESP32] MsgKeys: lfsrSeed=0x672D3901 tnk[0..3]=416BD0C6 trn[0..3]=25B95A9A
23:05:32.181 > 1_After_Salt (26): 48522D37302053504F322D3937205354 4550532D333034334D50
23:05:32.190 > 2_After_Padding (32): 48522D37302053504F322D3937205354 4550532D333034334D50000000000000
23:05:32.198 > [ESP32][LFSR] Initializing - Seed: 0x672D3901 SeedBe: 0x01392D67 ChaosKey[0..3]: 416BD0C6 InitialTap: 0x0029 State: 0x672D3901
23:05:32.209 > [ESP32][LFSR] Input (first 16 bytes): 48522D37302053504F322D3937205354 Buffer size: 32 bytes
23:05:32.215 > 3_After_LFSR (32): 496B00506A8F144ECBFFEE4FB41299C1 9270B8EC5608E72969B97A8D4C855CF2
23:05:32.222 > [ESP32][LFSR] Keystream (first 16 bytes): 01392D675AAF471E84CDC3768332CA95
23:05:32.231 > [ESP32][TINKERBELL] Input (first 16 bytes): 496B00506A8F144ECBFFEE4FB41299C1 Nonce: 0x00000004 Buffer size: 32 bytes
23:05:32.239 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000004 Counter: 0 (must start at 0) Key[0..3]: 416BD0C6
23:05:32.251 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9EC7E80F8D109470B704E6E2D63747BD
23:05:32.259 > 4_After_Tinkerbell (32): D7ACE85FE79F803E7CFB08AD6225DE7C FC33FD77ADA9776FE8DB21F8C8FA848C 
23:05:32.267 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9EC7E80F8D109470B704E6E2D63747BD
23:05:32.273 > 5_After_Transposition (32): E8DB6225D7AC803EFC33E79F7CFBDE7C 8C84E85FA9AD21F86F7708ADFAC8FD77 
23:05:32.281 > [ESP32] === HMAC DEBUG INFO ===
23:05:32.283 > [ESP32] HMAC Key being used: FFA8C952E061ADC72AB31EDC5145DC26D1F57845074BF87807BF5DE73CE622F0
23:05:32.292 > [ESP32] HMAC Input length: 44 bytes
23:05:32.294 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000004E8DB6225D7AC803EFC33E79F7CFBDE7C8C84E85F
23:05:32.306 > [ESP32] Nonce: 0x00000004
23:05:32.309 > [ESP32] Packet size before HMAC: 60
23:05:32.311 > [ESP32] Computed HMAC Tag: 3B056586CCF209FB0873C43C6DD002F1
23:05:32.317 > [ESP32] === END HMAC DEBUG ===
23:05:32.319 > 6_Final_Packet (60): 810218001800040800000004E8DB6225 D7AC803EFC33E79F7CFBDE7C8C84E85F ...
23:05:32.326 > [RETRY] Attempt 1/3 (nonce: 4)
23:05:32.328 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:32.335 > Sending pipeline data to server (560 bytes)
23:05:32.543 > [HTTP] Response code: 400
23:05:32.543 > [HTTP] Error response: {"error":"Decryption failed"}
23:05:32.547 > [HTTP] Request failed with code: 400
23:05:32.550 > [RETRY] Send failed, waiting 100 ms before retry
23:05:32.647 > [RETRY] Attempt 2/3 (nonce: 4)
23:05:32.647 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:32.653 > Sending pipeline data to server (560 bytes)
23:05:32.805 > [HTTP] Response code: 400
23:05:32.805 > [HTTP] Error response: {"error":"Decryption failed"}
23:05:32.811 > [HTTP] Request failed with code: 400
23:05:32.813 > [RETRY] Send failed, waiting 200 ms before retry
23:05:33.009 > [RETRY] Attempt 3/3 (nonce: 4)
23:05:33.009 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:33.015 > Sending pipeline data to server (560 bytes)
23:05:33.296 > [HTTP] Response code: 400
23:05:33.296 > [HTTP] Error response: {"error":"Decryption failed"}
23:05:33.301 > [HTTP] Request failed with code: 400
23:05:33.304 > [RETRY] All retry attempts failed - rolled back nonce to 3
23:05:33.309 > [RETRY] Consecutive failures: 3
23:05:33.312 > Health data send failed (retry count: 3/3)
23:05:33.315 > Health data transmission failed after max retries
23:05:38.426 > [607.4] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:38.431 > ERROR state - attempting recovery
23:05:38.433 > [RETRY] Attempting to send health data (Max retries: 3)
23:05:38.439 > [RETRY] Using nonce 4 for all retry attempts (saved: 3)
23:05:38.444 > Generated health data: HR-70 SPO2-97 STEPS-3059
23:05:38.448 > [ESP32] MsgKeys: lfsrSeed=0x672D3901 tnk[0..3]=416BD0C6 trn[0..3]=25B95A9A
23:05:38.456 > 1_After_Salt (26): 48522D37302053504F322D3937205354 4550532D333035394D50
23:05:38.461 > 2_After_Padding (32): 48522D37302053504F322D3937205354 4550532D333035394D50000000000000
23:05:38.469 > [ESP32][LFSR] Initializing - Seed: 0x672D3901 SeedBe: 0x01392D67 ChaosKey[0..3]: 416BD0C6 InitialTap: 0x0029 State: 0x672D3901
23:05:38.481 > [ESP32][LFSR] Input (first 16 bytes): 48522D37302053504F322D3937205354 Buffer size: 32 bytes
23:05:38.489 > 3_After_LFSR (32): 496B00506A8F144ECBFFEE4FB41299C1 9270B8EC5608E62369B97A8D4C855CF2
23:05:38.495 > [ESP32][LFSR] Keystream (first 16 bytes): 01392D675AAF471E84CDC3768332CA95
23:05:38.503 > [ESP32][TINKERBELL] Input (first 16 bytes): 496B00506A8F144ECBFFEE4FB41299C1 Nonce: 0x00000004 Buffer size: 32 bytes
23:05:38.511 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000004 Counter: 0 (must start at 0) Key[0..3]: 416BD0C6
23:05:38.523 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9EC7E80F8D109470B704E6E2D63747BD
23:05:38.531 > 4_After_Tinkerbell (32): D7ACE85FE79F803E7CFB08AD6225DE7C FC33FD77ADA97665E8DB21F8C8FA848C 
23:05:38.538 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9EC7E80F8D109470B704E6E2D63747BD
23:05:38.548 > 5_After_Transposition (32): E8DB6225D7AC803EFC33E79F7CFBDE7C 8C84E85FA9AD21F8657608ADFAC8FD77        
23:05:38.556 > [ESP32] === HMAC DEBUG INFO ===
23:05:38.559 > [ESP32] HMAC Key being used: FFA8C952E061ADC72AB31EDC5145DC26D1F57845074BF87807BF5DE73CE622F0
23:05:38.566 > [ESP32] HMAC Input length: 44 bytes
23:05:38.570 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000004E8DB6225D7AC803EFC33E79F7CFBDE7C8C84E85F
23:05:38.578 > [ESP32] Nonce: 0x00000004
23:05:38.581 > [ESP32] Packet size before HMAC: 60
23:05:38.584 > [ESP32] Computed HMAC Tag: ACD4E3DFD27E18F8A1343A88CB7F64FE
23:05:38.588 > [ESP32] === END HMAC DEBUG ===
23:05:38.591 > 6_Final_Packet (60): 810218001800040800000004E8DB6225 D7AC803EFC33E79F7CFBDE7C8C84E85F ...
23:05:38.600 > [RETRY] Attempt 1/3 (nonce: 4)
23:05:38.603 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:38.608 > Sending pipeline data to server (560 bytes)
23:05:38.796 > [HTTP] Response code: 400
23:05:38.796 > [HTTP] Error response: {"error":"Decryption failed"}
23:05:38.801 > [HTTP] Request failed with code: 400
23:05:38.804 > [RETRY] Send failed, waiting 100 ms before retry
23:05:38.901 > [RETRY] Attempt 2/3 (nonce: 4)
23:05:38.901 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:38.906 > Sending pipeline data to server (560 bytes)
23:05:39.064 > [HTTP] Response code: 400
23:05:39.064 > [HTTP] Error response: {"error":"Decryption failed"}
23:05:39.069 > [HTTP] Request failed with code: 400
23:05:39.072 > [RETRY] Send failed, waiting 200 ms before retry
23:05:39.267 > [RETRY] Attempt 3/3 (nonce: 4)
23:05:39.267 > POST http://10.45.98.115:8081/health-data with pipeline data
23:05:39.273 > Sending pipeline data to server (560 bytes)
23:05:39.602 > [HTTP] Response code: 400
23:05:39.602 > [HTTP] Error response: {"error":"Decryption failed"}
23:05:39.608 > [HTTP] Request failed with code: 400
23:05:39.609 > [RETRY] All retry attempts failed - rolled back nonce to 3
23:05:39.615 > [RETRY] Consecutive failures: 4
23:05:39.618 > ✗ Auto-recovery failed - restarting key exchange
23:05:41.717 > [WebSocket] Disconnected!
23:05:41.718 > [610.7] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED    
23:05:41.726 > ✓ Public key loaded from NVS
23:05:41.822 > [610.8] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:41.923 > [610.9] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:41.931 > Generating fresh master key from entropy...
23:05:41.938 > Generated master key (32): EE8179C3C4E0FA7EA2A3711A0F2AC958 A10461F48ECF977EC3F89634039DF26B
23:05:41.944 > Using reduced master key (byte % 3) for NTRU encryption only
23:05:41.955 > NTRU encrypted master key (502): 00780006000700710069000200600065 00360007007F001A000F001800090007 ...
23:05:41.963 > POST http://10.45.98.115:8081/master-key
23:05:42.304 > ✓ Master key exchange completed
23:05:42.404 > [611.3] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:42.414 > Loading master key from NVS and deriving symmetric keys...
23:05:42.416 > Loaded master key from NVS (32): EE8179C3C4E0FA7EA2A3711A0F2AC958 A10461F48ECF977EC3F89634039DF26B   
23:05:42.427 > Derived HMAC key (32): 0CA29D7DF326103078377A7D18D557D6 FB31A26014D292AAC4412BCD15A64EAC 
23:05:42.433 > Derived Tinkerbell key (16): 037E793EE4934A8A4FA6CF5B0A7CA3F2
23:05:42.438 > Derived Transposition key (16): CABC716069F758116DBA7D597F2515E9
23:05:42.447 > ✓ Symmetric keys derived successfully
23:05:42.449 > Nonce tracker reset - new session started
23:05:42.945 > Waiting for server to process master key...
23:05:42.948 > ✓ Symmetric keys ready - starting health data transmission
23:05:43.046 > [612.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:05:43.147 > [612.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED

23:06:18.859 > [ESP32] HMAC Key being used: 0E6418F2699399FBB4E7BF57F9061E356CDCF0D525EC42249ED36C94E0DF40AF        
23:06:18.867 > [ESP32] HMAC Input length: 44 bytes
23:06:18.870 > [ESP32] HMAC Input (first 32 bytes): 81021800180004080000000134C8D0DDEFBA7F21ED9B89454E88D98ACEEFB781
23:06:18.881 > [ESP32] Nonce: 0x00000001
23:06:18.883 > [ESP32] Packet size before HMAC: 60
23:06:18.887 > [ESP32] Computed HMAC Tag: F8F0E3A3BDF77915E2BE3A5539174791
23:06:18.892 > [ESP32] === END HMAC DEBUG ===
23:06:18.895 > 6_Final_Packet (60): 81021800180004080000000134C8D0DD EFBA7F21ED9B89454E88D98ACEEFB781 ...
23:06:18.901 > [RETRY] Attempt 1/3 (nonce: 1)
23:06:18.903 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:18.909 > Sending pipeline data to server (560 bytes)
23:06:19.108 > [HTTP] Response code: 400
23:06:19.108 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:19.114 > [HTTP] Request failed with code: 400
23:06:19.116 > [RETRY] Send failed, waiting 100 ms before retry
23:06:19.212 > [RETRY] Attempt 2/3 (nonce: 1)
23:06:19.212 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:19.217 > Sending pipeline data to server (560 bytes)
23:06:19.344 > [HTTP] Response code: 400
23:06:19.345 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:19.349 > [HTTP] Request failed with code: 400
23:06:19.352 > [RETRY] Send failed, waiting 200 ms before retry
23:06:19.549 > [RETRY] Attempt 3/3 (nonce: 1)
23:06:19.549 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:19.555 > Sending pipeline data to server (560 bytes)
23:06:19.850 > [HTTP] Response code: 400
23:06:19.850 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:19.856 > [HTTP] Request failed with code: 400
23:06:19.859 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:06:19.864 > [RETRY] Consecutive failures: 1
23:06:19.866 > Health data send failed (retry count: 3/3)
23:06:19.869 > Health data transmission failed after max retries
23:06:19.966 > [648.9] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:19.972 > ERROR state - attempting recovery
23:06:19.975 > [RETRY] Attempting to send health data (Max retries: 3)
23:06:19.980 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:06:19.986 > Generated health data: HR-74 SPO2-97 STEPS-3277
23:06:19.989 > [ESP32] MsgKeys: lfsrSeed=0x2218F0AF tnk[0..3]=99C198E5 trn[0..3]=C50B904E
23:06:19.996 > 1_After_Salt (26): 48522D37342053504F322D3937205354 4550532D333237374D50
23:06:20.002 > 2_After_Padding (32): 48522D37342053504F322D3937205354 4550532D333237374D50000000000000
23:06:20.011 > [ESP32][LFSR] Initializing - Seed: 0x2218F0AF SeedBe: 0xAFF01822 ChaosKey[0..3]: 99C198E5 InitialTap: 0x0029 State: 0x2218F0AF
23:06:20.022 > [ESP32][LFSR] Input (first 16 bytes): 48522D37342053504F322D3937205354 Buffer size: 32 bytes
23:06:20.030 > 3_After_LFSR (32): E7A235154F9A9623DE6B65447B3C3FF5 C41A51E6D5B59B1DC212B6497FAD0EA2
23:06:20.036 > [ESP32][LFSR] Keystream (first 16 bytes): AFF018227BBAC5739159487D4C1C6CA1
23:06:20.043 > [ESP32][TINKERBELL] Input (first 16 bytes): E7A235154F9A9623DE6B65447B3C3FF5 Nonce: 0x00000001 Buffer size: 32 bytes
23:06:20.052 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 99C198E5
23:06:20.063 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 02D7B1DC9847A2EB1084D2C5F279D26E
23:06:20.071 > 4_After_Tinkerbell (32): E57584C9D7DD34C8CEEFB7818945ED9B D474C6D74E88DB8FE66D752CEFBA7F21 
23:06:20.080 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 02D7B1DC9847A2EB1084D2C5F279D26E
23:06:20.088 > 5_After_Transposition (32): 34C8D7DDEFBA7F21ED9B89454E88DB8F CEEFB781E6756D2CE57584C9D4C674D7        
23:06:20.097 > [ESP32] === HMAC DEBUG INFO ===
23:06:20.100 > [ESP32] HMAC Key being used: 0E6418F2699399FBB4E7BF57F9061E356CDCF0D525EC42249ED36C94E0DF40AF
23:06:20.108 > [ESP32] HMAC Input length: 44 bytes
23:06:20.111 > [ESP32] HMAC Input (first 32 bytes): 81021800180004080000000134C8D7DDEFBA7F21ED9B89454E88DB8FCEEFB781
23:06:20.119 > [ESP32] Nonce: 0x00000001
23:06:20.122 > [ESP32] Packet size before HMAC: 60
23:06:20.124 > [ESP32] Computed HMAC Tag: B5F4E1FCD8CF55D0F26917421F77A107
23:06:20.130 > [ESP32] === END HMAC DEBUG ===
23:06:20.132 > 6_Final_Packet (60): 81021800180004080000000134C8D7DD EFBA7F21ED9B89454E88DB8FCEEFB781 ...
23:06:20.141 > [RETRY] Attempt 1/3 (nonce: 1)
23:06:20.143 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:20.150 > Sending pipeline data to server (560 bytes)
23:06:20.351 > [HTTP] Response code: 400
23:06:20.351 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:20.356 > [HTTP] Request failed with code: 400
23:06:20.359 > [RETRY] Send failed, waiting 100 ms before retry
23:06:20.455 > [RETRY] Attempt 2/3 (nonce: 1)
23:06:20.455 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:20.460 > Sending pipeline data to server (560 bytes)
23:06:20.606 > [HTTP] Response code: 400
23:06:20.606 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:20.612 > [HTTP] Request failed with code: 400
23:06:20.614 > [RETRY] Send failed, waiting 200 ms before retry
23:06:20.809 > [RETRY] Attempt 3/3 (nonce: 1)
23:06:20.810 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:20.815 > Sending pipeline data to server (560 bytes)
23:06:21.118 > [HTTP] Response code: 400
23:06:21.118 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:21.124 > [HTTP] Request failed with code: 400
23:06:21.126 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:06:21.132 > [RETRY] Consecutive failures: 2
23:06:21.135 > ✗ Auto-recovery failed - restarting key exchange
23:06:28.238 > [657.2] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:28.246 > ✓ Public key loaded from NVS
23:06:28.341 > [WebSocket] Disconnected!
23:06:28.341 > [657.3] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED 
23:06:28.443 > [657.4] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:28.451 > Generating fresh master key from entropy...
23:06:28.457 > Generated master key (32): 468B03CCCA997781896BFD933DC4046E C021E3220F96B0AC2A1C89CCCB0F4BC1
23:06:28.514 > Using reduced master key (byte % 3) for NTRU encryption only
23:06:28.522 > NTRU encrypted master key (502): 00780007000600710069000000610065 00380008007E001800100019000A0008 ...
23:06:28.530 > POST http://10.45.98.115:8081/master-key
23:06:28.855 > ✓ Master key exchange completed
23:06:28.957 > [657.9] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:28.965 > Loading master key from NVS and deriving symmetric keys...
23:06:28.967 > Loaded master key from NVS (32): 468B03CCCA997781896BFD933DC4046E C021E3220F96B0AC2A1C89CCCB0F4BC1   
23:06:28.978 > Derived HMAC key (32): 906AC2590B65795870D0EBD4E869E3AD 9C403FA32B16F86C4E489D54F1C5379F 
23:06:28.983 > Derived Tinkerbell key (16): CD8E5A7EAAF416A025088B23940D5653
23:06:28.990 > Derived Transposition key (16): E8E2D65D1F254081EF4D9BC4E8C4C7A8
23:06:28.998 > ✓ Symmetric keys derived successfully
23:06:29.001 > Nonce tracker reset - new session started
23:06:29.498 > Waiting for server to process master key...
23:06:29.500 > ✓ Symmetric keys ready - starting health data transmission
23:06:29.598 > [658.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:29.698 > [658.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:29.798 > [658.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:29.898 > [658.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:29.998 > [658.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:30.098 > [659.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:30.198 > [659.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:30.299 > [659.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:30.398 > [659.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:30.498 > [659.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:30.598 > [659.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:30.698 > [659.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:30.798 > [659.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:30.898 > [659.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:30.998 > [659.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:31.098 > [660.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:31.198 > [660.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:31.298 > [660.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:31.398 > [660.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:31.498 > [660.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:31.599 > [660.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:31.698 > [660.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:31.798 > [660.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:31.898 > [660.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:31.998 > [660.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:32.098 > [661.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:32.198 > [661.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:32.298 > [661.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:32.398 > [661.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:32.498 > [661.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:32.598 > [661.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:32.697 > [661.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:32.798 > [661.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:32.898 > [661.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:32.998 > [661.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:33.098 > [662.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:33.198 > [662.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:33.298 > [662.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:38.405 > [667.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:38.504 > [WebSocket] Disconnected!
23:06:38.504 > [667.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED    
23:06:38.605 > [667.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:38.705 > [667.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:38.805 > [667.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:38.905 > [667.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:39.004 > [667.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:39.106 > [668.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:39.205 > [668.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:39.305 > [668.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:39.406 > [668.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:39.505 > [668.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:39.513 > Generated health data: HR-71 SPO2-97 STEPS-3368
23:06:39.516 > [RETRY] Attempting to send health data (Max retries: 3)
23:06:39.522 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:06:39.527 > Generated health data: HR-71 SPO2-97 STEPS-3377
23:06:39.530 > [ESP32] MsgKeys: lfsrSeed=0xADF2270F tnk[0..3]=20C26C3E trn[0..3]=60CC1447
23:06:39.536 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333337374D50
23:06:39.544 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333337374D50000000000000
23:06:39.552 > [ESP32][LFSR] Initializing - Seed: 0xADF2270F SeedBe: 0x0F27F2AD ChaosKey[0..3]: 20C26C3E InitialTap: 0x0029 State: 0xADF2270F
23:06:39.564 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes
23:06:39.569 > 3_After_LFSR (32): 4775DF9A892A0FF4411162AF1FB467F7 7FF77B95DBE9C48E7E29C3D9EEBEF225
23:06:39.578 > [ESP32][LFSR] Keystream (first 16 bytes): 0F27F2ADB80A5CA40E234F96289434A3
23:06:39.586 > [ESP32][TINKERBELL] Input (first 16 bytes): 4775DF9A892A0FF4411162AF1FB467F7 Nonce: 0x00000001 Buffer size: 32 bytes
23:06:39.594 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 20C26C3E
23:06:39.605 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9C59B63F607F8BCBCB93C989442DAE73
23:06:39.614 > 4_After_Tinkerbell (32): DB2C69A5E955843F8A82AB265B99C984 3C68BE1F08316ABC2B4DEF29C598BDCA
23:06:39.621 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9C59B63F607F8BCBCB93C989442DAE73
23:06:39.627 > 5_After_Transposition (32): 824D5BC984312B3FBEEFAB98E98A692C 3C6A99BC08A526C55529BDCADB841F68 
23:06:39.636 > [ESP32] === HMAC DEBUG INFO ===
23:06:39.638 > [ESP32] HMAC Key being used: 906AC2590B65795870D0EBD4E869E3AD9C403FA32B16F86C4E489D54F1C5379F
23:06:39.646 > [ESP32] HMAC Input length: 44 bytes
23:06:39.649 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001824D5BC984312B3FBEEFAB98E98A692C3C6A99BC
23:06:39.661 > [ESP32] Nonce: 0x00000001
23:06:39.663 > [ESP32] Packet size before HMAC: 60
23:06:39.666 > [ESP32] Computed HMAC Tag: 6D24A3C22561EC9AFE9A7355ECC93650
23:06:39.672 > [ESP32] === END HMAC DEBUG ===
23:06:39.675 > 6_Final_Packet (60): 810218001800040800000001824D5BC9 84312B3FBEEFAB98E98A692C3C6A99BC ...
23:06:39.680 > [RETRY] Attempt 1/3 (nonce: 1)
23:06:39.683 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:39.689 > Sending pipeline data to server (560 bytes)
23:06:39.865 > [HTTP] Response code: 400
23:06:39.865 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:39.871 > [HTTP] Request failed with code: 400
23:06:39.873 > [RETRY] Send failed, waiting 100 ms before retry
23:06:39.969 > [RETRY] Attempt 2/3 (nonce: 1)
23:06:39.970 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:39.975 > Sending pipeline data to server (560 bytes)
23:06:40.137 > [HTTP] Response code: 400
23:06:40.137 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:40.142 > [HTTP] Request failed with code: 400
23:06:40.146 > [RETRY] Send failed, waiting 200 ms before retry
23:06:40.342 > [RETRY] Attempt 3/3 (nonce: 1)
23:06:40.342 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:40.348 > Sending pipeline data to server (560 bytes)
23:06:40.616 > [HTTP] Response code: 400
23:06:40.616 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:40.621 > [HTTP] Request failed with code: 400
23:06:40.624 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:06:40.630 > [RETRY] Consecutive failures: 3
23:06:40.632 > Health data send failed (retry count: 1/3)
23:06:40.731 > [669.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:40.740 > Generated health data: HR-71 SPO2-97 STEPS-3370
23:06:40.743 > [RETRY] Attempting to send health data (Max retries: 3)
23:06:40.748 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:06:40.754 > Generated health data: HR-71 SPO2-97 STEPS-3352
23:06:40.756 > [ESP32] MsgKeys: lfsrSeed=0xADF2270F tnk[0..3]=20C26C3E trn[0..3]=60CC1447
23:06:40.762 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333335324D50
23:06:40.770 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333335324D50000000000000
23:06:40.779 > [ESP32][LFSR] Initializing - Seed: 0xADF2270F SeedBe: 0x0F27F2AD ChaosKey[0..3]: 20C26C3E InitialTap: 0x0029 State: 0xADF2270F
23:06:40.790 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes
23:06:40.795 > 3_After_LFSR (32): 4775DF9A892A0FF4411162AF1FB467F7 7FF77B95DBE9C68B7E29C3D9EEBEF225 
23:06:40.804 > [ESP32][LFSR] Keystream (first 16 bytes): 0F27F2ADB80A5CA40E234F96289434A3
23:06:40.812 > [ESP32][TINKERBELL] Input (first 16 bytes): 4775DF9A892A0FF4411162AF1FB467F7 Nonce: 0x00000001 Buffer size: 32 bytes
23:06:40.821 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 20C26C3E
23:06:40.832 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9C59B63F607F8BCBCB93C989442DAE73
23:06:40.840 > 4_After_Tinkerbell (32): DB2C69A5E955843F8A82AB265B99C984 3C68BE1F083168B92B4DEF29C598BDCA 
23:06:40.848 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9C59B63F607F8BCBCB93C989442DAE73
23:06:40.854 > 5_After_Transposition (32): 824D5BC984312B3FBEEFAB98E98A692C 3C6899B908A526C55529BDCADB841F68 
23:06:40.862 > [ESP32] === HMAC DEBUG INFO ===
23:06:40.864 > [ESP32] HMAC Key being used: 906AC2590B65795870D0EBD4E869E3AD9C403FA32B16F86C4E489D54F1C5379F        
23:06:40.873 > [ESP32] HMAC Input length: 44 bytes
23:06:40.876 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001824D5BC984312B3FBEEFAB98E98A692C3C6899B9
23:06:40.887 > [ESP32] Nonce: 0x00000001
23:06:40.890 > [ESP32] Packet size before HMAC: 60
23:06:40.892 > [ESP32] Computed HMAC Tag: FFB15934FC7825803F22D4A9255AA48C
23:06:40.898 > [ESP32] === END HMAC DEBUG ===
23:06:40.900 > 6_Final_Packet (60): 810218001800040800000001824D5BC9 84312B3FBEEFAB98E98A692C3C6899B9 ...
23:06:40.907 > [RETRY] Attempt 1/3 (nonce: 1)
23:06:40.909 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:40.915 > Sending pipeline data to server (560 bytes)
23:06:41.159 > [HTTP] Response code: 400
23:06:41.159 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:41.164 > [HTTP] Request failed with code: 400
23:06:41.167 > [RETRY] Send failed, waiting 100 ms before retry
23:06:41.263 > [RETRY] Attempt 2/3 (nonce: 1)
23:06:41.264 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:41.269 > Sending pipeline data to server (560 bytes)
23:06:41.614 > [HTTP] Response code: 400
23:06:41.614 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:41.620 > [HTTP] Request failed with code: 400
23:06:41.623 > [RETRY] Send failed, waiting 200 ms before retry
23:06:41.818 > [RETRY] Attempt 3/3 (nonce: 1)
23:06:41.818 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:41.823 > Sending pipeline data to server (560 bytes)
23:06:42.147 > [HTTP] Response code: 400
23:06:42.147 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:42.152 > [HTTP] Request failed with code: 400
23:06:42.155 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:06:42.161 > [RETRY] Consecutive failures: 4
23:06:42.163 > Health data send failed (retry count: 2/3)
23:06:42.261 > [671.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:42.269 > Generated health data: HR-71 SPO2-97 STEPS-3359
23:06:42.272 > [RETRY] Attempting to send health data (Max retries: 3)
23:06:42.277 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:06:42.283 > Generated health data: HR-74 SPO2-97 STEPS-3386
23:06:42.286 > [ESP32] MsgKeys: lfsrSeed=0xADF2270F tnk[0..3]=20C26C3E trn[0..3]=60CC1447
23:06:42.291 > 1_After_Salt (26): 48522D37342053504F322D3937205354 4550532D333338364D50
23:06:42.300 > 2_After_Padding (32): 48522D37342053504F322D3937205354 4550532D333338364D50000000000000
23:06:42.308 > [ESP32][LFSR] Initializing - Seed: 0xADF2270F SeedBe: 0x0F27F2AD ChaosKey[0..3]: 20C26C3E InitialTap: 0x0029 State: 0xADF2270F
23:06:42.318 > [ESP32][LFSR] Input (first 16 bytes): 48522D37342053504F322D3937205354 Buffer size: 32 bytes
23:06:42.324 > 3_After_LFSR (32): 4775DF9A8C2A0FF4411162AF1FB467F7 7FF77B95DBE9CB8F7E29C3D9EEBEF225
23:06:42.333 > [ESP32][LFSR] Keystream (first 16 bytes): 0F27F2ADB80A5CA40E234F96289434A3
23:06:42.341 > [ESP32][TINKERBELL] Input (first 16 bytes): 4775DF9A8C2A0FF4411162AF1FB467F7 Nonce: 0x00000001 Buffer size: 32 bytes
23:06:42.349 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 20C26C3E
23:06:42.361 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9C59B63F607F8BCBCB93C989442DAE73
23:06:42.369 > 4_After_Tinkerbell (32): DB2C69A5EC55843F8A82AB265B99C984 3C68BE1F083165BD2B4DEF29C598BDCA
23:06:42.377 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9C59B63F607F8BCBCB93C989442DAE73
23:06:42.382 > 5_After_Transposition (32): 824D5BC984312B3FBEEFAB98EC8A692C 3C6599BD08A526C55529BDCADB841F68 
23:06:42.391 > [ESP32] === HMAC DEBUG INFO ===
23:06:42.393 > [ESP32] HMAC Key being used: 906AC2590B65795870D0EBD4E869E3AD9C403FA32B16F86C4E489D54F1C5379F
23:06:42.402 > [ESP32] HMAC Input length: 44 bytes
23:06:42.404 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001824D5BC984312B3FBEEFAB98EC8A692C3C6599BD
23:06:42.416 > [ESP32] Nonce: 0x00000001
23:06:42.419 > [ESP32] Packet size before HMAC: 60
23:06:42.421 > [ESP32] Computed HMAC Tag: DB9B7AFE924E3A9E71B53C31BAD16BCC
23:06:42.427 > [ESP32] === END HMAC DEBUG ===
23:06:42.430 > 6_Final_Packet (60): 810218001800040800000001824D5BC9 84312B3FBEEFAB98EC8A692C3C6599BD ...
23:06:42.435 > [RETRY] Attempt 1/3 (nonce: 1)
23:06:42.438 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:42.444 > Sending pipeline data to server (560 bytes)
23:06:42.623 > [HTTP] Response code: 400
23:06:42.623 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:42.628 > [HTTP] Request failed with code: 400
23:06:42.631 > [RETRY] Send failed, waiting 100 ms before retry
23:06:42.727 > [RETRY] Attempt 2/3 (nonce: 1)
23:06:42.727 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:42.735 > Sending pipeline data to server (560 bytes)
23:06:42.875 > [HTTP] Response code: 400
23:06:42.875 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:42.881 > [HTTP] Request failed with code: 400
23:06:42.883 > [RETRY] Send failed, waiting 200 ms before retry
23:06:43.079 > [RETRY] Attempt 3/3 (nonce: 1)
23:06:43.079 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:43.085 > Sending pipeline data to server (560 bytes)
23:06:43.378 > [HTTP] Response code: 400
23:06:43.378 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:43.383 > [HTTP] Request failed with code: 400
23:06:43.387 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:06:43.392 > [RETRY] Consecutive failures: 5
23:06:43.395 > [EMERGENCY] Triggering emergency reset!
23:06:43.397 > [CRYPTO] Resetting cryptographic state
23:06:43.403 > [CRYPTO] Crypto state reset complete
23:06:43.406 > [CRYPTO] Packet counter: 13
23:06:43.409 > [EMERGENCY] Emergency reset complete
23:06:43.411 > Health data send failed (retry count: 3/3)
23:06:43.414 > Health data transmission failed after max retries
23:06:48.520 > [677.5] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:48.525 > ERROR state - attempting recovery
23:06:48.528 > [RETRY] Attempting to send health data (Max retries: 3)
23:06:48.534 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:06:48.539 > Generated health data: HR-71 SPO2-97 STEPS-3424
23:06:48.541 > [ESP32] MsgKeys: lfsrSeed=0xADF2270F tnk[0..3]=20C26C3E trn[0..3]=60CC1447
23:06:48.550 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333432344D50
23:06:48.556 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333432344D50000000000000 
23:06:48.564 > [ESP32][LFSR] Initializing - Seed: 0xADF2270F SeedBe: 0x0F27F2AD ChaosKey[0..3]: 20C26C3E InitialTap: 0x0029 State: 0xADF2270F
23:06:48.575 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes
23:06:48.584 > 3_After_LFSR (32): 4775DF9A892A0FF4411162AF1FB467F7 7FF77B95DBEEC18D7E29C3D9EEBEF225 
23:06:48.589 > [ESP32][LFSR] Keystream (first 16 bytes): 0F27F2ADB80A5CA40E234F96289434A3
23:06:48.597 > [ESP32][TINKERBELL] Input (first 16 bytes): 4775DF9A892A0FF4411162AF1FB467F7 Nonce: 0x00000001 Buffer size: 32 bytes
23:06:48.606 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 20C26C3E
23:06:48.617 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9C59B63F607F8BCBCB93C989442DAE73
23:06:48.625 > 4_After_Tinkerbell (32): DB2C69A5E955843F8A82AB265B99C984 3C68BE1F08366FBF2B4DEF29C598BDCA
23:06:48.633 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9C59B63F607F8BCBCB93C989442DAE73
23:06:48.642 > 5_After_Transposition (32): 824D5BC984362B3FBEEFAB98E98A692C 3C6F99BF08A526C55529BDCADB841F68 
23:06:48.650 > [ESP32] === HMAC DEBUG INFO ===
23:06:48.652 > [ESP32] HMAC Key being used: 906AC2590B65795870D0EBD4E869E3AD9C403FA32B16F86C4E489D54F1C5379F        
23:06:48.661 > [ESP32] HMAC Input length: 44 bytes
23:06:48.664 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000001824D5BC984362B3FBEEFAB98E98A692C3C6F99BF
23:06:48.673 > [ESP32] Nonce: 0x00000001
23:06:48.675 > [ESP32] Packet size before HMAC: 60
23:06:48.678 > [ESP32] Computed HMAC Tag: 205219E6FB6ABF5D6369A4D6616124EA
23:06:48.683 > [ESP32] === END HMAC DEBUG ===
23:06:48.687 > 6_Final_Packet (60): 810218001800040800000001824D5BC9 84362B3FBEEFAB98E98A692C3C6F99BF ...
23:06:48.694 > [RETRY] Attempt 1/3 (nonce: 1)
23:06:48.697 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:48.702 > Sending pipeline data to server (560 bytes)
23:06:49.126 > [HTTP] Response code: 400
23:06:49.126 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:49.131 > [HTTP] Request failed with code: 400
23:06:49.135 > [RETRY] Send failed, waiting 100 ms before retry
23:06:49.231 > [RETRY] Attempt 2/3 (nonce: 1)
23:06:49.231 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:49.237 > Sending pipeline data to server (560 bytes)
23:06:49.380 > [HTTP] Response code: 400
23:06:49.380 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:49.385 > [HTTP] Request failed with code: 400
23:06:49.388 > [RETRY] Send failed, waiting 200 ms before retry
23:06:49.584 > [RETRY] Attempt 3/3 (nonce: 1)
23:06:49.584 > POST http://10.45.98.115:8081/health-data with pipeline data
23:06:49.590 > Sending pipeline data to server (560 bytes)
23:06:49.887 > [HTTP] Response code: 400
23:06:49.887 > [HTTP] Error response: {"error":"Decryption failed"}
23:06:49.892 > [HTTP] Request failed with code: 400
23:06:49.894 > [RETRY] All retry attempts failed - rolled back nonce to 0
23:06:49.900 > [RETRY] Consecutive failures: 1
23:06:49.903 > ✗ Auto-recovery failed - restarting key exchange
23:06:52.000 > [WebSocket] Disconnected!
23:06:52.000 > [680.9] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED    
23:06:52.008 > ✓ Public key loaded from NVS
23:06:52.105 > [681.0] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:52.206 > [681.1] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:52.214 > Generating fresh master key from entropy...
23:06:52.220 > Generated master key (32): B4F14AC05465F1AC9B614C61C4DF070C F7C13722B05F67114E9FB7A14DFD3B41 
23:06:52.227 > Using reduced master key (byte % 3) for NTRU encryption only
23:06:52.237 > NTRU encrypted master key (502): 00770007000800710068000200600066 00380007007E001900100019000A0006 ...
23:06:52.246 > POST http://10.45.98.115:8081/master-key
23:06:52.390 > ✓ Master key exchange completed
23:06:52.492 > [681.4] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:52.500 > Loading master key from NVS and deriving symmetric keys...
23:06:52.502 > Loaded master key from NVS (32): B4F14AC05465F1AC9B614C61C4DF070C F7C13722B05F67114E9FB7A14DFD3B41   
23:06:52.514 > Derived HMAC key (32): ACD708B197FD356FABBEA23163589349 E3FED90EACCE55C10FC43BF3877B32B7 
23:06:52.519 > Derived Tinkerbell key (16): 2D47758CA17A5FD96F9ED659B5AC68B7
23:06:52.524 > Derived Transposition key (16): 85186711FFD49E42153320807DE2CB66 
23:06:52.533 > ✓ Symmetric keys derived successfully
23:06:52.536 > Nonce tracker reset - new session started
23:06:53.033 > Waiting for server to process master key...
23:06:53.036 > ✓ Symmetric keys ready - starting health data transmission
23:06:53.133 > [682.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:53.234 > [682.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:53.334 > [682.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:53.434 > [682.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:53.534 > [682.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:53.634 > [682.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:53.734 > [682.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:53.834 > [682.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:53.933 > [682.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:54.034 > [683.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:54.133 > [683.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:54.234 > [683.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:54.333 > [683.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:54.434 > [683.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:54.534 > [683.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:54.634 > [683.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:54.734 > [683.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:54.834 > [683.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:54.934 > [683.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:55.034 > [684.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:55.133 > [684.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:55.234 > [684.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:55.333 > [684.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:55.433 > [684.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:55.533 > [684.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:55.633 > [684.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:55.733 > [684.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:55.833 > [684.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:55.933 > [684.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:56.034 > [685.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:56.133 > [685.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:56.234 > [685.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:56.333 > [685.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:56.433 > [685.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:56.533 > [685.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:56.634 > [685.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:56.733 > [685.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:56.833 > [685.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:06:56.933 > [685.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:07:02.040 > [691.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:07:02.139 > [WebSocket] Disconnected!
23:07:02.140 > [691.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED    
23:07:02.240 > [691.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:07:02.341 > [691.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:07:02.441 > [691.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:07:02.541 > [691.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:07:02.641 > [691.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:07:02.741 > [691.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:07:02.840 > [691.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:07:02.941 > [691.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:07:03.041 > [692.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: DISCONNECTED
23:07:03.049 > Generated health data: HR-71 SPO2-97 STEPS-3504
23:07:03.050 > [RETRY] Attempting to send health data (Max retries: 3)
23:07:03.057 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
23:07:03.063 > Generated health data: HR-71 SPO2-97 STEPS-3509
23:07:03.066 > [ESP32] MsgKeys: lfsrSeed=0x30B83DC9 tnk[0..3]=0188A7C1 trn[0..3]=8FD7A399
23:07:03.071 > 1_After_Salt (26): 48522D37312053504F322D3937205354 4550532D333530394D50
23:07:03.079 > 2_After_Padding (32): 48522D37312053504F322D3937205354 4550532D333530394D50000000000000 
23:07:03.088 > [ESP32][LFSR] Initializing - Seed: 0x30B83DC9 SeedBe: 0xC93DB830 ChaosKey[0..3]: 0188A7C1 InitialTap: 0x0029 State: 0x30B83DC9
23:07:03.099 > [ESP32][LFSR] Input (first 16 bytes): 48522D37312053504F322D3937205354 Buffer size: 32 bytes
23:07:03.105 > 3_After_LFSR (32): 816F95078057354161419EA8155FA157 DD67BE33C2EA15DC623D68A44AEDCFB1
23:07:03.113 > [ESP32][LFSR] Keystream (first 16 bytes): C93DB830B17766112E73B391227FF203
23:07:03.121 > [ESP32][TINKERBELL] Input (first 16 bytes): 816F95078057354161419EA8155FA157 Nonce: 0x00000001 Buffer size: 32 bytes
23:07:03.129 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 0188A7C1
23:07:03.141 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): D01C55C81B62322A5BDDE9DE3F18AA84
23:07:03.148 > 4_After_Tinkerbell (32): 5173C0CF9B35076B3A9C77762A470BD3 5038B08927431BD41288EA4118CD36FE
23:07:03.157 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): D01C55C81B62322A5BDDE9DE3F18AA84
23:07:03.163 > 5_After_Transposition (32): 5173C0CF1836FECD3A9C7776271BD443 5038B0892A0BD3471288EA419B076B35        
23:07:03.171 > [ESP32] === HMAC DEBUG INFO ===
23:07:03.174 > [ESP32] HMAC Key being used: ACD708B197FD356FABBEA23163589349E3FED90EACCE55C10FC43BF3877B32B7
23:07:03.182 > [ESP32] HMAC Input length: 44 bytes
23:07:03.185 > [ESP32] HMAC Input (first 32 bytes): 8102180018000408000000015173C0CF1836FECD3A9C7776271BD4435038B089
23:07:03.196 > [ESP32] Nonce: 0x00000001
23:07:03.198 > [ESP32] Packet size before HMAC: 60
23:07:03.202 > [ESP32] Computed HMAC Tag: 239928BA84279C9C741394025470F793
23:07:03.207 > [ESP32] === END HMAC DEBUG ===
23:07:03.209 > 6_Final_Packet (60): 8102180018000408000000015173C0CF 1836FECD3A9C7776271BD4435038B089 ...
23:07:03.215 > [RETRY] Attempt 1/3 (nonce: 1)
23:07:03.218 > POST http://10.45.98.115:8081/health-data with pipeline data
23:07:03.224 > Sending pipeline data to server (560 bytes)
23:07:03.407 > [HTTP] Response code: 200
23:07:03.407 > [HTTP] Response: {"status":"OK:DECRYPTED"}
23:07:03.412 > [RETRY] Health data sent successfully!
23:07:03.415 > ✓ Health data #14 sent successfully
23:07:03.512 > [692.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: DISCONNECTED
23:07:03.613 > [692.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: DISCONNECTED
23:07:03.713 > [692.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: DISCONNECTED
23:07:03.813 > [692.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: DISCONNECTED
23:07:03.912 > [692.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: DISCONNECTED