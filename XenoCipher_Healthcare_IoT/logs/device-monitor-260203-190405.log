19:04:05.171 > ets Jul 29 2019 12:21:46
19:04:05.171 > 
19:04:05.171 > rst:0x1 (POWERON_RESET),boot:0x13 (SPI_FAST_FLASH_BOOT)
19:04:05.177 > configsip: 0, SPIWP:0xee
19:04:05.179 > clk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00
19:04:05.185 > mode:DIO, clock div:2
19:04:05.189 > load:0x3fff0030,len:1184
19:04:05.190 > load:0x40078000,len:13232
19:04:05.194 > load:0x40080400,len:3028
19:04:05.194 > entry 0x400805e4
19:04:06.629 > === XenoCipher ESP32 Booting ===
19:04:06.632 > Free heap: 293120 bytes
19:04:06.632 > Nonce counter reset for new session
19:04:06.635 > [RECIPE] Recipe map version: 1
19:04:06.638 > [RECIPE] Mapping: 1=FULL_STACK 2=CHACHA_HEAVY 3=SALSA_LIGHT 4=CHAOS_ONLY 5=STREAM_FOCUS
19:04:06.646 > [1.0] STATE: INIT_NVS | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:06.655 > ✓ NVS initialized
19:04:06.752 > [1.2] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:06.759 > Connecting to motorola edge 40_6753
19:04:06.962 > [WiFi] STA Start
19:04:07.074 > [1.5] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:07.174 > [1.6] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:07.274 > [1.7] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:07.374 > [1.8] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:07.474 > [1.9] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:07.574 > [2.0] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:07.674 > [2.1] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:07.774 > [2.2] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:07.874 > [2.3] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:07.974 > [2.4] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:08.074 > [2.5] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:08.174 > [2.6] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:08.274 > [2.7] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:08.374 > [2.8] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:08.440 > [WiFi] Connected to AP
19:04:08.474 > [2.9] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:08.501 > [WiFi] Got IP: 10.249.92.171
19:04:08.502 > [WebSocket] Initialized - Server: 10.249.92.115:8081/api/ws
19:04:08.574 > [3.0] STATE: CONNECT_WIFI | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:08.580 > ✓ WiFi connected! IP: 10.249.92.171
19:04:08.675 > [3.1] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:08.684 > ✓ Public key loaded from NVS
19:04:08.779 > [3.2] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:08.880 > [3.3] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:08.889 > Generating fresh master key from entropy...
19:04:08.895 > Generated master key (32): 5F0A2EAF9B55CA7E725439F12C43DD90 2517487A99D0E85237CDD3D0B32E2C5E 
19:04:08.901 > Using reduced master key (byte % 3) for NTRU encryption only
19:04:08.911 > NTRU encrypted master key (502): 0023006F001F0016007F001C00070062 004400770039000D00020075006A006E ...
19:04:08.919 > POST http://10.249.92.115:8081/master-key
19:04:13.934 > Retry 1/3 for master key
19:04:17.084 > [11.5] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:17.092 > Generating fresh master key from entropy...
19:04:17.099 > Generated master key (32): 797FAD7D154AB3C417845010150FB701 D6E9DE965D45DF8A96A538FDAA9FF206 
19:04:17.105 > Using reduced master key (byte % 3) for NTRU encryption only
19:04:17.114 > NTRU encrypted master key (502): 0022006F00200017007D001D00080063 00460077003B000D000000740068006F ...
19:04:17.123 > POST http://10.249.92.115:8081/master-key
19:04:17.311 > ✓ Master key exchange completed
19:04:17.413 > [11.8] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:04:17.422 > Loading master key from NVS and deriving symmetric keys...
19:04:17.424 > Loaded master key from NVS (32): 797FAD7D154AB3C417845010150FB701 D6E9DE965D45DF8A96A538FDAA9FF206 
19:04:17.436 > Derived HMAC key (32): 8065854780689E955FB1F2E9139C7668 26C4C70DD386F1F6B5F350A483F10D10 
19:04:17.441 > Derived Tinkerbell key (16): 733A9074C4DB955DD01F14FED2F201CF 
19:04:17.447 > Derived Transposition key (16): FE9BF90EE064FD976CFF2374327C31D1 
19:04:17.455 > ✓ Symmetric keys derived successfully
19:04:17.458 > Nonce tracker reset - new session started
19:04:17.960 > Waiting for server to process master key...
19:04:17.963 > ✓ Symmetric keys ready - starting health data transmission
19:04:18.062 > [12.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:04:18.162 > [12.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:04:18.263 > [12.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:04:18.364 > [WebSocket] ========================================[WebSocket] CONNECTED to: /api/ws
19:04:18.370 > [WebSocket] WebSocket connection established[WebSocket] Ready to receive ZTM activation requests[WebSocket] ========================================[WebSocket] Sent hello message (hello_from_esp32)
19:04:18.386 > [12.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:18.492 > [WebSocket] Received (151 bytes): {"message":"Connected to XenoCipher Server","serverTime":1770125657082,"sessionId":"1770125657082-41","totalClients":1,"type":"connection_established"}
19:04:18.507 > [WebSocket] Processing message type: connection_established
19:04:18.512 > [WebSocket] Connection established - Session: 1770125657082-41
19:04:18.517 > [12.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:18.625 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125657254,"type":"master_key_received"}
19:04:18.639 > [WebSocket] Processing message type: master_key_received
19:04:18.642 > [13.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:18.747 > [WebSocket] Received (112 bytes): {"message":"ESP32 connection acknowledged","serverTime":1770125658381,"status":"ready","type":"esp32_connected"}
19:04:18.759 > [WebSocket] Processing message type: esp32_connected
19:04:18.764 > [13.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:18.870 > [13.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:18.971 > [13.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:19.072 > [13.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:19.173 > [13.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:19.274 > [13.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:19.375 > [13.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:19.476 > [13.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:19.577 > [14.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:19.678 > [14.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:19.779 > [14.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:19.880 > [14.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:19.981 > [14.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:20.082 > [14.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:20.183 > [14.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:20.284 > [14.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:20.385 > [14.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:20.486 > [14.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:20.586 > [15.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:20.688 > [15.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:20.789 > [15.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:20.890 > [15.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:20.991 > [15.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:21.092 > [15.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:21.192 > [15.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:21.294 > [15.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:21.395 > [15.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:21.496 > [15.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:21.597 > [16.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:21.698 > [16.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:21.799 > [16.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:21.900 > [16.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:22.001 > [16.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:22.102 > [16.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:22.203 > [16.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:22.304 > [16.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:22.405 > [16.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:22.506 > [16.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:22.607 > [17.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:22.708 > [17.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:22.808 > [17.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:22.909 > [17.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:23.011 > [17.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:23.112 > [17.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:23.213 > [17.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:23.314 > [17.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:23.415 > [17.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:23.517 > [17.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:23.617 > [18.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:23.718 > [18.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:23.819 > [18.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:23.920 > [18.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:24.021 > [18.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:24.122 > [18.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:24.223 > [18.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:24.324 > [18.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:24.425 > [18.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:24.525 > [18.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:24.627 > [19.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:24.727 > [19.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:24.829 > [19.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:24.930 > [19.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:25.031 > [19.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:25.132 > [19.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:25.233 > [19.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:25.334 > [19.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:25.435 > [19.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:25.536 > [19.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:25.636 > [20.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:25.738 > [20.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:25.839 > [20.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:25.940 > [20.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:26.041 > [20.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:26.142 > [20.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:26.243 > [20.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:26.344 > [20.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:26.445 > [20.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:26.546 > [20.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:26.647 > [21.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:26.748 > [21.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:26.849 > [21.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:26.950 > [21.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:27.051 > [21.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:27.152 > [21.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:27.253 > [21.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:27.354 > [21.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:27.454 > [21.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:27.556 > [22.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:27.657 > [22.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:27.758 > [22.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:27.858 > [22.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:27.960 > [22.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:04:27.965 > [RETRY] Attempting to send health data (Max retries: 3)
19:04:27.971 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:04:27.976 > Generated health data: HR-60 SPO2-95 STEPS-117
19:04:27.980 > [ESP32] ========================================
19:04:27.985 > [ESP32] ENCRYPTION PIPELINE START
19:04:27.988 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:04:27.997 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:04:28.002 > [ESP32] ========================================
19:04:28.005 > [ESP32] MsgKeys: lfsrSeed=0x190C314E tnk[0..3]=C0E44DA9 trn[0..3]=B7A9F210
19:04:28.013 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3131374D50
19:04:28.019 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3131374D5000000000000000 
19:04:28.027 > [ESP32][LFSR] Initializing - Seed: 0x190C314E SeedBe: 0x4E310C19 ChaosKey[0..3]: C0E44DA9 InitialTap: 0x0029 State: 0x190C314E
19:04:28.038 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:04:28.050 > 3_After_LFSR (32): 0663212FA981347DE603ED8EB36EDADF 4359B2181DC54A57216431A60CCBE07A 
19:04:28.053 > [ESP32][LFSR] Keystream (first 16 bytes): 4E310C1999A1672DA931C0B7864E898B
19:04:28.060 > [ESP32][4D] LFSR keystream (first 32 bytes): 4E310C1999A1672DA931C0B7864E898B0609E1352CF47D1A716431A60CCBE07A
19:04:28.071 > [ESP32][TINKERBELL] Input (first 16 bytes): 0663212FA981347DE603ED8EB36EDADF Nonce: 0x00000001 Buffer size: 32 bytes
19:04:28.080 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: C0E44DA9
19:04:28.091 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 49805F117D4648C052A32DBF060A57C4
19:04:28.097 > 4_After_Tinkerbell (32): 4FE37E3ED4C77CBDB4A0C031B5648D1B 1FE38806B274654F459FCA6184594065 
19:04:28.106 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 49805F117D4648C052A32DBF060A57C4
19:04:28.113 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 49805F117D4648C052A32DBF060A57C45CBA3A1EAFB12F1864FBFBC78892A01F
19:04:28.124 > 5_After_Transposition (32): 9F457E3ED4C77CBDE31FC031B5648D1B E34FCA61B274654FA0B4880684594065 
19:04:28.133 > [ESP32] === HMAC DEBUG INFO ===
19:04:28.135 > [ESP32] HMAC Key being used: 8065854780689E955FB1F2E9139C766826C4C70DD386F1F6B5F350A483F10D10
19:04:28.144 > [ESP32] HMAC Input length: 44 bytes
19:04:28.147 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000019F457E3ED4C77CBDE31FC031B5648D1BE34FCA61
19:04:28.155 > [ESP32] Nonce: 0x00000001
19:04:28.158 > [ESP32] Packet size before HMAC: 60
19:04:28.160 > [ESP32] Computed HMAC Tag: 053BD5D02DB702D0B2E6E177EF7B58F7
19:04:28.166 > [ESP32] === END HMAC DEBUG ===
19:04:28.169 > 6_Final_Packet (60): 8102170017000408000000019F457E3E D4C77CBDE31FC031B5648D1BE34FCA61 ...
19:04:28.177 > [RETRY] Attempt 1/3 (nonce: 1)
19:04:28.180 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:28.186 > Sending pipeline data to server (604 bytes)
19:04:28.561 > [HTTP] Response code: 200
19:04:28.561 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:04:28.571 > [RETRY] Health data sent successfully!
19:04:28.573 > ✓ Health data #1 sent successfully
19:04:28.674 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":1,"serverTime":1770125668287,"type":"security_update"}
19:04:28.692 > [WebSocket] Processing message type: security_update
19:04:28.697 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:04:28.703 > [23.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:28.808 > [WebSocket] Received (631 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:8102170017000408000000019F457E3ED4C77CBDE31FC031B5648D1BE34FCA61B274654FA0B4880684594065053BD5D02DB702D0B2E6E177EF7B58F7","pipeline":{"afterLFSR":"0663212FA981347DE603ED8EB36EDADF4359B2181DC54A57216431A60CCBE07A","afterSalt":"48522D36302053504F322D39352053544550532D3131374D50","afterTinkerbell":"4FE37E3ED4C77CBDB4A0C031B5648D1B1FE38806B274654F459FCA6184594065","afterTransposition":"9F457E3ED4C77CBDE31FC031B5648D1BE34FCA61B274654FA0B4880684594065"},"plaintext":"HR-60 SPO2-95 STEPS-117","serverTime":1770125668287,"timestamp":22589,"type":"encryption_update","ztmEnabled":false}
19:04:28.864 > [WebSocket] Processing message type: encryption_update
19:04:28.870 > [23.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:28.972 > [WebSocket] Received (87 bytes): {"heartRate":60,"spo2":95,"steps":117,"time":1770125668287,"type":"health_data_update"}
19:04:28.981 > [WebSocket] Processing message type: health_data_update
19:04:28.986 > [23.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:29.094 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3088,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-117","handshakeSuccess":true,"totalTime":0.3088},"type":"session_summary_update"}
19:04:29.116 > [WebSocket] Processing message type: session_summary_update
19:04:29.122 > [23.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:29.227 > [WebSocket] Received (656 bytes): {"decryptionTime":0.3088,"encryptedPacket":"8102170017000408000000019F457E3ED4C77CBDE31FC031B5648D1BE34FCA61B274654FA0B4880684594065053BD5D02DB702D0B2E6E177EF7B58F7","finalPlaintext":"HR-60 SPO2-95 STEPS-117","healthData":{"heartRate":60,"spo2":95,"steps":117},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D31313700000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D3131374D5000000000000000","afterTinkerbell":"0663212FA981347DE603ED8EB36EDADF4359B2181DC54A57216431A60CCBE07A","afterTransposition":"4FE37E3ED4C77CBDB4A0C031B5648D1B1FE38806B274654F459FCA6184594065"},"serverTime":1770125668288,"type":"decryption_update"}
19:04:29.286 > [WebSocket] Processing message type: decryption_update
19:04:29.292 > [WebSocket] Server decryption completed
19:04:29.295 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 117
19:04:29.299 > [23.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:29.401 > [WebSocket] Received (643 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":0,"pipeline":{"afterLFSR":"0663212FA981347DE603ED8EB36EDADF4359B2181DC54A57216431A60CCBE07A","afterSalt":"48522D36302053504F322D39352053544550532D3131374D50","afterTinkerbell":"4FE37E3ED4C77CBDB4A0C031B5648D1B1FE38806B274654F459FCA6184594065","afterTransposition":"9F457E3ED4C77CBDE31FC031B5648D1BE34FCA61B274654FA0B4880684594065","finalPacket":"8102170017000408000000019F457E3ED4C77CBDE31FC031B5648D1BE34FCA61B274654FA0B4880684594065053BD5D02DB702D0B2E6E177EF7B58F7"},"plaintext":"HR-60 SPO2-95 STEPS-117","timestamp":22965,"type":"encryption_pipeline","ztmEnabled":false}
19:04:29.460 > [WebSocket] Processing message type: encryption_pipeline
19:04:29.463 > [23.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:29.565 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":0,"message":"Health data #1 sent successfully","state":7,"success":true,"timestamp":22969,"type":"health_data_sent"}
19:04:29.582 > [WebSocket] Processing message type: health_data_sent
19:04:29.585 > [24.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:29.686 > [24.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:29.788 > [24.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:29.889 > [24.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:29.990 > [24.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:30.091 > [24.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:30.192 > [24.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:30.292 > [24.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:30.394 > [24.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:30.495 > [24.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:30.596 > [25.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:30.696 > [25.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:30.797 > [25.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:30.898 > [25.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:30.999 > [25.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:31.100 > [25.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:31.202 > [25.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:31.303 > [25.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:31.404 > [25.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:31.504 > [25.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:31.606 > [26.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:31.707 > [26.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:31.808 > [26.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:31.908 > [26.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:32.010 > [26.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:32.111 > [26.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:32.212 > [26.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:32.313 > [26.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:32.413 > [26.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:32.515 > [26.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:32.615 > [27.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:32.716 > [27.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:32.817 > [27.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:32.918 > [27.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:33.020 > [27.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:33.121 > [27.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:33.221 > [27.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:33.322 > [27.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:33.423 > [27.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:33.531 > [27.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:33.625 > [28.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:33.727 > [28.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:33.827 > [28.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:33.929 > [28.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:34.030 > [28.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:34.130 > [28.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:34.232 > [28.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:34.332 > [28.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:34.434 > [28.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:34.534 > [28.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:34.636 > [29.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:34.736 > [29.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:34.838 > [29.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:34.939 > [29.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:35.040 > [29.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:35.141 > [29.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:35.241 > [29.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:35.343 > [29.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:35.443 > [29.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:35.544 > [29.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:35.645 > [30.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:35.747 > [30.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:35.847 > [30.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:35.948 > [30.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:36.049 > [30.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:36.150 > [30.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:36.251 > [30.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:36.352 > [30.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:36.454 > [30.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:36.554 > [31.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:36.656 > [31.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:36.756 > [31.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:36.857 > [31.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:36.959 > [31.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:37.059 > [31.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:37.160 > [31.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:37.262 > [31.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:37.363 > [31.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:37.463 > [31.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:37.565 > [32.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:37.665 > [32.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:37.766 > [32.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:37.867 > [32.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:37.969 > [32.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:38.068 > [32.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:38.170 > [32.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:38.272 > [32.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:38.372 > [32.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:38.473 > [32.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:38.574 > [33.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:04:38.580 > [RETRY] Attempting to send health data (Max retries: 3)
19:04:38.585 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:04:38.591 > Generated health data: HR-60 SPO2-95 STEPS-163
19:04:38.595 > [ESP32] ========================================
19:04:38.600 > [ESP32] ENCRYPTION PIPELINE START
19:04:38.603 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:04:38.611 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:04:38.616 > [ESP32] ========================================
19:04:38.620 > [ESP32] MsgKeys: lfsrSeed=0x6DA354A0 tnk[0..3]=7E00C9E3 trn[0..3]=9B4F7718
19:04:38.627 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3136334D50
19:04:38.634 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3136334D5000000000000000 
19:04:38.642 > [ESP32][LFSR] Initializing - Seed: 0x6DA354A0 SeedBe: 0xA054A36D ChaosKey[0..3]: 7E00C9E3 InitialTap: 0x0029 State: 0x6DA354A0
19:04:38.653 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:04:38.661 > 3_After_LFSR (32): E8068E5B580077E838A7127654825365 858C88A91DB605982181C73DE204336D 
19:04:38.666 > [ESP32][LFSR] Keystream (first 16 bytes): A054A36D682024B877953F4F61A20031
19:04:38.675 > [ESP32][4D] LFSR keystream (first 32 bytes): A054A36D682024B877953F4F61A20031C0DCDB842C8036D57181C73DE204336D
19:04:38.684 > [ESP32][TINKERBELL] Input (first 16 bytes): E8068E5B580077E838A7127654825365 Nonce: 0x00000002 Buffer size: 32 bytes
19:04:38.694 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 7E00C9E3
19:04:38.706 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 4CC79C620EEF5B42FC20BFDAF1401BD0
19:04:38.711 > 4_After_Tinkerbell (32): A4C1123956EF2CAAC487ADACA5C248B5 6A927F4B2D9203ADEBDF66972A8535C5 
19:04:38.719 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 4CC79C620EEF5B42FC20BFDAF1401BD0
19:04:38.729 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 4CC79C620EEF5B42FC20BFDAF1401BD0EF1EF7E230240635CA5EA1AAC88106A8
19:04:38.739 > 5_After_Transposition (32): 56EF2CAAEBDF6697A5C248B5A4C11239 2D9203ADC487ADAC2A8535C56A927F4B 
19:04:38.747 > [ESP32] === HMAC DEBUG INFO ===
19:04:38.750 > [ESP32] HMAC Key being used: 8065854780689E955FB1F2E9139C766826C4C70DD386F1F6B5F350A483F10D10
19:04:38.759 > [ESP32] HMAC Input length: 44 bytes
19:04:38.761 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000256EF2CAAEBDF6697A5C248B5A4C112392D9203AD
19:04:38.770 > [ESP32] Nonce: 0x00000002
19:04:38.772 > [ESP32] Packet size before HMAC: 60
19:04:38.775 > [ESP32] Computed HMAC Tag: 3032D621A8DAF810D15431A315296CDC
19:04:38.781 > [ESP32] === END HMAC DEBUG ===
19:04:38.783 > 6_Final_Packet (60): 81021700170004080000000256EF2CAA EBDF6697A5C248B5A4C112392D9203AD ...
19:04:38.792 > [RETRY] Attempt 1/3 (nonce: 2)
19:04:38.794 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:38.802 > Sending pipeline data to server (604 bytes)
19:04:39.086 > [HTTP] Response code: 200
19:04:39.086 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:04:39.096 > [RETRY] Health data sent successfully!
19:04:39.098 > ✓ Health data #2 sent successfully
19:04:39.200 > [WebSocket] Received (631 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:81021700170004080000000256EF2CAAEBDF6697A5C248B5A4C112392D9203ADC487ADAC2A8535C56A927F4B3032D621A8DAF810D15431A315296CDC","pipeline":{"afterLFSR":"E8068E5B580077E838A7127654825365858C88A91DB605982181C73DE204336D","afterSalt":"48522D36302053504F322D39352053544550532D3136334D50","afterTinkerbell":"A4C1123956EF2CAAC487ADACA5C248B56A927F4B2D9203ADEBDF66972A8535C5","afterTransposition":"56EF2CAAEBDF6697A5C248B5A4C112392D9203ADC487ADAC2A8535C56A927F4B"},"plaintext":"HR-60 SPO2-95 STEPS-163","serverTime":1770125678904,"timestamp":33204,"type":"encryption_update","ztmEnabled":false}
19:04:39.255 > [WebSocket] Processing message type: encryption_update
19:04:39.261 > [33.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:39.364 > [WebSocket] Received (87 bytes): {"heartRate":60,"spo2":95,"steps":163,"time":1770125678904,"type":"health_data_update"}
19:04:39.372 > [WebSocket] Processing message type: health_data_update
19:04:39.378 > [33.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:39.487 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2688,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-163","handshakeSuccess":true,"totalTime":0.2688},"type":"session_summary_update"}
19:04:39.509 > [WebSocket] Processing message type: session_summary_update
19:04:39.515 > [33.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:39.621 > [WebSocket] Received (656 bytes): {"decryptionTime":0.2688,"encryptedPacket":"81021700170004080000000256EF2CAAEBDF6697A5C248B5A4C112392D9203ADC487ADAC2A8535C56A927F4B3032D621A8DAF810D15431A315296CDC","finalPlaintext":"HR-60 SPO2-95 STEPS-163","healthData":{"heartRate":60,"spo2":95,"steps":163},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D31363300000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D3136334D5000000000000000","afterTinkerbell":"E8068E5B580077E838A7127654825365858C88A91DB605982181C73DE204336D","afterTransposition":"A4C1123956EF2CAAC487ADACA5C248B56A927F4B2D9203ADEBDF66972A8535C5"},"serverTime":1770125678905,"type":"decryption_update"}
19:04:39.679 > [WebSocket] Processing message type: decryption_update
19:04:39.684 > [WebSocket] Server decryption completed
19:04:39.687 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 163
19:04:39.693 > [34.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:39.794 > [WebSocket] Received (643 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":1,"pipeline":{"afterLFSR":"E8068E5B580077E838A7127654825365858C88A91DB605982181C73DE204336D","afterSalt":"48522D36302053504F322D39352053544550532D3136334D50","afterTinkerbell":"A4C1123956EF2CAAC487ADACA5C248B56A927F4B2D9203ADEBDF66972A8535C5","afterTransposition":"56EF2CAAEBDF6697A5C248B5A4C112392D9203ADC487ADAC2A8535C56A927F4B","finalPacket":"81021700170004080000000256EF2CAAEBDF6697A5C248B5A4C112392D9203ADC487ADAC2A8535C56A927F4B3032D621A8DAF810D15431A315296CDC"},"plaintext":"HR-60 SPO2-95 STEPS-163","timestamp":33490,"type":"encryption_pipeline","ztmEnabled":false}
19:04:39.852 > [WebSocket] Processing message type: encryption_pipeline
19:04:39.855 > [34.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:39.958 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Health data #2 sent successfully","state":7,"success":true,"timestamp":33495,"type":"health_data_sent"}
19:04:39.975 > [WebSocket] Processing message type: health_data_sent
19:04:39.977 > [34.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:40.079 > [34.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:40.180 > [34.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:40.282 > [34.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:40.382 > [34.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:40.484 > [34.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:40.585 > [35.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:40.685 > [35.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:40.786 > [35.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:40.888 > [35.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:40.988 > [35.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:41.089 > [35.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:41.190 > [35.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:41.291 > [35.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:41.393 > [35.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:41.493 > [35.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:41.594 > [36.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:41.695 > [36.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:41.796 > [36.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:41.897 > [36.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:41.998 > [36.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:42.099 > [36.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:42.200 > [36.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:42.301 > [36.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:42.402 > [36.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:42.504 > [36.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:42.604 > [37.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:42.706 > [37.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:42.806 > [37.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:42.907 > [37.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:43.008 > [37.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:43.108 > [37.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:43.210 > [37.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:43.312 > [37.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:43.412 > [37.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:43.513 > [37.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:43.614 > [38.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:43.715 > [38.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:43.817 > [38.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:43.917 > [38.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:44.019 > [38.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:44.118 > [38.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:44.220 > [38.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:44.321 > [38.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:44.422 > [38.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:44.523 > [38.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:44.624 > [39.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:44.725 > [39.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:44.827 > [39.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:44.927 > [39.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:45.029 > [39.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:45.129 > [39.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:45.231 > [39.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:45.331 > [39.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:45.433 > [39.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:45.534 > [39.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:45.634 > [40.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:45.736 > [40.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:45.837 > [40.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:45.936 > [40.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:46.038 > [40.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:46.139 > [40.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:46.240 > [40.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:46.341 > [40.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:46.442 > [40.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:46.542 > [40.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:46.644 > [41.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:46.745 > [41.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:46.846 > [41.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:46.947 > [41.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:47.048 > [41.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:47.149 > [41.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:47.250 > [41.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:47.351 > [41.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:47.452 > [41.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:47.552 > [42.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:47.654 > [42.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:47.755 > [42.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:47.856 > [42.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:47.957 > [42.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:48.058 > [42.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:48.159 > [42.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:48.260 > [42.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:48.361 > [42.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:48.462 > [42.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:48.563 > [43.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:48.664 > [43.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:48.765 > [43.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:48.866 > [43.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:48.967 > [43.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:49.068 > [43.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:49.169 > [43.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:49.175 > [RETRY] Attempting to send health data (Max retries: 3)
19:04:49.181 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:04:49.186 > Generated health data: HR-60 SPO2-95 STEPS-242
19:04:49.189 > [ESP32] ========================================
19:04:49.195 > [ESP32] ENCRYPTION PIPELINE START
19:04:49.197 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:04:49.206 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:04:49.212 > [ESP32] ========================================
19:04:49.215 > [ESP32] MsgKeys: lfsrSeed=0xF469785D tnk[0..3]=3187E2D4 trn[0..3]=FA081B80
19:04:49.222 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3234324D50
19:04:49.229 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3234324D5000000000000000 
19:04:49.237 > [ESP32][LFSR] Initializing - Seed: 0xF469785D SeedBe: 0x5D7869F4 ChaosKey[0..3]: 3187E2D4 InitialTap: 0x0029 State: 0xF469785D
19:04:49.247 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:04:49.256 > 3_After_LFSR (32): 152A44C2BCB596E28ADCC419010054C2 7E0F846C48055D81B7D88BFBD0AAD5AD 
19:04:49.262 > [ESP32][LFSR] Keystream (first 16 bytes): 5D7869F48C95C5B2C5EEE92034200796
19:04:49.270 > [ESP32][4D] LFSR keystream (first 32 bytes): 5D7869F48C95C5B2C5EEE920342007963B5FD7417A316FCCE7D88BFBD0AAD5AD
19:04:49.278 > [ESP32][TINKERBELL] Input (first 16 bytes): 152A44C2BCB596E28ADCC419010054C2 Nonce: 0x00000003 Buffer size: 32 bytes
19:04:49.289 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 3187E2D4
19:04:49.300 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 75C3C10C472CEFE53612A003294528DC
19:04:49.306 > 4_After_Tinkerbell (32): 60E985CEFB997907BCCE641A28457C1E 75F11244F002690D7F537D68A793466A 
19:04:49.315 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 75C3C10C472CEFE53612A003294528DC
19:04:49.322 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 75C3C10C472CEFE53612A003294528DC0BFE9628B807348CC88BF693773993C7
19:04:49.333 > 5_After_Transposition (32): 02E9074460FB798599F11E1A75F06964 45CE0DCEBC287C127FA76846536A7D93 
19:04:49.342 > [ESP32] === HMAC DEBUG INFO ===
19:04:49.345 > [ESP32] HMAC Key being used: 8065854780689E955FB1F2E9139C766826C4C70DD386F1F6B5F350A483F10D10
19:04:49.353 > [ESP32] HMAC Input length: 44 bytes
19:04:49.356 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000302E9074460FB798599F11E1A75F0696445CE0DCE
19:04:49.364 > [ESP32] Nonce: 0x00000003
19:04:49.367 > [ESP32] Packet size before HMAC: 60
19:04:49.370 > [ESP32] Computed HMAC Tag: D2C9B776E8B8DA8392FF26AF04D55D87
19:04:49.375 > [ESP32] === END HMAC DEBUG ===
19:04:49.378 > 6_Final_Packet (60): 81021700170004080000000302E90744 60FB798599F11E1A75F0696445CE0DCE ...
19:04:49.387 > [RETRY] Attempt 1/3 (nonce: 3)
19:04:49.388 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:49.396 > Sending pipeline data to server (604 bytes)
19:04:49.569 > [HTTP] Response code: 400
19:04:49.569 > [HTTP] Error response: {"error":"Decryption failed"}
19:04:49.574 > [HTTP] Request failed with code: 400
19:04:49.576 > [RETRY] Send failed, waiting 100 ms before retry
19:04:49.676 > [RETRY] Attempt 2/3 (nonce: 3)
19:04:49.677 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:49.682 > Sending pipeline data to server (604 bytes)
19:04:49.844 > [HTTP] Response code: 400
19:04:49.844 > [HTTP] Error response: {"error":"Decryption failed"}
19:04:49.849 > [HTTP] Request failed with code: 400
19:04:49.852 > [RETRY] Send failed, waiting 200 ms before retry
19:04:50.050 > [RETRY] Attempt 3/3 (nonce: 3)
19:04:50.051 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:50.056 > Sending pipeline data to server (604 bytes)
19:04:50.343 > [HTTP] Response code: 400
19:04:50.345 > [HTTP] Error response: {"error":"Decryption failed"}
19:04:50.349 > [HTTP] Request failed with code: 400
19:04:50.352 > [RETRY] All retry attempts failed - rolled back nonce to 2
19:04:50.356 > [RETRY] Consecutive failures: 1
19:04:50.360 > Health data send failed (retry count: 1/3)
19:04:50.464 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":43973,"type":"health_data_error"}
19:04:50.483 > [WebSocket] Processing message type: health_data_error
19:04:50.485 > [44.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:50.499 > [RETRY] Attempting to send health data (Max retries: 3)
19:04:50.499 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:04:50.519 > Generated health data: HR-60 SPO2-95 STEPS-260
19:04:50.519 > [ESP32] ========================================
19:04:50.519 > [ESP32] ENCRYPTION PIPELINE START
19:04:50.519 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:04:50.523 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:04:50.528 > [ESP32] ========================================
19:04:50.531 > [ESP32] MsgKeys: lfsrSeed=0xF469785D tnk[0..3]=3187E2D4 trn[0..3]=FA081B80
19:04:50.540 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3236304D50
19:04:50.545 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3236304D5000000000000000 
19:04:50.551 > [ESP32][LFSR] Initializing - Seed: 0xF469785D SeedBe: 0x5D7869F4 ChaosKey[0..3]: 3187E2D4 InitialTap: 0x0029 State: 0xF469785D
19:04:50.562 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:04:50.570 > 3_After_LFSR (32): 152A44C2BCB596E28ADCC419010054C2 7E0F846C48075F81B7D88BFBD0AAD5AD 
19:04:50.579 > [ESP32][LFSR] Keystream (first 16 bytes): 5D7869F48C95C5B2C5EEE92034200796
19:04:50.584 > [ESP32][4D] LFSR keystream (first 32 bytes): 5D7869F48C95C5B2C5EEE920342007963B5FD7417A316FCCE7D88BFBD0AAD5AD
19:04:50.597 > [ESP32][TINKERBELL] Input (first 16 bytes): 152A44C2BCB596E28ADCC419010054C2 Nonce: 0x00000003 Buffer size: 32 bytes
19:04:50.608 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 3187E2D4
19:04:50.619 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 75C3C10C472CEFE53612A003294528DC
19:04:50.625 > 4_After_Tinkerbell (32): 60E985CEFB997907BCCE641A28457C1E 75F11244F0006B0D7F537D68A793466A 
19:04:50.631 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 75C3C10C472CEFE53612A003294528DC
19:04:50.640 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 75C3C10C472CEFE53612A003294528DC0BFE9628B807348CC88BF693773993C7
19:04:50.648 > 5_After_Transposition (32): 00E9074460FB798599F11E1A75F06B64 45CE0DCEBC287C127FA76846536A7D93 
19:04:50.656 > [ESP32] === HMAC DEBUG INFO ===
19:04:50.659 > [ESP32] HMAC Key being used: 8065854780689E955FB1F2E9139C766826C4C70DD386F1F6B5F350A483F10D10
19:04:50.668 > [ESP32] HMAC Input length: 44 bytes
19:04:50.673 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000300E9074460FB798599F11E1A75F06B6445CE0DCE
19:04:50.681 > [ESP32] Nonce: 0x00000003
19:04:50.684 > [ESP32] Packet size before HMAC: 60
19:04:50.693 > [ESP32] Computed HMAC Tag: 98349BDF9B70AA166412B3A0D27AFA8D
19:04:50.693 > [ESP32] === END HMAC DEBUG ===
19:04:50.706 > 6_Final_Packet (60): 81021700170004080000000300E90744 60FB798599F11E1A75F06B6445CE0DCE ...
19:04:50.706 > [RETRY] Attempt 1/3 (nonce: 3)
19:04:50.706 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:50.709 > Sending pipeline data to server (604 bytes)
19:04:51.054 > [HTTP] Response code: 400
19:04:51.054 > [HTTP] Error response: {"error":"Decryption failed"}
19:04:51.060 > [HTTP] Request failed with code: 400
19:04:51.063 > [RETRY] Send failed, waiting 100 ms before retry
19:04:51.161 > [RETRY] Attempt 2/3 (nonce: 3)
19:04:51.161 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:51.167 > Sending pipeline data to server (604 bytes)
19:04:51.324 > [HTTP] Response code: 400
19:04:51.325 > [HTTP] Error response: {"error":"Decryption failed"}
19:04:51.336 > [HTTP] Request failed with code: 400
19:04:51.336 > [RETRY] Send failed, waiting 200 ms before retry
19:04:51.533 > [RETRY] Attempt 3/3 (nonce: 3)
19:04:51.533 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:51.538 > Sending pipeline data to server (604 bytes)
19:04:51.825 > [HTTP] Response code: 400
19:04:51.825 > [HTTP] Error response: {"error":"Decryption failed"}
19:04:51.832 > [HTTP] Request failed with code: 400
19:04:51.834 > [RETRY] All retry attempts failed - rolled back nonce to 2
19:04:51.841 > [RETRY] Consecutive failures: 2
19:04:51.842 > Health data send failed (retry count: 2/3)
19:04:51.943 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":44248,"type":"health_data_error"}
19:04:51.957 > [WebSocket] Processing message type: health_data_error
19:04:51.963 > [46.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:51.980 > [RETRY] Attempting to send health data (Max retries: 3)
19:04:51.980 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:04:51.983 > Generated health data: HR-60 SPO2-95 STEPS-240
19:04:51.985 > [ESP32] ========================================
19:04:51.992 > [ESP32] ENCRYPTION PIPELINE START
19:04:51.994 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:04:52.001 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:04:52.039 > [ESP32] ========================================
19:04:52.039 > [ESP32] MsgKeys: lfsrSeed=0xF469785D tnk[0..3]=3187E2D4 trn[0..3]=FA081B80
19:04:52.039 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3234304D50
19:04:52.039 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3234304D5000000000000000 
19:04:52.039 > [ESP32][LFSR] Initializing - Seed: 0xF469785D SeedBe: 0x5D7869F4 ChaosKey[0..3]: 3187E2D4 InitialTap: 0x0029 State: 0xF469785D
19:04:52.060 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:04:52.060 > 3_After_LFSR (32): 152A44C2BCB596E28ADCC419010054C2 7E0F846C48055F81B7D88BFBD0AAD5AD 
19:04:52.060 > [ESP32][LFSR] Keystream (first 16 bytes): 5D7869F48C95C5B2C5EEE92034200796
19:04:52.090 > [ESP32][4D] LFSR keystream (first 32 bytes): 5D7869F48C95C5B2C5EEE920342007963B5FD7417A316FCCE7D88BFBD0AAD5AD
19:04:52.090 > [ESP32][TINKERBELL] Input (first 16 bytes): 152A44C2BCB596E28ADCC419010054C2 Nonce: 0x00000003 Buffer size: 32 bytes
19:04:52.090 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 3187E2D4
19:04:52.094 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 75C3C10C472CEFE53612A003294528DC
19:04:52.102 > 4_After_Tinkerbell (32): 60E985CEFB997907BCCE641A28457C1E 75F11244F0026B0D7F537D68A793466A 
19:04:52.114 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 75C3C10C472CEFE53612A003294528DC
19:04:52.130 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 75C3C10C472CEFE53612A003294528DC0BFE9628B807348CC88BF693773993C7
19:04:52.130 > 5_After_Transposition (32): 02E9074460FB798599F11E1A75F06B64 45CE0DCEBC287C127FA76846536A7D93 
19:04:52.136 > [ESP32] === HMAC DEBUG INFO ===
19:04:52.145 > [ESP32] HMAC Key being used: 8065854780689E955FB1F2E9139C766826C4C70DD386F1F6B5F350A483F10D10
19:04:52.148 > [ESP32] HMAC Input length: 44 bytes
19:04:52.152 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000302E9074460FB798599F11E1A75F06B6445CE0DCE
19:04:52.222 > [ESP32] Nonce: 0x00000003
19:04:52.222 > [ESP32] Packet size before HMAC: 60
19:04:52.222 > [ESP32] Computed HMAC Tag: 0CD53EE430E2C26EE7F8C98F39CF15CE
19:04:52.222 > [ESP32] === END HMAC DEBUG ===
19:04:52.222 > 6_Final_Packet (60): 81021700170004080000000302E90744 60FB798599F11E1A75F06B6445CE0DCE ...
19:04:52.222 > [RETRY] Attempt 1/3 (nonce: 3)
19:04:52.222 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:52.222 > Sending pipeline data to server (604 bytes)
19:04:52.361 > [HTTP] Response code: 400
19:04:52.362 > [HTTP] Error response: {"error":"Decryption failed"}
19:04:52.367 > [HTTP] Request failed with code: 400
19:04:52.370 > [RETRY] Send failed, waiting 100 ms before retry
19:04:52.468 > [RETRY] Attempt 2/3 (nonce: 3)
19:04:52.468 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:52.474 > Sending pipeline data to server (604 bytes)
19:04:52.812 > [HTTP] Response code: 400
19:04:52.812 > [HTTP] Error response: {"error":"Decryption failed"}
19:04:52.818 > [HTTP] Request failed with code: 400
19:04:52.820 > [RETRY] Send failed, waiting 200 ms before retry
19:04:53.018 > [RETRY] Attempt 3/3 (nonce: 3)
19:04:53.018 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:53.024 > Sending pipeline data to server (604 bytes)
19:04:53.348 > [HTTP] Response code: 400
19:04:53.348 > [HTTP] Error response: {"error":"Decryption failed"}
19:04:53.354 > [HTTP] Request failed with code: 400
19:04:53.357 > [RETRY] All retry attempts failed - rolled back nonce to 2
19:04:53.362 > [RETRY] Consecutive failures: 3
19:04:53.365 > Health data send failed (retry count: 3/3)
19:04:53.367 > Health data transmission failed after max retries
19:04:53.466 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":44748,"type":"health_data_error"}
19:04:53.481 > [WebSocket] Processing message type: health_data_error
19:04:53.486 > [47.9] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:53.495 > ERROR state - attempting recovery
19:04:53.497 > [RETRY] Attempting to send health data (Max retries: 3)
19:04:53.503 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:04:53.506 > Generated health data: HR-60 SPO2-95 STEPS-256
19:04:53.511 > [ESP32] ========================================
19:04:53.514 > [ESP32] ENCRYPTION PIPELINE START
19:04:53.516 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:04:53.525 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:04:53.531 > [ESP32] ========================================
19:04:53.536 > [ESP32] MsgKeys: lfsrSeed=0xF469785D tnk[0..3]=3187E2D4 trn[0..3]=FA081B80
19:04:53.542 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3235364D50
19:04:53.547 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3235364D5000000000000000 
19:04:53.557 > [ESP32][LFSR] Initializing - Seed: 0xF469785D SeedBe: 0x5D7869F4 ChaosKey[0..3]: 3187E2D4 InitialTap: 0x0029 State: 0xF469785D
19:04:53.566 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:04:53.576 > 3_After_LFSR (32): 152A44C2BCB596E28ADCC419010054C2 7E0F846C48045981B7D88BFBD0AAD5AD 
19:04:53.583 > [ESP32][LFSR] Keystream (first 16 bytes): 5D7869F48C95C5B2C5EEE92034200796
19:04:53.589 > [ESP32][4D] LFSR keystream (first 32 bytes): 5D7869F48C95C5B2C5EEE920342007963B5FD7417A316FCCE7D88BFBD0AAD5AD
19:04:53.599 > [ESP32][TINKERBELL] Input (first 16 bytes): 152A44C2BCB596E28ADCC419010054C2 Nonce: 0x00000003 Buffer size: 32 bytes
19:04:53.608 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 3187E2D4
19:04:53.619 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 75C3C10C472CEFE53612A003294528DC
19:04:53.628 > 4_After_Tinkerbell (32): 60E985CEFB997907BCCE641A28457C1E 75F11244F0036D0D7F537D68A793466A 
19:04:53.636 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 75C3C10C472CEFE53612A003294528DC
19:04:53.645 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 75C3C10C472CEFE53612A003294528DC0BFE9628B807348CC88BF693773993C7
19:04:53.653 > 5_After_Transposition (32): 03E9074460FB798599F11E1A75F06D64 45CE0DCEBC287C127FA76846536A7D93 
19:04:53.662 > [ESP32] === HMAC DEBUG INFO ===
19:04:53.664 > [ESP32] HMAC Key being used: 8065854780689E955FB1F2E9139C766826C4C70DD386F1F6B5F350A483F10D10
19:04:53.672 > [ESP32] HMAC Input length: 44 bytes
19:04:53.675 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000303E9074460FB798599F11E1A75F06D6445CE0DCE
19:04:53.686 > [ESP32] Nonce: 0x00000003
19:04:53.686 > [ESP32] Packet size before HMAC: 60
19:04:53.688 > [ESP32] Computed HMAC Tag: B5392E8BC995D3C4B7B830B4A6D42A1C
19:04:53.694 > [ESP32] === END HMAC DEBUG ===
19:04:53.697 > 6_Final_Packet (60): 81021700170004080000000303E90744 60FB798599F11E1A75F06D6445CE0DCE ...
19:04:53.706 > [RETRY] Attempt 1/3 (nonce: 3)
19:04:53.709 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:53.714 > Sending pipeline data to server (604 bytes)
19:04:54.070 > [HTTP] Response code: 400
19:04:54.070 > [HTTP] Error response: {"error":"Decryption failed"}
19:04:54.076 > [HTTP] Request failed with code: 400
19:04:54.079 > [RETRY] Send failed, waiting 100 ms before retry
19:04:54.177 > [RETRY] Attempt 2/3 (nonce: 3)
19:04:54.177 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:54.182 > Sending pipeline data to server (604 bytes)
19:04:54.527 > [HTTP] Response code: 400
19:04:54.528 > [HTTP] Error response: {"error":"Decryption failed"}
19:04:54.534 > [HTTP] Request failed with code: 400
19:04:54.546 > [RETRY] Send failed, waiting 200 ms before retry
19:04:54.738 > [RETRY] Attempt 3/3 (nonce: 3)
19:04:54.738 > POST http://10.249.92.115:8081/health-data with pipeline data
19:04:54.745 > Sending pipeline data to server (604 bytes)
19:04:55.102 > [HTTP] Response code: 400
19:04:55.102 > [HTTP] Error response: {"error":"Decryption failed"}
19:04:55.107 > [HTTP] Request failed with code: 400
19:04:55.110 > [RETRY] All retry attempts failed - rolled back nonce to 2
19:04:55.116 > [RETRY] Consecutive failures: 4
19:04:55.118 > ✗ Auto-recovery failed - restarting key exchange
19:04:57.222 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":45459,"type":"health_data_error"}
19:04:57.239 > [WebSocket] Processing message type: health_data_error
19:04:57.242 > [51.6] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:57.250 > ✓ Public key loaded from NVS
19:04:57.349 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":45730,"type":"health_data_error"}
19:04:57.363 > [WebSocket] Processing message type: health_data_error
19:04:57.368 > [51.8] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:57.472 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":46230,"type":"health_data_error"}
19:04:57.485 > [WebSocket] Processing message type: health_data_error
19:04:57.491 > [51.9] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:57.499 > Generating fresh master key from entropy...
19:04:57.507 > Generated master key (32): 8541E7C6AFCAF4CF1296964A1A1F18B5 713298AD18403965EB54A68B336192CC 
19:04:57.513 > Using reduced master key (byte % 3) for NTRU encryption only
19:04:57.523 > NTRU encrypted master key (502): 00220070001E0015007E001C00070062 004400770039000E000200750068006F ...
19:04:57.532 > POST http://10.249.92.115:8081/master-key
19:04:57.863 > ✓ Master key exchange completed
19:04:57.965 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":46766,"type":"health_data_error"}
19:04:57.984 > [WebSocket] Processing message type: health_data_error
19:04:57.992 > [52.4] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:57.992 > Loading master key from NVS and deriving symmetric keys...
19:04:57.998 > Loaded master key from NVS (32): 8541E7C6AFCAF4CF1296964A1A1F18B5 713298AD18403965EB54A68B336192CC 
19:04:58.008 > Derived HMAC key (32): 3B69F0C5D996BAB6EF753A4951CF568F 4BE3E4790B03567FC366991DF2290FA7 
19:04:58.017 > Derived Tinkerbell key (16): BD03C08911FF6AE9BEBA98D0A6A67315 
19:04:58.024 > Derived Transposition key (16): F71DC7E67C010A03F3DCC9B038A1F053 
19:04:58.026 > ✓ Symmetric keys derived successfully
19:04:58.029 > Nonce tracker reset - new session started
19:04:58.525 > Waiting for server to process master key...
19:04:58.528 > ✓ Symmetric keys ready - starting health data transmission
19:04:58.631 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":47216,"type":"health_data_error"}
19:04:58.644 > [WebSocket] Processing message type: health_data_error
19:04:58.650 > [53.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:58.752 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":47753,"type":"health_data_error"}
19:04:58.767 > [WebSocket] Processing message type: health_data_error
19:04:58.773 > [53.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:58.875 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":8,"success":false,"timestamp":48475,"type":"health_data_error"}
19:04:58.889 > [WebSocket] Processing message type: health_data_error
19:04:58.895 > [53.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:59.001 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":8,"success":false,"timestamp":48932,"type":"health_data_error"}
19:04:59.015 > [WebSocket] Processing message type: health_data_error
19:04:59.021 > [53.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:59.123 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":8,"success":false,"timestamp":49507,"type":"health_data_error"}
19:04:59.138 > [WebSocket] Processing message type: health_data_error
19:04:59.143 > [53.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:59.245 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125697665,"type":"master_key_received"}
19:04:59.260 > [WebSocket] Processing message type: master_key_received
19:04:59.262 > [53.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:59.367 > [WebSocket] Received (174 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":52261,"type":"master_key_exchanged"}
19:04:59.383 > [WebSocket] Processing message type: master_key_exchanged
19:04:59.389 > [53.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:59.489 > [WebSocket] Received (166 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":52929,"type":"symmetric_keys_derived"}
19:04:59.506 > [WebSocket] Processing message type: symmetric_keys_derived
19:04:59.511 > [53.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:59.611 > [54.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:59.712 > [54.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:59.812 > [54.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:04:59.914 > [54.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:00.015 > [54.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:00.115 > [54.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:00.217 > [54.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:00.317 > [54.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:00.418 > [54.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:00.520 > [54.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:00.621 > [55.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:00.721 > [55.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:00.822 > [55.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:00.924 > [55.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:01.024 > [55.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:01.125 > [55.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:01.226 > [55.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:01.327 > [55.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:01.429 > [55.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:01.530 > [55.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:01.630 > [56.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:01.731 > [56.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:01.832 > [56.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:01.933 > [56.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:02.035 > [56.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:02.136 > [56.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:02.237 > [56.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:02.338 > [56.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:02.439 > [56.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:02.540 > [56.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:02.641 > [57.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:02.742 > [57.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:02.842 > [57.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:02.944 > [57.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:03.045 > [57.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:03.146 > [57.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:03.247 > [57.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:03.347 > [57.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:03.449 > [57.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:03.550 > [58.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:03.651 > [58.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:03.752 > [58.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:03.852 > [58.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:03.954 > [58.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:04.054 > [58.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:04.155 > [58.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:04.256 > [58.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:04.358 > [58.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:04.460 > [58.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:04.560 > [59.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:04.661 > [59.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:04.762 > [59.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:04.863 > [59.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:04.964 > [59.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:05.064 > [59.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:05.166 > [59.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:05.267 > [59.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:05.367 > [59.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:05.469 > [59.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:05.570 > [60.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:05.671 > [60.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:05.772 > [60.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:05.873 > [60.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:05.973 > [60.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:06.074 > [60.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:06.176 > [60.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:06.277 > [60.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:06.377 > [60.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:06.479 > [60.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:06.580 > [61.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:06.681 > [61.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:06.781 > [61.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:06.883 > [61.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:06.983 > [61.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:07.084 > [61.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:07.185 > [61.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:07.286 > [61.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:07.388 > [61.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:07.488 > [61.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:07.590 > [62.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:07.691 > [62.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:07.791 > [62.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:07.892 > [62.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:07.994 > [62.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:08.095 > [62.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:08.196 > [62.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:08.297 > [62.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:08.398 > [62.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:08.499 > [62.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:08.599 > [63.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:08.605 > [RETRY] Attempting to send health data (Max retries: 3)
19:05:08.611 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:05:08.616 > Generated health data: HR-61 SPO2-95 STEPS-330
19:05:08.620 > [ESP32] ========================================
19:05:08.625 > [ESP32] ENCRYPTION PIPELINE START
19:05:08.627 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:05:08.636 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:05:08.642 > [ESP32] ========================================
19:05:08.644 > [ESP32] MsgKeys: lfsrSeed=0x180C622D tnk[0..3]=4BBD19B0 trn[0..3]=4D5CAC84
19:05:08.652 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3333304D50
19:05:08.658 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3333304D5000000000000000 
19:05:08.667 > [ESP32][LFSR] Initializing - Seed: 0x180C622D SeedBe: 0x2D620C18 ChaosKey[0..3]: 4BBD19B0 InitialTap: 0x0029 State: 0x180C622D
19:05:08.677 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:05:08.686 > 3_After_LFSR (32): 6530212E4897A3B89D69F4E06966087C A2D442BBCA88A4C238586D510FA779CB 
19:05:08.692 > [ESP32][LFSR] Keystream (first 16 bytes): 2D620C1879B7F0E8D25BD9D95C465B28
19:05:08.700 > [ESP32][4D] LFSR keystream (first 32 bytes): 2D620C1879B7F0E8D25BD9D95C465B28E7841196F9BB948F68586D510FA779CB
19:05:08.708 > [ESP32][TINKERBELL] Input (first 16 bytes): 6530212E4897A3B89D69F4E06966087C Nonce: 0x00000001 Buffer size: 32 bytes
19:05:08.722 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 4BBD19B0
19:05:08.731 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): EFD44D31CBBE0D25AF50914697FE5A64
19:05:08.736 > 4_After_Tinkerbell (32): 8AE46C1F8329AE9D323965A6FE985218 9EDD6A05E109B24EA58FA43232169451 
19:05:08.745 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): EFD44D31CBBE0D25AF50914697FE5A64
19:05:08.754 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): EFD44D31CBBE0D25AF50914697FE5A643C0928BE2B81168C9DD7C9633DB1ED9A
19:05:08.763 > 5_After_Transposition (32): E19E1F39189832A432A5A6E49D298A6A AE6C0983054E8F94526516FE3251DDB2 
19:05:08.772 > [ESP32] === HMAC DEBUG INFO ===
19:05:08.776 > [ESP32] HMAC Key being used: 3B69F0C5D996BAB6EF753A4951CF568F4BE3E4790B03567FC366991DF2290FA7
19:05:08.783 > [ESP32] HMAC Input length: 44 bytes
19:05:08.786 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001E19E1F39189832A432A5A6E49D298A6AAE6C0983
19:05:08.794 > [ESP32] Nonce: 0x00000001
19:05:08.797 > [ESP32] Packet size before HMAC: 60
19:05:08.800 > [ESP32] Computed HMAC Tag: 9763F215BCA5275A579844DC84EFBA46
19:05:08.806 > [ESP32] === END HMAC DEBUG ===
19:05:08.809 > 6_Final_Packet (60): 810217001700040800000001E19E1F39 189832A432A5A6E49D298A6AAE6C0983 ...
19:05:08.817 > [RETRY] Attempt 1/3 (nonce: 1)
19:05:08.820 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:08.826 > Sending pipeline data to server (604 bytes)
19:05:09.096 > [HTTP] Response code: 400
19:05:09.097 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:09.102 > [HTTP] Request failed with code: 400
19:05:09.105 > [RETRY] Send failed, waiting 100 ms before retry
19:05:09.204 > [RETRY] Attempt 2/3 (nonce: 1)
19:05:09.205 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:09.210 > Sending pipeline data to server (604 bytes)
19:05:09.370 > [HTTP] Response code: 400
19:05:09.370 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:09.375 > [HTTP] Request failed with code: 400
19:05:09.377 > [RETRY] Send failed, waiting 200 ms before retry
19:05:09.578 > [RETRY] Attempt 3/3 (nonce: 1)
19:05:09.578 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:09.584 > Sending pipeline data to server (604 bytes)
19:05:09.855 > [HTTP] Response code: 400
19:05:09.855 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:09.860 > [HTTP] Request failed with code: 400
19:05:09.863 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:05:09.869 > [RETRY] Consecutive failures: 5
19:05:09.872 > [EMERGENCY] Triggering emergency reset!
19:05:09.874 > [CRYPTO] Resetting cryptographic state
19:05:09.879 > [CRYPTO] Crypto state reset complete
19:05:09.882 > [CRYPTO] Packet counter: 1
19:05:09.885 > [EMERGENCY] Emergency reset complete
19:05:09.888 > Health data send failed (retry count: 1/3)
19:05:09.985 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":63502,"type":"health_data_error"}
19:05:09.998 > [WebSocket] Processing message type: health_data_error
19:05:10.004 > [64.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:10.012 > [RETRY] Attempting to send health data (Max retries: 3)
19:05:10.018 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:05:10.023 > Generated health data: HR-61 SPO2-95 STEPS-359
19:05:10.027 > [ESP32] ========================================
19:05:10.032 > [ESP32] ENCRYPTION PIPELINE START
19:05:10.034 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:05:10.041 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:05:10.049 > [ESP32] ========================================
19:05:10.052 > [ESP32] MsgKeys: lfsrSeed=0x180C622D tnk[0..3]=4BBD19B0 trn[0..3]=4D5CAC84
19:05:10.056 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3335394D50
19:05:10.065 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3335394D5000000000000000 
19:05:10.071 > [ESP32][LFSR] Initializing - Seed: 0x180C622D SeedBe: 0x2D620C18 ChaosKey[0..3]: 4BBD19B0 InitialTap: 0x0029 State: 0x180C622D
19:05:10.082 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:05:10.090 > 3_After_LFSR (32): 6530212E4897A3B89D69F4E06966087C A2D442BBCA8EADC238586D510FA779CB 
19:05:10.098 > [ESP32][LFSR] Keystream (first 16 bytes): 2D620C1879B7F0E8D25BD9D95C465B28
19:05:10.104 > [ESP32][4D] LFSR keystream (first 32 bytes): 2D620C1879B7F0E8D25BD9D95C465B28E7841196F9BB948F68586D510FA779CB
19:05:10.116 > [ESP32][TINKERBELL] Input (first 16 bytes): 6530212E4897A3B89D69F4E06966087C Nonce: 0x00000001 Buffer size: 32 bytes
19:05:10.126 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 4BBD19B0
19:05:10.135 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): EFD44D31CBBE0D25AF50914697FE5A64
19:05:10.142 > 4_After_Tinkerbell (32): 8AE46C1F8329AE9D323965A6FE985218 9EDD6A05E10FBB4EA58FA43232169451 
19:05:10.151 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): EFD44D31CBBE0D25AF50914697FE5A64
19:05:10.159 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): EFD44D31CBBE0D25AF50914697FE5A643C0928BE2B81168C9DD7C9633DB1ED9A
19:05:10.167 > 5_After_Transposition (32): E19E1F39189832A432A5A6E49D298A6A AE6C0F83054E8F94526516FE3251DDBB 
19:05:10.177 > [ESP32] === HMAC DEBUG INFO ===
19:05:10.179 > [ESP32] HMAC Key being used: 3B69F0C5D996BAB6EF753A4951CF568F4BE3E4790B03567FC366991DF2290FA7
19:05:10.188 > [ESP32] HMAC Input length: 44 bytes
19:05:10.192 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001E19E1F39189832A432A5A6E49D298A6AAE6C0F83
19:05:10.202 > [ESP32] Nonce: 0x00000001
19:05:10.204 > [ESP32] Packet size before HMAC: 60
19:05:10.206 > [ESP32] Computed HMAC Tag: 04C999F9B20A8444DB8CB0633DCABFA6
19:05:10.213 > [ESP32] === END HMAC DEBUG ===
19:05:10.215 > 6_Final_Packet (60): 810217001700040800000001E19E1F39 189832A432A5A6E49D298A6AAE6C0F83 ...
19:05:10.221 > [RETRY] Attempt 1/3 (nonce: 1)
19:05:10.224 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:10.229 > Sending pipeline data to server (604 bytes)
19:05:10.359 > [HTTP] Response code: 400
19:05:10.359 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:10.364 > [HTTP] Request failed with code: 400
19:05:10.367 > [RETRY] Send failed, waiting 100 ms before retry
19:05:10.467 > [RETRY] Attempt 2/3 (nonce: 1)
19:05:10.467 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:10.473 > Sending pipeline data to server (604 bytes)
19:05:10.627 > [HTTP] Response code: 400
19:05:10.627 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:10.634 > [HTTP] Request failed with code: 400
19:05:10.636 > [RETRY] Send failed, waiting 200 ms before retry
19:05:10.836 > [RETRY] Attempt 3/3 (nonce: 1)
19:05:10.836 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:10.842 > Sending pipeline data to server (604 bytes)
19:05:11.122 > [HTTP] Response code: 400
19:05:11.122 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:11.128 > [HTTP] Request failed with code: 400
19:05:11.131 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:05:11.137 > [RETRY] Consecutive failures: 1
19:05:11.140 > Health data send failed (retry count: 2/3)
19:05:11.241 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":63774,"type":"health_data_error"}
19:05:11.256 > [WebSocket] Processing message type: health_data_error
19:05:11.262 > [65.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:11.269 > [RETRY] Attempting to send health data (Max retries: 3)
19:05:11.276 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:05:11.281 > Generated health data: HR-61 SPO2-95 STEPS-349
19:05:11.284 > [ESP32] ========================================
19:05:11.293 > [ESP32] ENCRYPTION PIPELINE START
19:05:11.293 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:05:11.314 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:05:11.314 > [ESP32] ========================================
19:05:11.314 > [ESP32] MsgKeys: lfsrSeed=0x180C622D tnk[0..3]=4BBD19B0 trn[0..3]=4D5CAC84
19:05:11.316 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3334394D50
19:05:11.337 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3334394D5000000000000000 
19:05:11.337 > [ESP32][LFSR] Initializing - Seed: 0x180C622D SeedBe: 0x2D620C18 ChaosKey[0..3]: 4BBD19B0 InitialTap: 0x0029 State: 0x180C622D
19:05:11.338 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:05:11.347 > 3_After_LFSR (32): 6530212E4897A3B89D69F4E06966087C A2D442BBCA8FADC238586D510FA779CB 
19:05:11.357 > [ESP32][LFSR] Keystream (first 16 bytes): 2D620C1879B7F0E8D25BD9D95C465B28
19:05:11.362 > [ESP32][4D] LFSR keystream (first 32 bytes): 2D620C1879B7F0E8D25BD9D95C465B28E7841196F9BB948F68586D510FA779CB
19:05:11.373 > [ESP32][TINKERBELL] Input (first 16 bytes): 6530212E4897A3B89D69F4E06966087C Nonce: 0x00000001 Buffer size: 32 bytes
19:05:11.384 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 4BBD19B0
19:05:11.392 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): EFD44D31CBBE0D25AF50914697FE5A64
19:05:11.400 > 4_After_Tinkerbell (32): 8AE46C1F8329AE9D323965A6FE985218 9EDD6A05E10EBB4EA58FA43232169451 
19:05:11.409 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): EFD44D31CBBE0D25AF50914697FE5A64
19:05:11.417 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): EFD44D31CBBE0D25AF50914697FE5A643C0928BE2B81168C9DD7C9633DB1ED9A
19:05:11.425 > 5_After_Transposition (32): E19E1F39189832A432A5A6E49D298A6A AE6C0E83054E8F94526516FE3251DDBB 
19:05:11.434 > [ESP32] === HMAC DEBUG INFO ===
19:05:11.436 > [ESP32] HMAC Key being used: 3B69F0C5D996BAB6EF753A4951CF568F4BE3E4790B03567FC366991DF2290FA7
19:05:11.445 > [ESP32] HMAC Input length: 44 bytes
19:05:11.450 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001E19E1F39189832A432A5A6E49D298A6AAE6C0E83
19:05:11.458 > [ESP32] Nonce: 0x00000001
19:05:11.462 > [ESP32] Packet size before HMAC: 60
19:05:11.464 > [ESP32] Computed HMAC Tag: 9BB584927D6B1A6F53B1CD3F0B1E81C2
19:05:11.470 > [ESP32] === END HMAC DEBUG ===
19:05:11.474 > 6_Final_Packet (60): 810217001700040800000001E19E1F39 189832A432A5A6E49D298A6AAE6C0E83 ...
19:05:11.478 > [RETRY] Attempt 1/3 (nonce: 1)
19:05:11.481 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:11.486 > Sending pipeline data to server (604 bytes)
19:05:11.855 > [HTTP] Response code: 400
19:05:11.855 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:11.860 > [HTTP] Request failed with code: 400
19:05:11.863 > [RETRY] Send failed, waiting 100 ms before retry
19:05:11.963 > [RETRY] Attempt 2/3 (nonce: 1)
19:05:11.963 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:11.968 > Sending pipeline data to server (604 bytes)
19:05:12.118 > [HTTP] Response code: 400
19:05:12.120 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:12.124 > [HTTP] Request failed with code: 400
19:05:12.127 > [RETRY] Send failed, waiting 200 ms before retry
19:05:12.326 > [RETRY] Attempt 3/3 (nonce: 1)
19:05:12.326 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:12.332 > Sending pipeline data to server (604 bytes)
19:05:12.653 > [HTTP] Response code: 400
19:05:12.653 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:12.658 > [HTTP] Request failed with code: 400
19:05:12.661 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:05:12.667 > [RETRY] Consecutive failures: 2
19:05:12.670 > Health data send failed (retry count: 3/3)
19:05:12.672 > Health data transmission failed after max retries
19:05:12.773 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":64259,"type":"health_data_error"}
19:05:12.786 > [WebSocket] Processing message type: health_data_error
19:05:12.793 > [67.2] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:12.801 > ERROR state - attempting recovery
19:05:12.804 > [RETRY] Attempting to send health data (Max retries: 3)
19:05:12.808 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:05:12.812 > Generated health data: HR-61 SPO2-95 STEPS-344
19:05:12.817 > [ESP32] ========================================
19:05:12.820 > [ESP32] ENCRYPTION PIPELINE START
19:05:12.823 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:05:12.831 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:05:12.836 > [ESP32] ========================================
19:05:12.842 > [ESP32] MsgKeys: lfsrSeed=0x180C622D tnk[0..3]=4BBD19B0 trn[0..3]=4D5CAC84
19:05:12.848 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3334344D50
19:05:12.854 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3334344D5000000000000000 
19:05:12.862 > [ESP32][LFSR] Initializing - Seed: 0x180C622D SeedBe: 0x2D620C18 ChaosKey[0..3]: 4BBD19B0 InitialTap: 0x0029 State: 0x180C622D
19:05:12.873 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:05:12.881 > 3_After_LFSR (32): 6530212E4897A3B89D69F4E06966087C A2D442BBCA8FA0C238586D510FA779CB 
19:05:12.890 > [ESP32][LFSR] Keystream (first 16 bytes): 2D620C1879B7F0E8D25BD9D95C465B28
19:05:12.895 > [ESP32][4D] LFSR keystream (first 32 bytes): 2D620C1879B7F0E8D25BD9D95C465B28E7841196F9BB948F68586D510FA779CB
19:05:12.906 > [ESP32][TINKERBELL] Input (first 16 bytes): 6530212E4897A3B89D69F4E06966087C Nonce: 0x00000001 Buffer size: 32 bytes
19:05:12.915 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 4BBD19B0
19:05:12.925 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): EFD44D31CBBE0D25AF50914697FE5A64
19:05:12.934 > 4_After_Tinkerbell (32): 8AE46C1F8329AE9D323965A6FE985218 9EDD6A05E10EB64EA58FA43232169451 
19:05:12.942 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): EFD44D31CBBE0D25AF50914697FE5A64
19:05:12.951 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): EFD44D31CBBE0D25AF50914697FE5A643C0928BE2B81168C9DD7C9633DB1ED9A
19:05:12.959 > 5_After_Transposition (32): E19E1F39189832A432A5A6E49D298A6A AE6C0E83054E8F94526516FE3251DDB6 
19:05:12.967 > [ESP32] === HMAC DEBUG INFO ===
19:05:12.970 > [ESP32] HMAC Key being used: 3B69F0C5D996BAB6EF753A4951CF568F4BE3E4790B03567FC366991DF2290FA7
19:05:12.979 > [ESP32] HMAC Input length: 44 bytes
19:05:12.981 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001E19E1F39189832A432A5A6E49D298A6AAE6C0E83
19:05:12.992 > [ESP32] Nonce: 0x00000001
19:05:12.992 > [ESP32] Packet size before HMAC: 60
19:05:12.996 > [ESP32] Computed HMAC Tag: 164F8999E018B0992B4000DC20F775BC
19:05:13.000 > [ESP32] === END HMAC DEBUG ===
19:05:13.004 > 6_Final_Packet (60): 810217001700040800000001E19E1F39 189832A432A5A6E49D298A6AAE6C0E83 ...
19:05:13.012 > [RETRY] Attempt 1/3 (nonce: 1)
19:05:13.014 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:13.023 > Sending pipeline data to server (604 bytes)
19:05:13.370 > [HTTP] Response code: 400
19:05:13.370 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:13.376 > [HTTP] Request failed with code: 400
19:05:13.379 > [RETRY] Send failed, waiting 100 ms before retry
19:05:13.480 > [RETRY] Attempt 2/3 (nonce: 1)
19:05:13.480 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:13.486 > Sending pipeline data to server (604 bytes)
19:05:13.641 > [HTTP] Response code: 400
19:05:13.641 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:13.646 > [HTTP] Request failed with code: 400
19:05:13.650 > [RETRY] Send failed, waiting 200 ms before retry
19:05:13.847 > [RETRY] Attempt 3/3 (nonce: 1)
19:05:13.849 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:13.854 > Sending pipeline data to server (604 bytes)
19:05:14.136 > [HTTP] Response code: 400
19:05:14.136 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:14.142 > [HTTP] Request failed with code: 400
19:05:14.145 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:05:14.150 > [RETRY] Consecutive failures: 3
19:05:14.153 > ✗ Auto-recovery failed - restarting key exchange
19:05:16.259 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":64764,"type":"health_data_error"}
19:05:16.273 > [WebSocket] Processing message type: health_data_error
19:05:16.279 > [70.7] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:16.287 > ✓ Public key loaded from NVS
19:05:16.385 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":65034,"type":"health_data_error"}
19:05:16.399 > [WebSocket] Processing message type: health_data_error
19:05:16.404 > [70.8] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:16.508 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":65528,"type":"health_data_error"}
19:05:16.521 > [WebSocket] Processing message type: health_data_error
19:05:16.528 > [70.9] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:16.536 > Generating fresh master key from entropy...
19:05:16.544 > Generated master key (32): B6A3EC9E25E7CEDF6F1C09F68E7E5C61 BAFD2F67CFAEB0C223D03733696D0AC8 
19:05:16.550 > Using reduced master key (byte % 3) for NTRU encryption only
19:05:16.560 > NTRU encrypted master key (502): 0023006F00200017007E001B00080063 004400780039000C00010074006A006F ...
19:05:16.569 > POST http://10.249.92.115:8081/master-key
19:05:16.933 > ✓ Master key exchange completed
19:05:17.034 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":66260,"type":"health_data_error"}
19:05:17.048 > [WebSocket] Processing message type: health_data_error
19:05:17.054 > [71.4] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:17.061 > Loading master key from NVS and deriving symmetric keys...
19:05:17.067 > Loaded master key from NVS (32): B6A3EC9E25E7CEDF6F1C09F68E7E5C61 BAFD2F67CFAEB0C223D03733696D0AC8 
19:05:17.075 > Derived HMAC key (32): 65B2E06F9FA6A32353661762E4C4C923 D9530DA8D7AC2F58FB38DD2DB6774AF7 
19:05:17.084 > Derived Tinkerbell key (16): C61B945837FDC4384DB0C762B8803B69 
19:05:17.090 > Derived Transposition key (16): DA3AB427EB453DA65843EF3BDAD1514F 
19:05:17.095 > ✓ Symmetric keys derived successfully
19:05:17.097 > Nonce tracker reset - new session started
19:05:17.594 > Waiting for server to process master key...
19:05:17.598 > ✓ Symmetric keys ready - starting health data transmission
19:05:17.700 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":66524,"type":"health_data_error"}
19:05:17.714 > [WebSocket] Processing message type: health_data_error
19:05:17.720 > [72.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:17.822 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":7,"success":false,"timestamp":67058,"type":"health_data_error"}
19:05:17.837 > [WebSocket] Processing message type: health_data_error
19:05:17.842 > [72.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:17.944 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":8,"success":false,"timestamp":67776,"type":"health_data_error"}
19:05:17.959 > [WebSocket] Processing message type: health_data_error
19:05:17.965 > [72.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:18.067 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":8,"success":false,"timestamp":68046,"type":"health_data_error"}
19:05:18.081 > [WebSocket] Processing message type: health_data_error
19:05:18.086 > [72.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:18.190 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Failed to send health data","state":8,"success":false,"timestamp":68542,"type":"health_data_error"}
19:05:18.204 > [WebSocket] Processing message type: health_data_error
19:05:18.210 > [72.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:18.312 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125716693,"type":"master_key_received"}
19:05:18.334 > [WebSocket] Processing message type: master_key_received
19:05:18.334 > [72.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:18.434 > [WebSocket] Received (174 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":71332,"type":"master_key_exchanged"}
19:05:18.450 > [WebSocket] Processing message type: master_key_exchanged
19:05:18.456 > [72.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:18.555 > [WebSocket] Received (166 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":71999,"type":"symmetric_keys_derived"}
19:05:18.572 > [WebSocket] Processing message type: symmetric_keys_derived
19:05:18.577 > [73.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:18.677 > [73.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:18.779 > [73.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:18.879 > [73.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:18.980 > [73.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:19.081 > [73.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:19.182 > [73.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:19.283 > [73.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:19.383 > [73.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:19.485 > [73.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:19.586 > [74.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:19.687 > [74.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:19.788 > [74.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:19.889 > [74.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:19.990 > [74.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:20.091 > [74.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:20.192 > [74.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:20.292 > [74.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:20.394 > [74.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:20.495 > [74.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:20.596 > [75.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:20.697 > [75.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:20.798 > [75.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:20.899 > [75.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:21.000 > [75.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:21.101 > [75.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:21.202 > [75.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:21.302 > [75.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:21.404 > [75.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:21.505 > [75.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:21.606 > [76.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:21.707 > [76.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:21.808 > [76.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:21.908 > [76.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:22.010 > [76.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:22.111 > [76.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:22.212 > [76.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:22.313 > [76.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:22.414 > [76.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:22.515 > [76.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:22.616 > [77.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:22.717 > [77.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:22.818 > [77.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:22.919 > [77.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:23.020 > [77.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:23.121 > [77.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:23.222 > [77.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:23.333 > [77.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:23.424 > [77.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:23.525 > [77.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:23.626 > [78.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:23.727 > [78.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:23.827 > [78.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:23.929 > [78.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:24.030 > [78.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:24.131 > [78.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:24.232 > [78.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:24.333 > [78.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:24.434 > [78.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:24.535 > [78.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:24.636 > [79.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:24.736 > [79.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:24.838 > [79.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:24.939 > [79.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:25.040 > [79.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:25.141 > [79.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:25.242 > [79.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:25.342 > [79.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:25.444 > [79.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:25.545 > [79.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:25.646 > [80.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:25.747 > [80.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:25.847 > [80.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:25.949 > [80.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:26.050 > [80.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:26.151 > [80.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:26.252 > [80.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:26.352 > [80.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:26.454 > [80.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:26.555 > [81.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:26.656 > [81.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:26.757 > [81.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:26.858 > [81.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:26.958 > [81.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:27.060 > [81.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:27.161 > [81.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:27.262 > [81.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:27.363 > [81.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:27.464 > [81.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:27.564 > [82.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:27.665 > [82.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:05:27.671 > [RETRY] Attempting to send health data (Max retries: 3)
19:05:27.677 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:05:27.683 > Generated health data: HR-61 SPO2-95 STEPS-415
19:05:27.686 > [ESP32] ========================================
19:05:27.692 > [ESP32] ENCRYPTION PIPELINE START
19:05:27.694 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:05:27.703 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:05:27.708 > [ESP32] ========================================
19:05:27.711 > [ESP32] MsgKeys: lfsrSeed=0x38F29441 tnk[0..3]=8FD0EADD trn[0..3]=92B3BFB8
19:05:27.720 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3431354D50
19:05:27.725 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3431354D5000000000000000 
19:05:27.733 > [ESP32][LFSR] Initializing - Seed: 0x38F29441 SeedBe: 0x4194F238 ChaosKey[0..3]: 8FD0EADD InitialTap: 0x0029 State: 0x38F29441
19:05:27.744 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:05:27.753 > 3_After_LFSR (32): 09C6DF0EDDD11722BE146D09802A3966 700EE8D84EBCC25275D8CBC4D85B3874 
19:05:27.759 > [ESP32][LFSR] Keystream (first 16 bytes): 4194F238ECF14472F1264030B50A6A32
19:05:27.766 > [ESP32][4D] LFSR keystream (first 32 bytes): 4194F238ECF14472F1264030B50A6A32355EBBF57A8DF71F25D8CBC4D85B3874
19:05:27.774 > [ESP32][TINKERBELL] Input (first 16 bytes): 09C6DF0EDDD11722BE146D09802A3966 Nonce: 0x00000001 Buffer size: 32 bytes
19:05:27.786 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 8FD0EADD
19:05:27.797 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 380E11460313EF17B82220C44B6F451C
19:05:27.803 > 4_After_Tinkerbell (32): 31C8CE48DEC2F83506364DCDCB457C7A AFA9B34BB07BC82647345FA395BBAE5A 
19:05:27.811 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 380E11460313EF17B82220C44B6F451C
19:05:27.820 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 380E11460313EF17B82220C44B6F451CDFA75B93FEC70A7432EC94674DE0962E
19:05:27.831 > 5_After_Transposition (32): 4BA9B3AF35DEC2F8CD364D067ACB457C 48C8CE3126B07BC895AEBB5A475F34A3 
19:05:27.838 > [ESP32] === HMAC DEBUG INFO ===
19:05:27.841 > [ESP32] HMAC Key being used: 65B2E06F9FA6A32353661762E4C4C923D9530DA8D7AC2F58FB38DD2DB6774AF7
19:05:27.850 > [ESP32] HMAC Input length: 44 bytes
19:05:27.853 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000014BA9B3AF35DEC2F8CD364D067ACB457C48C8CE31
19:05:27.861 > [ESP32] Nonce: 0x00000001
19:05:27.864 > [ESP32] Packet size before HMAC: 60
19:05:27.866 > [ESP32] Computed HMAC Tag: DEED30AF9DEE49096EE30C680CE56A55
19:05:27.872 > [ESP32] === END HMAC DEBUG ===
19:05:27.874 > 6_Final_Packet (60): 8102170017000408000000014BA9B3AF 35DEC2F8CD364D067ACB457C48C8CE31 ...
19:05:27.883 > [RETRY] Attempt 1/3 (nonce: 1)
19:05:27.886 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:27.892 > Sending pipeline data to server (604 bytes)
19:05:28.143 > [HTTP] Response code: 200
19:05:28.144 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:05:28.153 > [RETRY] Health data sent successfully!
19:05:28.155 > ✓ Health data #3 sent successfully
19:05:28.257 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":2,"serverTime":1770125727996,"type":"security_update"}
19:05:28.273 > [WebSocket] Processing message type: security_update
19:05:28.279 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:05:28.285 > [82.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:28.390 > [WebSocket] Received (631 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:8102170017000408000000014BA9B3AF35DEC2F8CD364D067ACB457C48C8CE3126B07BC895AEBB5A475F34A3DEED30AF9DEE49096EE30C680CE56A55","pipeline":{"afterLFSR":"09C6DF0EDDD11722BE146D09802A3966700EE8D84EBCC25275D8CBC4D85B3874","afterSalt":"48522D36312053504F322D39352053544550532D3431354D50","afterTinkerbell":"31C8CE48DEC2F83506364DCDCB457C7AAFA9B34BB07BC82647345FA395BBAE5A","afterTransposition":"4BA9B3AF35DEC2F8CD364D067ACB457C48C8CE3126B07BC895AEBB5A475F34A3"},"plaintext":"HR-61 SPO2-95 STEPS-415","serverTime":1770125727996,"timestamp":82297,"type":"encryption_update","ztmEnabled":false}
19:05:28.446 > [WebSocket] Processing message type: encryption_update
19:05:28.452 > [82.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:28.554 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":415,"time":1770125727996,"type":"health_data_update"}
19:05:28.562 > [WebSocket] Processing message type: health_data_update
19:05:28.568 > [83.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:28.676 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2845,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-415","handshakeSuccess":true,"totalTime":0.2845},"type":"session_summary_update"}
19:05:28.698 > [WebSocket] Processing message type: session_summary_update
19:05:28.704 > [83.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:28.810 > [WebSocket] Received (656 bytes): {"decryptionTime":0.2845,"encryptedPacket":"8102170017000408000000014BA9B3AF35DEC2F8CD364D067ACB457C48C8CE3126B07BC895AEBB5A475F34A3DEED30AF9DEE49096EE30C680CE56A55","finalPlaintext":"HR-61 SPO2-95 STEPS-415","healthData":{"heartRate":61,"spo2":95,"steps":415},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D34313500000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3431354D5000000000000000","afterTinkerbell":"09C6DF0EDDD11722BE146D09802A3966700EE8D84EBCC25275D8CBC4D85B3874","afterTransposition":"31C8CE48DEC2F83506364DCDCB457C7AAFA9B34BB07BC82647345FA395BBAE5A"},"serverTime":1770125727997,"type":"decryption_update"}
19:05:28.868 > [WebSocket] Processing message type: decryption_update
19:05:28.873 > [WebSocket] Server decryption completed
19:05:28.876 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 415
19:05:28.882 > [83.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:28.984 > [WebSocket] Received (643 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":2,"pipeline":{"afterLFSR":"09C6DF0EDDD11722BE146D09802A3966700EE8D84EBCC25275D8CBC4D85B3874","afterSalt":"48522D36312053504F322D39352053544550532D3431354D50","afterTinkerbell":"31C8CE48DEC2F83506364DCDCB457C7AAFA9B34BB07BC82647345FA395BBAE5A","afterTransposition":"4BA9B3AF35DEC2F8CD364D067ACB457C48C8CE3126B07BC895AEBB5A475F34A3","finalPacket":"8102170017000408000000014BA9B3AF35DEC2F8CD364D067ACB457C48C8CE3126B07BC895AEBB5A475F34A3DEED30AF9DEE49096EE30C680CE56A55"},"plaintext":"HR-61 SPO2-95 STEPS-415","timestamp":82549,"type":"encryption_pipeline","ztmEnabled":false}
19:05:29.042 > [WebSocket] Processing message type: encryption_pipeline
19:05:29.046 > [83.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:29.149 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Health data #3 sent successfully","state":7,"success":true,"timestamp":82554,"type":"health_data_sent"}
19:05:29.165 > [WebSocket] Processing message type: health_data_sent
19:05:29.168 > [83.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:29.270 > [83.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:29.371 > [83.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:29.472 > [83.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:29.573 > [84.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:29.674 > [84.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:29.775 > [84.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:29.876 > [84.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:29.977 > [84.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:30.077 > [84.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:30.179 > [84.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:30.280 > [84.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:30.381 > [84.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:30.482 > [84.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:30.583 > [85.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:30.684 > [85.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:30.785 > [85.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:30.885 > [85.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:30.986 > [85.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:31.087 > [85.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:31.189 > [85.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:31.290 > [85.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:31.390 > [85.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:31.491 > [85.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:31.593 > [86.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:31.694 > [86.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:31.794 > [86.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:31.896 > [86.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:31.997 > [86.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:32.097 > [86.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:32.198 > [86.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:32.299 > [86.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:32.400 > [86.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:32.502 > [86.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:32.603 > [87.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:32.704 > [87.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:32.805 > [87.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:32.906 > [87.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:33.007 > [87.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:33.108 > [87.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:33.208 > [87.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:33.310 > [87.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:33.410 > [87.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:33.512 > [87.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:33.613 > [88.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:33.713 > [88.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:33.815 > [88.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:33.915 > [88.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:34.016 > [88.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:34.117 > [88.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:34.219 > [88.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:34.320 > [88.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:34.421 > [88.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:34.522 > [88.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:34.623 > [89.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:34.724 > [89.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:34.825 > [89.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:34.925 > [89.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:35.026 > [89.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:35.127 > [89.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:35.229 > [89.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:35.330 > [89.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:35.431 > [89.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:35.531 > [89.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:35.632 > [90.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:35.734 > [90.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:35.834 > [90.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:35.935 > [90.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:36.036 > [90.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:36.138 > [90.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:36.239 > [90.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:36.340 > [90.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:36.440 > [90.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:36.542 > [90.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:36.643 > [91.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:36.744 > [91.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:36.845 > [91.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:36.946 > [91.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:37.047 > [91.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:37.147 > [91.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:37.249 > [91.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:37.350 > [91.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:37.450 > [91.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:37.552 > [92.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:37.653 > [92.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:37.754 > [92.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:37.855 > [92.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:37.955 > [92.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:38.056 > [92.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:38.157 > [92.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:05:38.163 > [RETRY] Attempting to send health data (Max retries: 3)
19:05:38.170 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:05:38.174 > Generated health data: HR-61 SPO2-95 STEPS-468
19:05:38.178 > [ESP32] ========================================
19:05:38.184 > [ESP32] ENCRYPTION PIPELINE START
19:05:38.186 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:05:38.194 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:05:38.200 > [ESP32] ========================================
19:05:38.204 > [ESP32] MsgKeys: lfsrSeed=0xFD89E48B tnk[0..3]=ACEA6347 trn[0..3]=B1CF12F0
19:05:38.211 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3436384D50
19:05:38.217 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3436384D5000000000000000 
19:05:38.225 > [ESP32][LFSR] Initializing - Seed: 0xFD89E48B SeedBe: 0x8BE489FD ChaosKey[0..3]: ACEA6347 InitialTap: 0x0029 State: 0xFD89E48B
19:05:38.236 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:05:38.244 > 3_After_LFSR (32): C3B6A4CB5C98D42D519F735EE31A4508 EF498BCDB288B92CBA2CA444D387AB6F 
19:05:38.250 > [ESP32][LFSR] Keystream (first 16 bytes): 8BE489FD6DB8877D1EAD5E67D63A165C
19:05:38.258 > [ESP32][4D] LFSR keystream (first 32 bytes): 8BE489FD6DB8877D1EAD5E67D63A165CAA19D8E086BE8161EA2CA444D387AB6F
19:05:38.267 > [ESP32][TINKERBELL] Input (first 16 bytes): C3B6A4CB5C98D42D519F735EE31A4508 Nonce: 0x00000002 Buffer size: 32 bytes
19:05:38.278 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: ACEA6347
19:05:38.289 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A0FCBD8B9973C44F8499415E8E455AF4
19:05:38.294 > 4_After_Tinkerbell (32): 634A1940C5EB1062D50632006D5F1FFC C3E503776C4A7F87265CF29606E0E955 
19:05:38.303 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A0FCBD8B9973C44F8499415E8E455AF4
19:05:38.311 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A0FCBD8B9973C44F8499415E8E455AF42CAC88BADEC2C6AB9C7056D2D567423A
19:05:38.322 > 5_After_Transposition (32): 06E0E9556210EBC56C4A7F87FC1F5F6D C3E50377D5320600265CF29663194A40 
19:05:38.331 > [ESP32] === HMAC DEBUG INFO ===
19:05:38.333 > [ESP32] HMAC Key being used: 65B2E06F9FA6A32353661762E4C4C923D9530DA8D7AC2F58FB38DD2DB6774AF7
19:05:38.342 > [ESP32] HMAC Input length: 44 bytes
19:05:38.344 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000206E0E9556210EBC56C4A7F87FC1F5F6DC3E50377
19:05:38.353 > [ESP32] Nonce: 0x00000002
19:05:38.356 > [ESP32] Packet size before HMAC: 60
19:05:38.358 > [ESP32] Computed HMAC Tag: A5F6B70E9C1B1045D03D77E11D1EFED5
19:05:38.364 > [ESP32] === END HMAC DEBUG ===
19:05:38.367 > 6_Final_Packet (60): 81021700170004080000000206E0E955 6210EBC56C4A7F87FC1F5F6DC3E50377 ...
19:05:38.375 > [RETRY] Attempt 1/3 (nonce: 2)
19:05:38.377 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:38.384 > Sending pipeline data to server (604 bytes)
19:05:38.670 > [HTTP] Response code: 200
19:05:38.670 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:05:38.681 > [RETRY] Health data sent successfully!
19:05:38.683 > ✓ Health data #4 sent successfully
19:05:38.785 > [WebSocket] Received (631 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:81021700170004080000000206E0E9556210EBC56C4A7F87FC1F5F6DC3E50377D5320600265CF29663194A40A5F6B70E9C1B1045D03D77E11D1EFED5","pipeline":{"afterLFSR":"C3B6A4CB5C98D42D519F735EE31A4508EF498BCDB288B92CBA2CA444D387AB6F","afterSalt":"48522D36312053504F322D39352053544550532D3436384D50","afterTinkerbell":"634A1940C5EB1062D50632006D5F1FFCC3E503776C4A7F87265CF29606E0E955","afterTransposition":"06E0E9556210EBC56C4A7F87FC1F5F6DC3E50377D5320600265CF29663194A40"},"plaintext":"HR-61 SPO2-95 STEPS-468","serverTime":1770125738529,"timestamp":92789,"type":"encryption_update","ztmEnabled":false}
19:05:38.841 > [WebSocket] Processing message type: encryption_update
19:05:38.847 > [93.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:38.949 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":468,"time":1770125738530,"type":"health_data_update"}
19:05:38.957 > [WebSocket] Processing message type: health_data_update
19:05:38.962 > [93.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:39.071 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2673,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-468","handshakeSuccess":true,"totalTime":0.2673},"type":"session_summary_update"}
19:05:39.093 > [WebSocket] Processing message type: session_summary_update
19:05:39.098 > [93.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:39.205 > [WebSocket] Received (656 bytes): {"decryptionTime":0.2673,"encryptedPacket":"81021700170004080000000206E0E9556210EBC56C4A7F87FC1F5F6DC3E50377D5320600265CF29663194A40A5F6B70E9C1B1045D03D77E11D1EFED5","finalPlaintext":"HR-61 SPO2-95 STEPS-468","healthData":{"heartRate":61,"spo2":95,"steps":468},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D34363800000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3436384D5000000000000000","afterTinkerbell":"C3B6A4CB5C98D42D519F735EE31A4508EF498BCDB288B92CBA2CA444D387AB6F","afterTransposition":"634A1940C5EB1062D50632006D5F1FFCC3E503776C4A7F87265CF29606E0E955"},"serverTime":1770125738530,"type":"decryption_update"}
19:05:39.271 > [WebSocket] Processing message type: decryption_update
19:05:39.271 > [WebSocket] Server decryption completed
19:05:39.273 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 468
19:05:39.311 > [93.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:39.377 > [WebSocket] Received (643 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":3,"pipeline":{"afterLFSR":"C3B6A4CB5C98D42D519F735EE31A4508EF498BCDB288B92CBA2CA444D387AB6F","afterSalt":"48522D36312053504F322D39352053544550532D3436384D50","afterTinkerbell":"634A1940C5EB1062D50632006D5F1FFCC3E503776C4A7F87265CF29606E0E955","afterTransposition":"06E0E9556210EBC56C4A7F87FC1F5F6DC3E50377D5320600265CF29663194A40","finalPacket":"81021700170004080000000206E0E9556210EBC56C4A7F87FC1F5F6DC3E50377D5320600265CF29663194A40A5F6B70E9C1B1045D03D77E11D1EFED5"},"plaintext":"HR-61 SPO2-95 STEPS-468","timestamp":93076,"type":"encryption_pipeline","ztmEnabled":false}
19:05:39.437 > [WebSocket] Processing message type: encryption_pipeline
19:05:39.441 > [93.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:39.542 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Health data #4 sent successfully","state":7,"success":true,"timestamp":93080,"type":"health_data_sent"}
19:05:39.558 > [WebSocket] Processing message type: health_data_sent
19:05:39.561 > [94.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:39.664 > [94.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:39.764 > [94.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:39.866 > [94.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:39.967 > [94.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:40.067 > [94.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:40.169 > [94.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:40.269 > [94.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:40.370 > [94.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:40.472 > [94.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:40.573 > [95.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:40.673 > [95.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:40.775 > [95.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:40.875 > [95.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:40.976 > [95.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:41.078 > [95.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:41.178 > [95.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:41.280 > [95.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:41.380 > [95.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:41.482 > [95.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:41.583 > [96.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:41.684 > [96.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:41.784 > [96.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:41.885 > [96.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:41.986 > [96.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:42.088 > [96.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:42.189 > [96.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:42.289 > [96.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:42.390 > [96.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:42.491 > [96.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:42.593 > [97.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:42.694 > [97.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:42.795 > [97.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:42.896 > [97.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:42.997 > [97.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:43.097 > [97.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:43.199 > [97.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:43.300 > [97.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:43.400 > [97.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:43.501 > [97.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:43.602 > [98.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:43.703 > [98.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:43.804 > [98.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:43.905 > [98.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:44.007 > [98.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:44.108 > [98.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:44.208 > [98.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:44.310 > [98.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:44.411 > [98.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:44.511 > [98.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:44.613 > [99.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:44.713 > [99.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:44.815 > [99.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:44.915 > [99.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:45.016 > [99.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:45.117 > [99.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:45.219 > [99.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:45.319 > [99.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:45.421 > [99.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:45.521 > [99.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:45.622 > [100.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:45.723 > [100.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:45.824 > [100.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:45.925 > [100.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:46.026 > [100.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:46.127 > [100.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:46.228 > [100.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:46.330 > [100.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:46.430 > [100.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:46.532 > [100.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:46.632 > [101.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:46.733 > [101.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:46.834 > [101.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:46.935 > [101.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:47.037 > [101.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:47.138 > [101.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:47.238 > [101.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:47.339 > [101.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:47.441 > [101.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:47.541 > [101.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:47.642 > [102.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:47.743 > [102.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:47.844 > [102.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:47.945 > [102.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:48.046 > [102.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:48.147 > [102.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:48.249 > [102.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:48.349 > [102.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:48.450 > [102.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:48.552 > [103.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:48.652 > [103.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:48.753 > [103.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:48.759 > [RETRY] Attempting to send health data (Max retries: 3)
19:05:48.765 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:05:48.770 > Generated health data: HR-61 SPO2-95 STEPS-548
19:05:48.773 > [ESP32] ========================================
19:05:48.779 > [ESP32] ENCRYPTION PIPELINE START
19:05:48.781 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:05:48.790 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:05:48.796 > [ESP32] ========================================
19:05:48.801 > [ESP32] MsgKeys: lfsrSeed=0x24A9744A tnk[0..3]=BBD70AAE trn[0..3]=E46F0518
19:05:48.807 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3534384D50
19:05:48.812 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3534384D5000000000000000 
19:05:48.821 > [ESP32][LFSR] Initializing - Seed: 0x24A9744A SeedBe: 0x4A74A924 ChaosKey[0..3]: BBD70AAE InitialTap: 0x0029 State: 0x24A9744A
19:05:48.832 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:05:48.840 > 3_After_LFSR (32): 022684125DA62C235887EE46C1FD1AEF 704B396CCF4FB525248DDB1C48034FF3 
19:05:48.847 > [ESP32][LFSR] Keystream (first 16 bytes): 4A74A9246C867F7317B5C37FF4DD49BB
19:05:48.854 > [ESP32][4D] LFSR keystream (first 32 bytes): 4A74A9246C867F7317B5C37FF4DD49BB351B6A41FA7B8D68748DDB1C48034FF3
19:05:48.862 > [ESP32][TINKERBELL] Input (first 16 bytes): 022684125DA62C235887EE46C1FD1AEF Nonce: 0x00000003 Buffer size: 32 bytes
19:05:48.875 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: BBD70AAE
19:05:48.884 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): F5600709E6E85E2EB504441F349F42FB
19:05:48.892 > 4_After_Tinkerbell (32): F746831BBB4E720DED83AA59F5625814 DD507E4153E6B493E6FBD7123D9D3724 
19:05:48.898 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): F5600709E6E85E2EB504441F349F42FB
19:05:48.907 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): F5600709E6E85E2EB504441F349F42FBAD1B472D9CA901B6C2760C0E759E78D7
19:05:48.918 > 5_After_Transposition (32): ED83AA59F746831B53E6B493BB4E720D 50DD417E249D373DE6FBD712F5625814 
19:05:48.926 > [ESP32] === HMAC DEBUG INFO ===
19:05:48.929 > [ESP32] HMAC Key being used: 65B2E06F9FA6A32353661762E4C4C923D9530DA8D7AC2F58FB38DD2DB6774AF7
19:05:48.938 > [ESP32] HMAC Input length: 44 bytes
19:05:48.940 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000003ED83AA59F746831B53E6B493BB4E720D50DD417E
19:05:48.949 > [ESP32] Nonce: 0x00000003
19:05:48.952 > [ESP32] Packet size before HMAC: 60
19:05:48.954 > [ESP32] Computed HMAC Tag: 595401532A18642A109A165160B6EA7C
19:05:48.960 > [ESP32] === END HMAC DEBUG ===
19:05:48.963 > 6_Final_Packet (60): 810217001700040800000003ED83AA59 F746831B53E6B493BB4E720D50DD417E ...
19:05:48.971 > [RETRY] Attempt 1/3 (nonce: 3)
19:05:48.974 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:48.980 > Sending pipeline data to server (605 bytes)
19:05:49.157 > [HTTP] Response code: 400
19:05:49.157 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:49.163 > [HTTP] Request failed with code: 400
19:05:49.165 > [RETRY] Send failed, waiting 100 ms before retry
19:05:49.265 > [RETRY] Attempt 2/3 (nonce: 3)
19:05:49.265 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:49.271 > Sending pipeline data to server (605 bytes)
19:05:49.424 > [HTTP] Response code: 400
19:05:49.424 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:49.429 > [HTTP] Request failed with code: 400
19:05:49.432 > [RETRY] Send failed, waiting 200 ms before retry
19:05:49.633 > [RETRY] Attempt 3/3 (nonce: 3)
19:05:49.633 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:49.639 > Sending pipeline data to server (605 bytes)
19:05:49.921 > [HTTP] Response code: 400
19:05:49.922 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:49.927 > [HTTP] Request failed with code: 400
19:05:49.930 > [RETRY] All retry attempts failed - rolled back nonce to 2
19:05:49.935 > [RETRY] Consecutive failures: 1
19:05:49.938 > Health data send failed (retry count: 1/3)
19:05:50.042 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":103563,"type":"health_data_error"}
19:05:50.056 > [WebSocket] Processing message type: health_data_error
19:05:50.062 > [104.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:50.070 > [RETRY] Attempting to send health data (Max retries: 3)
19:05:50.075 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:05:50.081 > Generated health data: HR-61 SPO2-95 STEPS-525
19:05:50.083 > [ESP32] ========================================
19:05:50.089 > [ESP32] ENCRYPTION PIPELINE START
19:05:50.092 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:05:50.098 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:05:50.106 > [ESP32] ========================================
19:05:50.109 > [ESP32] MsgKeys: lfsrSeed=0x24A9744A tnk[0..3]=BBD70AAE trn[0..3]=E46F0518
19:05:50.114 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3532354D50
19:05:50.122 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3532354D5000000000000000 
19:05:50.131 > [ESP32][LFSR] Initializing - Seed: 0x24A9744A SeedBe: 0x4A74A924 ChaosKey[0..3]: BBD70AAE InitialTap: 0x0029 State: 0x24A9744A
19:05:50.142 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:05:50.147 > 3_After_LFSR (32): 022684125DA62C235887EE46C1FD1AEF 704B396CCF49B825248DDB1C48034FF3 
19:05:50.156 > [ESP32][LFSR] Keystream (first 16 bytes): 4A74A9246C867F7317B5C37FF4DD49BB
19:05:50.164 > [ESP32][4D] LFSR keystream (first 32 bytes): 4A74A9246C867F7317B5C37FF4DD49BB351B6A41FA7B8D68748DDB1C48034FF3
19:05:50.173 > [ESP32][TINKERBELL] Input (first 16 bytes): 022684125DA62C235887EE46C1FD1AEF Nonce: 0x00000003 Buffer size: 32 bytes
19:05:50.183 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: BBD70AAE
19:05:50.192 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): F5600709E6E85E2EB504441F349F42FB
19:05:50.200 > 4_After_Tinkerbell (32): F746831BBB4E720DED83AA59F5625814 DD507E4153E0B993E6FBD7123D9D3724 
19:05:50.208 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): F5600709E6E85E2EB504441F349F42FB
19:05:50.217 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): F5600709E6E85E2EB504441F349F42FBAD1B472D9CA901B6C2760C0E759E78D7
19:05:50.228 > 5_After_Transposition (32): ED83AA59F746831B53E0B993BB4E720D 50DD417E249D373DE6FBD712F5625814 
19:05:50.236 > [ESP32] === HMAC DEBUG INFO ===
19:05:50.239 > [ESP32] HMAC Key being used: 65B2E06F9FA6A32353661762E4C4C923D9530DA8D7AC2F58FB38DD2DB6774AF7
19:05:50.245 > [ESP32] HMAC Input length: 44 bytes
19:05:50.250 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000003ED83AA59F746831B53E0B993BB4E720D50DD417E
19:05:50.258 > [ESP32] Nonce: 0x00000003
19:05:50.261 > [ESP32] Packet size before HMAC: 60
19:05:50.264 > [ESP32] Computed HMAC Tag: 25B57AE5401F8545A0C7496B4219062B
19:05:50.270 > [ESP32] === END HMAC DEBUG ===
19:05:50.272 > 6_Final_Packet (60): 810217001700040800000003ED83AA59 F746831B53E0B993BB4E720D50DD417E ...
19:05:50.281 > [RETRY] Attempt 1/3 (nonce: 3)
19:05:50.281 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:50.286 > Sending pipeline data to server (605 bytes)
19:05:50.414 > [HTTP] Response code: 400
19:05:50.414 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:50.420 > [HTTP] Request failed with code: 400
19:05:50.422 > [RETRY] Send failed, waiting 100 ms before retry
19:05:50.522 > [RETRY] Attempt 2/3 (nonce: 3)
19:05:50.522 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:50.527 > Sending pipeline data to server (605 bytes)
19:05:50.679 > [HTTP] Response code: 400
19:05:50.718 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:50.718 > [HTTP] Request failed with code: 400
19:05:50.718 > [RETRY] Send failed, waiting 200 ms before retry
19:05:50.886 > [RETRY] Attempt 3/3 (nonce: 3)
19:05:50.888 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:50.892 > Sending pipeline data to server (605 bytes)
19:05:51.183 > [HTTP] Response code: 400
19:05:51.190 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:51.190 > [HTTP] Request failed with code: 400
19:05:51.192 > [RETRY] All retry attempts failed - rolled back nonce to 2
19:05:51.197 > [RETRY] Consecutive failures: 2
19:05:51.205 > Health data send failed (retry count: 2/3)
19:05:51.302 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":103830,"type":"health_data_error"}
19:05:51.316 > [WebSocket] Processing message type: health_data_error
19:05:51.322 > [105.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:51.330 > [RETRY] Attempting to send health data (Max retries: 3)
19:05:51.336 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:05:51.341 > Generated health data: HR-61 SPO2-95 STEPS-546
19:05:51.344 > [ESP32] ========================================
19:05:51.352 > [ESP32] ENCRYPTION PIPELINE START
19:05:51.352 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:05:51.357 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:05:51.366 > [ESP32] ========================================
19:05:51.368 > [ESP32] MsgKeys: lfsrSeed=0x24A9744A tnk[0..3]=BBD70AAE trn[0..3]=E46F0518
19:05:51.374 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3534364D50
19:05:51.383 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3534364D5000000000000000 
19:05:51.391 > [ESP32][LFSR] Initializing - Seed: 0x24A9744A SeedBe: 0x4A74A924 ChaosKey[0..3]: BBD70AAE InitialTap: 0x0029 State: 0x24A9744A
19:05:51.402 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:05:51.407 > 3_After_LFSR (32): 022684125DA62C235887EE46C1FD1AEF 704B396CCF4FBB25248DDB1C48034FF3 
19:05:51.416 > [ESP32][LFSR] Keystream (first 16 bytes): 4A74A9246C867F7317B5C37FF4DD49BB
19:05:51.424 > [ESP32][4D] LFSR keystream (first 32 bytes): 4A74A9246C867F7317B5C37FF4DD49BB351B6A41FA7B8D68748DDB1C48034FF3
19:05:51.432 > [ESP32][TINKERBELL] Input (first 16 bytes): 022684125DA62C235887EE46C1FD1AEF Nonce: 0x00000003 Buffer size: 32 bytes
19:05:51.444 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: BBD70AAE
19:05:51.453 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): F5600709E6E85E2EB504441F349F42FB
19:05:51.460 > 4_After_Tinkerbell (32): F746831BBB4E720DED83AA59F5625814 DD507E4153E6BA93E6FBD7123D9D3724 
19:05:51.469 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): F5600709E6E85E2EB504441F349F42FB
19:05:51.477 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): F5600709E6E85E2EB504441F349F42FBAD1B472D9CA901B6C2760C0E759E78D7
19:05:51.488 > 5_After_Transposition (32): ED83AA59F746831B53E6BA93BB4E720D 50DD417E249D373DE6FBD712F5625814 
19:05:51.496 > [ESP32] === HMAC DEBUG INFO ===
19:05:51.498 > [ESP32] HMAC Key being used: 65B2E06F9FA6A32353661762E4C4C923D9530DA8D7AC2F58FB38DD2DB6774AF7
19:05:51.505 > [ESP32] HMAC Input length: 44 bytes
19:05:51.510 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000003ED83AA59F746831B53E6BA93BB4E720D50DD417E
19:05:51.518 > [ESP32] Nonce: 0x00000003
19:05:51.522 > [ESP32] Packet size before HMAC: 60
19:05:51.524 > [ESP32] Computed HMAC Tag: A8672805C9248081A0AEB5FD58A26A9F
19:05:51.530 > [ESP32] === END HMAC DEBUG ===
19:05:51.533 > 6_Final_Packet (60): 810217001700040800000003ED83AA59 F746831B53E6BA93BB4E720D50DD417E ...
19:05:51.541 > [RETRY] Attempt 1/3 (nonce: 3)
19:05:51.541 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:51.546 > Sending pipeline data to server (605 bytes)
19:05:51.895 > [HTTP] Response code: 400
19:05:51.895 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:51.900 > [HTTP] Request failed with code: 400
19:05:51.904 > [RETRY] Send failed, waiting 100 ms before retry
19:05:52.003 > [RETRY] Attempt 2/3 (nonce: 3)
19:05:52.003 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:52.009 > Sending pipeline data to server (605 bytes)
19:05:52.177 > [HTTP] Response code: 400
19:05:52.179 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:52.183 > [HTTP] Request failed with code: 400
19:05:52.186 > [RETRY] Send failed, waiting 200 ms before retry
19:05:52.386 > [RETRY] Attempt 3/3 (nonce: 3)
19:05:52.386 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:52.393 > Sending pipeline data to server (605 bytes)
19:05:52.674 > [HTTP] Response code: 400
19:05:52.674 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:52.680 > [HTTP] Request failed with code: 400
19:05:52.683 > [RETRY] All retry attempts failed - rolled back nonce to 2
19:05:52.688 > [RETRY] Consecutive failures: 3
19:05:52.691 > Health data send failed (retry count: 3/3)
19:05:52.694 > Health data transmission failed after max retries
19:05:52.794 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":104327,"type":"health_data_error"}
19:05:52.807 > [WebSocket] Processing message type: health_data_error
19:05:52.814 > [107.2] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:52.822 > ERROR state - attempting recovery
19:05:52.824 > [RETRY] Attempting to send health data (Max retries: 3)
19:05:52.830 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:05:52.833 > Generated health data: HR-61 SPO2-95 STEPS-550
19:05:52.838 > [ESP32] ========================================
19:05:52.842 > [ESP32] ENCRYPTION PIPELINE START
19:05:52.844 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:05:52.855 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:05:52.858 > [ESP32] ========================================
19:05:52.863 > [ESP32] MsgKeys: lfsrSeed=0x24A9744A tnk[0..3]=BBD70AAE trn[0..3]=E46F0518
19:05:52.869 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3535304D50
19:05:52.875 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3535304D5000000000000000 
19:05:52.883 > [ESP32][LFSR] Initializing - Seed: 0x24A9744A SeedBe: 0x4A74A924 ChaosKey[0..3]: BBD70AAE InitialTap: 0x0029 State: 0x24A9744A
19:05:52.915 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:05:52.915 > 3_After_LFSR (32): 022684125DA62C235887EE46C1FD1AEF 704B396CCF4EBD25248DDB1C48034FF3 
19:05:52.915 > [ESP32][LFSR] Keystream (first 16 bytes): 4A74A9246C867F7317B5C37FF4DD49BB
19:05:52.932 > [ESP32][4D] LFSR keystream (first 32 bytes): 4A74A9246C867F7317B5C37FF4DD49BB351B6A41FA7B8D68748DDB1C48034FF3
19:05:52.932 > [ESP32][TINKERBELL] Input (first 16 bytes): 022684125DA62C235887EE46C1FD1AEF Nonce: 0x00000003 Buffer size: 32 bytes
19:05:52.968 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: BBD70AAE
19:05:52.968 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): F5600709E6E85E2EB504441F349F42FB
19:05:52.968 > 4_After_Tinkerbell (32): F746831BBB4E720DED83AA59F5625814 DD507E4153E7BC93E6FBD7123D9D3724 
19:05:52.968 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): F5600709E6E85E2EB504441F349F42FB
19:05:52.975 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): F5600709E6E85E2EB504441F349F42FBAD1B472D9CA901B6C2760C0E759E78D7
19:05:52.981 > 5_After_Transposition (32): ED83AA59F746831B53E7BC93BB4E720D 50DD417E249D373DE6FBD712F5625814 
19:05:52.989 > [ESP32] === HMAC DEBUG INFO ===
19:05:52.991 > [ESP32] HMAC Key being used: 65B2E06F9FA6A32353661762E4C4C923D9530DA8D7AC2F58FB38DD2DB6774AF7
19:05:53.012 > [ESP32] HMAC Input length: 44 bytes
19:05:53.012 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000003ED83AA59F746831B53E7BC93BB4E720D50DD417E
19:05:53.020 > [ESP32] Nonce: 0x00000003
19:05:53.020 > [ESP32] Packet size before HMAC: 60
19:05:53.020 > [ESP32] Computed HMAC Tag: 3AD274EB17ED4B329AC0B78F44453666
19:05:53.023 > [ESP32] === END HMAC DEBUG ===
19:05:53.026 > 6_Final_Packet (60): 810217001700040800000003ED83AA59 F746831B53E7BC93BB4E720D50DD417E ...
19:05:53.033 > [RETRY] Attempt 1/3 (nonce: 3)
19:05:53.036 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:53.041 > Sending pipeline data to server (605 bytes)
19:05:53.198 > [HTTP] Response code: 400
19:05:53.198 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:53.204 > [HTTP] Request failed with code: 400
19:05:53.208 > [RETRY] Send failed, waiting 100 ms before retry
19:05:53.309 > [RETRY] Attempt 2/3 (nonce: 3)
19:05:53.310 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:53.316 > Sending pipeline data to server (605 bytes)
19:05:53.438 > [HTTP] Response code: 400
19:05:53.438 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:53.444 > [HTTP] Request failed with code: 400
19:05:53.447 > [RETRY] Send failed, waiting 200 ms before retry
19:05:53.645 > [RETRY] Attempt 3/3 (nonce: 3)
19:05:53.645 > POST http://10.249.92.115:8081/health-data with pipeline data
19:05:53.650 > Sending pipeline data to server (605 bytes)
19:05:53.957 > [HTTP] Response code: 400
19:05:53.957 > [HTTP] Error response: {"error":"Decryption failed"}
19:05:53.963 > [HTTP] Request failed with code: 400
19:05:53.966 > [RETRY] All retry attempts failed - rolled back nonce to 2
19:05:53.972 > [RETRY] Consecutive failures: 4
19:05:53.975 > ✗ Auto-recovery failed - restarting key exchange
19:05:56.078 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":104821,"type":"health_data_error"}
19:05:56.092 > [WebSocket] Processing message type: health_data_error
19:05:56.097 > [110.5] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:56.105 > ✓ Public key loaded from NVS
19:05:56.204 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":105086,"type":"health_data_error"}
19:05:56.217 > [WebSocket] Processing message type: health_data_error
19:05:56.223 > [110.6] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:56.326 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":105590,"type":"health_data_error"}
19:05:56.340 > [WebSocket] Processing message type: health_data_error
19:05:56.346 > [110.7] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:56.354 > Generating fresh master key from entropy...
19:05:56.363 > Generated master key (32): 40CBBF820C5B0B92868207B9622E5E2A 74A84CDBC1DDC00B4EAD5A8781729848 
19:05:56.369 > Using reduced master key (byte % 3) for NTRU encryption only
19:05:56.377 > NTRU encrypted master key (502): 0022007000200016007D001C00080064 00460078003A000E000200750069006E ...
19:05:56.386 > POST http://10.249.92.115:8081/master-key
19:05:56.716 > ✓ Master key exchange completed
19:05:56.817 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":106301,"type":"health_data_error"}
19:05:56.831 > [WebSocket] Processing message type: health_data_error
19:05:56.837 > [111.2] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:56.846 > Loading master key from NVS and deriving symmetric keys...
19:05:56.853 > Loaded master key from NVS (32): 40CBBF820C5B0B92868207B9622E5E2A 74A84CDBC1DDC00B4EAD5A8781729848 
19:05:56.859 > Derived HMAC key (32): F70AB55ADD99B5D8354164D0B5FDFCA4 0DAFF2932653195326AE2BBF05653E6C 
19:05:56.868 > Derived Tinkerbell key (16): E5D2A759E3C6571E8555ECC17E07187F 
19:05:56.873 > Derived Transposition key (16): 6AFD4A0576B116504282680F0F3C647C 
19:05:56.879 > ✓ Symmetric keys derived successfully
19:05:56.881 > Nonce tracker reset - new session started
19:05:57.376 > Waiting for server to process master key...
19:05:57.381 > ✓ Symmetric keys ready - starting health data transmission
19:05:57.483 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":106585,"type":"health_data_error"}
19:05:57.497 > [WebSocket] Processing message type: health_data_error
19:05:57.502 > [111.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:57.606 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":107081,"type":"health_data_error"}
19:05:57.619 > [WebSocket] Processing message type: health_data_error
19:05:57.625 > [112.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:57.727 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":8,"success":false,"timestamp":107605,"type":"health_data_error"}
19:05:57.771 > [WebSocket] Processing message type: health_data_error
19:05:57.771 > [112.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:57.852 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":8,"success":false,"timestamp":107845,"type":"health_data_error"}
19:05:57.867 > [WebSocket] Processing message type: health_data_error
19:05:57.871 > [112.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:57.974 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":8,"success":false,"timestamp":108364,"type":"health_data_error"}
19:05:57.988 > [WebSocket] Processing message type: health_data_error
19:05:57.994 > [112.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:58.096 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125756492,"type":"master_key_received"}
19:05:58.111 > [WebSocket] Processing message type: master_key_received
19:05:58.113 > [112.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:58.219 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":111115,"type":"master_key_exchanged"}
19:05:58.235 > [WebSocket] Processing message type: master_key_exchanged
19:05:58.241 > [112.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:58.341 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":111783,"type":"symmetric_keys_derived"}
19:05:58.357 > [WebSocket] Processing message type: symmetric_keys_derived
19:05:58.363 > [112.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:58.462 > [112.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:58.563 > [113.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:58.664 > [113.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:58.765 > [113.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:58.866 > [113.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:58.967 > [113.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:59.067 > [113.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:59.168 > [113.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:59.270 > [113.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:59.371 > [113.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:59.472 > [113.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:59.573 > [114.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:59.674 > [114.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:59.775 > [114.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:59.876 > [114.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:05:59.977 > [114.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:00.077 > [114.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:00.179 > [114.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:00.280 > [114.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:00.381 > [114.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:00.482 > [114.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:00.583 > [115.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:00.684 > [115.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:00.785 > [115.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:00.886 > [115.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:00.986 > [115.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:01.088 > [115.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:01.189 > [115.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:01.290 > [115.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:01.391 > [115.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:01.492 > [115.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:01.593 > [116.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:01.694 > [116.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:01.794 > [116.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:01.896 > [116.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:01.996 > [116.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:02.097 > [116.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:02.198 > [116.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:02.300 > [116.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:02.400 > [116.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:02.502 > [116.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:02.603 > [117.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:02.704 > [117.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:02.805 > [117.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:02.905 > [117.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:03.007 > [117.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:03.108 > [117.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:03.208 > [117.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:03.310 > [117.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:03.411 > [117.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:03.512 > [117.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:03.613 > [118.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:03.714 > [118.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:03.815 > [118.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:03.916 > [118.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:04.017 > [118.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:04.117 > [118.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:04.219 > [118.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:04.319 > [118.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:04.421 > [118.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:04.522 > [118.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:04.623 > [119.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:04.724 > [119.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:04.825 > [119.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:04.926 > [119.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:05.026 > [119.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:05.128 > [119.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:05.229 > [119.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:05.330 > [119.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:05.430 > [119.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:05.532 > [119.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:05.633 > [120.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:05.733 > [120.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:05.835 > [120.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:05.935 > [120.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:06.037 > [120.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:06.137 > [120.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:06.239 > [120.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:06.340 > [120.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:06.441 > [120.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:06.541 > [120.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:06.643 > [121.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:06.744 > [121.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:06.844 > [121.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:06.946 > [121.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:07.047 > [121.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:07.147 > [121.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:07.248 > [121.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:07.350 > [121.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:07.450 > [121.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:07.457 > [RETRY] Attempting to send health data (Max retries: 3)
19:06:07.462 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:06:07.469 > Generated health data: HR-62 SPO2-95 STEPS-645
19:06:07.471 > [ESP32] ========================================
19:06:07.476 > [ESP32] ENCRYPTION PIPELINE START
19:06:07.479 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:06:07.488 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:06:07.493 > [ESP32] ========================================
19:06:07.499 > [ESP32] MsgKeys: lfsrSeed=0xFC056931 tnk[0..3]=044FD0B3 trn[0..3]=260CE053
19:06:07.504 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3634354D50
19:06:07.510 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3634354D5000000000000000 
19:06:07.518 > [ESP32][LFSR] Initializing - Seed: 0xFC056931 SeedBe: 0x316905FC ChaosKey[0..3]: 044FD0B3 InitialTap: 0x0029 State: 0xFC056931
19:06:07.529 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:06:07.538 > 3_After_LFSR (32): 793B28CACA89231E0E33353B45E6C3BD 2D666642C993770E0F7613FC66B17590 
19:06:07.546 > [ESP32][LFSR] Keystream (first 16 bytes): 316905FCF8A9704E4101180270C690E9
19:06:07.551 > [ESP32][4D] LFSR keystream (first 32 bytes): 316905FCF8A9704E4101180270C690E96836356FFFA742435F7613FC66B17590
19:06:07.560 > [ESP32][TINKERBELL] Input (first 16 bytes): 793B28CACA89231E0E33353B45E6C3BD Nonce: 0x00000001 Buffer size: 32 bytes
19:06:07.571 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 044FD0B3
19:06:07.588 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FE99F8C0BB15DD5194AFDAC8161CCEEB
19:06:07.590 > 4_After_Tinkerbell (32): 87A2D00A719CFE4F9A9CEFF353FA0D56 A09E3A38BB967B4ED3DFB81C82A98F2D 
19:06:07.596 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FE99F8C0BB15DD5194AFDAC8161CCEEB
19:06:07.604 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FE99F8C0BB15DD5194AFDAC8161CCEEB8DF85C7A72050C40DCA9ABE0E418FABD
19:06:07.616 > 5_After_Transposition (32): 0A7B4ED0BB9CA29A38FE4FEF71969CA0 F30D563A53FA9E871C2DA9B88FD3DF82 
19:06:07.623 > [ESP32] === HMAC DEBUG INFO ===
19:06:07.626 > [ESP32] HMAC Key being used: F70AB55ADD99B5D8354164D0B5FDFCA40DAFF2932653195326AE2BBF05653E6C
19:06:07.635 > [ESP32] HMAC Input length: 44 bytes
19:06:07.638 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000010A7B4ED0BB9CA29A38FE4FEF71969CA0F30D563A
19:06:07.646 > [ESP32] Nonce: 0x00000001
19:06:07.649 > [ESP32] Packet size before HMAC: 60
19:06:07.651 > [ESP32] Computed HMAC Tag: 1B5919937E52D1018ED2C99D6A2311CF
19:06:07.657 > [ESP32] === END HMAC DEBUG ===
19:06:07.660 > 6_Final_Packet (60): 8102170017000408000000010A7B4ED0 BB9CA29A38FE4FEF71969CA0F30D563A ...
19:06:07.668 > [RETRY] Attempt 1/3 (nonce: 1)
19:06:07.671 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:07.678 > Sending pipeline data to server (605 bytes)
19:06:07.967 > [HTTP] Response code: 400
19:06:07.967 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:07.973 > [HTTP] Request failed with code: 400
19:06:07.976 > [RETRY] Send failed, waiting 100 ms before retry
19:06:08.075 > [RETRY] Attempt 2/3 (nonce: 1)
19:06:08.076 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:08.081 > Sending pipeline data to server (605 bytes)
19:06:08.229 > [HTTP] Response code: 400
19:06:08.229 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:08.235 > [HTTP] Request failed with code: 400
19:06:08.237 > [RETRY] Send failed, waiting 200 ms before retry
19:06:08.436 > [RETRY] Attempt 3/3 (nonce: 1)
19:06:08.436 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:08.443 > Sending pipeline data to server (605 bytes)
19:06:08.723 > [HTTP] Response code: 400
19:06:08.723 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:08.729 > [HTTP] Request failed with code: 400
19:06:08.732 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:06:08.737 > [RETRY] Consecutive failures: 5
19:06:08.740 > [EMERGENCY] Triggering emergency reset!
19:06:08.743 > [CRYPTO] Resetting cryptographic state
19:06:08.748 > [CRYPTO] Crypto state reset complete
19:06:08.751 > [CRYPTO] Packet counter: 2
19:06:08.754 > [EMERGENCY] Emergency reset complete
19:06:08.757 > Health data send failed (retry count: 1/3)
19:06:08.852 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":122375,"type":"health_data_error"}
19:06:08.867 > [WebSocket] Processing message type: health_data_error
19:06:08.872 > [123.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:08.880 > [RETRY] Attempting to send health data (Max retries: 3)
19:06:08.887 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:06:08.891 > Generated health data: HR-62 SPO2-95 STEPS-663
19:06:08.894 > [ESP32] ========================================
19:06:08.900 > [ESP32] ENCRYPTION PIPELINE START
19:06:08.902 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:06:08.908 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:06:08.917 > [ESP32] ========================================
19:06:08.920 > [ESP32] MsgKeys: lfsrSeed=0xFC056931 tnk[0..3]=044FD0B3 trn[0..3]=260CE053
19:06:08.925 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3636334D50
19:06:08.934 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3636334D5000000000000000 
19:06:08.942 > [ESP32][LFSR] Initializing - Seed: 0xFC056931 SeedBe: 0x316905FC ChaosKey[0..3]: 044FD0B3 InitialTap: 0x0029 State: 0xFC056931
19:06:08.953 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:06:08.958 > 3_After_LFSR (32): 793B28CACA89231E0E33353B45E6C3BD 2D666642C991710E0F7613FC66B17590 
19:06:08.967 > [ESP32][LFSR] Keystream (first 16 bytes): 316905FCF8A9704E4101180270C690E9
19:06:08.974 > [ESP32][4D] LFSR keystream (first 32 bytes): 316905FCF8A9704E4101180270C690E96836356FFFA742435F7613FC66B17590
19:06:08.983 > [ESP32][TINKERBELL] Input (first 16 bytes): 793B28CACA89231E0E33353B45E6C3BD Nonce: 0x00000001 Buffer size: 32 bytes
19:06:08.994 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 044FD0B3
19:06:09.002 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FE99F8C0BB15DD5194AFDAC8161CCEEB
19:06:09.012 > 4_After_Tinkerbell (32): 87A2D00A719CFE4F9A9CEFF353FA0D56 A09E3A38BB947D4ED3DFB81C82A98F2D 
19:06:09.019 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FE99F8C0BB15DD5194AFDAC8161CCEEB
19:06:09.027 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FE99F8C0BB15DD5194AFDAC8161CCEEB8DF85C7A72050C40DCA9ABE0E418FABD
19:06:09.039 > 5_After_Transposition (32): 0A7D4ED0BB9CA29A38FE4FEF71949CA0 F30D563A53FA9E871C2DA9B88FD3DF82 
19:06:09.047 > [ESP32] === HMAC DEBUG INFO ===
19:06:09.049 > [ESP32] HMAC Key being used: F70AB55ADD99B5D8354164D0B5FDFCA40DAFF2932653195326AE2BBF05653E6C
19:06:09.056 > [ESP32] HMAC Input length: 44 bytes
19:06:09.061 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000010A7D4ED0BB9CA29A38FE4FEF71949CA0F30D563A
19:06:09.070 > [ESP32] Nonce: 0x00000001
19:06:09.072 > [ESP32] Packet size before HMAC: 60
19:06:09.075 > [ESP32] Computed HMAC Tag: 506D2FDF76D12F0D9ECFFA895594AFE9
19:06:09.080 > [ESP32] === END HMAC DEBUG ===
19:06:09.083 > 6_Final_Packet (60): 8102170017000408000000010A7D4ED0 BB9CA29A38FE4FEF71949CA0F30D563A ...
19:06:09.091 > [RETRY] Attempt 1/3 (nonce: 1)
19:06:09.092 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:09.097 > Sending pipeline data to server (605 bytes)
19:06:09.454 > [HTTP] Response code: 400
19:06:09.455 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:09.459 > [HTTP] Request failed with code: 400
19:06:09.462 > [RETRY] Send failed, waiting 100 ms before retry
19:06:09.561 > [RETRY] Attempt 2/3 (nonce: 1)
19:06:09.561 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:09.566 > Sending pipeline data to server (605 bytes)
19:06:09.715 > [HTTP] Response code: 400
19:06:09.716 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:09.721 > [HTTP] Request failed with code: 400
19:06:09.723 > [RETRY] Send failed, waiting 200 ms before retry
19:06:09.923 > [RETRY] Attempt 3/3 (nonce: 1)
19:06:09.924 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:09.929 > Sending pipeline data to server (605 bytes)
19:06:10.252 > [HTTP] Response code: 400
19:06:10.252 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:10.257 > [HTTP] Request failed with code: 400
19:06:10.260 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:06:10.266 > [RETRY] Consecutive failures: 1
19:06:10.268 > Health data send failed (retry count: 2/3)
19:06:10.371 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":122636,"type":"health_data_error"}
19:06:10.385 > [WebSocket] Processing message type: health_data_error
19:06:10.390 > [124.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:10.399 > [RETRY] Attempting to send health data (Max retries: 3)
19:06:10.404 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:06:10.410 > Generated health data: HR-62 SPO2-95 STEPS-657
19:06:10.413 > [ESP32] ========================================
19:06:10.419 > [ESP32] ENCRYPTION PIPELINE START
19:06:10.422 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:06:10.427 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:06:10.436 > [ESP32] ========================================
19:06:10.438 > [ESP32] MsgKeys: lfsrSeed=0xFC056931 tnk[0..3]=044FD0B3 trn[0..3]=260CE053
19:06:10.444 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3635374D50
19:06:10.452 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3635374D5000000000000000 
19:06:10.460 > [ESP32][LFSR] Initializing - Seed: 0xFC056931 SeedBe: 0x316905FC ChaosKey[0..3]: 044FD0B3 InitialTap: 0x0029 State: 0xFC056931
19:06:10.471 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:06:10.476 > 3_After_LFSR (32): 793B28CACA89231E0E33353B45E6C3BD 2D666642C992750E0F7613FC66B17590 
19:06:10.486 > [ESP32][LFSR] Keystream (first 16 bytes): 316905FCF8A9704E4101180270C690E9
19:06:10.493 > [ESP32][4D] LFSR keystream (first 32 bytes): 316905FCF8A9704E4101180270C690E96836356FFFA742435F7613FC66B17590
19:06:10.502 > [ESP32][TINKERBELL] Input (first 16 bytes): 793B28CACA89231E0E33353B45E6C3BD Nonce: 0x00000001 Buffer size: 32 bytes
19:06:10.513 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 044FD0B3
19:06:10.521 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FE99F8C0BB15DD5194AFDAC8161CCEEB
19:06:10.530 > 4_After_Tinkerbell (32): 87A2D00A719CFE4F9A9CEFF353FA0D56 A09E3A38BB97794ED3DFB81C82A98F2D 
19:06:10.538 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FE99F8C0BB15DD5194AFDAC8161CCEEB
19:06:10.546 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FE99F8C0BB15DD5194AFDAC8161CCEEB8DF85C7A72050C40DCA9ABE0E418FABD
19:06:10.558 > 5_After_Transposition (32): 0A794ED0BB9CA29A38FE4FEF71979CA0 F30D563A53FA9E871C2DA9B88FD3DF82 
19:06:10.566 > [ESP32] === HMAC DEBUG INFO ===
19:06:10.568 > [ESP32] HMAC Key being used: F70AB55ADD99B5D8354164D0B5FDFCA40DAFF2932653195326AE2BBF05653E6C
19:06:10.574 > [ESP32] HMAC Input length: 44 bytes
19:06:10.580 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000010A794ED0BB9CA29A38FE4FEF71979CA0F30D563A
19:06:10.588 > [ESP32] Nonce: 0x00000001
19:06:10.591 > [ESP32] Packet size before HMAC: 60
19:06:10.594 > [ESP32] Computed HMAC Tag: AB7617D26661FF9D163E41D782927018
19:06:10.600 > [ESP32] === END HMAC DEBUG ===
19:06:10.602 > 6_Final_Packet (60): 8102170017000408000000010A794ED0 BB9CA29A38FE4FEF71979CA0F30D563A ...
19:06:10.610 > [RETRY] Attempt 1/3 (nonce: 1)
19:06:10.611 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:10.616 > Sending pipeline data to server (605 bytes)
19:06:10.974 > [HTTP] Response code: 400
19:06:10.975 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:10.980 > [HTTP] Request failed with code: 400
19:06:10.983 > [RETRY] Send failed, waiting 100 ms before retry
19:06:11.082 > [RETRY] Attempt 2/3 (nonce: 1)
19:06:11.082 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:11.088 > Sending pipeline data to server (605 bytes)
19:06:11.244 > [HTTP] Response code: 400
19:06:11.244 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:11.250 > [HTTP] Request failed with code: 400
19:06:11.253 > [RETRY] Send failed, waiting 200 ms before retry
19:06:11.454 > [RETRY] Attempt 3/3 (nonce: 1)
19:06:11.454 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:11.459 > Sending pipeline data to server (605 bytes)
19:06:11.738 > [HTTP] Response code: 400
19:06:11.739 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:11.744 > [HTTP] Request failed with code: 400
19:06:11.747 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:06:11.753 > [RETRY] Consecutive failures: 2
19:06:11.756 > Health data send failed (retry count: 3/3)
19:06:11.758 > Health data transmission failed after max retries
19:06:11.858 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":123130,"type":"health_data_error"}
19:06:11.872 > [WebSocket] Processing message type: health_data_error
19:06:11.878 > [126.3] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:11.885 > ERROR state - attempting recovery
19:06:11.889 > [RETRY] Attempting to send health data (Max retries: 3)
19:06:11.894 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:06:11.897 > Generated health data: HR-62 SPO2-95 STEPS-646
19:06:11.902 > [ESP32] ========================================
19:06:11.906 > [ESP32] ENCRYPTION PIPELINE START
19:06:11.909 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:06:11.917 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:06:11.922 > [ESP32] ========================================
19:06:11.928 > [ESP32] MsgKeys: lfsrSeed=0xFC056931 tnk[0..3]=044FD0B3 trn[0..3]=260CE053
19:06:11.936 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3634364D50
19:06:11.940 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3634364D5000000000000000 
19:06:11.947 > [ESP32][LFSR] Initializing - Seed: 0xFC056931 SeedBe: 0x316905FC ChaosKey[0..3]: 044FD0B3 InitialTap: 0x0029 State: 0xFC056931
19:06:11.958 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:06:11.966 > 3_After_LFSR (32): 793B28CACA89231E0E33353B45E6C3BD 2D666642C993740E0F7613FC66B17590 
19:06:11.975 > [ESP32][LFSR] Keystream (first 16 bytes): 316905FCF8A9704E4101180270C690E9
19:06:11.981 > [ESP32][4D] LFSR keystream (first 32 bytes): 316905FCF8A9704E4101180270C690E96836356FFFA742435F7613FC66B17590
19:06:11.991 > [ESP32][TINKERBELL] Input (first 16 bytes): 793B28CACA89231E0E33353B45E6C3BD Nonce: 0x00000001 Buffer size: 32 bytes
19:06:12.000 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 044FD0B3
19:06:12.011 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FE99F8C0BB15DD5194AFDAC8161CCEEB
19:06:12.019 > 4_After_Tinkerbell (32): 87A2D00A719CFE4F9A9CEFF353FA0D56 A09E3A38BB96784ED3DFB81C82A98F2D 
19:06:12.028 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FE99F8C0BB15DD5194AFDAC8161CCEEB
19:06:12.038 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FE99F8C0BB15DD5194AFDAC8161CCEEB8DF85C7A72050C40DCA9ABE0E418FABD
19:06:12.045 > 5_After_Transposition (32): 0A784ED0BB9CA29A38FE4FEF71969CA0 F30D563A53FA9E871C2DA9B88FD3DF82 
19:06:12.053 > [ESP32] === HMAC DEBUG INFO ===
19:06:12.055 > [ESP32] HMAC Key being used: F70AB55ADD99B5D8354164D0B5FDFCA40DAFF2932653195326AE2BBF05653E6C
19:06:12.064 > [ESP32] HMAC Input length: 44 bytes
19:06:12.068 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000010A784ED0BB9CA29A38FE4FEF71969CA0F30D563A
19:06:12.078 > [ESP32] Nonce: 0x00000001
19:06:12.078 > [ESP32] Packet size before HMAC: 60
19:06:12.083 > [ESP32] Computed HMAC Tag: ED40C67EE30F002F7E47FECC150B6828
19:06:12.086 > [ESP32] === END HMAC DEBUG ===
19:06:12.090 > 6_Final_Packet (60): 8102170017000408000000010A784ED0 BB9CA29A38FE4FEF71969CA0F30D563A ...
19:06:12.097 > [RETRY] Attempt 1/3 (nonce: 1)
19:06:12.100 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:12.106 > Sending pipeline data to server (605 bytes)
19:06:12.470 > [HTTP] Response code: 400
19:06:12.470 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:12.475 > [HTTP] Request failed with code: 400
19:06:12.479 > [RETRY] Send failed, waiting 100 ms before retry
19:06:12.578 > [RETRY] Attempt 2/3 (nonce: 1)
19:06:12.578 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:12.584 > Sending pipeline data to server (605 bytes)
19:06:12.732 > [HTTP] Response code: 400
19:06:12.732 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:12.738 > [HTTP] Request failed with code: 400
19:06:12.740 > [RETRY] Send failed, waiting 200 ms before retry
19:06:12.940 > [RETRY] Attempt 3/3 (nonce: 1)
19:06:12.940 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:12.945 > Sending pipeline data to server (605 bytes)
19:06:13.236 > [HTTP] Response code: 400
19:06:13.236 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:13.242 > [HTTP] Request failed with code: 400
19:06:13.245 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:06:13.251 > [RETRY] Consecutive failures: 3
19:06:13.253 > ✗ Auto-recovery failed - restarting key exchange
19:06:15.358 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":123860,"type":"health_data_error"}
19:06:15.373 > [WebSocket] Processing message type: health_data_error
19:06:15.377 > [129.8] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:15.386 > ✓ Public key loaded from NVS
19:06:15.484 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":124122,"type":"health_data_error"}
19:06:15.499 > [WebSocket] Processing message type: health_data_error
19:06:15.504 > [129.9] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:15.607 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":124659,"type":"health_data_error"}
19:06:15.620 > [WebSocket] Processing message type: health_data_error
19:06:15.626 > [130.0] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:15.634 > Generating fresh master key from entropy...
19:06:15.643 > Generated master key (32): 5B4FE2D7A10C9B0B7E4285D09CA61B85 C3134AED198039459FA3C134EBBC1813 
19:06:15.649 > Using reduced master key (byte % 3) for NTRU encryption only
19:06:15.659 > NTRU encrypted master key (502): 0022006F001F0017007F001B00080064 00440077003A000D000000750068006F ...
19:06:15.667 > POST http://10.249.92.115:8081/master-key
19:06:16.014 > ✓ Master key exchange completed
19:06:16.116 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":125382,"type":"health_data_error"}
19:06:16.129 > [WebSocket] Processing message type: health_data_error
19:06:16.135 > [130.5] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:16.142 > Loading master key from NVS and deriving symmetric keys...
19:06:16.149 > Loaded master key from NVS (32): 5B4FE2D7A10C9B0B7E4285D09CA61B85 C3134AED198039459FA3C134EBBC1813 
19:06:16.157 > Derived HMAC key (32): 48A07443D16453316591A32BD9ADFC4C B005412FE526B1079063584835ECA04E 
19:06:16.165 > Derived Tinkerbell key (16): D9E6ED710F6EB724E8DCE8406CA92218 
19:06:16.171 > Derived Transposition key (16): DACFA50CFD5674140B643DB1A1FA8EAE 
19:06:16.176 > ✓ Symmetric keys derived successfully
19:06:16.180 > Nonce tracker reset - new session started
19:06:16.675 > Waiting for server to process master key...
19:06:16.678 > ✓ Symmetric keys ready - starting health data transmission
19:06:16.780 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":125652,"type":"health_data_error"}
19:06:16.795 > [WebSocket] Processing message type: health_data_error
19:06:16.801 > [131.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:16.904 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":7,"success":false,"timestamp":126146,"type":"health_data_error"}
19:06:16.918 > [WebSocket] Processing message type: health_data_error
19:06:16.923 > [131.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:17.026 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":8,"success":false,"timestamp":126877,"type":"health_data_error"}
19:06:17.040 > [WebSocket] Processing message type: health_data_error
19:06:17.045 > [131.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:17.148 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":8,"success":false,"timestamp":127139,"type":"health_data_error"}
19:06:17.163 > [WebSocket] Processing message type: health_data_error
19:06:17.169 > [131.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:17.270 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Failed to send health data","state":8,"success":false,"timestamp":127644,"type":"health_data_error"}
19:06:17.285 > [WebSocket] Processing message type: health_data_error
19:06:17.290 > [131.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:17.393 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125775784,"type":"master_key_received"}
19:06:17.407 > [WebSocket] Processing message type: master_key_received
19:06:17.410 > [131.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:17.515 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":130414,"type":"master_key_exchanged"}
19:06:17.532 > [WebSocket] Processing message type: master_key_exchanged
19:06:17.538 > [131.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:17.636 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":131082,"type":"symmetric_keys_derived"}
19:06:17.654 > [WebSocket] Processing message type: symmetric_keys_derived
19:06:17.659 > [132.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:17.758 > [132.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:17.860 > [132.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:17.960 > [132.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:18.061 > [132.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:18.163 > [132.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:18.263 > [132.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:18.365 > [132.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:18.466 > [132.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:18.566 > [133.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:18.667 > [133.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:18.768 > [133.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:18.870 > [133.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:18.971 > [133.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:19.072 > [133.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:19.172 > [133.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:19.273 > [133.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:19.374 > [133.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:19.475 > [133.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:19.576 > [134.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:19.677 > [134.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:19.778 > [134.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:19.879 > [134.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:19.981 > [134.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:20.081 > [134.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:20.182 > [134.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:20.283 > [134.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:20.384 > [134.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:20.485 > [134.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:20.587 > [135.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:20.688 > [135.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:20.788 > [135.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:20.890 > [135.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:20.991 > [135.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:21.092 > [135.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:21.192 > [135.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:21.294 > [135.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:21.394 > [135.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:21.495 > [135.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:21.597 > [136.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:21.697 > [136.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:21.798 > [136.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:21.898 > [136.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:22.000 > [136.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:22.101 > [136.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:22.202 > [136.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:22.302 > [136.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:22.405 > [136.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:22.506 > [WebSocket] Received (452 bytes): {"activatedAt":1770125782390,"active":true,"epoch":1,"heuristics":{"cpuUsage":20.0,"decryptFailures":0,"entropy":7.5,"hmacFailures":0,"latency":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"lastSwitchReason":"ZTM activated - baseline recipe","message":"Zero Trust Mode activated successfully","pendingProposals":0,"recipe":"CHAOS_ONLY","serverTime":1770125782390,"success":true,"threatLevel":0,"type":"ztm_activation_acknowledged"}
19:06:22.547 > [WebSocket] Processing message type: ztm_activation_acknowledged
19:06:22.553 > [WebSocket] ========================================
19:06:22.556 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged, fromFrontend: NO)
19:06:22.564 > [WebSocket] ========================================
19:06:22.571 > [ZTM] Settings saved successfully
19:06:22.573 > [WebSocket] ✓ ZTM activated successfully
19:06:22.577 > [WebSocket] ✓ Normal Mode encryption STOPPED
19:06:22.581 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
19:06:22.583 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
19:06:22.589 > [WebSocket] ========================================
19:06:22.593 > [WebSocket] Received server ack - not sending duplicate ack (prevents loop)
19:06:22.600 > [137.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:22.710 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":136998,"type":"ztm_activated"}
19:06:22.726 > [WebSocket] Processing message type: ztm_activated
19:06:22.729 > [137.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:22.832 > [137.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:22.932 > [137.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:23.034 > [137.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:23.134 > [137.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:23.235 > [137.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:23.336 > [137.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:23.440 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125783391,"threatLevel":0,"type":"heuristics_update"}
19:06:23.465 > [WebSocket] Processing message type: heuristics_update
19:06:23.471 > [137.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:23.572 > [138.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:23.673 > [138.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:23.775 > [138.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:23.876 > [138.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:23.976 > [138.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:24.077 > [138.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:24.177 > [138.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:24.280 > [138.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:24.381 > [138.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:24.482 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125784391,"threatLevel":0,"type":"heuristics_update"}
19:06:24.507 > [WebSocket] Processing message type: heuristics_update
19:06:24.513 > [138.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:24.614 > [139.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:24.715 > [139.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:24.816 > [139.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:24.917 > [139.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:25.018 > [139.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:25.118 > [139.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:25.220 > [139.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:25.321 > [139.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:25.423 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125785391,"threatLevel":0,"type":"heuristics_update"}
19:06:25.447 > [WebSocket] Processing message type: heuristics_update
19:06:25.454 > [139.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:25.555 > [140.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:25.656 > [140.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:25.757 > [140.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:25.858 > [140.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:25.959 > [140.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:26.060 > [140.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:26.161 > [140.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:26.262 > [140.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:26.363 > [140.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:26.465 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125786392,"threatLevel":0,"type":"heuristics_update"}
19:06:26.490 > [WebSocket] Processing message type: heuristics_update
19:06:26.496 > [140.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:26.597 > [141.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:26.698 > [141.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:06:26.704 > [RETRY] Attempting to send health data (Max retries: 3)
19:06:26.710 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:06:26.714 > Generated health data: HR-65 SPO2-95 STEPS-714
19:06:26.718 > [ESP32] ========================================
19:06:26.723 > [ESP32] ENCRYPTION PIPELINE START
19:06:26.727 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:06:26.732 > [ESP32] Active Algorithms for this packet:
19:06:26.735 > [ESP32]   + LFSR
19:06:26.737 > [ESP32]   + Tinkerbell
19:06:26.741 > [ESP32]   + Transposition
19:06:26.741 > [ESP32]   - ChaCha20
19:06:26.743 > [ESP32]   - Salsa20
19:06:26.746 > [ESP32] ========================================
19:06:26.748 > [ESP32] MsgKeys: lfsrSeed=0xE5692A73 tnk[0..3]=A406613B trn[0..3]=AA92820C
19:06:26.757 > 1_After_Salt (25): 48522D36352053504F322D3935205354 4550532D3731344D50
19:06:26.763 > 2_After_Padding (32): 48522D36352053504F322D3935205354 4550532D3731344D5000000000000000 
19:06:26.771 > [ESP32][LFSR] Initializing - Seed: 0xE5692A73 SeedBe: 0x732A69E5 ChaosKey[0..3]: A406613B InitialTap: 0x0029 State: 0xE5692A73
19:06:26.782 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3935205354 Buffer size: 32 bytes
19:06:26.788 > 3_After_LFSR (32): 3B7844D370CD31F3FC39F1BA544839A3 C500E017DE62A8B2B58A7057CEF38EBC 
19:06:26.796 > [ESP32][LFSR] Keystream (first 16 bytes): 732A69E545ED62A3B30BDC8361686AF7
19:06:26.805 > [ESP32][4D] LFSR keystream (first 32 bytes): 732A69E545ED62A3B30BDC8361686AF78050B33AE9539CFFE58A7057CEF38EBC
19:06:26.813 > [ESP32][TINKERBELL] Input (first 16 bytes): 3B7844D370CD31F3FC39F1BA544839A3 Nonce: 0x00000001 Buffer size: 32 bytes
19:06:26.823 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: A406613B
19:06:26.832 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 1A3AB9C9E0151F412ED76F860E08478F
19:06:26.840 > 4_After_Tinkerbell (32): 2142FD1A90D82EB2D2EE9E3C5A407E2C 0238028DD78B75A90C0BE46BAEF46FB7 
19:06:26.848 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 1A3AB9C9E0151F412ED76F860E08478F
19:06:26.856 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 1A3AB9C9E0151F412ED76F860E08478FC738E29A09E9DD1BB981943C6007E10B
19:06:26.868 > 5_After_Transposition (32): 1A90D8FD2142A9753C5A409ED2EEB22E 8DD78B0202382C7E0C0BE4F4AE6BB76F 
19:06:26.876 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:06:26.879 > [ESP32] === HMAC DEBUG INFO ===
19:06:26.882 > [ESP32] HMAC Key being used: 48A07443D16453316591A32BD9ADFC4CB005412FE526B1079063584835ECA04E
19:06:26.891 > [ESP32] HMAC Input length: 45 bytes
19:06:26.893 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000011A90D8FD2142A9753C5A409ED2EEB22E8DD78B
19:06:26.904 > [ESP32] Nonce: 0x00000001
19:06:26.904 > [ESP32] Packet size before HMAC: 61
19:06:26.907 > [ESP32] Computed HMAC Tag: 5CD1F0F69CB5457AD7625AAE5536E613
19:06:26.912 > [ESP32] === END HMAC DEBUG ===
19:06:26.915 > 6_Final_Packet (61): 820217001700040804000000011A90D8 FD2142A9753C5A409ED2EEB22E8DD78B ...
19:06:26.923 > [RETRY] Attempt 1/3 (nonce: 1)
19:06:26.926 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:26.932 > Sending pipeline data to server (606 bytes)
19:06:27.266 > [HTTP] Response code: 200
19:06:27.266 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:06:27.277 > [RETRY] Health data sent successfully!
19:06:27.280 > ✓ Health data #5 sent successfully
19:06:27.381 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":1,"serverTime":1770125787040,"type":"security_update"}
19:06:27.397 > [WebSocket] Processing message type: security_update
19:06:27.403 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:06:27.408 > [141.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:27.514 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820217001700040804000000011A90D8FD2142A9753C5A409ED2EEB22E8DD78B0202382C7E0C0BE4F4AE6BB76F5CD1F0F69CB5457AD7625AAE5536E613","pipeline":{"afterLFSR":"3B7844D370CD31F3FC39F1BA544839A3C500E017DE62A8B2B58A7057CEF38EBC","afterSalt":"48522D36352053504F322D39352053544550532D3731344D50","afterTinkerbell":"2142FD1A90D82EB2D2EE9E3C5A407E2C0238028DD78B75A90C0BE46BAEF46FB7","afterTransposition":"1A90D8FD2142A9753C5A409ED2EEB22E8DD78B0202382C7E0C0BE4F4AE6BB76F"},"plaintext":"HR-65 SPO2-95 STEPS-714","serverTime":1770125787040,"timestamp":141332,"type":"encryption_update","ztmEnabled":true}
19:06:27.570 > [WebSocket] Processing message type: encryption_update
19:06:27.574 > [142.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:27.677 > [WebSocket] Received (87 bytes): {"heartRate":65,"spo2":95,"steps":714,"time":1770125787040,"type":"health_data_update"}
19:06:27.686 > [WebSocket] Processing message type: health_data_update
19:06:27.692 > [142.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:27.799 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2972,"encryptionTime":0.0,"finalPlaintext":"HR-65 SPO2-95 STEPS-714","handshakeSuccess":true,"totalTime":0.2972},"type":"session_summary_update"}
19:06:27.822 > [WebSocket] Processing message type: session_summary_update
19:06:27.827 > [142.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:27.933 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2972,"encryptedPacket":"820217001700040804000000011A90D8FD2142A9753C5A409ED2EEB22E8DD78B0202382C7E0C0BE4F4AE6BB76F5CD1F0F69CB5457AD7625AAE5536E613","finalPlaintext":"HR-65 SPO2-95 STEPS-714","healthData":{"heartRate":65,"spo2":95,"steps":714},"pipeline":{"afterDepad":"48522D36352053504F322D39352053544550532D37313400000000000000","afterLFSR":"48522D36352053504F322D39352053544550532D3731344D5000000000000000","afterTinkerbell":"3B7844D370CD31F3FC39F1BA544839A3C500E017DE62A8B2B58A7057CEF38EBC","afterTransposition":"2142FD1A90D82EB2D2EE9E3C5A407E2C0238028DD78B75A90C0BE46BAEF46FB7"},"serverTime":1770125787041,"type":"decryption_update"}
19:06:27.991 > [WebSocket] Processing message type: decryption_update
19:06:27.997 > [WebSocket] Server decryption completed
19:06:28.000 > [WebSocket] Health data - HR: 65, SPO2: 95, Steps: 714
19:06:28.005 > [142.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:28.107 > [WebSocket] Received (645 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":4,"pipeline":{"afterLFSR":"3B7844D370CD31F3FC39F1BA544839A3C500E017DE62A8B2B58A7057CEF38EBC","afterSalt":"48522D36352053504F322D39352053544550532D3731344D50","afterTinkerbell":"2142FD1A90D82EB2D2EE9E3C5A407E2C0238028DD78B75A90C0BE46BAEF46FB7","afterTransposition":"1A90D8FD2142A9753C5A409ED2EEB22E8DD78B0202382C7E0C0BE4F4AE6BB76F","finalPacket":"820217001700040804000000011A90D8FD2142A9753C5A409ED2EEB22E8DD78B0202382C7E0C0BE4F4AE6BB76F5CD1F0F69CB5457AD7625AAE5536E613"},"plaintext":"HR-65 SPO2-95 STEPS-714","timestamp":141675,"type":"encryption_pipeline","ztmEnabled":true}
19:06:28.166 > [WebSocket] Processing message type: encryption_pipeline
19:06:28.172 > [142.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:28.271 > [WebSocket] Received (158 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Health data #5 sent successfully","state":7,"success":true,"timestamp":141679,"type":"health_data_sent"}
19:06:28.286 > [WebSocket] Processing message type: health_data_sent
19:06:28.290 > [142.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:28.395 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125787392,"threatLevel":0,"type":"heuristics_update"}
19:06:28.420 > [WebSocket] Processing message type: heuristics_update
19:06:28.425 > [142.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:28.528 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125788392,"threatLevel":0,"type":"heuristics_update"}
19:06:28.553 > [WebSocket] Processing message type: heuristics_update
19:06:28.558 > [143.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:28.660 > [143.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:28.761 > [143.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:28.862 > [143.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:28.963 > [143.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:29.064 > [143.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:29.165 > [143.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:29.266 > [143.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:29.367 > [143.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:29.468 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125789393,"threatLevel":0,"type":"heuristics_update"}
19:06:29.494 > [WebSocket] Processing message type: heuristics_update
19:06:29.499 > [143.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:29.601 > [144.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:29.702 > [144.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:29.803 > [144.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:29.904 > [144.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:30.005 > [144.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:30.106 > [144.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:30.207 > [144.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:30.308 > [144.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:30.410 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125790394,"threatLevel":0,"type":"heuristics_update"}
19:06:30.435 > [WebSocket] Processing message type: heuristics_update
19:06:30.440 > [144.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:30.542 > [144.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:30.643 > [145.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:30.744 > [145.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:30.846 > [145.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:30.946 > [145.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:31.047 > [145.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:31.147 > [145.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:31.249 > [145.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:31.350 > [145.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:31.452 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125791394,"threatLevel":0,"type":"heuristics_update"}
19:06:31.477 > [WebSocket] Processing message type: heuristics_update
19:06:31.483 > [145.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:31.584 > [146.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:31.685 > [146.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:31.786 > [146.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:31.886 > [146.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:31.988 > [146.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:32.089 > [146.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:32.190 > [146.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:32.291 > [146.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:32.392 > [146.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:32.494 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125792395,"threatLevel":0,"type":"heuristics_update"}
19:06:32.518 > [WebSocket] Processing message type: heuristics_update
19:06:32.524 > [146.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:32.626 > [147.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:32.727 > [147.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:32.828 > [147.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:32.929 > [147.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:33.030 > [147.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:33.131 > [147.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:33.232 > [147.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:33.333 > [147.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:33.436 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125793395,"threatLevel":0,"type":"heuristics_update"}
19:06:33.462 > [WebSocket] Processing message type: heuristics_update
19:06:33.467 > [147.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:33.570 > [148.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:33.670 > [148.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:33.771 > [148.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:33.871 > [148.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:33.973 > [148.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:34.074 > [148.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:34.175 > [148.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:34.276 > [148.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:34.377 > [148.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:34.479 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125794395,"threatLevel":0,"type":"heuristics_update"}
19:06:34.504 > [WebSocket] Processing message type: heuristics_update
19:06:34.510 > [148.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:34.611 > [149.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:34.712 > [149.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:34.813 > [149.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:34.913 > [149.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:35.015 > [149.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:35.116 > [149.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:35.217 > [149.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:35.318 > [149.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:35.420 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125795396,"threatLevel":0,"type":"heuristics_update"}
19:06:35.445 > [WebSocket] Processing message type: heuristics_update
19:06:35.450 > [149.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:35.552 > [150.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:35.653 > [150.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:35.754 > [150.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:35.855 > [150.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:35.956 > [150.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:36.057 > [150.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:36.157 > [150.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:36.259 > [150.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:36.360 > [150.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:36.462 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125796397,"threatLevel":0,"type":"heuristics_update"}
19:06:36.486 > [WebSocket] Processing message type: heuristics_update
19:06:36.492 > [150.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:36.594 > [151.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:36.695 > [151.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:36.795 > [151.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:36.897 > [151.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:36.997 > [151.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:37.099 > [151.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:37.200 > [151.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:37.301 > [151.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:37.306 > [RETRY] Attempting to send health data (Max retries: 3)
19:06:37.312 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:06:37.317 > Generated health data: HR-62 SPO2-95 STEPS-779
19:06:37.321 > [ESP32] ========================================
19:06:37.326 > [ESP32] ENCRYPTION PIPELINE START
19:06:37.329 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:06:37.335 > [ESP32] Active Algorithms for this packet:
19:06:37.338 > [ESP32]   + LFSR
19:06:37.341 > [ESP32]   + Tinkerbell
19:06:37.343 > [ESP32]   + Transposition
19:06:37.343 > [ESP32]   - ChaCha20
19:06:37.346 > [ESP32]   - Salsa20
19:06:37.349 > [ESP32] ========================================
19:06:37.352 > [ESP32] MsgKeys: lfsrSeed=0xB7A49FB3 tnk[0..3]=6BD962B2 trn[0..3]=F497FE10
19:06:37.360 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3737394D50
19:06:37.366 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3737394D5000000000000000 
19:06:37.373 > [ESP32][LFSR] Initializing - Seed: 0xB7A49FB3 SeedBe: 0xB39FA4B7 ChaosKey[0..3]: 6BD962B2 InitialTap: 0x0029 State: 0xB7A49FB3
19:06:37.385 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:06:37.391 > 3_After_LFSR (32): FBCD8981D211E2451B45C568D5A9FED2 51CA9B50864F6BDC3167E1CCC6CBD301 
19:06:37.398 > [ESP32][LFSR] Keystream (first 16 bytes): B39FA4B7E031B1155477E851E089AD86
19:06:37.407 > [ESP32][4D] LFSR keystream (first 32 bytes): B39FA4B7E031B1155477E851E089AD86149AC87DB17852916167E1CCC6CBD301
19:06:37.416 > [ESP32][TINKERBELL] Input (first 16 bytes): FBCD8981D211E2451B45C568D5A9FED2 Nonce: 0x00000002 Buffer size: 32 bytes
19:06:37.426 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 6BD962B2
19:06:37.435 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 495D1623DE1D7DA7E12EBB4B85599BC1
19:06:37.442 > 4_After_Tinkerbell (32): B2909FA20C0C9FE2FA6B7E2350F06513 5813D20870476EDC75F91B8BE2A81A47 
19:06:37.452 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 495D1623DE1D7DA7E12EBB4B85599BC1
19:06:37.459 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 495D1623DE1D7DA7E12EBB4B85599BC109D94958F6080500449EFA472463C946
19:06:37.471 > 5_After_Transposition (32): 1AA8E2476550F01375F91B8B70476EDC 5813D2080C0C9FE2909FA2B2FA6B7E23 
19:06:37.480 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:06:37.482 > [ESP32] === HMAC DEBUG INFO ===
19:06:37.485 > [ESP32] HMAC Key being used: 48A07443D16453316591A32BD9ADFC4CB005412FE526B1079063584835ECA04E
19:06:37.492 > [ESP32] HMAC Input length: 45 bytes
19:06:37.496 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000021AA8E2476550F01375F91B8B70476EDC5813D2
19:06:37.507 > [ESP32] Nonce: 0x00000002
19:06:37.507 > [ESP32] Packet size before HMAC: 61
19:06:37.510 > [ESP32] Computed HMAC Tag: C075C3F0ADED5C45877731A3B1DA74C4
19:06:37.519 > [ESP32] === END HMAC DEBUG ===
19:06:37.519 > 6_Final_Packet (61): 820217001700040804000000021AA8E2 476550F01375F91B8B70476EDC5813D2 ...
19:06:37.527 > [RETRY] Attempt 1/3 (nonce: 2)
19:06:37.529 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:37.535 > Sending pipeline data to server (606 bytes)
19:06:37.795 > [HTTP] Response code: 400
19:06:37.796 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:37.802 > [HTTP] Request failed with code: 400
19:06:37.804 > [RETRY] Send failed, waiting 100 ms before retry
19:06:37.904 > [RETRY] Attempt 2/3 (nonce: 2)
19:06:37.904 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:37.909 > Sending pipeline data to server (606 bytes)
19:06:38.033 > [HTTP] Response code: 400
19:06:38.033 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:38.039 > [HTTP] Request failed with code: 400
19:06:38.042 > [RETRY] Send failed, waiting 200 ms before retry
19:06:38.240 > [RETRY] Attempt 3/3 (nonce: 2)
19:06:38.240 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:38.245 > Sending pipeline data to server (606 bytes)
19:06:38.560 > [HTTP] Response code: 400
19:06:38.560 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:38.565 > [HTTP] Request failed with code: 400
19:06:38.569 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:06:38.574 > [RETRY] Consecutive failures: 1
19:06:38.576 > Health data send failed (retry count: 1/3)
19:06:38.682 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125797397,"threatLevel":0,"type":"heuristics_update"}
19:06:38.707 > [WebSocket] Processing message type: heuristics_update
19:06:38.712 > [153.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:38.718 > [RETRY] Attempting to send health data (Max retries: 3)
19:06:38.723 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:06:38.729 > Generated health data: HR-62 SPO2-95 STEPS-794
19:06:38.731 > [ESP32] ========================================
19:06:38.738 > [ESP32] ENCRYPTION PIPELINE START
19:06:38.787 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:06:38.787 > [ESP32] Active Algorithms for this packet:
19:06:38.787 > [ESP32]   + LFSR
19:06:38.787 > [ESP32]   + Tinkerbell
19:06:38.787 > [ESP32]   + Transposition
19:06:38.787 > [ESP32]   - ChaCha20
19:06:38.787 > [ESP32]   - Salsa20
19:06:38.787 > [ESP32] ========================================
19:06:38.787 > [ESP32] MsgKeys: lfsrSeed=0xB7A49FB3 tnk[0..3]=6BD962B2 trn[0..3]=F497FE10
19:06:38.787 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3739344D50
19:06:38.787 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3739344D5000000000000000 
19:06:38.787 > [ESP32][LFSR] Initializing - Seed: 0xB7A49FB3 SeedBe: 0xB39FA4B7 ChaosKey[0..3]: 6BD962B2 InitialTap: 0x0029 State: 0xB7A49FB3
19:06:38.817 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:06:38.817 > 3_After_LFSR (32): FBCD8981D211E2451B45C568D5A9FED2 51CA9B50864166DC3167E1CCC6CBD301 
19:06:38.817 > [ESP32][LFSR] Keystream (first 16 bytes): B39FA4B7E031B1155477E851E089AD86
19:06:38.818 > [ESP32][4D] LFSR keystream (first 32 bytes): B39FA4B7E031B1155477E851E089AD86149AC87DB17852916167E1CCC6CBD301
19:06:38.827 > [ESP32][TINKERBELL] Input (first 16 bytes): FBCD8981D211E2451B45C568D5A9FED2 Nonce: 0x00000002 Buffer size: 32 bytes
19:06:38.842 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 6BD962B2
19:06:38.847 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 495D1623DE1D7DA7E12EBB4B85599BC1
19:06:38.854 > 4_After_Tinkerbell (32): B2909FA20C0C9FE2FA6B7E2350F06513 5813D208704963DC75F91B8BE2A81A47 
19:06:38.863 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 495D1623DE1D7DA7E12EBB4B85599BC1
19:06:38.870 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 495D1623DE1D7DA7E12EBB4B85599BC109D94958F6080500449EFA472463C946
19:06:38.882 > 5_After_Transposition (32): 1AA8E2476550F01375F91B8B704963DC 5813D2080C0C9FE2909FA2B2FA6B7E23 
19:06:38.890 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:06:38.893 > [ESP32] === HMAC DEBUG INFO ===
19:06:38.895 > [ESP32] HMAC Key being used: 48A07443D16453316591A32BD9ADFC4CB005412FE526B1079063584835ECA04E
19:06:38.904 > [ESP32] HMAC Input length: 45 bytes
19:06:38.907 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000021AA8E2476550F01375F91B8B704963DC5813D2
19:06:38.918 > [ESP32] Nonce: 0x00000002
19:06:38.918 > [ESP32] Packet size before HMAC: 61
19:06:38.920 > [ESP32] Computed HMAC Tag: FA71501E97A398ADDC809AA2EACCC6DB
19:06:38.926 > [ESP32] === END HMAC DEBUG ===
19:06:38.929 > 6_Final_Packet (61): 820217001700040804000000021AA8E2 476550F01375F91B8B704963DC5813D2 ...
19:06:38.938 > [RETRY] Attempt 1/3 (nonce: 2)
19:06:38.940 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:38.945 > Sending pipeline data to server (606 bytes)
19:06:39.320 > [HTTP] Response code: 400
19:06:39.320 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:39.325 > [HTTP] Request failed with code: 400
19:06:39.329 > [RETRY] Send failed, waiting 100 ms before retry
19:06:39.430 > [RETRY] Attempt 2/3 (nonce: 2)
19:06:39.430 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:39.435 > Sending pipeline data to server (606 bytes)
19:06:39.550 > [HTTP] Response code: 400
19:06:39.551 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:39.556 > [HTTP] Request failed with code: 400
19:06:39.559 > [RETRY] Send failed, waiting 200 ms before retry
19:06:39.757 > [RETRY] Attempt 3/3 (nonce: 2)
19:06:39.757 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:39.763 > Sending pipeline data to server (606 bytes)
19:06:40.045 > [HTTP] Response code: 400
19:06:40.045 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:40.052 > [HTTP] Request failed with code: 400
19:06:40.054 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:06:40.060 > [RETRY] Consecutive failures: 2
19:06:40.063 > Health data send failed (retry count: 2/3)
19:06:40.164 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":152204,"type":"health_data_error"}
19:06:40.178 > [WebSocket] Processing message type: health_data_error
19:06:40.184 > [154.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:40.192 > [RETRY] Attempting to send health data (Max retries: 3)
19:06:40.198 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:06:40.203 > Generated health data: HR-62 SPO2-95 STEPS-772
19:06:40.206 > [ESP32] ========================================
19:06:40.212 > [ESP32] ENCRYPTION PIPELINE START
19:06:40.215 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:06:40.219 > [ESP32] Active Algorithms for this packet:
19:06:40.222 > [ESP32]   + LFSR
19:06:40.222 > [ESP32]   + Tinkerbell
19:06:40.226 > [ESP32]   + Transposition
19:06:40.229 > [ESP32]   - ChaCha20
19:06:40.231 > [ESP32]   - Salsa20
19:06:40.231 > [ESP32] ========================================
19:06:40.236 > [ESP32] MsgKeys: lfsrSeed=0xB7A49FB3 tnk[0..3]=6BD962B2 trn[0..3]=F497FE10
19:06:40.243 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3737324D50
19:06:40.247 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3737324D5000000000000000 
19:06:40.256 > [ESP32][LFSR] Initializing - Seed: 0xB7A49FB3 SeedBe: 0xB39FA4B7 ChaosKey[0..3]: 6BD962B2 InitialTap: 0x0029 State: 0xB7A49FB3
19:06:40.267 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:06:40.275 > 3_After_LFSR (32): FBCD8981D211E2451B45C568D5A9FED2 51CA9B50864F60DC3167E1CCC6CBD301 
19:06:40.284 > [ESP32][LFSR] Keystream (first 16 bytes): B39FA4B7E031B1155477E851E089AD86
19:06:40.289 > [ESP32][4D] LFSR keystream (first 32 bytes): B39FA4B7E031B1155477E851E089AD86149AC87DB17852916167E1CCC6CBD301
19:06:40.301 > [ESP32][TINKERBELL] Input (first 16 bytes): FBCD8981D211E2451B45C568D5A9FED2 Nonce: 0x00000002 Buffer size: 32 bytes
19:06:40.309 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 6BD962B2
19:06:40.320 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 495D1623DE1D7DA7E12EBB4B85599BC1
19:06:40.328 > 4_After_Tinkerbell (32): B2909FA20C0C9FE2FA6B7E2350F06513 5813D208704765DC75F91B8BE2A81A47 
19:06:40.336 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 495D1623DE1D7DA7E12EBB4B85599BC1
19:06:40.345 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 495D1623DE1D7DA7E12EBB4B85599BC109D94958F6080500449EFA472463C946
19:06:40.352 > 5_After_Transposition (32): 1AA8E2476550F01375F91B8B704765DC 5813D2080C0C9FE2909FA2B2FA6B7E23 
19:06:40.362 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:06:40.368 > [ESP32] === HMAC DEBUG INFO ===
19:06:40.370 > [ESP32] HMAC Key being used: 48A07443D16453316591A32BD9ADFC4CB005412FE526B1079063584835ECA04E
19:06:40.377 > [ESP32] HMAC Input length: 45 bytes
19:06:40.381 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000021AA8E2476550F01375F91B8B704765DC5813D2
19:06:40.390 > [ESP32] Nonce: 0x00000002
19:06:40.392 > [ESP32] Packet size before HMAC: 61
19:06:40.395 > [ESP32] Computed HMAC Tag: 94F01887BE51C9E1B7C9AD51E8711D36
19:06:40.400 > [ESP32] === END HMAC DEBUG ===
19:06:40.403 > 6_Final_Packet (61): 820217001700040804000000021AA8E2 476550F01375F91B8B704765DC5813D2 ...
19:06:40.412 > [RETRY] Attempt 1/3 (nonce: 2)
19:06:40.414 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:40.420 > Sending pipeline data to server (606 bytes)
19:06:40.586 > [HTTP] Response code: 400
19:06:40.586 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:40.591 > [HTTP] Request failed with code: 400
19:06:40.595 > [RETRY] Send failed, waiting 100 ms before retry
19:06:40.694 > [RETRY] Attempt 2/3 (nonce: 2)
19:06:40.694 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:40.701 > Sending pipeline data to server (606 bytes)
19:06:41.035 > [HTTP] Response code: 400
19:06:41.035 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:41.041 > [HTTP] Request failed with code: 400
19:06:41.044 > [RETRY] Send failed, waiting 200 ms before retry
19:06:41.243 > [RETRY] Attempt 3/3 (nonce: 2)
19:06:41.243 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:41.248 > Sending pipeline data to server (606 bytes)
19:06:41.575 > [HTTP] Response code: 400
19:06:41.576 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:41.581 > [HTTP] Request failed with code: 400
19:06:41.583 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:06:41.590 > [RETRY] Consecutive failures: 3
19:06:41.592 > Health data send failed (retry count: 3/3)
19:06:41.595 > Health data transmission failed after max retries
19:06:41.694 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":152441,"type":"health_data_error"}
19:06:41.708 > [WebSocket] Processing message type: health_data_error
19:06:41.713 > [156.1] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:41.722 > ERROR state - attempting recovery
19:06:41.725 > [RETRY] Attempting to send health data (Max retries: 3)
19:06:41.731 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:06:41.734 > Generated health data: HR-62 SPO2-95 STEPS-785
19:06:41.739 > [ESP32] ========================================
19:06:41.741 > [ESP32] ENCRYPTION PIPELINE START
19:06:41.744 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:06:41.750 > [ESP32] Active Algorithms for this packet:
19:06:41.755 > [ESP32]   + LFSR
19:06:41.755 > [ESP32]   + Tinkerbell
19:06:41.758 > [ESP32]   + Transposition
19:06:41.761 > [ESP32]   - ChaCha20
19:06:41.761 > [ESP32]   - Salsa20
19:06:41.765 > [ESP32] ========================================
19:06:41.769 > [ESP32] MsgKeys: lfsrSeed=0xB7A49FB3 tnk[0..3]=6BD962B2 trn[0..3]=F497FE10
19:06:41.775 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3738354D50
19:06:41.781 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3738354D5000000000000000 
19:06:41.789 > [ESP32][LFSR] Initializing - Seed: 0xB7A49FB3 SeedBe: 0xB39FA4B7 ChaosKey[0..3]: 6BD962B2 InitialTap: 0x0029 State: 0xB7A49FB3
19:06:41.800 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:06:41.808 > 3_After_LFSR (32): FBCD8981D211E2451B45C568D5A9FED2 51CA9B50864067DC3167E1CCC6CBD301 
19:06:41.816 > [ESP32][LFSR] Keystream (first 16 bytes): B39FA4B7E031B1155477E851E089AD86
19:06:41.822 > [ESP32][4D] LFSR keystream (first 32 bytes): B39FA4B7E031B1155477E851E089AD86149AC87DB17852916167E1CCC6CBD301
19:06:41.831 > [ESP32][TINKERBELL] Input (first 16 bytes): FBCD8981D211E2451B45C568D5A9FED2 Nonce: 0x00000002 Buffer size: 32 bytes
19:06:41.841 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 6BD962B2
19:06:41.852 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 495D1623DE1D7DA7E12EBB4B85599BC1
19:06:41.861 > 4_After_Tinkerbell (32): B2909FA20C0C9FE2FA6B7E2350F06513 5813D208704862DC75F91B8BE2A81A47 
19:06:41.867 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 495D1623DE1D7DA7E12EBB4B85599BC1
19:06:41.875 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 495D1623DE1D7DA7E12EBB4B85599BC109D94958F6080500449EFA472463C946
19:06:41.886 > 5_After_Transposition (32): 1AA8E2476550F01375F91B8B704862DC 5813D2080C0C9FE2909FA2B2FA6B7E23 
19:06:41.894 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:06:41.900 > [ESP32] === HMAC DEBUG INFO ===
19:06:41.903 > [ESP32] HMAC Key being used: 48A07443D16453316591A32BD9ADFC4CB005412FE526B1079063584835ECA04E
19:06:41.911 > [ESP32] HMAC Input length: 45 bytes
19:06:41.914 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000021AA8E2476550F01375F91B8B704862DC5813D2
19:06:41.922 > [ESP32] Nonce: 0x00000002
19:06:41.925 > [ESP32] Packet size before HMAC: 61
19:06:41.928 > [ESP32] Computed HMAC Tag: B57C26EF98663DC7C10AC4F54C462E9C
19:06:41.934 > [ESP32] === END HMAC DEBUG ===
19:06:41.936 > 6_Final_Packet (61): 820217001700040804000000021AA8E2 476550F01375F91B8B704862DC5813D2 ...
19:06:41.944 > [RETRY] Attempt 1/3 (nonce: 2)
19:06:41.947 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:41.951 > Sending pipeline data to server (606 bytes)
19:06:42.295 > [HTTP] Response code: 400
19:06:42.295 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:42.300 > [HTTP] Request failed with code: 400
19:06:42.303 > [RETRY] Send failed, waiting 100 ms before retry
19:06:42.402 > [RETRY] Attempt 2/3 (nonce: 2)
19:06:42.403 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:42.409 > Sending pipeline data to server (606 bytes)
19:06:42.570 > [HTTP] Response code: 400
19:06:42.570 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:42.575 > [HTTP] Request failed with code: 400
19:06:42.578 > [RETRY] Send failed, waiting 200 ms before retry
19:06:42.779 > [RETRY] Attempt 3/3 (nonce: 2)
19:06:42.779 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:42.784 > Sending pipeline data to server (606 bytes)
19:06:43.062 > [HTTP] Response code: 400
19:06:43.062 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:43.068 > [HTTP] Request failed with code: 400
19:06:43.070 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:06:43.075 > [RETRY] Consecutive failures: 4
19:06:43.079 > ✗ Auto-recovery failed - restarting key exchange
19:06:45.181 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125798398,"threatLevel":0,"type":"heuristics_update"}
19:06:45.206 > [WebSocket] Processing message type: heuristics_update
19:06:45.212 > [159.6] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:45.221 > ✓ Public key loaded from NVS
19:06:45.319 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":152968,"type":"health_data_error"}
19:06:45.332 > [WebSocket] Processing message type: health_data_error
19:06:45.338 > [159.7] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:45.442 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":153728,"type":"health_data_error"}
19:06:45.455 > [WebSocket] Processing message type: health_data_error
19:06:45.462 > [159.9] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:45.470 > Generating fresh master key from entropy...
19:06:45.479 > Generated master key (32): BF168B4E4553235F8C34A05AC09F8523 C3CED7D5A2D5BD12E6AB733C8BA564B6 
19:06:45.483 > Using reduced master key (byte % 3) for NTRU encryption only
19:06:45.494 > NTRU encrypted master key (502): 0023006F001F0015007D001D00080064 00460078003A000C0000007400690070 ...
19:06:45.502 > POST http://10.249.92.115:8081/master-key
19:06:45.818 > ✓ Master key exchange completed
19:06:45.920 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125799400,"threatLevel":0,"type":"heuristics_update"}
19:06:45.945 > [WebSocket] Processing message type: heuristics_update
19:06:45.950 > [160.3] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:45.955 > Loading master key from NVS and deriving symmetric keys...
19:06:45.961 > Loaded master key from NVS (32): BF168B4E4553235F8C34A05AC09F8523 C3CED7D5A2D5BD12E6AB733C8BA564B6 
19:06:45.972 > Derived HMAC key (32): B9EE652BD85B4FE58418B32B45A2F39C 66147685873867222687483AB0FB46FB 
19:06:45.977 > Derived Tinkerbell key (16): 03CCC577D3B549724EDD86F642D4FCC7 
19:06:45.983 > Derived Transposition key (16): 4A3FE9022512C29487E2FE5C667A264C 
19:06:45.992 > ✓ Symmetric keys derived successfully
19:06:45.994 > Nonce tracker reset - new session started
19:06:46.490 > Waiting for server to process master key...
19:06:46.494 > ✓ Symmetric keys ready - starting health data transmission
19:06:46.596 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":153959,"type":"health_data_error"}
19:06:46.610 > [WebSocket] Processing message type: health_data_error
19:06:46.615 > [161.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:46.719 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":154454,"type":"health_data_error"}
19:06:46.732 > [WebSocket] Processing message type: health_data_error
19:06:46.738 > [161.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:46.841 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125800400,"threatLevel":0,"type":"heuristics_update"}
19:06:46.866 > [WebSocket] Processing message type: heuristics_update
19:06:46.872 > [161.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:46.974 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":154994,"type":"health_data_error"}
19:06:46.988 > [WebSocket] Processing message type: health_data_error
19:06:46.994 > [161.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:47.096 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":155443,"type":"health_data_error"}
19:06:47.109 > [WebSocket] Processing message type: health_data_error
19:06:47.115 > [161.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:47.220 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125801401,"threatLevel":0,"type":"heuristics_update"}
19:06:47.246 > [WebSocket] Processing message type: heuristics_update
19:06:47.252 > [161.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:47.354 > [161.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:47.455 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":155983,"type":"health_data_error"}
19:06:47.469 > [WebSocket] Processing message type: health_data_error
19:06:47.475 > [161.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:47.577 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":8,"success":false,"timestamp":156702,"type":"health_data_error"}
19:06:47.592 > [WebSocket] Processing message type: health_data_error
19:06:47.597 > [162.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:47.700 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125802401,"threatLevel":0,"type":"heuristics_update"}
19:06:47.725 > [WebSocket] Processing message type: heuristics_update
19:06:47.731 > [162.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:47.832 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":8,"success":false,"timestamp":156978,"type":"health_data_error"}
19:06:47.847 > [WebSocket] Processing message type: health_data_error
19:06:47.853 > [162.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:47.955 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":8,"success":false,"timestamp":157470,"type":"health_data_error"}
19:06:47.968 > [WebSocket] Processing message type: health_data_error
19:06:47.974 > [162.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:48.077 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125803401,"threatLevel":0,"type":"heuristics_update"}
19:06:48.102 > [WebSocket] Processing message type: heuristics_update
19:06:48.107 > [162.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:48.210 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125804402,"threatLevel":0,"type":"heuristics_update"}
19:06:48.235 > [WebSocket] Processing message type: heuristics_update
19:06:48.241 > [162.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:48.343 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125805403,"threatLevel":0,"type":"heuristics_update"}
19:06:48.369 > [WebSocket] Processing message type: heuristics_update
19:06:48.374 > [162.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:48.476 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125805627,"type":"master_key_received"}
19:06:48.489 > [WebSocket] Processing message type: master_key_received
19:06:48.493 > [162.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:48.598 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":160219,"type":"master_key_exchanged"}
19:06:48.615 > [WebSocket] Processing message type: master_key_exchanged
19:06:48.621 > [163.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:48.720 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125806404,"threatLevel":0,"type":"heuristics_update"}
19:06:48.745 > [WebSocket] Processing message type: heuristics_update
19:06:48.750 > [163.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:48.853 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":160898,"type":"symmetric_keys_derived"}
19:06:48.869 > [WebSocket] Processing message type: symmetric_keys_derived
19:06:48.875 > [163.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:48.975 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125807405,"threatLevel":0,"type":"heuristics_update"}
19:06:48.999 > [WebSocket] Processing message type: heuristics_update
19:06:49.005 > [163.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:49.111 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125808405,"threatLevel":0,"type":"heuristics_update"}
19:06:49.135 > [WebSocket] Processing message type: heuristics_update
19:06:49.141 > [163.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:49.244 > [163.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:49.345 > [163.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:49.446 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125809405,"threatLevel":0,"type":"heuristics_update"}
19:06:49.472 > [WebSocket] Processing message type: heuristics_update
19:06:49.477 > [163.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:49.579 > [164.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:49.679 > [164.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:49.780 > [164.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:49.881 > [164.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:49.983 > [164.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:50.083 > [164.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:50.185 > [164.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:50.285 > [164.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:50.386 > [164.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:50.488 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125810406,"threatLevel":0,"type":"heuristics_update"}
19:06:50.513 > [WebSocket] Processing message type: heuristics_update
19:06:50.518 > [164.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:50.621 > [165.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:50.721 > [165.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:50.823 > [165.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:50.923 > [165.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:51.024 > [165.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:51.125 > [165.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:51.226 > [165.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:51.327 > [165.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:51.429 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125811407,"threatLevel":0,"type":"heuristics_update"}
19:06:51.454 > [WebSocket] Processing message type: heuristics_update
19:06:51.459 > [165.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:51.561 > [166.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:51.663 > [166.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:51.764 > [166.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:51.864 > [166.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:51.965 > [166.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:52.067 > [166.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:52.167 > [166.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:52.268 > [166.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:52.370 > [166.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:52.471 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125812408,"threatLevel":0,"type":"heuristics_update"}
19:06:52.496 > [WebSocket] Processing message type: heuristics_update
19:06:52.502 > [166.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:52.604 > [167.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:52.704 > [167.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:52.805 > [167.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:52.906 > [167.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:53.007 > [167.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:53.108 > [167.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:53.209 > [167.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:53.310 > [167.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:53.412 > [167.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:53.513 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125813409,"threatLevel":0,"type":"heuristics_update"}
19:06:53.537 > [WebSocket] Processing message type: heuristics_update
19:06:53.544 > [167.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:53.645 > [168.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:53.746 > [168.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:53.848 > [168.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:53.948 > [168.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:54.049 > [168.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:54.151 > [168.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:54.251 > [168.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:54.352 > [168.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:54.456 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125814409,"threatLevel":0,"type":"heuristics_update"}
19:06:54.481 > [WebSocket] Processing message type: heuristics_update
19:06:54.487 > [168.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:54.589 > [169.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:54.689 > [169.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:54.790 > [169.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:54.891 > [169.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:54.992 > [169.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:55.092 > [169.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:55.194 > [169.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:55.295 > [169.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:55.396 > [169.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:55.497 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125815410,"threatLevel":0,"type":"heuristics_update"}
19:06:55.523 > [WebSocket] Processing message type: heuristics_update
19:06:55.529 > [169.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:55.630 > [170.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:55.732 > [170.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:55.832 > [170.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:55.933 > [170.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:56.034 > [170.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:56.135 > [170.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:56.236 > [170.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:56.337 > [170.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:56.439 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125816410,"threatLevel":0,"type":"heuristics_update"}
19:06:56.464 > [WebSocket] Processing message type: heuristics_update
19:06:56.470 > [170.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:56.571 > [171.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:56.577 > [RETRY] Attempting to send health data (Max retries: 3)
19:06:56.582 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:06:56.588 > Generated health data: HR-62 SPO2-95 STEPS-878
19:06:56.591 > [ESP32] ========================================
19:06:56.597 > [ESP32] ENCRYPTION PIPELINE START
19:06:56.599 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:06:56.605 > [ESP32] Active Algorithms for this packet:
19:06:56.608 > [ESP32]   + LFSR
19:06:56.610 > [ESP32]   + Tinkerbell
19:06:56.613 > [ESP32]   + Transposition
19:06:56.613 > [ESP32]   - ChaCha20
19:06:56.616 > [ESP32]   - Salsa20
19:06:56.619 > [ESP32] ========================================
19:06:56.622 > [ESP32] MsgKeys: lfsrSeed=0x2DFF11D5 tnk[0..3]=C16273B0 trn[0..3]=8A4D2C09
19:06:56.630 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3837384D50
19:06:56.636 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3837384D5000000000000000 
19:06:56.644 > [ESP32][LFSR] Initializing - Seed: 0x2DFF11D5 SeedBe: 0xD511FF2D ChaosKey[0..3]: C16273B0 InitialTap: 0x0029 State: 0x2DFF11D5
19:06:56.655 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:06:56.661 > 3_After_LFSR (32): 9D43D21BD7CFA153BEB9B6AEABDD32F5 7845E28A813E70609EBAAAE85F2705F5 
19:06:56.669 > [ESP32][LFSR] Keystream (first 16 bytes): D511FF2DE5EFF203F18B9B979EFD61A1
19:06:56.677 > [ESP32][4D] LFSR keystream (first 32 bytes): D511FF2DE5EFF203F18B9B979EFD61A13D15B1A7B909482DCEBAAAE85F2705F5
19:06:56.686 > [ESP32][TINKERBELL] Input (first 16 bytes): 9D43D21BD7CFA153BEB9B6AEABDD32F5 Nonce: 0x00000001 Buffer size: 32 bytes
19:06:56.697 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: C16273B0
19:06:56.705 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 7ABA872B10FE9C6D41101F60F88F70F8
19:06:56.713 > 4_After_Tinkerbell (32): E7F95530C7313D3EFFA9A9CE5352420D 695D7EF5E61F9A66CF1C67288320CF28 
19:06:56.722 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 7ABA872B10FE9C6D41101F60F88F70F8
19:06:56.731 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 7ABA872B10FE9C6D41101F60F88F70F811189C7F6721EA0651A6CDC0DC07CADD
19:06:56.742 > 5_After_Transposition (32): E7F9420D7EF55352FFA93D3E5530C731 695D9A66A9CEE61F20836728CF28CF1C 
19:06:56.749 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:06:56.753 > [ESP32] === HMAC DEBUG INFO ===
19:06:56.755 > [ESP32] HMAC Key being used: B9EE652BD85B4FE58418B32B45A2F39C66147685873867222687483AB0FB46FB
19:06:56.764 > [ESP32] HMAC Input length: 45 bytes
19:06:56.767 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000001E7F9420D7EF55352FFA93D3E5530C731695D9A
19:06:56.777 > [ESP32] Nonce: 0x00000001
19:06:56.777 > [ESP32] Packet size before HMAC: 61
19:06:56.780 > [ESP32] Computed HMAC Tag: C56402AD232348A47A38FB35C439774B
19:06:56.786 > [ESP32] === END HMAC DEBUG ===
19:06:56.788 > 6_Final_Packet (61): 82021700170004080400000001E7F942 0D7EF55352FFA93D3E5530C731695D9A ...
19:06:56.797 > [RETRY] Attempt 1/3 (nonce: 1)
19:06:56.800 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:56.806 > Sending pipeline data to server (606 bytes)
19:06:57.108 > [HTTP] Response code: 400
19:06:57.108 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:57.113 > [HTTP] Request failed with code: 400
19:06:57.116 > [RETRY] Send failed, waiting 100 ms before retry
19:06:57.217 > [RETRY] Attempt 2/3 (nonce: 1)
19:06:57.217 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:57.223 > Sending pipeline data to server (606 bytes)
19:06:57.592 > [HTTP] Response code: 400
19:06:57.592 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:57.597 > [HTTP] Request failed with code: 400
19:06:57.600 > [RETRY] Send failed, waiting 200 ms before retry
19:06:57.800 > [RETRY] Attempt 3/3 (nonce: 1)
19:06:57.800 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:57.805 > Sending pipeline data to server (606 bytes)
19:06:58.134 > [HTTP] Response code: 400
19:06:58.135 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:58.141 > [HTTP] Request failed with code: 400
19:06:58.143 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:06:58.149 > [RETRY] Consecutive failures: 5
19:06:58.152 > [EMERGENCY] Triggering emergency reset!
19:06:58.154 > [CRYPTO] Resetting cryptographic state
19:06:58.160 > [CRYPTO] Crypto state reset complete
19:06:58.163 > [CRYPTO] Packet counter: 3
19:06:58.166 > [EMERGENCY] Emergency reset complete
19:06:58.169 > Health data send failed (retry count: 1/3)
19:06:58.265 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":171517,"type":"health_data_error"}
19:06:58.280 > [WebSocket] Processing message type: health_data_error
19:06:58.288 > [172.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:58.303 > [RETRY] Attempting to send health data (Max retries: 3)
19:06:58.303 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:06:58.305 > Generated health data: HR-62 SPO2-95 STEPS-900
19:06:58.307 > [ESP32] ========================================
19:06:58.313 > [ESP32] ENCRYPTION PIPELINE START
19:06:58.315 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:06:58.321 > [ESP32] Active Algorithms for this packet:
19:06:58.329 > [ESP32]   + LFSR
19:06:58.329 > [ESP32]   + Tinkerbell
19:06:58.329 > [ESP32]   + Transposition
19:06:58.329 > [ESP32]   - ChaCha20
19:06:58.334 > [ESP32]   - Salsa20
19:06:58.334 > [ESP32] ========================================
19:06:58.337 > [ESP32] MsgKeys: lfsrSeed=0x2DFF11D5 tnk[0..3]=C16273B0 trn[0..3]=8A4D2C09
19:06:58.343 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3930304D50
19:06:58.349 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3930304D5000000000000000 
19:06:58.357 > [ESP32][LFSR] Initializing - Seed: 0x2DFF11D5 SeedBe: 0xD511FF2D ChaosKey[0..3]: C16273B0 InitialTap: 0x0029 State: 0x2DFF11D5
19:06:58.368 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:06:58.376 > 3_After_LFSR (32): 9D43D21BD7CFA153BEB9B6AEABDD32F5 7845E28A803978609EBAAAE85F2705F5 
19:06:58.385 > [ESP32][LFSR] Keystream (first 16 bytes): D511FF2DE5EFF203F18B9B979EFD61A1
19:06:58.391 > [ESP32][4D] LFSR keystream (first 32 bytes): D511FF2DE5EFF203F18B9B979EFD61A13D15B1A7B909482DCEBAAAE85F2705F5
19:06:58.402 > [ESP32][TINKERBELL] Input (first 16 bytes): 9D43D21BD7CFA153BEB9B6AEABDD32F5 Nonce: 0x00000001 Buffer size: 32 bytes
19:06:58.410 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: C16273B0
19:06:58.421 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 7ABA872B10FE9C6D41101F60F88F70F8
19:06:58.429 > 4_After_Tinkerbell (32): E7F95530C7313D3EFFA9A9CE5352420D 695D7EF5E7189266CF1C67288320CF28 
19:06:58.438 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 7ABA872B10FE9C6D41101F60F88F70F8
19:06:58.446 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 7ABA872B10FE9C6D41101F60F88F70F811189C7F6721EA0651A6CDC0DC07CADD
19:06:58.454 > 5_After_Transposition (32): E7F9420D7EF55352FFA93D3E5530C731 695D9266A9CEE71820836728CF28CF1C 
19:06:58.462 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:06:58.468 > [ESP32] === HMAC DEBUG INFO ===
19:06:58.471 > [ESP32] HMAC Key being used: B9EE652BD85B4FE58418B32B45A2F39C66147685873867222687483AB0FB46FB
19:06:58.479 > [ESP32] HMAC Input length: 45 bytes
19:06:58.482 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000001E7F9420D7EF55352FFA93D3E5530C731695D92
19:06:58.490 > [ESP32] Nonce: 0x00000001
19:06:58.492 > [ESP32] Packet size before HMAC: 61
19:06:58.496 > [ESP32] Computed HMAC Tag: DC8C439E2D8118B1DF83022714B7B067
19:06:58.502 > [ESP32] === END HMAC DEBUG ===
19:06:58.504 > 6_Final_Packet (61): 82021700170004080400000001E7F942 0D7EF55352FFA93D3E5530C731695D92 ...
19:06:58.512 > [RETRY] Attempt 1/3 (nonce: 1)
19:06:58.515 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:58.521 > Sending pipeline data to server (606 bytes)
19:06:58.855 > [HTTP] Response code: 400
19:06:58.855 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:58.860 > [HTTP] Request failed with code: 400
19:06:58.864 > [RETRY] Send failed, waiting 100 ms before retry
19:06:58.963 > [RETRY] Attempt 2/3 (nonce: 1)
19:06:58.965 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:58.970 > Sending pipeline data to server (606 bytes)
19:06:59.122 > [HTTP] Response code: 400
19:06:59.122 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:59.127 > [HTTP] Request failed with code: 400
19:06:59.130 > [RETRY] Send failed, waiting 200 ms before retry
19:06:59.330 > [RETRY] Attempt 3/3 (nonce: 1)
19:06:59.330 > POST http://10.249.92.115:8081/health-data with pipeline data
19:06:59.335 > Sending pipeline data to server (606 bytes)
19:06:59.618 > [HTTP] Response code: 400
19:06:59.618 > [HTTP] Error response: {"error":"Decryption failed"}
19:06:59.624 > [HTTP] Request failed with code: 400
19:06:59.627 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:06:59.632 > [RETRY] Consecutive failures: 1
19:06:59.635 > Health data send failed (retry count: 2/3)
19:06:59.738 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125817411,"threatLevel":0,"type":"heuristics_update"}
19:06:59.762 > [WebSocket] Processing message type: heuristics_update
19:06:59.768 > [174.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:06:59.774 > [RETRY] Attempting to send health data (Max retries: 3)
19:06:59.780 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:06:59.785 > Generated health data: HR-62 SPO2-95 STEPS-894
19:06:59.788 > [ESP32] ========================================
19:06:59.792 > [ESP32] ENCRYPTION PIPELINE START
19:06:59.796 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:06:59.801 > [ESP32] Active Algorithms for this packet:
19:06:59.804 > [ESP32]   + LFSR
19:06:59.807 > [ESP32]   + Tinkerbell
19:06:59.810 > [ESP32]   + Transposition
19:06:59.810 > [ESP32]   - ChaCha20
19:06:59.812 > [ESP32]   - Salsa20
19:06:59.815 > [ESP32] ========================================
19:06:59.818 > [ESP32] MsgKeys: lfsrSeed=0x2DFF11D5 tnk[0..3]=C16273B0 trn[0..3]=8A4D2C09
19:06:59.826 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3839344D50
19:06:59.832 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3839344D5000000000000000 
19:06:59.840 > [ESP32][LFSR] Initializing - Seed: 0x2DFF11D5 SeedBe: 0xD511FF2D ChaosKey[0..3]: C16273B0 InitialTap: 0x0029 State: 0x2DFF11D5
19:06:59.852 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:06:59.857 > 3_After_LFSR (32): 9D43D21BD7CFA153BEB9B6AEABDD32F5 7845E28A81307C609EBAAAE85F2705F5 
19:06:59.866 > [ESP32][LFSR] Keystream (first 16 bytes): D511FF2DE5EFF203F18B9B979EFD61A1
19:06:59.874 > [ESP32][4D] LFSR keystream (first 32 bytes): D511FF2DE5EFF203F18B9B979EFD61A13D15B1A7B909482DCEBAAAE85F2705F5
19:06:59.882 > [ESP32][TINKERBELL] Input (first 16 bytes): 9D43D21BD7CFA153BEB9B6AEABDD32F5 Nonce: 0x00000001 Buffer size: 32 bytes
19:06:59.894 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: C16273B0
19:06:59.902 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 7ABA872B10FE9C6D41101F60F88F70F8
19:06:59.910 > 4_After_Tinkerbell (32): E7F95530C7313D3EFFA9A9CE5352420D 695D7EF5E6119666CF1C67288320CF28 
19:06:59.918 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 7ABA872B10FE9C6D41101F60F88F70F8
19:06:59.927 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 7ABA872B10FE9C6D41101F60F88F70F811189C7F6721EA0651A6CDC0DC07CADD
19:06:59.938 > 5_After_Transposition (32): E7F9420D7EF55352FFA93D3E5530C731 695D9666A9CEE61120836728CF28CF1C 
19:06:59.946 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:06:59.949 > [ESP32] === HMAC DEBUG INFO ===
19:06:59.951 > [ESP32] HMAC Key being used: B9EE652BD85B4FE58418B32B45A2F39C66147685873867222687483AB0FB46FB
19:06:59.960 > [ESP32] HMAC Input length: 45 bytes
19:06:59.963 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000001E7F9420D7EF55352FFA93D3E5530C731695D96
19:06:59.974 > [ESP32] Nonce: 0x00000001
19:06:59.974 > [ESP32] Packet size before HMAC: 61
19:06:59.977 > [ESP32] Computed HMAC Tag: 8F8FA0DD9654B4D3E9BA48494FE4C6C0
19:06:59.982 > [ESP32] === END HMAC DEBUG ===
19:06:59.985 > 6_Final_Packet (61): 82021700170004080400000001E7F942 0D7EF55352FFA93D3E5530C731695D96 ...
19:06:59.994 > [RETRY] Attempt 1/3 (nonce: 1)
19:06:59.995 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:00.002 > Sending pipeline data to server (606 bytes)
19:07:00.336 > [HTTP] Response code: 400
19:07:00.336 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:00.342 > [HTTP] Request failed with code: 400
19:07:00.344 > [RETRY] Send failed, waiting 100 ms before retry
19:07:00.444 > [RETRY] Attempt 2/3 (nonce: 1)
19:07:00.444 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:00.450 > Sending pipeline data to server (606 bytes)
19:07:00.652 > [HTTP] Response code: 400
19:07:00.652 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:00.658 > [HTTP] Request failed with code: 400
19:07:00.660 > [RETRY] Send failed, waiting 200 ms before retry
19:07:00.860 > [RETRY] Attempt 3/3 (nonce: 1)
19:07:00.860 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:00.865 > Sending pipeline data to server (606 bytes)
19:07:01.150 > [HTTP] Response code: 400
19:07:01.151 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:01.156 > [HTTP] Request failed with code: 400
19:07:01.158 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:07:01.164 > [RETRY] Consecutive failures: 2
19:07:01.167 > Health data send failed (retry count: 3/3)
19:07:01.169 > Health data transmission failed after max retries
19:07:01.268 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":172001,"type":"health_data_error"}
19:07:01.283 > [WebSocket] Processing message type: health_data_error
19:07:01.289 > [175.7] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:01.296 > ERROR state - attempting recovery
19:07:01.300 > [RETRY] Attempting to send health data (Max retries: 3)
19:07:01.305 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:07:01.308 > Generated health data: HR-62 SPO2-95 STEPS-915
19:07:01.313 > [ESP32] ========================================
19:07:01.316 > [ESP32] ENCRYPTION PIPELINE START
19:07:01.318 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:07:01.324 > [ESP32] Active Algorithms for this packet:
19:07:01.330 > [ESP32]   + LFSR
19:07:01.330 > [ESP32]   + Tinkerbell
19:07:01.333 > [ESP32]   + Transposition
19:07:01.335 > [ESP32]   - ChaCha20
19:07:01.335 > [ESP32]   - Salsa20
19:07:01.338 > [ESP32] ========================================
19:07:01.344 > [ESP32] MsgKeys: lfsrSeed=0x2DFF11D5 tnk[0..3]=C16273B0 trn[0..3]=8A4D2C09
19:07:01.349 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3931354D50
19:07:01.355 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3931354D5000000000000000 
19:07:01.363 > [ESP32][LFSR] Initializing - Seed: 0x2DFF11D5 SeedBe: 0xD511FF2D ChaosKey[0..3]: C16273B0 InitialTap: 0x0029 State: 0x2DFF11D5
19:07:01.374 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:07:01.382 > 3_After_LFSR (32): 9D43D21BD7CFA153BEB9B6AEABDD32F5 7845E28A80387D609EBAAAE85F2705F5 
19:07:01.391 > [ESP32][LFSR] Keystream (first 16 bytes): D511FF2DE5EFF203F18B9B979EFD61A1
19:07:01.396 > [ESP32][4D] LFSR keystream (first 32 bytes): D511FF2DE5EFF203F18B9B979EFD61A13D15B1A7B909482DCEBAAAE85F2705F5
19:07:01.405 > [ESP32][TINKERBELL] Input (first 16 bytes): 9D43D21BD7CFA153BEB9B6AEABDD32F5 Nonce: 0x00000001 Buffer size: 32 bytes
19:07:01.416 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: C16273B0
19:07:01.427 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 7ABA872B10FE9C6D41101F60F88F70F8
19:07:01.435 > 4_After_Tinkerbell (32): E7F95530C7313D3EFFA9A9CE5352420D 695D7EF5E7199766CF1C67288320CF28 
19:07:01.441 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 7ABA872B10FE9C6D41101F60F88F70F8
19:07:01.450 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 7ABA872B10FE9C6D41101F60F88F70F811189C7F6721EA0651A6CDC0DC07CADD
19:07:01.461 > 5_After_Transposition (32): E7F9420D7EF55352FFA93D3E5530C731 695D9766A9CEE71920836728CF28CF1C 
19:07:01.468 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:07:01.474 > [ESP32] === HMAC DEBUG INFO ===
19:07:01.477 > [ESP32] HMAC Key being used: B9EE652BD85B4FE58418B32B45A2F39C66147685873867222687483AB0FB46FB
19:07:01.485 > [ESP32] HMAC Input length: 45 bytes
19:07:01.488 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000001E7F9420D7EF55352FFA93D3E5530C731695D97
19:07:01.497 > [ESP32] Nonce: 0x00000001
19:07:01.499 > [ESP32] Packet size before HMAC: 61
19:07:01.502 > [ESP32] Computed HMAC Tag: 5D1E5E4A96E78A39204EFC62D5F488ED
19:07:01.507 > [ESP32] === END HMAC DEBUG ===
19:07:01.511 > 6_Final_Packet (61): 82021700170004080400000001E7F942 0D7EF55352FFA93D3E5530C731695D97 ...
19:07:01.518 > [RETRY] Attempt 1/3 (nonce: 1)
19:07:01.522 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:01.524 > Sending pipeline data to server (606 bytes)
19:07:01.876 > [HTTP] Response code: 400
19:07:01.876 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:01.881 > [HTTP] Request failed with code: 400
19:07:01.884 > [RETRY] Send failed, waiting 100 ms before retry
19:07:01.983 > [RETRY] Attempt 2/3 (nonce: 1)
19:07:01.983 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:01.990 > Sending pipeline data to server (606 bytes)
19:07:02.141 > [HTTP] Response code: 400
19:07:02.141 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:02.146 > [HTTP] Request failed with code: 400
19:07:02.149 > [RETRY] Send failed, waiting 200 ms before retry
19:07:02.348 > [RETRY] Attempt 3/3 (nonce: 1)
19:07:02.350 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:02.355 > Sending pipeline data to server (606 bytes)
19:07:02.640 > [HTTP] Response code: 400
19:07:02.640 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:02.646 > [HTTP] Request failed with code: 400
19:07:02.648 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:07:02.654 > [RETRY] Consecutive failures: 3
19:07:02.657 > ✗ Auto-recovery failed - restarting key exchange
19:07:04.759 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":172543,"type":"health_data_error"}
19:07:04.773 > [WebSocket] Processing message type: health_data_error
19:07:04.779 > [179.2] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:04.788 > ✓ Public key loaded from NVS
19:07:04.889 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125818412,"threatLevel":0,"type":"heuristics_update"}
19:07:04.914 > [WebSocket] Processing message type: heuristics_update
19:07:04.920 > [179.3] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:05.023 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":173264,"type":"health_data_error"}
19:07:05.036 > [WebSocket] Processing message type: health_data_error
19:07:05.042 > [179.4] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:05.051 > Generating fresh master key from entropy...
19:07:05.059 > Generated master key (32): 214E25726FB5F09F58007DD5B1833F11 77518AD5C23EABC704FB9723B359E954 
19:07:05.065 > Using reduced master key (byte % 3) for NTRU encryption only
19:07:05.074 > NTRU encrypted master key (502): 0021006E001F0015007D001C00060062 00450077003B000C0000007600680070 ...
19:07:05.083 > POST http://10.249.92.115:8081/master-key
19:07:05.654 > ✓ Master key exchange completed
19:07:05.756 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":173530,"type":"health_data_error"}
19:07:05.770 > [WebSocket] Processing message type: health_data_error
19:07:05.775 > [180.2] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:05.784 > Loading master key from NVS and deriving symmetric keys...
19:07:05.789 > Loaded master key from NVS (32): 214E25726FB5F09F58007DD5B1833F11 77518AD5C23EABC704FB9723B359E954 
19:07:05.797 > Derived HMAC key (32): 4D5AD2DAF99909B4F2FB3181B7CA6BF1 68036721CC6651E72E5F0EADF394B222 
19:07:05.806 > Derived Tinkerbell key (16): 55BC39DBD19C2D4F7B93F38475FEC527 
19:07:05.812 > Derived Transposition key (16): D09D5FE410101A20E41F9977A5ED0043 
19:07:05.817 > ✓ Symmetric keys derived successfully
19:07:05.820 > Nonce tracker reset - new session started
19:07:06.316 > Waiting for server to process master key...
19:07:06.321 > ✓ Symmetric keys ready - starting health data transmission
19:07:06.423 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125819413,"threatLevel":0,"type":"heuristics_update"}
19:07:06.447 > [WebSocket] Processing message type: heuristics_update
19:07:06.453 > [180.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:06.555 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":174027,"type":"health_data_error"}
19:07:06.570 > [WebSocket] Processing message type: health_data_error
19:07:06.575 > [181.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:06.677 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":174745,"type":"health_data_error"}
19:07:06.691 > [WebSocket] Processing message type: health_data_error
19:07:06.697 > [181.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:06.799 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125820413,"threatLevel":0,"type":"heuristics_update"}
19:07:06.824 > [WebSocket] Processing message type: heuristics_update
19:07:06.830 > [181.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:06.933 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":175061,"type":"health_data_error"}
19:07:06.947 > [WebSocket] Processing message type: health_data_error
19:07:06.953 > [181.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:07.055 > [181.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:07.156 > [181.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:07.257 > [181.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:07.358 > [181.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:07.459 > [181.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:07.559 > [182.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:07.661 > [182.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:07.762 > [182.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:07.866 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":175559,"type":"health_data_error"}
19:07:07.880 > [WebSocket] Processing message type: health_data_error
19:07:07.885 > [182.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:07.988 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125821414,"threatLevel":0,"type":"heuristics_update"}
19:07:08.013 > [WebSocket] Processing message type: heuristics_update
19:07:08.019 > [182.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:08.121 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":8,"success":false,"timestamp":176284,"type":"health_data_error"}
19:07:08.135 > [WebSocket] Processing message type: health_data_error
19:07:08.141 > [182.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:08.243 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":8,"success":false,"timestamp":176549,"type":"health_data_error"}
19:07:08.257 > [WebSocket] Processing message type: health_data_error
19:07:08.263 > [182.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:08.365 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125822415,"threatLevel":0,"type":"heuristics_update"}
19:07:08.390 > [WebSocket] Processing message type: heuristics_update
19:07:08.396 > [182.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:08.498 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":8,"success":false,"timestamp":177049,"type":"health_data_error"}
19:07:08.513 > [WebSocket] Processing message type: health_data_error
19:07:08.518 > [182.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:08.620 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125823415,"threatLevel":0,"type":"heuristics_update"}
19:07:08.645 > [WebSocket] Processing message type: heuristics_update
19:07:08.651 > [183.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:08.754 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125824416,"threatLevel":0,"type":"heuristics_update"}
19:07:08.779 > [WebSocket] Processing message type: heuristics_update
19:07:08.784 > [183.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:08.886 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125825417,"threatLevel":0,"type":"heuristics_update"}
19:07:08.911 > [WebSocket] Processing message type: heuristics_update
19:07:08.917 > [183.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:09.020 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125825425,"type":"master_key_received"}
19:07:09.034 > [WebSocket] Processing message type: master_key_received
19:07:09.036 > [183.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:09.141 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":180056,"type":"master_key_exchanged"}
19:07:09.157 > [WebSocket] Processing message type: master_key_exchanged
19:07:09.164 > [183.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:09.263 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":180724,"type":"symmetric_keys_derived"}
19:07:09.280 > [WebSocket] Processing message type: symmetric_keys_derived
19:07:09.285 > [183.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:09.385 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125826418,"threatLevel":0,"type":"heuristics_update"}
19:07:09.410 > [WebSocket] Processing message type: heuristics_update
19:07:09.416 > [183.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:09.521 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125827419,"threatLevel":0,"type":"heuristics_update"}
19:07:09.546 > [WebSocket] Processing message type: heuristics_update
19:07:09.552 > [183.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:09.654 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125828420,"threatLevel":0,"type":"heuristics_update"}
19:07:09.680 > [WebSocket] Processing message type: heuristics_update
19:07:09.685 > [184.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:09.788 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125829420,"threatLevel":0,"type":"heuristics_update"}
19:07:09.812 > [WebSocket] Processing message type: heuristics_update
19:07:09.818 > [184.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:09.920 > [184.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:10.021 > [184.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:10.121 > [184.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:10.222 > [184.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:10.324 > [184.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:10.425 > [184.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:10.527 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125830421,"threatLevel":0,"type":"heuristics_update"}
19:07:10.552 > [WebSocket] Processing message type: heuristics_update
19:07:10.557 > [185.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:10.659 > [185.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:10.759 > [185.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:10.861 > [185.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:10.962 > [185.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:11.063 > [185.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:11.164 > [185.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:11.265 > [185.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:11.365 > [185.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:11.467 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125831422,"threatLevel":0,"type":"heuristics_update"}
19:07:11.493 > [WebSocket] Processing message type: heuristics_update
19:07:11.499 > [185.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:11.600 > [186.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:11.700 > [186.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:11.802 > [186.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:11.903 > [186.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:12.004 > [186.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:12.105 > [186.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:12.206 > [186.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:12.307 > [186.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:12.407 > [186.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:12.509 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125832423,"threatLevel":0,"type":"heuristics_update"}
19:07:12.534 > [WebSocket] Processing message type: heuristics_update
19:07:12.540 > [186.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:12.642 > [187.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:12.743 > [187.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:12.844 > [187.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:12.945 > [187.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:13.046 > [187.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:13.147 > [187.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:13.247 > [187.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:13.349 > [187.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:13.451 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125833424,"threatLevel":0,"type":"heuristics_update"}
19:07:13.475 > [WebSocket] Processing message type: heuristics_update
19:07:13.481 > [187.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:13.583 > [188.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:13.684 > [188.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:13.784 > [188.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:13.886 > [188.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:13.987 > [188.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:14.088 > [188.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:14.189 > [188.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:14.289 > [188.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:14.390 > [188.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:14.492 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125834425,"threatLevel":0,"type":"heuristics_update"}
19:07:14.517 > [WebSocket] Processing message type: heuristics_update
19:07:14.523 > [188.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:14.625 > [189.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:14.726 > [189.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:14.827 > [189.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:14.928 > [189.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:15.029 > [189.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:15.130 > [189.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:15.231 > [189.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:15.332 > [189.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:15.433 > [189.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:15.536 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125835425,"threatLevel":0,"type":"heuristics_update"}
19:07:15.561 > [WebSocket] Processing message type: heuristics_update
19:07:15.567 > [190.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:15.668 > [190.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:15.769 > [190.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:15.870 > [190.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:15.972 > [190.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:16.072 > [190.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:16.174 > [190.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:16.274 > [190.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:16.376 > [190.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:16.382 > [RETRY] Attempting to send health data (Max retries: 3)
19:07:16.386 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:07:16.392 > Generated health data: HR-63 SPO2-95 STEPS-983
19:07:16.396 > [ESP32] ========================================
19:07:16.401 > [ESP32] ENCRYPTION PIPELINE START
19:07:16.404 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:07:16.409 > [ESP32] Active Algorithms for this packet:
19:07:16.412 > [ESP32]   + LFSR
19:07:16.415 > [ESP32]   + Tinkerbell
19:07:16.417 > [ESP32]   + Transposition
19:07:16.417 > [ESP32]   - ChaCha20
19:07:16.421 > [ESP32]   - Salsa20
19:07:16.423 > [ESP32] ========================================
19:07:16.426 > [ESP32] MsgKeys: lfsrSeed=0x23604ED7 tnk[0..3]=B952C0ED trn[0..3]=5520556F
19:07:16.434 > 1_After_Salt (25): 48522D36332053504F322D3935205354 4550532D3938334D50
19:07:16.441 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D3938334D5000000000000000 
19:07:16.448 > [ESP32][LFSR] Initializing - Seed: 0x23604ED7 SeedBe: 0xD74E6023 ChaosKey[0..3]: B952C0ED InitialTap: 0x0029 State: 0x23604ED7
19:07:16.459 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:07:16.465 > 3_After_LFSR (32): 9F1C4D1540CE6D9FA0E84E37B1FA9CCA FFF8EBAF1F9FA509DF8CCF1DDFA307A6 
19:07:16.473 > [ESP32][LFSR] Keystream (first 16 bytes): D74E602373EE3ECFEFDA630E84DACF9E
19:07:16.482 > [ESP32][4D] LFSR keystream (first 32 bytes): D74E602373EE3ECFEFDA630E84DACF9EBAA8B88226A796448F8CCF1DDFA307A6
19:07:16.490 > [ESP32][TINKERBELL] Input (first 16 bytes): 9F1C4D1540CE6D9FA0E84E37B1FA9CCA Nonce: 0x00000001 Buffer size: 32 bytes
19:07:16.501 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: B952C0ED
19:07:16.510 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): CEEBCA83ECFD003B0248DFA23367C366
19:07:16.518 > 4_After_Tinkerbell (32): 51F78796AC336DA4A2A09195829D5FAC 3E83F942242BADFAA25D0FB8D89F353F 
19:07:16.526 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): CEEBCA83ECFD003B0248DFA23367C366
19:07:16.534 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): CEEBCA83ECFD003B0248DFA23367C366C17B12ED3BB408F37DD1C0A5073C3299
19:07:16.546 > 5_After_Transposition (32): 3E3396FA8783429FA29D953F915DB82B 6DA4D8A20FAD82F75FAC2451F935ACA0 
19:07:16.554 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:07:16.557 > [ESP32] === HMAC DEBUG INFO ===
19:07:16.559 > [ESP32] HMAC Key being used: 4D5AD2DAF99909B4F2FB3181B7CA6BF168036721CC6651E72E5F0EADF394B222
19:07:16.567 > [ESP32] HMAC Input length: 45 bytes
19:07:16.571 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000013E3396FA8783429FA29D953F915DB82B6DA4D8
19:07:16.581 > [ESP32] Nonce: 0x00000001
19:07:16.581 > [ESP32] Packet size before HMAC: 61
19:07:16.584 > [ESP32] Computed HMAC Tag: DD7403C8FE6C3D7504B68F3EC83FFC5A
19:07:16.589 > [ESP32] === END HMAC DEBUG ===
19:07:16.592 > 6_Final_Packet (61): 820217001700040804000000013E3396 FA8783429FA29D953F915DB82B6DA4D8 ...
19:07:16.601 > [RETRY] Attempt 1/3 (nonce: 1)
19:07:16.604 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:16.609 > Sending pipeline data to server (606 bytes)
19:07:17.180 > [HTTP] Response code: 400
19:07:17.180 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:17.185 > [HTTP] Request failed with code: 400
19:07:17.188 > [RETRY] Send failed, waiting 100 ms before retry
19:07:17.288 > [RETRY] Attempt 2/3 (nonce: 1)
19:07:17.288 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:17.293 > Sending pipeline data to server (606 bytes)
19:07:17.662 > [HTTP] Response code: 400
19:07:17.662 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:17.668 > [HTTP] Request failed with code: 400
19:07:17.671 > [RETRY] Send failed, waiting 200 ms before retry
19:07:17.871 > [RETRY] Attempt 3/3 (nonce: 1)
19:07:17.871 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:17.877 > Sending pipeline data to server (606 bytes)
19:07:18.158 > [HTTP] Response code: 400
19:07:18.158 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:18.164 > [HTTP] Request failed with code: 400
19:07:18.167 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:07:18.172 > [RETRY] Consecutive failures: 4
19:07:18.175 > Health data send failed (retry count: 1/3)
19:07:18.277 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125836426,"threatLevel":0,"type":"heuristics_update"}
19:07:18.302 > [WebSocket] Processing message type: heuristics_update
19:07:18.308 > [192.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:18.314 > [RETRY] Attempting to send health data (Max retries: 3)
19:07:18.320 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:07:18.325 > Generated health data: HR-63 SPO2-95 STEPS-1007
19:07:18.327 > [ESP32] ========================================
19:07:18.334 > [ESP32] ENCRYPTION PIPELINE START
19:07:18.336 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:07:18.341 > [ESP32] Active Algorithms for this packet:
19:07:18.345 > [ESP32]   + LFSR
19:07:18.347 > [ESP32]   + Tinkerbell
19:07:18.349 > [ESP32]   + Transposition
19:07:18.349 > [ESP32]   - ChaCha20
19:07:18.353 > [ESP32]   - Salsa20
19:07:18.355 > [ESP32] ========================================
19:07:18.358 > [ESP32] MsgKeys: lfsrSeed=0x23604ED7 tnk[0..3]=B952C0ED trn[0..3]=5520556F
19:07:18.367 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313030374D50
19:07:18.372 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313030374D50000000000000 
19:07:18.381 > [ESP32][LFSR] Initializing - Seed: 0x23604ED7 SeedBe: 0xD74E6023 ChaosKey[0..3]: B952C0ED InitialTap: 0x0029 State: 0x23604ED7
19:07:18.392 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:07:18.402 > 3_After_LFSR (32): 9F1C4D1540CE6D9FA0E84E37B1FA9CCA FFF8EBAF1797A673C2DCCF1DDFA307A6 
19:07:18.408 > [ESP32][LFSR] Keystream (first 16 bytes): D74E602373EE3ECFEFDA630E84DACF9E
19:07:18.416 > [ESP32][4D] LFSR keystream (first 32 bytes): D74E602373EE3ECFEFDA630E84DACF9EBAA8B88226A796448F8CCF1DDFA307A6
19:07:18.424 > [ESP32][TINKERBELL] Input (first 16 bytes): 9F1C4D1540CE6D9FA0E84E37B1FA9CCA Nonce: 0x00000001 Buffer size: 32 bytes
19:07:18.435 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: B952C0ED
19:07:18.444 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): CEEBCA83ECFD003B0248DFA23367C366
19:07:18.452 > 4_After_Tinkerbell (32): 51F78796AC336DA4A2A09195829D5FAC 3E83F9422C23AE80BF0D0FB8D89F353F 
19:07:18.461 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): CEEBCA83ECFD003B0248DFA23367C366
19:07:18.469 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): CEEBCA83ECFD003B0248DFA23367C366C17B12ED3BB408F37DD1C0A5073C3299
19:07:18.480 > 5_After_Transposition (32): 3E3396808783429FBF9D953F910DB823 6DA4D8A20FAE82F75FAC2C51F935ACA0 
19:07:18.488 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:07:18.491 > [ESP32] === HMAC DEBUG INFO ===
19:07:18.494 > [ESP32] HMAC Key being used: 4D5AD2DAF99909B4F2FB3181B7CA6BF168036721CC6651E72E5F0EADF394B222
19:07:18.502 > [ESP32] HMAC Input length: 45 bytes
19:07:18.505 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000013E3396808783429FBF9D953F910DB8236DA4D8
19:07:18.516 > [ESP32] Nonce: 0x00000001
19:07:18.516 > [ESP32] Packet size before HMAC: 61
19:07:18.522 > [ESP32] Computed HMAC Tag: FCC282ED7A93253F5655D1A781328900
19:07:18.524 > [ESP32] === END HMAC DEBUG ===
19:07:18.527 > 6_Final_Packet (61): 820218001800040804000000013E3396 808783429FBF9D953F910DB8236DA4D8 ...
19:07:18.535 > [RETRY] Attempt 1/3 (nonce: 1)
19:07:18.538 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:18.544 > Sending pipeline data to server (609 bytes)
19:07:18.930 > [HTTP] Response code: 400
19:07:18.930 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:18.936 > [HTTP] Request failed with code: 400
19:07:18.938 > [RETRY] Send failed, waiting 100 ms before retry
19:07:19.039 > [RETRY] Attempt 2/3 (nonce: 1)
19:07:19.039 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:19.045 > Sending pipeline data to server (609 bytes)
19:07:19.177 > [HTTP] Response code: 400
19:07:19.178 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:19.183 > [HTTP] Request failed with code: 400
19:07:19.186 > [RETRY] Send failed, waiting 200 ms before retry
19:07:19.385 > [RETRY] Attempt 3/3 (nonce: 1)
19:07:19.385 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:19.391 > Sending pipeline data to server (609 bytes)
19:07:19.685 > [HTTP] Response code: 400
19:07:19.685 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:19.691 > [HTTP] Request failed with code: 400
19:07:19.693 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:07:19.698 > [RETRY] Consecutive failures: 5
19:07:19.701 > [EMERGENCY] Triggering emergency reset!
19:07:19.704 > [CRYPTO] Resetting cryptographic state
19:07:19.709 > [CRYPTO] Crypto state reset complete
19:07:19.712 > [CRYPTO] Packet counter: 4
19:07:19.715 > [EMERGENCY] Emergency reset complete
19:07:19.718 > Health data send failed (retry count: 2/3)
19:07:19.812 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":191589,"type":"health_data_error"}
19:07:19.827 > [WebSocket] Processing message type: health_data_error
19:07:19.833 > [194.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:19.840 > [RETRY] Attempting to send health data (Max retries: 3)
19:07:19.847 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:07:19.852 > Generated health data: HR-63 SPO2-95 STEPS-990
19:07:19.854 > [ESP32] ========================================
19:07:19.861 > [ESP32] ENCRYPTION PIPELINE START
19:07:19.864 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:07:19.868 > [ESP32] Active Algorithms for this packet:
19:07:19.872 > [ESP32]   + LFSR
19:07:19.872 > [ESP32]   + Tinkerbell
19:07:19.874 > [ESP32]   + Transposition
19:07:19.877 > [ESP32]   - ChaCha20
19:07:19.880 > [ESP32]   - Salsa20
19:07:19.880 > [ESP32] ========================================
19:07:19.885 > [ESP32] MsgKeys: lfsrSeed=0x23604ED7 tnk[0..3]=B952C0ED trn[0..3]=5520556F
19:07:19.891 > 1_After_Salt (25): 48522D36332053504F322D3935205354 4550532D3939304D50
19:07:19.897 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D3939304D5000000000000000 
19:07:19.905 > [ESP32][LFSR] Initializing - Seed: 0x23604ED7 SeedBe: 0xD74E6023 ChaosKey[0..3]: B952C0ED InitialTap: 0x0029 State: 0x23604ED7
19:07:19.916 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:07:19.924 > 3_After_LFSR (32): 9F1C4D1540CE6D9FA0E84E37B1FA9CCA FFF8EBAF1F9EA609DF8CCF1DDFA307A6 
19:07:19.933 > [ESP32][LFSR] Keystream (first 16 bytes): D74E602373EE3ECFEFDA630E84DACF9E
19:07:19.938 > [ESP32][4D] LFSR keystream (first 32 bytes): D74E602373EE3ECFEFDA630E84DACF9EBAA8B88226A796448F8CCF1DDFA307A6
19:07:19.950 > [ESP32][TINKERBELL] Input (first 16 bytes): 9F1C4D1540CE6D9FA0E84E37B1FA9CCA Nonce: 0x00000001 Buffer size: 32 bytes
19:07:19.958 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: B952C0ED
19:07:19.969 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): CEEBCA83ECFD003B0248DFA23367C366
19:07:19.977 > 4_After_Tinkerbell (32): 51F78796AC336DA4A2A09195829D5FAC 3E83F942242AAEFAA25D0FB8D89F353F 
19:07:19.985 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): CEEBCA83ECFD003B0248DFA23367C366
19:07:19.994 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): CEEBCA83ECFD003B0248DFA23367C366C17B12ED3BB408F37DD1C0A5073C3299
19:07:20.002 > 5_After_Transposition (32): 3E3396FA8783429FA29D953F915DB82A 6DA4D8A20FAE82F75FAC2451F935ACA0 
19:07:20.010 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:07:20.015 > [ESP32] === HMAC DEBUG INFO ===
19:07:20.018 > [ESP32] HMAC Key being used: 4D5AD2DAF99909B4F2FB3181B7CA6BF168036721CC6651E72E5F0EADF394B222
19:07:20.027 > [ESP32] HMAC Input length: 45 bytes
19:07:20.030 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000013E3396FA8783429FA29D953F915DB82A6DA4D8
19:07:20.037 > [ESP32] Nonce: 0x00000001
19:07:20.041 > [ESP32] Packet size before HMAC: 61
19:07:20.044 > [ESP32] Computed HMAC Tag: E3633E6FB2F0F2BBC4520894836FD134
19:07:20.049 > [ESP32] === END HMAC DEBUG ===
19:07:20.052 > 6_Final_Packet (61): 820217001700040804000000013E3396 FA8783429FA29D953F915DB82A6DA4D8 ...
19:07:20.060 > [RETRY] Attempt 1/3 (nonce: 1)
19:07:20.063 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:20.069 > Sending pipeline data to server (606 bytes)
19:07:20.422 > [HTTP] Response code: 400
19:07:20.422 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:20.427 > [HTTP] Request failed with code: 400
19:07:20.430 > [RETRY] Send failed, waiting 100 ms before retry
19:07:20.530 > [RETRY] Attempt 2/3 (nonce: 1)
19:07:20.530 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:20.536 > Sending pipeline data to server (606 bytes)
19:07:20.680 > [HTTP] Response code: 400
19:07:20.681 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:20.686 > [HTTP] Request failed with code: 400
19:07:20.689 > [RETRY] Send failed, waiting 200 ms before retry
19:07:20.888 > [RETRY] Attempt 3/3 (nonce: 1)
19:07:20.889 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:20.894 > Sending pipeline data to server (606 bytes)
19:07:21.180 > [HTTP] Response code: 400
19:07:21.180 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:21.185 > [HTTP] Request failed with code: 400
19:07:21.189 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:07:21.194 > [RETRY] Consecutive failures: 1
19:07:21.197 > Health data send failed (retry count: 3/3)
19:07:21.199 > Health data transmission failed after max retries
19:07:21.298 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125837426,"threatLevel":0,"type":"heuristics_update"}
19:07:21.322 > [WebSocket] Processing message type: heuristics_update
19:07:21.330 > [195.7] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:21.335 > ERROR state - attempting recovery
19:07:21.337 > [RETRY] Attempting to send health data (Max retries: 3)
19:07:21.343 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:07:21.348 > Generated health data: HR-63 SPO2-95 STEPS-1011
19:07:21.352 > [ESP32] ========================================
19:07:21.357 > [ESP32] ENCRYPTION PIPELINE START
19:07:21.359 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:07:21.365 > [ESP32] Active Algorithms for this packet:
19:07:21.369 > [ESP32]   + LFSR
19:07:21.370 > [ESP32]   + Tinkerbell
19:07:21.370 > [ESP32]   + Transposition
19:07:21.373 > [ESP32]   - ChaCha20
19:07:21.376 > [ESP32]   - Salsa20
19:07:21.376 > [ESP32] ========================================
19:07:21.382 > [ESP32] MsgKeys: lfsrSeed=0x23604ED7 tnk[0..3]=B952C0ED trn[0..3]=5520556F
19:07:21.388 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313031314D50
19:07:21.396 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313031314D50000000000000 
19:07:21.402 > [ESP32][LFSR] Initializing - Seed: 0x23604ED7 SeedBe: 0xD74E6023 ChaosKey[0..3]: B952C0ED InitialTap: 0x0029 State: 0x23604ED7
19:07:21.413 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:07:21.421 > 3_After_LFSR (32): 9F1C4D1540CE6D9FA0E84E37B1FA9CCA FFF8EBAF1797A775C2DCCF1DDFA307A6 
19:07:21.430 > [ESP32][LFSR] Keystream (first 16 bytes): D74E602373EE3ECFEFDA630E84DACF9E
19:07:21.435 > [ESP32][4D] LFSR keystream (first 32 bytes): D74E602373EE3ECFEFDA630E84DACF9EBAA8B88226A796448F8CCF1DDFA307A6
19:07:21.446 > [ESP32][TINKERBELL] Input (first 16 bytes): 9F1C4D1540CE6D9FA0E84E37B1FA9CCA Nonce: 0x00000001 Buffer size: 32 bytes
19:07:21.457 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: B952C0ED
19:07:21.465 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): CEEBCA83ECFD003B0248DFA23367C366
19:07:21.474 > 4_After_Tinkerbell (32): 51F78796AC336DA4A2A09195829D5FAC 3E83F9422C23AF86BF0D0FB8D89F353F 
19:07:21.482 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): CEEBCA83ECFD003B0248DFA23367C366
19:07:21.491 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): CEEBCA83ECFD003B0248DFA23367C366C17B12ED3BB408F37DD1C0A5073C3299
19:07:21.498 > 5_After_Transposition (32): 3E3396868783429FBF9D953F910DB823 6DA4D8A20FAF82F75FAC2C51F935ACA0 
19:07:21.507 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:07:21.512 > [ESP32] === HMAC DEBUG INFO ===
19:07:21.515 > [ESP32] HMAC Key being used: 4D5AD2DAF99909B4F2FB3181B7CA6BF168036721CC6651E72E5F0EADF394B222
19:07:21.523 > [ESP32] HMAC Input length: 45 bytes
19:07:21.526 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000013E3396868783429FBF9D953F910DB8236DA4D8
19:07:21.535 > [ESP32] Nonce: 0x00000001
19:07:21.538 > [ESP32] Packet size before HMAC: 61
19:07:21.540 > [ESP32] Computed HMAC Tag: 33AEF6A5C440666420D332F6D06BD2E5
19:07:21.546 > [ESP32] === END HMAC DEBUG ===
19:07:21.549 > 6_Final_Packet (61): 820218001800040804000000013E3396 868783429FBF9D953F910DB8236DA4D8 ...
19:07:21.557 > [RETRY] Attempt 1/3 (nonce: 1)
19:07:21.560 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:21.565 > Sending pipeline data to server (609 bytes)
19:07:21.941 > [HTTP] Response code: 400
19:07:21.941 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:21.946 > [HTTP] Request failed with code: 400
19:07:21.949 > [RETRY] Send failed, waiting 100 ms before retry
19:07:22.047 > [RETRY] Attempt 2/3 (nonce: 1)
19:07:22.047 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:22.053 > Sending pipeline data to server (609 bytes)
19:07:22.211 > [HTTP] Response code: 400
19:07:22.211 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:22.217 > [HTTP] Request failed with code: 400
19:07:22.220 > [RETRY] Send failed, waiting 200 ms before retry
19:07:22.420 > [RETRY] Attempt 3/3 (nonce: 1)
19:07:22.420 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:22.425 > Sending pipeline data to server (609 bytes)
19:07:22.712 > [HTTP] Response code: 400
19:07:22.712 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:22.717 > [HTTP] Request failed with code: 400
19:07:22.721 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:07:22.726 > [RETRY] Consecutive failures: 2
19:07:22.729 > ✗ Auto-recovery failed - restarting key exchange
19:07:24.832 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":192072,"type":"health_data_error"}
19:07:24.846 > [WebSocket] Processing message type: health_data_error
19:07:24.852 > [199.3] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:24.859 > ✓ Public key loaded from NVS
19:07:24.957 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":192568,"type":"health_data_error"}
19:07:24.972 > [WebSocket] Processing message type: health_data_error
19:07:24.977 > [199.4] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:25.083 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125838427,"threatLevel":0,"type":"heuristics_update"}
19:07:25.108 > [WebSocket] Processing message type: heuristics_update
19:07:25.114 > [199.5] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:25.123 > Generating fresh master key from entropy...
19:07:25.126 > Generated master key (32): 15E5702600A5F566A03A4106EA90FE3C C05A2C3ECEF82F617314B3E3CBE3492A 
19:07:25.137 > Using reduced master key (byte % 3) for NTRU encryption only
19:07:25.146 > NTRU encrypted master key (502): 0021006F001F0017007D001B00080062 00450078003B000C00000074006A006E ...
19:07:25.155 > POST http://10.249.92.115:8081/master-key
19:07:25.457 > ✓ Master key exchange completed
19:07:25.558 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":193339,"type":"health_data_error"}
19:07:25.572 > [WebSocket] Processing message type: health_data_error
19:07:25.577 > [200.0] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:25.587 > Loading master key from NVS and deriving symmetric keys...
19:07:25.591 > Loaded master key from NVS (32): 15E5702600A5F566A03A4106EA90FE3C C05A2C3ECEF82F617314B3E3CBE3492A 
19:07:25.599 > Derived HMAC key (32): A768D3DFE9A99F60B528BADF259A95B3 A352044A64DD0FE54FCC3045F5C97595 
19:07:25.608 > Derived Tinkerbell key (16): 269A1B5788D1D725CECB4C311DF615C4 
19:07:25.613 > Derived Transposition key (16): 28428F9AFE256179EBFBA045DC3A7BA8 
19:07:25.620 > ✓ Symmetric keys derived successfully
19:07:25.622 > Nonce tracker reset - new session started
19:07:26.118 > Waiting for server to process master key...
19:07:26.121 > ✓ Symmetric keys ready - starting health data transmission
19:07:26.224 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":193587,"type":"health_data_error"}
19:07:26.238 > [WebSocket] Processing message type: health_data_error
19:07:26.244 > [200.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:26.347 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125839428,"threatLevel":0,"type":"heuristics_update"}
19:07:26.372 > [WebSocket] Processing message type: heuristics_update
19:07:26.377 > [200.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:26.480 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":194094,"type":"health_data_error"}
19:07:26.494 > [WebSocket] Processing message type: health_data_error
19:07:26.499 > [200.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:26.603 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125840429,"threatLevel":0,"type":"heuristics_update"}
19:07:26.627 > [WebSocket] Processing message type: heuristics_update
19:07:26.634 > [201.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:26.736 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":194832,"type":"health_data_error"}
19:07:26.749 > [WebSocket] Processing message type: health_data_error
19:07:26.756 > [201.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:26.858 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":195090,"type":"health_data_error"}
19:07:26.872 > [WebSocket] Processing message type: health_data_error
19:07:26.878 > [201.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:26.980 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":7,"success":false,"timestamp":195589,"type":"health_data_error"}
19:07:26.995 > [WebSocket] Processing message type: health_data_error
19:07:27.000 > [201.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:27.103 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125841429,"threatLevel":0,"type":"heuristics_update"}
19:07:27.127 > [WebSocket] Processing message type: heuristics_update
19:07:27.134 > [201.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:27.235 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":8,"success":false,"timestamp":196350,"type":"health_data_error"}
19:07:27.250 > [WebSocket] Processing message type: health_data_error
19:07:27.256 > [201.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:27.357 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":8,"success":false,"timestamp":196620,"type":"health_data_error"}
19:07:27.372 > [WebSocket] Processing message type: health_data_error
19:07:27.377 > [201.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:27.480 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125842430,"threatLevel":0,"type":"heuristics_update"}
19:07:27.504 > [WebSocket] Processing message type: heuristics_update
19:07:27.511 > [201.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:27.612 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Failed to send health data","state":8,"success":false,"timestamp":197121,"type":"health_data_error"}
19:07:27.627 > [WebSocket] Processing message type: health_data_error
19:07:27.633 > [202.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:27.735 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125843430,"threatLevel":0,"type":"heuristics_update"}
19:07:27.760 > [WebSocket] Processing message type: heuristics_update
19:07:27.766 > [202.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:27.867 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125844432,"threatLevel":0,"type":"heuristics_update"}
19:07:27.893 > [WebSocket] Processing message type: heuristics_update
19:07:27.898 > [202.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:28.000 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125845233,"type":"master_key_received"}
19:07:28.014 > [WebSocket] Processing message type: master_key_received
19:07:28.017 > [202.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:28.123 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125845432,"threatLevel":0,"type":"heuristics_update"}
19:07:28.147 > [WebSocket] Processing message type: heuristics_update
19:07:28.154 > [202.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:28.256 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":199858,"type":"master_key_exchanged"}
19:07:28.272 > [WebSocket] Processing message type: master_key_exchanged
19:07:28.277 > [202.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:28.378 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":200527,"type":"symmetric_keys_derived"}
19:07:28.395 > [WebSocket] Processing message type: symmetric_keys_derived
19:07:28.400 > [202.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:28.500 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125846433,"threatLevel":0,"type":"heuristics_update"}
19:07:28.524 > [WebSocket] Processing message type: heuristics_update
19:07:28.530 > [202.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:28.635 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125847434,"threatLevel":0,"type":"heuristics_update"}
19:07:28.661 > [WebSocket] Processing message type: heuristics_update
19:07:28.666 > [203.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:28.768 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125848434,"threatLevel":0,"type":"heuristics_update"}
19:07:28.793 > [WebSocket] Processing message type: heuristics_update
19:07:28.799 > [203.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:28.901 > [203.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:29.001 > [203.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:29.102 > [203.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:29.203 > [203.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:29.304 > [203.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:29.405 > [203.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:29.507 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125849435,"threatLevel":0,"type":"heuristics_update"}
19:07:29.532 > [WebSocket] Processing message type: heuristics_update
19:07:29.537 > [203.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:29.639 > [204.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:29.740 > [204.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:29.841 > [204.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:29.942 > [204.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:30.044 > [204.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:30.144 > [204.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:30.245 > [204.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:30.346 > [204.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:30.448 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125850435,"threatLevel":0,"type":"heuristics_update"}
19:07:30.473 > [WebSocket] Processing message type: heuristics_update
19:07:30.479 > [204.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:30.580 > [205.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:30.681 > [205.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:30.782 > [205.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:30.883 > [205.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:30.984 > [205.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:31.085 > [205.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:31.186 > [205.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:31.286 > [205.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:31.388 > [205.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:31.490 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125851436,"threatLevel":0,"type":"heuristics_update"}
19:07:31.515 > [WebSocket] Processing message type: heuristics_update
19:07:31.520 > [205.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:31.622 > [206.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:31.723 > [206.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:31.824 > [206.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:31.925 > [206.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:32.026 > [206.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:32.127 > [206.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:32.228 > [206.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:32.329 > [206.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:32.430 > [206.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:32.531 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125852438,"threatLevel":0,"type":"heuristics_update"}
19:07:32.557 > [WebSocket] Processing message type: heuristics_update
19:07:32.563 > [207.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:32.665 > [207.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:32.766 > [207.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:32.867 > [207.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:32.968 > [207.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:33.068 > [207.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:33.170 > [207.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:33.271 > [207.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:33.372 > [207.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:33.474 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125853438,"threatLevel":0,"type":"heuristics_update"}
19:07:33.499 > [WebSocket] Processing message type: heuristics_update
19:07:33.505 > [207.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:33.606 > [208.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:33.707 > [208.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:33.808 > [208.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:33.909 > [208.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:34.010 > [208.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:34.111 > [208.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:34.212 > [208.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:34.313 > [208.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:34.414 > [208.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:34.518 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125854438,"threatLevel":0,"type":"heuristics_update"}
19:07:34.542 > [WebSocket] Processing message type: heuristics_update
19:07:34.549 > [208.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:34.650 > [209.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:34.752 > [209.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:34.852 > [209.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:34.953 > [209.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:35.054 > [209.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:35.155 > [209.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:35.256 > [209.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:35.357 > [209.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:35.458 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125855439,"threatLevel":0,"type":"heuristics_update"}
19:07:35.484 > [WebSocket] Processing message type: heuristics_update
19:07:35.489 > [209.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:35.591 > [210.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:35.692 > [210.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:35.792 > [210.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:35.894 > [210.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:35.995 > [210.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:36.096 > [210.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:36.197 > [210.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:07:36.203 > [RETRY] Attempting to send health data (Max retries: 3)
19:07:36.208 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:07:36.214 > Generated health data: HR-63 SPO2-95 STEPS-1081
19:07:36.217 > [ESP32] ========================================
19:07:36.223 > [ESP32] ENCRYPTION PIPELINE START
19:07:36.225 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:07:36.231 > [ESP32] Active Algorithms for this packet:
19:07:36.234 > [ESP32]   + LFSR
19:07:36.236 > [ESP32]   + Tinkerbell
19:07:36.239 > [ESP32]   + Transposition
19:07:36.239 > [ESP32]   - ChaCha20
19:07:36.242 > [ESP32]   - Salsa20
19:07:36.245 > [ESP32] ========================================
19:07:36.247 > [ESP32] MsgKeys: lfsrSeed=0x66240080 tnk[0..3]=55C049BE trn[0..3]=71D61C41
19:07:36.256 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313038314D50
19:07:36.261 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313038314D50000000000000 
19:07:36.270 > [ESP32][LFSR] Initializing - Seed: 0x66240080 SeedBe: 0x80002466 ChaosKey[0..3]: 55C049BE InitialTap: 0x0029 State: 0x66240080
19:07:36.281 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:07:36.290 > 3_After_LFSR (32): C8520950338FDC2F1220190F9B4FB905 2DA4DE3698C8A7A947684509EE2A6CBC 
19:07:36.295 > [ESP32][LFSR] Keystream (first 16 bytes): 8000246600AF8F7F5D123436AE6FEA51
19:07:36.303 > [ESP32][4D] LFSR keystream (first 32 bytes): 8000246600AF8F7F5D123436AE6FEA5168F48D1BA9F89F980A384509EE2A6CBC
19:07:36.311 > [ESP32][TINKERBELL] Input (first 16 bytes): C8520950338FDC2F1220190F9B4FB905 Nonce: 0x00000001 Buffer size: 32 bytes
19:07:36.322 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 55C049BE
19:07:36.331 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): C67E48AF3C1416CA24002D3935B93151
19:07:36.340 > 4_After_Tinkerbell (32): 0E2C41FF0F9BCAE536203436AEF68854 7ADD385BA51D9A9C46C68208FFE61701 
19:07:36.348 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): C67E48AF3C1416CA24002D3935B93151
19:07:36.356 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): C67E48AF3C1416CA24002D3935B931515779E66D3DD53D3501AEC70111CC7BBD
19:07:36.367 > 5_After_Transposition (32): 1D5BA582C6469A9CE608FF38DD7A1701 F6AE36343620CAE59B0FFF410E2C8854 
19:07:36.375 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:07:36.379 > [ESP32] === HMAC DEBUG INFO ===
19:07:36.381 > [ESP32] HMAC Key being used: A768D3DFE9A99F60B528BADF259A95B3A352044A64DD0FE54FCC3045F5C97595
19:07:36.390 > [ESP32] HMAC Input length: 45 bytes
19:07:36.392 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000011D5BA582C6469A9CE608FF38DD7A1701F6AE36
19:07:36.403 > [ESP32] Nonce: 0x00000001
19:07:36.403 > [ESP32] Packet size before HMAC: 61
19:07:36.409 > [ESP32] Computed HMAC Tag: 4A1A422EC3DC64A8F99B07155B236C74
19:07:36.412 > [ESP32] === END HMAC DEBUG ===
19:07:36.414 > 6_Final_Packet (61): 820218001800040804000000011D5BA5 82C6469A9CE608FF38DD7A1701F6AE36 ...
19:07:36.422 > [RETRY] Attempt 1/3 (nonce: 1)
19:07:36.426 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:36.431 > Sending pipeline data to server (609 bytes)
19:07:37.063 > [HTTP] Response code: 200
19:07:37.063 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:07:37.074 > [RETRY] Health data sent successfully!
19:07:37.076 > ✓ Health data #6 sent successfully
19:07:37.178 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125856439,"threatLevel":0,"type":"heuristics_update"}
19:07:37.204 > [WebSocket] Processing message type: heuristics_update
19:07:37.209 > [211.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:37.312 > [WebSocket] Received (183 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":13,"serverTime":1770125856742,"type":"security_update"}
19:07:37.329 > [WebSocket] Processing message type: security_update
19:07:37.334 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:07:37.340 > [211.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:37.445 > [WebSocket] Received (636 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820218001800040804000000011D5BA582C6469A9CE608FF38DD7A1701F6AE36343620CAE59B0FFF410E2C88544A1A422EC3DC64A8F99B07155B236C74","pipeline":{"afterLFSR":"C8520950338FDC2F1220190F9B4FB9052DA4DE3698C8A7A947684509EE2A6CBC","afterSalt":"48522D36332053504F322D39352053544550532D313038314D50","afterTinkerbell":"0E2C41FF0F9BCAE536203436AEF688547ADD385BA51D9A9C46C68208FFE61701","afterTransposition":"1D5BA582C6469A9CE608FF38DD7A1701F6AE36343620CAE59B0FFF410E2C8854"},"plaintext":"HR-63 SPO2-95 STEPS-1081","serverTime":1770125856742,"timestamp":210833,"type":"encryption_update","ztmEnabled":true}
19:07:37.501 > [WebSocket] Processing message type: encryption_update
19:07:37.506 > [211.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:37.608 > [WebSocket] Received (88 bytes): {"heartRate":63,"spo2":95,"steps":1081,"time":1770125856742,"type":"health_data_update"}
19:07:37.617 > [WebSocket] Processing message type: health_data_update
19:07:37.622 > [212.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:37.731 > [WebSocket] Received (222 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.33,"encryptionTime":0.0,"finalPlaintext":"HR-63 SPO2-95 STEPS-1081","handshakeSuccess":true,"totalTime":0.33},"type":"session_summary_update"}
19:07:37.752 > [WebSocket] Processing message type: session_summary_update
19:07:37.755 > [212.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:37.863 > [WebSocket] Received (658 bytes): {"decryptionTime":0.33,"encryptedPacket":"820218001800040804000000011D5BA582C6469A9CE608FF38DD7A1701F6AE36343620CAE59B0FFF410E2C88544A1A422EC3DC64A8F99B07155B236C74","finalPlaintext":"HR-63 SPO2-95 STEPS-1081","healthData":{"heartRate":63,"spo2":95,"steps":1081},"pipeline":{"afterDepad":"48522D36332053504F322D39352053544550532D31303831000000000000","afterLFSR":"48522D36332053504F322D39352053544550532D313038314D50000000000000","afterTinkerbell":"C8520950338FDC2F1220190F9B4FB9052DA4DE3698C8A7A947684509EE2A6CBC","afterTransposition":"0E2C41FF0F9BCAE536203436AEF688547ADD385BA51D9A9C46C68208FFE61701"},"serverTime":1770125856743,"type":"decryption_update"}
19:07:37.922 > [WebSocket] Processing message type: decryption_update
19:07:37.928 > [WebSocket] Server decryption completed
19:07:37.931 > [WebSocket] Health data - HR: 63, SPO2: 95, Steps: 1081
19:07:37.936 > [212.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:38.038 > [WebSocket] Received (648 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":5,"pipeline":{"afterLFSR":"C8520950338FDC2F1220190F9B4FB9052DA4DE3698C8A7A947684509EE2A6CBC","afterSalt":"48522D36332053504F322D39352053544550532D313038314D50","afterTinkerbell":"0E2C41FF0F9BCAE536203436AEF688547ADD385BA51D9A9C46C68208FFE61701","afterTransposition":"1D5BA582C6469A9CE608FF38DD7A1701F6AE36343620CAE59B0FFF410E2C8854","finalPacket":"820218001800040804000000011D5BA582C6469A9CE608FF38DD7A1701F6AE36343620CAE59B0FFF410E2C88544A1A422EC3DC64A8F99B07155B236C74"},"plaintext":"HR-63 SPO2-95 STEPS-1081","timestamp":211472,"type":"encryption_pipeline","ztmEnabled":true}
19:07:38.097 > [WebSocket] Processing message type: encryption_pipeline
19:07:38.103 > [212.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:38.204 > [WebSocket] Received (158 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Health data #6 sent successfully","state":7,"success":true,"timestamp":211477,"type":"health_data_sent"}
19:07:38.220 > [WebSocket] Processing message type: health_data_sent
19:07:38.222 > [212.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:38.326 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125857440,"threatLevel":0,"type":"heuristics_update"}
19:07:38.352 > [WebSocket] Processing message type: heuristics_update
19:07:38.357 > [212.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:38.459 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125858441,"threatLevel":0,"type":"heuristics_update"}
19:07:38.484 > [WebSocket] Processing message type: heuristics_update
19:07:38.490 > [212.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:38.592 > [213.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:38.692 > [213.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:38.794 > [213.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:38.895 > [213.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:38.997 > [213.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:39.097 > [213.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:39.198 > [213.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:39.299 > [213.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:39.400 > [213.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:39.502 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125859454,"threatLevel":0,"type":"heuristics_update"}
19:07:39.527 > [WebSocket] Processing message type: heuristics_update
19:07:39.532 > [213.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:39.634 > [214.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:39.735 > [214.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:39.836 > [214.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:39.937 > [214.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:40.037 > [214.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:40.139 > [214.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:40.239 > [214.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:40.341 > [214.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:40.442 > [214.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:40.544 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125860455,"threatLevel":0,"type":"heuristics_update"}
19:07:40.569 > [WebSocket] Processing message type: heuristics_update
19:07:40.574 > [215.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:40.676 > [215.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:40.777 > [215.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:40.877 > [215.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:40.979 > [215.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:41.080 > [215.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:41.181 > [215.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:41.282 > [215.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:41.382 > [215.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:41.485 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125861455,"threatLevel":0,"type":"heuristics_update"}
19:07:41.509 > [WebSocket] Processing message type: heuristics_update
19:07:41.515 > [215.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:41.617 > [216.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:41.717 > [216.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:41.818 > [216.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:41.920 > [216.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:42.020 > [216.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:42.121 > [216.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:42.223 > [216.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:42.324 > [216.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:42.425 > [216.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:42.526 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125862456,"threatLevel":0,"type":"heuristics_update"}
19:07:42.552 > [WebSocket] Processing message type: heuristics_update
19:07:42.557 > [217.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:42.659 > [217.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:42.760 > [217.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:42.860 > [217.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:42.961 > [217.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:43.063 > [217.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:43.164 > [217.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:43.265 > [217.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:43.366 > [217.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:43.469 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125863456,"threatLevel":0,"type":"heuristics_update"}
19:07:43.495 > [WebSocket] Processing message type: heuristics_update
19:07:43.500 > [217.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:43.602 > [218.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:43.703 > [218.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:43.804 > [218.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:43.905 > [218.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:44.006 > [218.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:44.107 > [218.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:44.207 > [218.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:44.308 > [218.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:44.409 > [218.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:44.511 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125864457,"threatLevel":0,"type":"heuristics_update"}
19:07:44.536 > [WebSocket] Processing message type: heuristics_update
19:07:44.542 > [218.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:44.644 > [219.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:44.745 > [219.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:44.846 > [219.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:44.946 > [219.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:45.047 > [219.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:45.149 > [219.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:45.249 > [219.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:45.350 > [219.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:45.452 > [219.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:45.553 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125865457,"threatLevel":0,"type":"heuristics_update"}
19:07:45.579 > [WebSocket] Processing message type: heuristics_update
19:07:45.584 > [220.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:45.686 > [220.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:45.787 > [220.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:45.888 > [220.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:45.988 > [220.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:46.089 > [220.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:46.191 > [220.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:46.291 > [220.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:46.392 > [220.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:46.495 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125866458,"threatLevel":0,"type":"heuristics_update"}
19:07:46.520 > [WebSocket] Processing message type: heuristics_update
19:07:46.525 > [220.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:46.627 > [221.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:46.728 > [221.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:46.828 > [221.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:46.930 > [221.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:47.031 > [221.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:47.132 > [221.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:47.138 > [RETRY] Attempting to send health data (Max retries: 3)
19:07:47.143 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:07:47.148 > Generated health data: HR-63 SPO2-95 STEPS-1122
19:07:47.152 > [ESP32] ========================================
19:07:47.157 > [ESP32] ENCRYPTION PIPELINE START
19:07:47.161 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:07:47.166 > [ESP32] Active Algorithms for this packet:
19:07:47.169 > [ESP32]   + LFSR
19:07:47.171 > [ESP32]   + Tinkerbell
19:07:47.174 > [ESP32]   + Transposition
19:07:47.174 > [ESP32]   - ChaCha20
19:07:47.176 > [ESP32]   - Salsa20
19:07:47.180 > [ESP32] ========================================
19:07:47.183 > [ESP32] MsgKeys: lfsrSeed=0x6ED09B75 tnk[0..3]=DD1F4D1C trn[0..3]=7E65E9D7
19:07:47.190 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313132324D50
19:07:47.196 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313132324D50000000000000 
19:07:47.204 > [ESP32][LFSR] Initializing - Seed: 0x6ED09B75 SeedBe: 0x759BD06E ChaosKey[0..3]: DD1F4D1C InitialTap: 0x0029 State: 0x6ED09B75
19:07:47.215 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:07:47.224 > 3_After_LFSR (32): 3DC9FD58E7F70AE7E281B9B4FAA04C8C 4790C347657B6B99010DD154CBED52BF 
19:07:47.230 > [ESP32][LFSR] Keystream (first 16 bytes): 759BD06ED4D759B7ADB3948DCF801FD8
19:07:47.238 > [ESP32][4D] LFSR keystream (first 32 bytes): 759BD06ED4D759B7ADB3948DCF801FD802C0906A544A59AB4C5DD154CBED52BF
19:07:47.246 > [ESP32][TINKERBELL] Input (first 16 bytes): 3DC9FD58E7F70AE7E281B9B4FAA04C8C Nonce: 0x00000002 Buffer size: 32 bytes
19:07:47.257 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: DD1F4D1C
19:07:47.266 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A9428D6B62097E38B0B2172772D846C0
19:07:47.274 > 4_After_Tinkerbell (32): 948B703385FE74DF5233AE9388780A4C 8C4A3B678B8751967D17EDDC63C618B0 
19:07:47.282 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A9428D6B62097E38B0B2172772D846C0
19:07:47.290 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A9428D6B62097E38B0B2172772D846C0CBDAF820EEFC3A0F7C1A3C88A82B4A0F
19:07:47.301 > 5_After_Transposition (32): DF748C4A878B3B674C0A948B7888AE93 96515233FE8570337D17DCED18B0C663 
19:07:47.310 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:07:47.313 > [ESP32] === HMAC DEBUG INFO ===
19:07:47.316 > [ESP32] HMAC Key being used: A768D3DFE9A99F60B528BADF259A95B3A352044A64DD0FE54FCC3045F5C97595
19:07:47.324 > [ESP32] HMAC Input length: 45 bytes
19:07:47.327 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002DF748C4A878B3B674C0A948B7888AE93965152
19:07:47.338 > [ESP32] Nonce: 0x00000002
19:07:47.338 > [ESP32] Packet size before HMAC: 61
19:07:47.344 > [ESP32] Computed HMAC Tag: 6B2E1EA1045BA784FE1325834933F661
19:07:47.346 > [ESP32] === END HMAC DEBUG ===
19:07:47.349 > 6_Final_Packet (61): 82021800180004080400000002DF748C 4A878B3B674C0A948B7888AE93965152 ...
19:07:47.357 > [RETRY] Attempt 1/3 (nonce: 2)
19:07:47.360 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:47.366 > Sending pipeline data to server (609 bytes)
19:07:47.772 > [HTTP] Response code: 400
19:07:47.772 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:47.778 > [HTTP] Request failed with code: 400
19:07:47.781 > [RETRY] Send failed, waiting 100 ms before retry
19:07:47.883 > [RETRY] Attempt 2/3 (nonce: 2)
19:07:47.883 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:47.888 > Sending pipeline data to server (609 bytes)
19:07:48.221 > [HTTP] Response code: 400
19:07:48.221 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:48.226 > [HTTP] Request failed with code: 400
19:07:48.230 > [RETRY] Send failed, waiting 200 ms before retry
19:07:48.430 > [RETRY] Attempt 3/3 (nonce: 2)
19:07:48.430 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:48.435 > Sending pipeline data to server (609 bytes)
19:07:48.753 > [HTTP] Response code: 400
19:07:48.754 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:48.758 > [HTTP] Request failed with code: 400
19:07:48.762 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:07:48.768 > [RETRY] Consecutive failures: 1
19:07:48.770 > Health data send failed (retry count: 1/3)
19:07:48.877 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125867458,"threatLevel":0,"type":"heuristics_update"}
19:07:48.902 > [WebSocket] Processing message type: heuristics_update
19:07:48.907 > [223.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:48.913 > [RETRY] Attempting to send health data (Max retries: 3)
19:07:48.919 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:07:48.925 > Generated health data: HR-63 SPO2-95 STEPS-1121
19:07:48.927 > [ESP32] ========================================
19:07:48.933 > [ESP32] ENCRYPTION PIPELINE START
19:07:48.936 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:07:48.941 > [ESP32] Active Algorithms for this packet:
19:07:48.944 > [ESP32]   + LFSR
19:07:48.946 > [ESP32]   + Tinkerbell
19:07:48.950 > [ESP32]   + Transposition
19:07:48.950 > [ESP32]   - ChaCha20
19:07:48.952 > [ESP32]   - Salsa20
19:07:48.955 > [ESP32] ========================================
19:07:48.958 > [ESP32] MsgKeys: lfsrSeed=0x6ED09B75 tnk[0..3]=DD1F4D1C trn[0..3]=7E65E9D7
19:07:48.966 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313132314D50
19:07:48.972 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313132314D50000000000000 
19:07:48.980 > [ESP32][LFSR] Initializing - Seed: 0x6ED09B75 SeedBe: 0x759BD06E ChaosKey[0..3]: DD1F4D1C InitialTap: 0x0029 State: 0x6ED09B75
19:07:48.990 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:07:49.000 > 3_After_LFSR (32): 3DC9FD58E7F70AE7E281B9B4FAA04C8C 4790C347657B6B9A010DD154CBED52BF 
19:07:49.005 > [ESP32][LFSR] Keystream (first 16 bytes): 759BD06ED4D759B7ADB3948DCF801FD8
19:07:49.014 > [ESP32][4D] LFSR keystream (first 32 bytes): 759BD06ED4D759B7ADB3948DCF801FD802C0906A544A59AB4C5DD154CBED52BF
19:07:49.022 > [ESP32][TINKERBELL] Input (first 16 bytes): 3DC9FD58E7F70AE7E281B9B4FAA04C8C Nonce: 0x00000002 Buffer size: 32 bytes
19:07:49.033 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: DD1F4D1C
19:07:49.041 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A9428D6B62097E38B0B2172772D846C0
19:07:49.049 > 4_After_Tinkerbell (32): 948B703385FE74DF5233AE9388780A4C 8C4A3B678B8751957D17EDDC63C618B0 
19:07:49.057 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A9428D6B62097E38B0B2172772D846C0
19:07:49.066 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A9428D6B62097E38B0B2172772D846C0CBDAF820EEFC3A0F7C1A3C88A82B4A0F
19:07:49.077 > 5_After_Transposition (32): DF748C4A878B3B674C0A948B7888AE93 95515233FE8570337D17DCED18B0C663 
19:07:49.085 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:07:49.089 > [ESP32] === HMAC DEBUG INFO ===
19:07:49.091 > [ESP32] HMAC Key being used: A768D3DFE9A99F60B528BADF259A95B3A352044A64DD0FE54FCC3045F5C97595
19:07:49.099 > [ESP32] HMAC Input length: 45 bytes
19:07:49.102 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002DF748C4A878B3B674C0A948B7888AE93955152
19:07:49.113 > [ESP32] Nonce: 0x00000002
19:07:49.113 > [ESP32] Packet size before HMAC: 61
19:07:49.118 > [ESP32] Computed HMAC Tag: 7362E62F50AC85B78CA8C51616DC9E0B
19:07:49.121 > [ESP32] === END HMAC DEBUG ===
19:07:49.124 > 6_Final_Packet (61): 82021800180004080400000002DF748C 4A878B3B674C0A948B7888AE93955152 ...
19:07:49.133 > [RETRY] Attempt 1/3 (nonce: 2)
19:07:49.135 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:49.140 > Sending pipeline data to server (609 bytes)
19:07:49.494 > [HTTP] Response code: 400
19:07:49.494 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:49.499 > [HTTP] Request failed with code: 400
19:07:49.502 > [RETRY] Send failed, waiting 100 ms before retry
19:07:49.603 > [RETRY] Attempt 2/3 (nonce: 2)
19:07:49.604 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:49.609 > Sending pipeline data to server (609 bytes)
19:07:49.757 > [HTTP] Response code: 400
19:07:49.758 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:49.763 > [HTTP] Request failed with code: 400
19:07:49.766 > [RETRY] Send failed, waiting 200 ms before retry
19:07:49.965 > [RETRY] Attempt 3/3 (nonce: 2)
19:07:49.965 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:49.971 > Sending pipeline data to server (609 bytes)
19:07:50.288 > [HTTP] Response code: 400
19:07:50.288 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:50.293 > [HTTP] Request failed with code: 400
19:07:50.296 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:07:50.302 > [RETRY] Consecutive failures: 2
19:07:50.304 > Health data send failed (retry count: 2/3)
19:07:50.406 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Failed to send health data","state":7,"success":false,"timestamp":222183,"type":"health_data_error"}
19:07:50.420 > [WebSocket] Processing message type: health_data_error
19:07:50.425 > [224.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:50.434 > [RETRY] Attempting to send health data (Max retries: 3)
19:07:50.439 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:07:50.446 > Generated health data: HR-64 SPO2-95 STEPS-1160
19:07:50.447 > [ESP32] ========================================
19:07:50.452 > [ESP32] ENCRYPTION PIPELINE START
19:07:50.456 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:07:50.462 > [ESP32] Active Algorithms for this packet:
19:07:50.465 > [ESP32]   + LFSR
19:07:50.465 > [ESP32]   + Tinkerbell
19:07:50.468 > [ESP32]   + Transposition
19:07:50.470 > [ESP32]   - ChaCha20
19:07:50.474 > [ESP32]   - Salsa20
19:07:50.474 > [ESP32] ========================================
19:07:50.479 > [ESP32] MsgKeys: lfsrSeed=0x6ED09B75 tnk[0..3]=DD1F4D1C trn[0..3]=7E65E9D7
19:07:50.484 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313136304D50
19:07:50.489 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313136304D50000000000000 
19:07:50.497 > [ESP32][LFSR] Initializing - Seed: 0x6ED09B75 SeedBe: 0x759BD06E ChaosKey[0..3]: DD1F4D1C InitialTap: 0x0029 State: 0x6ED09B75
19:07:50.509 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
19:07:50.517 > 3_After_LFSR (32): 3DC9FD58E0F70AE7E281B9B4FAA04C8C 4790C347657B6F9B010DD154CBED52BF 
19:07:50.526 > [ESP32][LFSR] Keystream (first 16 bytes): 759BD06ED4D759B7ADB3948DCF801FD8
19:07:50.531 > [ESP32][4D] LFSR keystream (first 32 bytes): 759BD06ED4D759B7ADB3948DCF801FD802C0906A544A59AB4C5DD154CBED52BF
19:07:50.542 > [ESP32][TINKERBELL] Input (first 16 bytes): 3DC9FD58E0F70AE7E281B9B4FAA04C8C Nonce: 0x00000002 Buffer size: 32 bytes
19:07:50.551 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: DD1F4D1C
19:07:50.562 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A9428D6B62097E38B0B2172772D846C0
19:07:50.570 > 4_After_Tinkerbell (32): 948B703382FE74DF5233AE9388780A4C 8C4A3B678B8755947D17EDDC63C618B0 
19:07:50.579 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A9428D6B62097E38B0B2172772D846C0
19:07:50.586 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A9428D6B62097E38B0B2172772D846C0CBDAF820EEFC3A0F7C1A3C88A82B4A0F
19:07:50.596 > 5_After_Transposition (32): DF748C4A878B3B674C0A948B7888AE93 94555233FE8270337D17DCED18B0C663 
19:07:50.604 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:07:50.609 > [ESP32] === HMAC DEBUG INFO ===
19:07:50.612 > [ESP32] HMAC Key being used: A768D3DFE9A99F60B528BADF259A95B3A352044A64DD0FE54FCC3045F5C97595
19:07:50.620 > [ESP32] HMAC Input length: 45 bytes
19:07:50.623 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002DF748C4A878B3B674C0A948B7888AE93945552
19:07:50.631 > [ESP32] Nonce: 0x00000002
19:07:50.634 > [ESP32] Packet size before HMAC: 61
19:07:50.637 > [ESP32] Computed HMAC Tag: 4752971E329D174B569DADDD5D55A273
19:07:50.642 > [ESP32] === END HMAC DEBUG ===
19:07:50.645 > 6_Final_Packet (61): 82021800180004080400000002DF748C 4A878B3B674C0A948B7888AE93945552 ...
19:07:50.654 > [RETRY] Attempt 1/3 (nonce: 2)
19:07:50.656 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:50.661 > Sending pipeline data to server (609 bytes)
19:07:51.007 > [HTTP] Response code: 400
19:07:51.007 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:51.012 > [HTTP] Request failed with code: 400
19:07:51.015 > [RETRY] Send failed, waiting 100 ms before retry
19:07:51.114 > [RETRY] Attempt 2/3 (nonce: 2)
19:07:51.114 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:51.120 > Sending pipeline data to server (609 bytes)
19:07:51.515 > [HTTP] Response code: 400
19:07:51.515 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:51.520 > [HTTP] Request failed with code: 400
19:07:51.524 > [RETRY] Send failed, waiting 200 ms before retry
19:07:51.722 > [RETRY] Attempt 3/3 (nonce: 2)
19:07:51.722 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:51.728 > Sending pipeline data to server (609 bytes)
19:07:52.045 > [HTTP] Response code: 400
19:07:52.045 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:52.050 > [HTTP] Request failed with code: 400
19:07:52.054 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:07:52.059 > [RETRY] Consecutive failures: 3
19:07:52.062 > Health data send failed (retry count: 3/3)
19:07:52.065 > Health data transmission failed after max retries
19:07:52.163 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Failed to send health data","state":7,"success":false,"timestamp":222632,"type":"health_data_error"}
19:07:52.177 > [WebSocket] Processing message type: health_data_error
19:07:52.182 > [226.6] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:52.191 > ERROR state - attempting recovery
19:07:52.194 > [RETRY] Attempting to send health data (Max retries: 3)
19:07:52.222 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:07:52.222 > Generated health data: HR-63 SPO2-95 STEPS-1146
19:07:52.222 > [ESP32] ========================================
19:07:52.222 > [ESP32] ENCRYPTION PIPELINE START
19:07:52.222 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:07:52.222 > [ESP32] Active Algorithms for this packet:
19:07:52.245 > [ESP32]   + LFSR
19:07:52.245 > [ESP32]   + Tinkerbell
19:07:52.245 > [ESP32]   + Transposition
19:07:52.245 > [ESP32]   - ChaCha20
19:07:52.245 > [ESP32]   - Salsa20
19:07:52.245 > [ESP32] ========================================
19:07:52.245 > [ESP32] MsgKeys: lfsrSeed=0x6ED09B75 tnk[0..3]=DD1F4D1C trn[0..3]=7E65E9D7
19:07:52.245 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313134364D50
19:07:52.261 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313134364D50000000000000 
19:07:52.261 > [ESP32][LFSR] Initializing - Seed: 0x6ED09B75 SeedBe: 0x759BD06E ChaosKey[0..3]: DD1F4D1C InitialTap: 0x0029 State: 0x6ED09B75
19:07:52.269 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:07:52.279 > 3_After_LFSR (32): 3DC9FD58E7F70AE7E281B9B4FAA04C8C 4790C347657B6D9D010DD154CBED52BF 
19:07:52.288 > [ESP32][LFSR] Keystream (first 16 bytes): 759BD06ED4D759B7ADB3948DCF801FD8
19:07:52.290 > [ESP32][4D] LFSR keystream (first 32 bytes): 759BD06ED4D759B7ADB3948DCF801FD802C0906A544A59AB4C5DD154CBED52BF
19:07:52.300 > [ESP32][TINKERBELL] Input (first 16 bytes): 3DC9FD58E7F70AE7E281B9B4FAA04C8C Nonce: 0x00000002 Buffer size: 32 bytes
19:07:52.310 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: DD1F4D1C
19:07:52.321 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A9428D6B62097E38B0B2172772D846C0
19:07:52.329 > 4_After_Tinkerbell (32): 948B703385FE74DF5233AE9388780A4C 8C4A3B678B8757927D17EDDC63C618B0 
19:07:52.339 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A9428D6B62097E38B0B2172772D846C0
19:07:52.344 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A9428D6B62097E38B0B2172772D846C0CBDAF820EEFC3A0F7C1A3C88A82B4A0F
19:07:52.355 > 5_After_Transposition (32): DF748C4A878B3B674C0A948B7888AE93 92575233FE8570337D17DCED18B0C663 
19:07:52.364 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:07:52.369 > [ESP32] === HMAC DEBUG INFO ===
19:07:52.372 > [ESP32] HMAC Key being used: A768D3DFE9A99F60B528BADF259A95B3A352044A64DD0FE54FCC3045F5C97595
19:07:52.380 > [ESP32] HMAC Input length: 45 bytes
19:07:52.382 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002DF748C4A878B3B674C0A948B7888AE93925752
19:07:52.391 > [ESP32] Nonce: 0x00000002
19:07:52.394 > [ESP32] Packet size before HMAC: 61
19:07:52.397 > [ESP32] Computed HMAC Tag: B7B265C7098A657F6B90D5CC01F5A327
19:07:52.402 > [ESP32] === END HMAC DEBUG ===
19:07:52.405 > 6_Final_Packet (61): 82021800180004080400000002DF748C 4A878B3B674C0A948B7888AE93925752 ...
19:07:52.414 > [RETRY] Attempt 1/3 (nonce: 2)
19:07:52.417 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:52.422 > Sending pipeline data to server (609 bytes)
19:07:52.780 > [HTTP] Response code: 400
19:07:52.780 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:52.785 > [HTTP] Request failed with code: 400
19:07:52.788 > [RETRY] Send failed, waiting 100 ms before retry
19:07:52.888 > [RETRY] Attempt 2/3 (nonce: 2)
19:07:52.888 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:52.893 > Sending pipeline data to server (609 bytes)
19:07:53.299 > [HTTP] Response code: 400
19:07:53.299 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:53.305 > [HTTP] Request failed with code: 400
19:07:53.307 > [RETRY] Send failed, waiting 200 ms before retry
19:07:53.507 > [RETRY] Attempt 3/3 (nonce: 2)
19:07:53.507 > POST http://10.249.92.115:8081/health-data with pipeline data
19:07:53.513 > Sending pipeline data to server (609 bytes)
19:07:53.793 > [HTTP] Response code: 400
19:07:53.793 > [HTTP] Error response: {"error":"Decryption failed"}
19:07:53.797 > [HTTP] Request failed with code: 400
19:07:53.801 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:07:53.807 > [RETRY] Consecutive failures: 4
19:07:53.809 > ✗ Auto-recovery failed - restarting key exchange
19:07:55.912 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125868458,"threatLevel":0,"type":"heuristics_update"}
19:07:55.937 > [WebSocket] Processing message type: heuristics_update
19:07:55.942 > [230.3] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:55.952 > ✓ Public key loaded from NVS
19:07:56.049 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Failed to send health data","state":7,"success":false,"timestamp":223163,"type":"health_data_error"}
19:07:56.063 > [WebSocket] Processing message type: health_data_error
19:07:56.069 > [230.5] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:56.173 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125869459,"threatLevel":0,"type":"heuristics_update"}
19:07:56.197 > [WebSocket] Processing message type: heuristics_update
19:07:56.202 > [230.6] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:56.212 > Generating fresh master key from entropy...
19:07:56.214 > Generated master key (32): 31B52C68D47A055926354B869BB45A4F 7DD155FF0878FC8D1D25B7ECD8782050 
19:07:56.227 > Using reduced master key (byte % 3) for NTRU encryption only
19:07:56.235 > NTRU encrypted master key (502): 0022006F00200017007F001D00080064 004600790039000E000200740068006F ...
19:07:56.244 > POST http://10.249.92.115:8081/master-key
19:07:56.549 > ✓ Master key exchange completed
19:07:56.651 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Failed to send health data","state":7,"success":false,"timestamp":223904,"type":"health_data_error"}
19:07:56.664 > [WebSocket] Processing message type: health_data_error
19:07:56.670 > [231.1] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:56.677 > Loading master key from NVS and deriving symmetric keys...
19:07:56.683 > Loaded master key from NVS (32): 31B52C68D47A055926354B869BB45A4F 7DD155FF0878FC8D1D25B7ECD8782050 
19:07:56.692 > Derived HMAC key (32): 7839EEDBCB4F1A2AA6285B2F1F7FC597 3D23ADC08F8AD515A0DAD8E932086580 
19:07:56.700 > Derived Tinkerbell key (16): B472BCC18E1EF3901049C845631B7F33 
19:07:56.705 > Derived Transposition key (16): 52494FDE2ADF760F9837230F3611AC07 
19:07:56.712 > ✓ Symmetric keys derived successfully
19:07:56.714 > Nonce tracker reset - new session started
19:07:57.210 > Waiting for server to process master key...
19:07:57.214 > ✓ Symmetric keys ready - starting health data transmission
19:07:57.316 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Failed to send health data","state":7,"success":false,"timestamp":224167,"type":"health_data_error"}
19:07:57.331 > [WebSocket] Processing message type: health_data_error
19:07:57.336 > [231.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:57.439 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Failed to send health data","state":7,"success":false,"timestamp":224698,"type":"health_data_error"}
19:07:57.453 > [WebSocket] Processing message type: health_data_error
19:07:57.458 > [231.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:57.561 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125870460,"threatLevel":0,"type":"heuristics_update"}
19:07:57.586 > [WebSocket] Processing message type: heuristics_update
19:07:57.592 > [232.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:57.694 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Failed to send health data","state":7,"success":false,"timestamp":225417,"type":"health_data_error"}
19:07:57.708 > [WebSocket] Processing message type: health_data_error
19:07:57.713 > [232.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:57.815 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125871461,"threatLevel":0,"type":"heuristics_update"}
19:07:57.840 > [WebSocket] Processing message type: heuristics_update
19:07:57.847 > [232.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:57.952 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Failed to send health data","state":7,"success":false,"timestamp":225925,"type":"health_data_error"}
19:07:57.965 > [WebSocket] Processing message type: health_data_error
19:07:57.971 > [232.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:58.073 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Failed to send health data","state":7,"success":false,"timestamp":226455,"type":"health_data_error"}
19:07:58.088 > [WebSocket] Processing message type: health_data_error
19:07:58.094 > [232.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:58.196 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125872461,"threatLevel":0,"type":"heuristics_update"}
19:07:58.221 > [WebSocket] Processing message type: heuristics_update
19:07:58.226 > [232.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:58.329 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Failed to send health data","state":8,"success":false,"timestamp":227190,"type":"health_data_error"}
19:07:58.343 > [WebSocket] Processing message type: health_data_error
19:07:58.348 > [232.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:58.450 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Failed to send health data","state":8,"success":false,"timestamp":227710,"type":"health_data_error"}
19:07:58.464 > [WebSocket] Processing message type: health_data_error
19:07:58.471 > [232.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:58.572 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125873462,"threatLevel":0,"type":"heuristics_update"}
19:07:58.597 > [WebSocket] Processing message type: heuristics_update
19:07:58.603 > [233.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:58.706 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Failed to send health data","state":8,"success":false,"timestamp":228203,"type":"health_data_error"}
19:07:58.720 > [WebSocket] Processing message type: health_data_error
19:07:58.725 > [233.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:58.828 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125874462,"threatLevel":0,"type":"heuristics_update"}
19:07:58.854 > [WebSocket] Processing message type: heuristics_update
19:07:58.859 > [233.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:58.961 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125875463,"threatLevel":0,"type":"heuristics_update"}
19:07:58.986 > [WebSocket] Processing message type: heuristics_update
19:07:58.992 > [233.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:59.095 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125876339,"type":"master_key_received"}
19:07:59.109 > [WebSocket] Processing message type: master_key_received
19:07:59.111 > [233.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:59.217 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125876464,"threatLevel":0,"type":"heuristics_update"}
19:07:59.242 > [WebSocket] Processing message type: heuristics_update
19:07:59.247 > [233.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:59.349 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":230952,"type":"master_key_exchanged"}
19:07:59.366 > [WebSocket] Processing message type: master_key_exchanged
19:07:59.372 > [233.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:59.472 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":231620,"type":"symmetric_keys_derived"}
19:07:59.488 > [WebSocket] Processing message type: symmetric_keys_derived
19:07:59.494 > [233.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:59.594 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125877465,"threatLevel":0,"type":"heuristics_update"}
19:07:59.619 > [WebSocket] Processing message type: heuristics_update
19:07:59.624 > [234.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:59.727 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125878466,"threatLevel":0,"type":"heuristics_update"}
19:07:59.753 > [WebSocket] Processing message type: heuristics_update
19:07:59.758 > [234.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:59.860 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125879467,"threatLevel":0,"type":"heuristics_update"}
19:07:59.885 > [WebSocket] Processing message type: heuristics_update
19:07:59.891 > [234.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:07:59.992 > [234.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:00.094 > [234.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:00.195 > [234.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:00.296 > [234.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:00.396 > [234.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:00.499 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125880467,"threatLevel":0,"type":"heuristics_update"}
19:08:00.524 > [WebSocket] Processing message type: heuristics_update
19:08:00.530 > [234.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:00.632 > [235.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:00.732 > [235.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:00.833 > [235.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:00.934 > [235.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:01.035 > [235.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:01.136 > [235.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:01.238 > [235.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:01.338 > [235.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:01.439 > [235.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:01.542 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125881468,"threatLevel":0,"type":"heuristics_update"}
19:08:01.567 > [WebSocket] Processing message type: heuristics_update
19:08:01.572 > [236.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:01.674 > [236.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:01.775 > [236.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:01.876 > [236.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:01.977 > [236.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:02.077 > [236.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:02.179 > [236.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:02.281 > [236.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:02.382 > [236.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:02.482 > [236.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:02.584 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125882468,"threatLevel":0,"type":"heuristics_update"}
19:08:02.609 > [WebSocket] Processing message type: heuristics_update
19:08:02.615 > [237.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:02.717 > [237.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:02.817 > [237.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:02.919 > [237.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:03.019 > [237.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:03.120 > [237.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:03.221 > [237.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:03.322 > [237.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:03.423 > [237.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:03.527 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125883470,"threatLevel":0,"type":"heuristics_update"}
19:08:03.552 > [WebSocket] Processing message type: heuristics_update
19:08:03.557 > [238.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:03.659 > [238.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:03.760 > [238.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:03.861 > [238.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:03.962 > [238.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:04.064 > [238.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:04.164 > [238.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:04.265 > [238.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:04.366 > [238.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:04.467 > [238.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:04.569 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125884471,"threatLevel":0,"type":"heuristics_update"}
19:08:04.594 > [WebSocket] Processing message type: heuristics_update
19:08:04.599 > [239.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:04.701 > [239.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:04.802 > [239.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:04.903 > [239.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:05.004 > [239.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:05.105 > [239.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:05.206 > [239.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:05.307 > [239.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:05.408 > [239.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:05.509 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125885471,"threatLevel":0,"type":"heuristics_update"}
19:08:05.535 > [WebSocket] Processing message type: heuristics_update
19:08:05.541 > [239.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:05.642 > [240.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:05.742 > [240.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:05.844 > [240.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:05.945 > [240.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:06.046 > [240.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:06.147 > [240.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:06.248 > [240.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:06.349 > [240.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:06.450 > [240.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:06.552 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125886472,"threatLevel":0,"type":"heuristics_update"}
19:08:06.577 > [WebSocket] Processing message type: heuristics_update
19:08:06.582 > [241.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:06.683 > [241.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:06.785 > [241.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:06.886 > [241.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:06.986 > [241.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:07.087 > [241.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:07.189 > [241.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:07.290 > [241.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:08:07.296 > [RETRY] Attempting to send health data (Max retries: 3)
19:08:07.301 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:08:07.306 > Generated health data: HR-64 SPO2-95 STEPS-1243
19:08:07.309 > [ESP32] ========================================
19:08:07.315 > [ESP32] ENCRYPTION PIPELINE START
19:08:07.318 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:08:07.324 > [ESP32] Active Algorithms for this packet:
19:08:07.327 > [ESP32]   + LFSR
19:08:07.329 > [ESP32]   + Tinkerbell
19:08:07.332 > [ESP32]   + Transposition
19:08:07.332 > [ESP32]   - ChaCha20
19:08:07.335 > [ESP32]   - Salsa20
19:08:07.338 > [ESP32] ========================================
19:08:07.340 > [ESP32] MsgKeys: lfsrSeed=0xA6990EC6 tnk[0..3]=CB84C913 trn[0..3]=5211EA62
19:08:07.349 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313234334D50
19:08:07.354 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313234334D50000000000000 
19:08:07.363 > [ESP32][LFSR] Initializing - Seed: 0xA6990EC6 SeedBe: 0xC60E99A6 ChaosKey[0..3]: CB84C913 InitialTap: 0x0029 State: 0xA6990EC6
19:08:07.374 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
19:08:07.382 > 3_After_LFSR (32): 8E5CB49049E7D740C2D938F3F89D1F5A D3ACC72311F37942AB4CF49A6EAC2041 
19:08:07.388 > [ESP32][LFSR] Keystream (first 16 bytes): C60E99A67DC784108DEB15CACDBD4C0E
19:08:07.396 > [ESP32][4D] LFSR keystream (first 32 bytes): C60E99A67DC784108DEB15CACDBD4C0E96FC940E20C14D71E61CF49A6EAC2041
19:08:07.404 > [ESP32][TINKERBELL] Input (first 16 bytes): 8E5CB49049E7D740C2D938F3F89D1F5A Nonce: 0x00000001 Buffer size: 32 bytes
19:08:07.416 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: CB84C913
19:08:07.424 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 6F093F883B897DA4E50D7910CD1748F4
19:08:07.432 > 4_After_Tinkerbell (32): E1558B18726EAAE427D441E3358A57AE B7D983EDC63E068C933C39B00DAE07CE 
19:08:07.440 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 6F093F883B897DA4E50D7910CD1748F4
19:08:07.449 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 6F093F883B897DA4E50D7910CD1748F4647544CED7CD7FCE3870CD2A6302278F
19:08:07.460 > 5_After_Transposition (32): 6E72AAE455E1ED838A3557AED427188B 3EC6068CD9B7E34139B00DAE3C9307CE 
19:08:07.468 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:08:07.471 > [ESP32] === HMAC DEBUG INFO ===
19:08:07.474 > [ESP32] HMAC Key being used: 7839EEDBCB4F1A2AA6285B2F1F7FC5973D23ADC08F8AD515A0DAD8E932086580
19:08:07.482 > [ESP32] HMAC Input length: 45 bytes
19:08:07.485 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000016E72AAE455E1ED838A3557AED427188B3EC606
19:08:07.496 > [ESP32] Nonce: 0x00000001
19:08:07.496 > [ESP32] Packet size before HMAC: 61
19:08:07.502 > [ESP32] Computed HMAC Tag: 161F23FA5215409385BCA30462A942D5
19:08:07.504 > [ESP32] === END HMAC DEBUG ===
19:08:07.507 > 6_Final_Packet (61): 820218001800040804000000016E72AA E455E1ED838A3557AED427188B3EC606 ...
19:08:07.516 > [RETRY] Attempt 1/3 (nonce: 1)
19:08:07.518 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:07.524 > Sending pipeline data to server (609 bytes)
19:08:07.840 > [HTTP] Response code: 200
19:08:07.841 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:08:07.852 > [RETRY] Health data sent successfully!
19:08:07.854 > ✓ Health data #7 sent successfully
19:08:07.955 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125887472,"threatLevel":0,"type":"heuristics_update"}
19:08:07.980 > [WebSocket] Processing message type: heuristics_update
19:08:07.985 > [242.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:08.088 > [WebSocket] Received (183 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":26,"serverTime":1770125887668,"type":"security_update"}
19:08:08.105 > [WebSocket] Processing message type: security_update
19:08:08.110 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:08:08.116 > [242.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:08.221 > [WebSocket] Received (636 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820218001800040804000000016E72AAE455E1ED838A3557AED427188B3EC6068CD9B7E34139B00DAE3C9307CE161F23FA5215409385BCA30462A942D5","pipeline":{"afterLFSR":"8E5CB49049E7D740C2D938F3F89D1F5AD3ACC72311F37942AB4CF49A6EAC2041","afterSalt":"48522D36342053504F322D39352053544550532D313234334D50","afterTinkerbell":"E1558B18726EAAE427D441E3358A57AEB7D983EDC63E068C933C39B00DAE07CE","afterTransposition":"6E72AAE455E1ED838A3557AED427188B3EC6068CD9B7E34139B00DAE3C9307CE"},"plaintext":"HR-64 SPO2-95 STEPS-1243","serverTime":1770125887668,"timestamp":241926,"type":"encryption_update","ztmEnabled":true}
19:08:08.277 > [WebSocket] Processing message type: encryption_update
19:08:08.282 > [242.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:08.384 > [WebSocket] Received (88 bytes): {"heartRate":64,"spo2":95,"steps":1243,"time":1770125887668,"type":"health_data_update"}
19:08:08.393 > [WebSocket] Processing message type: health_data_update
19:08:08.398 > [242.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:08.506 > [WebSocket] Received (226 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.4123,"encryptionTime":0.0,"finalPlaintext":"HR-64 SPO2-95 STEPS-1243","handshakeSuccess":true,"totalTime":0.4123},"type":"session_summary_update"}
19:08:08.529 > [WebSocket] Processing message type: session_summary_update
19:08:08.534 > [242.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:08.639 > [WebSocket] Received (660 bytes): {"decryptionTime":0.4123,"encryptedPacket":"820218001800040804000000016E72AAE455E1ED838A3557AED427188B3EC6068CD9B7E34139B00DAE3C9307CE161F23FA5215409385BCA30462A942D5","finalPlaintext":"HR-64 SPO2-95 STEPS-1243","healthData":{"heartRate":64,"spo2":95,"steps":1243},"pipeline":{"afterDepad":"48522D36342053504F322D39352053544550532D313234330523341E0000","afterLFSR":"48522D36342053504F322D39352053544550532D3132343370610523341E0000","afterTinkerbell":"8E5CB49049E7D740C2D938F3F89D1F5AD3ACC72311F37942967DF1B95AB22041","afterTransposition":"E1558B18726EAAE427D441E3358A57AEB7D983EDC63E068CAE0D3C9339B007CE"},"serverTime":1770125887669,"type":"decryption_update"}
19:08:08.699 > [WebSocket] Processing message type: decryption_update
19:08:08.704 > [WebSocket] Server decryption completed
19:08:08.706 > [WebSocket] Health data - HR: 64, SPO2: 95, Steps: 1243
19:08:08.712 > [243.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:08.813 > [WebSocket] Received (648 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":6,"pipeline":{"afterLFSR":"8E5CB49049E7D740C2D938F3F89D1F5AD3ACC72311F37942AB4CF49A6EAC2041","afterSalt":"48522D36342053504F322D39352053544550532D313234334D50","afterTinkerbell":"E1558B18726EAAE427D441E3358A57AEB7D983EDC63E068C933C39B00DAE07CE","afterTransposition":"6E72AAE455E1ED838A3557AED427188B3EC6068CD9B7E34139B00DAE3C9307CE","finalPacket":"820218001800040804000000016E72AAE455E1ED838A3557AED427188B3EC6068CD9B7E34139B00DAE3C9307CE161F23FA5215409385BCA30462A942D5"},"plaintext":"HR-64 SPO2-95 STEPS-1243","timestamp":242251,"type":"encryption_pipeline","ztmEnabled":true}
19:08:08.872 > [WebSocket] Processing message type: encryption_pipeline
19:08:08.877 > [243.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:08.977 > [WebSocket] Received (158 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Health data #7 sent successfully","state":7,"success":true,"timestamp":242255,"type":"health_data_sent"}
19:08:08.994 > [WebSocket] Processing message type: health_data_sent
19:08:08.997 > [243.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:09.100 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125888473,"threatLevel":0,"type":"heuristics_update"}
19:08:09.124 > [WebSocket] Processing message type: heuristics_update
19:08:09.131 > [243.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:09.233 > [243.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:09.333 > [243.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:09.434 > [243.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:09.536 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125889474,"threatLevel":0,"type":"heuristics_update"}
19:08:09.561 > [WebSocket] Processing message type: heuristics_update
19:08:09.566 > [244.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:09.668 > [244.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:09.769 > [244.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:09.870 > [244.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:09.971 > [244.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:10.072 > [244.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:10.173 > [244.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:10.274 > [244.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:10.374 > [244.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:10.476 > [244.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:10.577 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125890475,"threatLevel":0,"type":"heuristics_update"}
19:08:10.603 > [WebSocket] Processing message type: heuristics_update
19:08:10.608 > [245.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:10.710 > [245.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:10.811 > [245.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:10.912 > [245.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:11.012 > [245.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:11.114 > [245.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:11.215 > [245.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:11.316 > [245.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:11.417 > [245.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:11.519 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125891476,"threatLevel":0,"type":"heuristics_update"}
19:08:11.544 > [WebSocket] Processing message type: heuristics_update
19:08:11.550 > [245.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:11.651 > [246.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:11.752 > [246.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:11.852 > [246.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:11.954 > [246.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:12.055 > [246.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:12.156 > [246.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:12.257 > [246.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:12.357 > [246.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:12.458 > [246.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:12.561 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125892476,"threatLevel":0,"type":"heuristics_update"}
19:08:12.585 > [WebSocket] Processing message type: heuristics_update
19:08:12.591 > [247.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:12.692 > [247.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:12.794 > [247.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:12.895 > [247.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:12.996 > [247.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:13.097 > [247.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:13.198 > [247.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:13.299 > [247.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:13.399 > [247.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:13.500 > [247.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:13.604 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125893477,"threatLevel":0,"type":"heuristics_update"}
19:08:13.629 > [WebSocket] Processing message type: heuristics_update
19:08:13.635 > [248.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:13.736 > [248.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:13.837 > [248.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:13.939 > [248.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:14.040 > [248.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:14.141 > [248.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:14.242 > [248.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:14.342 > [248.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:14.444 > [248.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:14.545 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125894477,"threatLevel":0,"type":"heuristics_update"}
19:08:14.571 > [WebSocket] Processing message type: heuristics_update
19:08:14.577 > [249.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:14.678 > [249.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:14.779 > [249.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:14.880 > [249.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:14.981 > [249.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:15.081 > [249.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:15.183 > [249.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:15.284 > [249.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:15.385 > [249.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:15.486 > [249.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:15.588 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125895479,"threatLevel":0,"type":"heuristics_update"}
19:08:15.612 > [WebSocket] Processing message type: heuristics_update
19:08:15.618 > [250.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:15.720 > [250.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:15.820 > [250.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:15.922 > [250.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:16.023 > [250.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:16.124 > [250.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:16.224 > [250.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:16.325 > [250.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:16.427 > [250.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:16.529 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125896479,"threatLevel":0,"type":"heuristics_update"}
19:08:16.554 > [WebSocket] Processing message type: heuristics_update
19:08:16.559 > [251.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:16.661 > [251.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:16.762 > [251.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:16.862 > [251.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:16.963 > [251.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:17.064 > [251.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:17.166 > [251.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:17.267 > [251.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:17.367 > [251.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:17.468 > [251.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:17.570 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125897480,"threatLevel":0,"type":"heuristics_update"}
19:08:17.595 > [WebSocket] Processing message type: heuristics_update
19:08:17.601 > [252.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:17.703 > [252.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:17.804 > [252.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:17.905 > [252.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:08:17.910 > [RETRY] Attempting to send health data (Max retries: 3)
19:08:17.916 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:08:17.921 > Generated health data: HR-64 SPO2-95 STEPS-1307
19:08:17.924 > [ESP32] ========================================
19:08:17.931 > [ESP32] ENCRYPTION PIPELINE START
19:08:17.933 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:08:17.938 > [ESP32] Active Algorithms for this packet:
19:08:17.941 > [ESP32]   + LFSR
19:08:17.944 > [ESP32]   + Tinkerbell
19:08:17.947 > [ESP32]   + Transposition
19:08:17.947 > [ESP32]   - ChaCha20
19:08:17.950 > [ESP32]   - Salsa20
19:08:17.953 > [ESP32] ========================================
19:08:17.955 > [ESP32] MsgKeys: lfsrSeed=0xFC584DEC tnk[0..3]=1AD2EEDB trn[0..3]=367F2E65
19:08:17.964 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313330374D50
19:08:17.969 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313330374D50000000000000 
19:08:17.977 > [ESP32][LFSR] Initializing - Seed: 0xFC584DEC SeedBe: 0xEC4D58FC ChaosKey[0..3]: 1AD2EEDB InitialTap: 0x0029 State: 0xFC584DEC
19:08:17.989 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
19:08:17.997 > 3_After_LFSR (32): A41F75CAC01CF55AED4B4FF2311073FB 039A8B661ED9D7EC2DB06D185BC4E196 
19:08:18.002 > [ESP32][LFSR] Keystream (first 16 bytes): EC4D58FCF43CA60AA27962CB043020AF
19:08:18.010 > [ESP32][4D] LFSR keystream (first 32 bytes): EC4D58FCF43CA60AA27962CB043020AF46CAD84B2FEAE7DB60E06D185BC4E196
19:08:18.019 > [ESP32][TINKERBELL] Input (first 16 bytes): A41F75CAC01CF55AED4B4FF2311073FB Nonce: 0x00000002 Buffer size: 32 bytes
19:08:18.031 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 1AD2EEDB
19:08:18.038 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 5F49732BED4ACD50C10DADEE35C85049
19:08:18.047 > 4_After_Tinkerbell (32): FB5606E12D56380A2C46E21C04D823B2 1B1D4871D6A977D719D2991B15494F11 
19:08:18.055 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 5F49732BED4ACD50C10DADEE35C85049
19:08:18.063 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 5F49732BED4ACD50C10DADEE35C850491887C317C870A03B3462F4034E8DAE87
19:08:18.075 > 5_After_Transposition (32): 711D481B2D56380A1C46E22CD6A977D7 E15606FB04D823B219D2991B15114F49 
19:08:18.083 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:08:18.086 > [ESP32] === HMAC DEBUG INFO ===
19:08:18.088 > [ESP32] HMAC Key being used: 7839EEDBCB4F1A2AA6285B2F1F7FC5973D23ADC08F8AD515A0DAD8E932086580
19:08:18.098 > [ESP32] HMAC Input length: 45 bytes
19:08:18.100 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002711D481B2D56380A1C46E22CD6A977D7E15606
19:08:18.111 > [ESP32] Nonce: 0x00000002
19:08:18.111 > [ESP32] Packet size before HMAC: 61
19:08:18.116 > [ESP32] Computed HMAC Tag: A48CD23903B449CB4A0E877BB9DF169A
19:08:18.119 > [ESP32] === END HMAC DEBUG ===
19:08:18.122 > 6_Final_Packet (61): 82021800180004080400000002711D48 1B2D56380A1C46E22CD6A977D7E15606 ...
19:08:18.131 > [RETRY] Attempt 1/3 (nonce: 2)
19:08:18.133 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:18.139 > Sending pipeline data to server (609 bytes)
19:08:18.375 > [HTTP] Response code: 200
19:08:18.375 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:08:18.387 > [RETRY] Health data sent successfully!
19:08:18.390 > ✓ Health data #8 sent successfully
19:08:18.490 > [WebSocket] Received (636 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:82021800180004080400000002711D481B2D56380A1C46E22CD6A977D7E15606FB04D823B219D2991B15114F49A48CD23903B449CB4A0E877BB9DF169A","pipeline":{"afterLFSR":"A41F75CAC01CF55AED4B4FF2311073FB039A8B661ED9D7EC2DB06D185BC4E196","afterSalt":"48522D36342053504F322D39352053544550532D313330374D50","afterTinkerbell":"FB5606E12D56380A2C46E21C04D823B21B1D4871D6A977D719D2991B15494F11","afterTransposition":"711D481B2D56380A1C46E22CD6A977D7E15606FB04D823B219D2991B15114F49"},"plaintext":"HR-64 SPO2-95 STEPS-1307","serverTime":1770125898238,"timestamp":252541,"type":"encryption_update","ztmEnabled":true}
19:08:18.546 > [WebSocket] Processing message type: encryption_update
19:08:18.551 > [253.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:18.654 > [WebSocket] Received (88 bytes): {"heartRate":64,"spo2":95,"steps":1307,"time":1770125898238,"type":"health_data_update"}
19:08:18.662 > [WebSocket] Processing message type: health_data_update
19:08:18.668 > [253.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:18.776 > [WebSocket] Received (226 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2461,"encryptionTime":0.0,"finalPlaintext":"HR-64 SPO2-95 STEPS-1307","handshakeSuccess":true,"totalTime":0.2461},"type":"session_summary_update"}
19:08:18.799 > [WebSocket] Processing message type: session_summary_update
19:08:18.804 > [253.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:18.909 > [WebSocket] Received (660 bytes): {"decryptionTime":0.2461,"encryptedPacket":"82021800180004080400000002711D481B2D56380A1C46E22CD6A977D7E15606FB04D823B219D2991B15114F49A48CD23903B449CB4A0E877BB9DF169A","finalPlaintext":"HR-64 SPO2-95 STEPS-1307","healthData":{"heartRate":64,"spo2":95,"steps":1307},"pipeline":{"afterDepad":"48522D36342053504F322D39352053544550532D31333037000000000000","afterLFSR":"48522D36342053504F322D39352053544550532D313330374D50000000000000","afterTinkerbell":"A41F75CAC01CF55AED4B4FF2311073FB039A8B661ED9D7EC2DB06D185BC4E196","afterTransposition":"FB5606E12D56380A2C46E21C04D823B21B1D4871D6A977D719D2991B15494F11"},"serverTime":1770125898239,"type":"decryption_update"}
19:08:18.968 > [WebSocket] Processing message type: decryption_update
19:08:18.973 > [WebSocket] Server decryption completed
19:08:18.976 > [WebSocket] Health data - HR: 64, SPO2: 95, Steps: 1307
19:08:18.982 > [253.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:19.083 > [WebSocket] Received (648 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":7,"pipeline":{"afterLFSR":"A41F75CAC01CF55AED4B4FF2311073FB039A8B661ED9D7EC2DB06D185BC4E196","afterSalt":"48522D36342053504F322D39352053544550532D313330374D50","afterTinkerbell":"FB5606E12D56380A2C46E21C04D823B21B1D4871D6A977D719D2991B15494F11","afterTransposition":"711D481B2D56380A1C46E22CD6A977D7E15606FB04D823B219D2991B15114F49","finalPacket":"82021800180004080400000002711D481B2D56380A1C46E22CD6A977D7E15606FB04D823B219D2991B15114F49A48CD23903B449CB4A0E877BB9DF169A"},"plaintext":"HR-64 SPO2-95 STEPS-1307","timestamp":252787,"type":"encryption_pipeline","ztmEnabled":true}
19:08:19.141 > [WebSocket] Processing message type: encryption_pipeline
19:08:19.147 > [253.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:19.247 > [WebSocket] Received (158 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Health data #8 sent successfully","state":7,"success":true,"timestamp":252791,"type":"health_data_sent"}
19:08:19.264 > [WebSocket] Processing message type: health_data_sent
19:08:19.267 > [253.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:19.369 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125898481,"threatLevel":0,"type":"heuristics_update"}
19:08:19.395 > [WebSocket] Processing message type: heuristics_update
19:08:19.400 > [253.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:19.505 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125899481,"threatLevel":0,"type":"heuristics_update"}
19:08:19.529 > [WebSocket] Processing message type: heuristics_update
19:08:19.535 > [253.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:19.636 > [254.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:19.738 > [254.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:19.839 > [254.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:19.940 > [254.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:20.041 > [254.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:20.142 > [254.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:20.243 > [254.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:20.344 > [254.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:20.445 > [254.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:20.547 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125900482,"threatLevel":0,"type":"heuristics_update"}
19:08:20.571 > [WebSocket] Processing message type: heuristics_update
19:08:20.577 > [255.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:20.679 > [255.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:20.780 > [255.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:20.880 > [255.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:20.982 > [255.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:21.083 > [255.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:21.184 > [255.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:21.285 > [255.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:21.386 > [255.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:21.486 > [255.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:21.589 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125901482,"threatLevel":0,"type":"heuristics_update"}
19:08:21.613 > [WebSocket] Processing message type: heuristics_update
19:08:21.620 > [256.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:21.721 > [256.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:21.821 > [256.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:21.922 > [256.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:22.024 > [256.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:22.124 > [256.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:22.226 > [256.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:22.327 > [256.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:22.427 > [256.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:22.529 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125902482,"threatLevel":0,"type":"heuristics_update"}
19:08:22.554 > [WebSocket] Processing message type: heuristics_update
19:08:22.560 > [257.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:22.661 > [257.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:22.763 > [257.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:22.864 > [257.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:22.964 > [257.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:23.066 > [257.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:23.167 > [257.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:23.267 > [257.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:23.369 > [257.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:23.469 > [257.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:23.571 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125903483,"threatLevel":0,"type":"heuristics_update"}
19:08:23.596 > [WebSocket] Processing message type: heuristics_update
19:08:23.602 > [258.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:23.704 > [258.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:23.805 > [258.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:23.906 > [258.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:24.007 > [258.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:24.107 > [258.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:24.208 > [258.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:24.309 > [258.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:24.411 > [258.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:24.512 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125904484,"threatLevel":0,"type":"heuristics_update"}
19:08:24.538 > [WebSocket] Processing message type: heuristics_update
19:08:24.542 > [258.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:24.645 > [259.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:24.746 > [259.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:24.847 > [259.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:24.947 > [259.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:25.048 > [259.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:25.149 > [259.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:25.250 > [259.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:25.352 > [259.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:25.453 > [259.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:25.556 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125905485,"threatLevel":0,"type":"heuristics_update"}
19:08:25.581 > [WebSocket] Processing message type: heuristics_update
19:08:25.586 > [260.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:25.688 > [260.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:25.789 > [260.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:25.890 > [260.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:25.991 > [260.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:26.093 > [260.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:26.194 > [260.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:26.295 > [260.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:26.396 > [260.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:26.496 > [260.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:26.598 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125906486,"threatLevel":0,"type":"heuristics_update"}
19:08:26.623 > [WebSocket] Processing message type: heuristics_update
19:08:26.629 > [261.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:26.730 > [261.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:26.831 > [261.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:26.932 > [261.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:27.033 > [261.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:27.134 > [261.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:27.235 > [261.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:27.337 > [261.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:27.438 > [261.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:27.539 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125907488,"threatLevel":0,"type":"heuristics_update"}
19:08:27.564 > [WebSocket] Processing message type: heuristics_update
19:08:27.569 > [262.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:27.672 > [262.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:27.773 > [262.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:27.873 > [262.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:27.974 > [262.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:28.076 > [262.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:28.177 > [262.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:28.278 > [262.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:28.379 > [262.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:28.479 > [262.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:28.485 > [RETRY] Attempting to send health data (Max retries: 3)
19:08:28.491 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:08:28.497 > Generated health data: HR-64 SPO2-95 STEPS-1343
19:08:28.499 > [ESP32] ========================================
19:08:28.504 > [ESP32] ENCRYPTION PIPELINE START
19:08:28.507 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:08:28.513 > [ESP32] Active Algorithms for this packet:
19:08:28.516 > [ESP32]   + LFSR
19:08:28.519 > [ESP32]   + Tinkerbell
19:08:28.521 > [ESP32]   + Transposition
19:08:28.521 > [ESP32]   - ChaCha20
19:08:28.524 > [ESP32]   - Salsa20
19:08:28.527 > [ESP32] ========================================
19:08:28.531 > [ESP32] MsgKeys: lfsrSeed=0xB3D7AD8E tnk[0..3]=7A87DBE9 trn[0..3]=29E4894C
19:08:28.538 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313334334D50
19:08:28.544 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313334334D50000000000000 
19:08:28.552 > [ESP32][LFSR] Initializing - Seed: 0xB3D7AD8E SeedBe: 0x8EADD7B3 ChaosKey[0..3]: 7A87DBE9 InitialTap: 0x0029 State: 0xB3D7AD8E
19:08:28.564 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
19:08:28.571 > 3_After_LFSR (32): C6FFFA856E9DD7AD9EAD0C1BD5F6A615 5338DC7135C1B230D984051577E97542 
19:08:28.577 > [ESP32][LFSR] Keystream (first 16 bytes): 8EADD7B35ABD84FDD19F2122E0D6F541
19:08:28.585 > [ESP32][4D] LFSR keystream (first 32 bytes): 8EADD7B35ABD84FDD19F2122E0D6F54116688F5C04F2860394D4051577E97542
19:08:28.594 > [ESP32][TINKERBELL] Input (first 16 bytes): C6FFFA856E9DD7AD9EAD0C1BD5F6A615 Nonce: 0x00000003 Buffer size: 32 bytes
19:08:28.605 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 7A87DBE9
19:08:28.613 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 079A6B66A8B8A548168F5CF9886B7DE1
19:08:28.621 > 4_After_Tinkerbell (32): C16591E3C62572E5882250E25D9DDBF4 85B32B0F407473B94BB6DDE4CAF4CB76 
19:08:28.630 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 079A6B66A8B8A548168F5CF9886B7DE1
19:08:28.639 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 079A6B66A8B8A548168F5CF9886B7DE1D68BF77E75B5C1899232D8F1BD1DBE34
19:08:28.649 > 5_After_Transposition (32): E2C185B3F4F47265E3884BB6E574DB22 252BC69140730FB99DDD5D50CACBE476 
19:08:28.657 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000003
19:08:28.660 > [ESP32] === HMAC DEBUG INFO ===
19:08:28.663 > [ESP32] HMAC Key being used: 7839EEDBCB4F1A2AA6285B2F1F7FC5973D23ADC08F8AD515A0DAD8E932086580
19:08:28.672 > [ESP32] HMAC Input length: 45 bytes
19:08:28.674 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000003E2C185B3F4F47265E3884BB6E574DB22252BC6
19:08:28.685 > [ESP32] Nonce: 0x00000003
19:08:28.685 > [ESP32] Packet size before HMAC: 61
19:08:28.691 > [ESP32] Computed HMAC Tag: 65B55C28A82869AE9A67767F4E155620
19:08:28.694 > [ESP32] === END HMAC DEBUG ===
19:08:28.697 > 6_Final_Packet (61): 82021800180004080400000003E2C185 B3F4F47265E3884BB6E574DB22252BC6 ...
19:08:28.705 > [RETRY] Attempt 1/3 (nonce: 3)
19:08:28.708 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:28.714 > Sending pipeline data to server (609 bytes)
19:08:28.869 > [HTTP] Response code: 400
19:08:28.869 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:28.874 > [HTTP] Request failed with code: 400
19:08:28.877 > [RETRY] Send failed, waiting 100 ms before retry
19:08:28.978 > [RETRY] Attempt 2/3 (nonce: 3)
19:08:28.978 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:28.983 > Sending pipeline data to server (609 bytes)
19:08:29.130 > [HTTP] Response code: 400
19:08:29.130 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:29.135 > [HTTP] Request failed with code: 400
19:08:29.139 > [RETRY] Send failed, waiting 200 ms before retry
19:08:29.338 > [RETRY] Attempt 3/3 (nonce: 3)
19:08:29.339 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:29.344 > Sending pipeline data to server (609 bytes)
19:08:29.619 > [HTTP] Response code: 400
19:08:29.619 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:29.625 > [HTTP] Request failed with code: 400
19:08:29.627 > [RETRY] All retry attempts failed - rolled back nonce to 2
19:08:29.633 > [RETRY] Consecutive failures: 1
19:08:29.636 > Health data send failed (retry count: 1/3)
19:08:29.741 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125908489,"threatLevel":0,"type":"heuristics_update"}
19:08:29.766 > [WebSocket] Processing message type: heuristics_update
19:08:29.772 > [264.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:29.777 > [RETRY] Attempting to send health data (Max retries: 3)
19:08:29.783 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:08:29.789 > Generated health data: HR-64 SPO2-95 STEPS-1352
19:08:29.792 > [ESP32] ========================================
19:08:29.797 > [ESP32] ENCRYPTION PIPELINE START
19:08:29.800 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:08:29.805 > [ESP32] Active Algorithms for this packet:
19:08:29.808 > [ESP32]   + LFSR
19:08:29.811 > [ESP32]   + Tinkerbell
19:08:29.813 > [ESP32]   + Transposition
19:08:29.813 > [ESP32]   - ChaCha20
19:08:29.816 > [ESP32]   - Salsa20
19:08:29.819 > [ESP32] ========================================
19:08:29.821 > [ESP32] MsgKeys: lfsrSeed=0xB3D7AD8E tnk[0..3]=7A87DBE9 trn[0..3]=29E4894C
19:08:29.831 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313335324D50
19:08:29.836 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313335324D50000000000000 
19:08:29.844 > [ESP32][LFSR] Initializing - Seed: 0xB3D7AD8E SeedBe: 0x8EADD7B3 ChaosKey[0..3]: 7A87DBE9 InitialTap: 0x0029 State: 0xB3D7AD8E
19:08:29.855 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
19:08:29.863 > 3_After_LFSR (32): C6FFFA856E9DD7AD9EAD0C1BD5F6A615 5338DC7135C1B331D984051577E97542 
19:08:29.870 > [ESP32][LFSR] Keystream (first 16 bytes): 8EADD7B35ABD84FDD19F2122E0D6F541
19:08:29.878 > [ESP32][4D] LFSR keystream (first 32 bytes): 8EADD7B35ABD84FDD19F2122E0D6F54116688F5C04F2860394D4051577E97542
19:08:29.886 > [ESP32][TINKERBELL] Input (first 16 bytes): C6FFFA856E9DD7AD9EAD0C1BD5F6A615 Nonce: 0x00000003 Buffer size: 32 bytes
19:08:29.897 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 7A87DBE9
19:08:29.905 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 079A6B66A8B8A548168F5CF9886B7DE1
19:08:29.913 > 4_After_Tinkerbell (32): C16591E3C62572E5882250E25D9DDBF4 85B32B0F407472B84BB6DDE4CAF4CB76 
19:08:29.921 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 079A6B66A8B8A548168F5CF9886B7DE1
19:08:29.930 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 079A6B66A8B8A548168F5CF9886B7DE1D68BF77E75B5C1899232D8F1BD1DBE34
19:08:29.942 > 5_After_Transposition (32): E2C185B3F4F47265E3884BB6E574DB22 252BC69140720FB89DDD5D50CACBE476 
19:08:29.950 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000003
19:08:29.953 > [ESP32] === HMAC DEBUG INFO ===
19:08:29.955 > [ESP32] HMAC Key being used: 7839EEDBCB4F1A2AA6285B2F1F7FC5973D23ADC08F8AD515A0DAD8E932086580
19:08:29.964 > [ESP32] HMAC Input length: 45 bytes
19:08:29.967 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000003E2C185B3F4F47265E3884BB6E574DB22252BC6
19:08:29.977 > [ESP32] Nonce: 0x00000003
19:08:29.977 > [ESP32] Packet size before HMAC: 61
19:08:29.983 > [ESP32] Computed HMAC Tag: B0763CEA955CB7C059D074DCD1CBD866
19:08:29.986 > [ESP32] === END HMAC DEBUG ===
19:08:29.988 > 6_Final_Packet (61): 82021800180004080400000003E2C185 B3F4F47265E3884BB6E574DB22252BC6 ...
19:08:29.997 > [RETRY] Attempt 1/3 (nonce: 3)
19:08:30.000 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:30.005 > Sending pipeline data to server (609 bytes)
19:08:30.341 > [HTTP] Response code: 400
19:08:30.342 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:30.347 > [HTTP] Request failed with code: 400
19:08:30.349 > [RETRY] Send failed, waiting 100 ms before retry
19:08:30.451 > [RETRY] Attempt 2/3 (nonce: 3)
19:08:30.451 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:30.455 > Sending pipeline data to server (609 bytes)
19:08:30.656 > [HTTP] Response code: 400
19:08:30.656 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:30.661 > [HTTP] Request failed with code: 400
19:08:30.664 > [RETRY] Send failed, waiting 200 ms before retry
19:08:30.864 > [RETRY] Attempt 3/3 (nonce: 3)
19:08:30.864 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:30.869 > Sending pipeline data to server (609 bytes)
19:08:31.145 > [HTTP] Response code: 400
19:08:31.146 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:31.151 > [HTTP] Request failed with code: 400
19:08:31.154 > [RETRY] All retry attempts failed - rolled back nonce to 2
19:08:31.159 > [RETRY] Consecutive failures: 2
19:08:31.162 > Health data send failed (retry count: 2/3)
19:08:31.264 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":263280,"type":"health_data_error"}
19:08:31.279 > [WebSocket] Processing message type: health_data_error
19:08:31.284 > [265.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:31.292 > [RETRY] Attempting to send health data (Max retries: 3)
19:08:31.298 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:08:31.304 > Generated health data: HR-64 SPO2-95 STEPS-1373
19:08:31.306 > [ESP32] ========================================
19:08:31.312 > [ESP32] ENCRYPTION PIPELINE START
19:08:31.315 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:08:31.320 > [ESP32] Active Algorithms for this packet:
19:08:31.323 > [ESP32]   + LFSR
19:08:31.323 > [ESP32]   + Tinkerbell
19:08:31.326 > [ESP32]   + Transposition
19:08:31.329 > [ESP32]   - ChaCha20
19:08:31.332 > [ESP32]   - Salsa20
19:08:31.332 > [ESP32] ========================================
19:08:31.337 > [ESP32] MsgKeys: lfsrSeed=0xB3D7AD8E tnk[0..3]=7A87DBE9 trn[0..3]=29E4894C
19:08:31.342 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313337334D50
19:08:31.349 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313337334D50000000000000 
19:08:31.357 > [ESP32][LFSR] Initializing - Seed: 0xB3D7AD8E SeedBe: 0x8EADD7B3 ChaosKey[0..3]: 7A87DBE9 InitialTap: 0x0029 State: 0xB3D7AD8E
19:08:31.367 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
19:08:31.375 > 3_After_LFSR (32): C6FFFA856E9DD7AD9EAD0C1BD5F6A615 5338DC7135C1B130D984051577E97542 
19:08:31.385 > [ESP32][LFSR] Keystream (first 16 bytes): 8EADD7B35ABD84FDD19F2122E0D6F541
19:08:31.389 > [ESP32][4D] LFSR keystream (first 32 bytes): 8EADD7B35ABD84FDD19F2122E0D6F54116688F5C04F2860394D4051577E97542
19:08:31.402 > [ESP32][TINKERBELL] Input (first 16 bytes): C6FFFA856E9DD7AD9EAD0C1BD5F6A615 Nonce: 0x00000003 Buffer size: 32 bytes
19:08:31.409 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 7A87DBE9
19:08:31.420 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 079A6B66A8B8A548168F5CF9886B7DE1
19:08:31.429 > 4_After_Tinkerbell (32): C16591E3C62572E5882250E25D9DDBF4 85B32B0F407470B94BB6DDE4CAF4CB76 
19:08:31.438 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 079A6B66A8B8A548168F5CF9886B7DE1
19:08:31.445 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 079A6B66A8B8A548168F5CF9886B7DE1D68BF77E75B5C1899232D8F1BD1DBE34
19:08:31.454 > 5_After_Transposition (32): E2C185B3F4F47265E3884BB6E574DB22 252BC69140700FB99DDD5D50CACBE476 
19:08:31.462 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000003
19:08:31.467 > [ESP32] === HMAC DEBUG INFO ===
19:08:31.470 > [ESP32] HMAC Key being used: 7839EEDBCB4F1A2AA6285B2F1F7FC5973D23ADC08F8AD515A0DAD8E932086580
19:08:31.479 > [ESP32] HMAC Input length: 45 bytes
19:08:31.482 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000003E2C185B3F4F47265E3884BB6E574DB22252BC6
19:08:31.490 > [ESP32] Nonce: 0x00000003
19:08:31.493 > [ESP32] Packet size before HMAC: 61
19:08:31.496 > [ESP32] Computed HMAC Tag: 25E65C031C6873411C45C8ACCA50E1F5
19:08:31.501 > [ESP32] === END HMAC DEBUG ===
19:08:31.504 > 6_Final_Packet (61): 82021800180004080400000003E2C185 B3F4F47265E3884BB6E574DB22252BC6 ...
19:08:31.512 > [RETRY] Attempt 1/3 (nonce: 3)
19:08:31.515 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:31.520 > Sending pipeline data to server (609 bytes)
19:08:31.632 > [HTTP] Response code: 400
19:08:31.632 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:31.638 > [HTTP] Request failed with code: 400
19:08:31.640 > [RETRY] Send failed, waiting 100 ms before retry
19:08:31.740 > [RETRY] Attempt 2/3 (nonce: 3)
19:08:31.740 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:31.745 > Sending pipeline data to server (609 bytes)
19:08:32.140 > [HTTP] Response code: 400
19:08:32.140 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:32.146 > [HTTP] Request failed with code: 400
19:08:32.149 > [RETRY] Send failed, waiting 200 ms before retry
19:08:32.349 > [RETRY] Attempt 3/3 (nonce: 3)
19:08:32.350 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:32.355 > Sending pipeline data to server (609 bytes)
19:08:32.641 > [HTTP] Response code: 400
19:08:32.642 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:32.648 > [HTTP] Request failed with code: 400
19:08:32.650 > [RETRY] All retry attempts failed - rolled back nonce to 2
19:08:32.656 > [RETRY] Consecutive failures: 3
19:08:32.659 > Health data send failed (retry count: 3/3)
19:08:32.661 > Health data transmission failed after max retries
19:08:32.761 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":263542,"type":"health_data_error"}
19:08:32.776 > [WebSocket] Processing message type: health_data_error
19:08:32.781 > [267.2] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:32.789 > ERROR state - attempting recovery
19:08:32.792 > [RETRY] Attempting to send health data (Max retries: 3)
19:08:32.798 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:08:32.800 > Generated health data: HR-65 SPO2-95 STEPS-1367
19:08:32.806 > [ESP32] ========================================
19:08:32.809 > [ESP32] ENCRYPTION PIPELINE START
19:08:32.812 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:08:32.817 > [ESP32] Active Algorithms for this packet:
19:08:32.823 > [ESP32]   + LFSR
19:08:32.823 > [ESP32]   + Tinkerbell
19:08:32.825 > [ESP32]   + Transposition
19:08:32.829 > [ESP32]   - ChaCha20
19:08:32.829 > [ESP32]   - Salsa20
19:08:32.831 > [ESP32] ========================================
19:08:32.837 > [ESP32] MsgKeys: lfsrSeed=0xB3D7AD8E tnk[0..3]=7A87DBE9 trn[0..3]=29E4894C
19:08:32.842 > 1_After_Salt (26): 48522D36352053504F322D3935205354 4550532D313336374D50
19:08:32.848 > 2_After_Padding (32): 48522D36352053504F322D3935205354 4550532D313336374D50000000000000 
19:08:32.856 > [ESP32][LFSR] Initializing - Seed: 0xB3D7AD8E SeedBe: 0x8EADD7B3 ChaosKey[0..3]: 7A87DBE9 InitialTap: 0x0029 State: 0xB3D7AD8E
19:08:32.868 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3935205354 Buffer size: 32 bytes
19:08:32.876 > 3_After_LFSR (32): C6FFFA856F9DD7AD9EAD0C1BD5F6A615 5338DC7135C1B034D984051577E97542 
19:08:32.884 > [ESP32][LFSR] Keystream (first 16 bytes): 8EADD7B35ABD84FDD19F2122E0D6F541
19:08:32.889 > [ESP32][4D] LFSR keystream (first 32 bytes): 8EADD7B35ABD84FDD19F2122E0D6F54116688F5C04F2860394D4051577E97542
19:08:32.898 > [ESP32][TINKERBELL] Input (first 16 bytes): C6FFFA856F9DD7AD9EAD0C1BD5F6A615 Nonce: 0x00000003 Buffer size: 32 bytes
19:08:32.909 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 7A87DBE9
19:08:32.921 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 079A6B66A8B8A548168F5CF9886B7DE1
19:08:32.928 > 4_After_Tinkerbell (32): C16591E3C72572E5882250E25D9DDBF4 85B32B0F407471BD4BB6DDE4CAF4CB76 
19:08:32.936 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 079A6B66A8B8A548168F5CF9886B7DE1
19:08:32.942 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 079A6B66A8B8A548168F5CF9886B7DE1D68BF77E75B5C1899232D8F1BD1DBE34
19:08:32.954 > 5_After_Transposition (32): E2C185B3F4F47265E3884BB6E574DB22 252BC79140710FBD9DDD5D50CACBE476 
19:08:32.962 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000003
19:08:32.967 > [ESP32] === HMAC DEBUG INFO ===
19:08:32.970 > [ESP32] HMAC Key being used: 7839EEDBCB4F1A2AA6285B2F1F7FC5973D23ADC08F8AD515A0DAD8E932086580
19:08:32.979 > [ESP32] HMAC Input length: 45 bytes
19:08:32.981 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000003E2C185B3F4F47265E3884BB6E574DB22252BC7
19:08:32.990 > [ESP32] Nonce: 0x00000003
19:08:32.993 > [ESP32] Packet size before HMAC: 61
19:08:32.995 > [ESP32] Computed HMAC Tag: 936BC460781A10F09A1093C0709E5B65
19:08:33.000 > [ESP32] === END HMAC DEBUG ===
19:08:33.004 > 6_Final_Packet (61): 82021800180004080400000003E2C185 B3F4F47265E3884BB6E574DB22252BC7 ...
19:08:33.012 > [RETRY] Attempt 1/3 (nonce: 3)
19:08:33.015 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:33.020 > Sending pipeline data to server (609 bytes)
19:08:33.176 > [HTTP] Response code: 400
19:08:33.176 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:33.182 > [HTTP] Request failed with code: 400
19:08:33.184 > [RETRY] Send failed, waiting 100 ms before retry
19:08:33.285 > [RETRY] Attempt 2/3 (nonce: 3)
19:08:33.286 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:33.291 > Sending pipeline data to server (609 bytes)
19:08:33.622 > [HTTP] Response code: 400
19:08:33.623 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:33.629 > [HTTP] Request failed with code: 400
19:08:33.631 > [RETRY] Send failed, waiting 200 ms before retry
19:08:33.830 > [RETRY] Attempt 3/3 (nonce: 3)
19:08:33.831 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:33.835 > Sending pipeline data to server (609 bytes)
19:08:34.395 > [HTTP] Response code: 400
19:08:34.395 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:34.400 > [HTTP] Request failed with code: 400
19:08:34.403 > [RETRY] All retry attempts failed - rolled back nonce to 2
19:08:34.409 > [RETRY] Consecutive failures: 4
19:08:34.412 > ✗ Auto-recovery failed - restarting key exchange
19:08:36.514 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125909489,"threatLevel":0,"type":"heuristics_update"}
19:08:36.540 > [WebSocket] Processing message type: heuristics_update
19:08:36.546 > [270.9] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:36.555 > ✓ Public key loaded from NVS
19:08:36.652 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":264030,"type":"health_data_error"}
19:08:36.665 > [WebSocket] Processing message type: health_data_error
19:08:36.671 > [271.1] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:36.776 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":264753,"type":"health_data_error"}
19:08:36.790 > [WebSocket] Processing message type: health_data_error
19:08:36.795 > [271.2] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:36.802 > Generating fresh master key from entropy...
19:08:36.812 > Generated master key (32): A745DEA13BDBA1B18F1D975BBC40120A F864C0EB01DD567224E6D18DDC74D0D9 
19:08:36.817 > Using reduced master key (byte % 3) for NTRU encryption only
19:08:36.828 > NTRU encrypted master key (502): 0023006E001E0017007F001B00080062 00460079003A000D000200750068006F ...
19:08:36.836 > POST http://10.249.92.115:8081/master-key
19:08:37.186 > ✓ Master key exchange completed
19:08:37.289 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125910491,"threatLevel":0,"type":"heuristics_update"}
19:08:37.314 > [WebSocket] Processing message type: heuristics_update
19:08:37.319 > [271.7] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:37.324 > Loading master key from NVS and deriving symmetric keys...
19:08:37.331 > Loaded master key from NVS (32): A745DEA13BDBA1B18F1D975BBC40120A F864C0EB01DD567224E6D18DDC74D0D9 
19:08:37.342 > Derived HMAC key (32): 4D2EDC45182B04548A658B3C48D88D83 AC77BDF6ACE6D7D086CEDCE67BCEB2F5 
19:08:37.348 > Derived Tinkerbell key (16): 780444F6C29798BAEC25B57B95C96880 
19:08:37.353 > Derived Transposition key (16): D5206331584E6256970BF00CB75E2D9E 
19:08:37.361 > ✓ Symmetric keys derived successfully
19:08:37.364 > Nonce tracker reset - new session started
19:08:37.859 > Waiting for server to process master key...
19:08:37.865 > ✓ Symmetric keys ready - starting health data transmission
19:08:37.966 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":265067,"type":"health_data_error"}
19:08:37.980 > [WebSocket] Processing message type: health_data_error
19:08:37.985 > [272.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:38.088 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":265557,"type":"health_data_error"}
19:08:38.102 > [WebSocket] Processing message type: health_data_error
19:08:38.108 > [272.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:38.210 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125911491,"threatLevel":0,"type":"heuristics_update"}
19:08:38.236 > [WebSocket] Processing message type: heuristics_update
19:08:38.241 > [272.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:38.344 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":266043,"type":"health_data_error"}
19:08:38.358 > [WebSocket] Processing message type: health_data_error
19:08:38.363 > [272.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:38.466 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":266552,"type":"health_data_error"}
19:08:38.480 > [WebSocket] Processing message type: health_data_error
19:08:38.485 > [272.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:38.590 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125912492,"threatLevel":0,"type":"heuristics_update"}
19:08:38.615 > [WebSocket] Processing message type: heuristics_update
19:08:38.620 > [273.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:38.722 > [273.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:38.823 > [273.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:38.924 > [273.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:39.025 > [273.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:39.126 > [273.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:39.227 > [273.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:39.328 > [273.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:39.429 > [273.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:39.530 > [273.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:39.631 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":267053,"type":"health_data_error"}
19:08:39.646 > [WebSocket] Processing message type: health_data_error
19:08:39.651 > [274.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:39.755 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":8,"success":false,"timestamp":267588,"type":"health_data_error"}
19:08:39.768 > [WebSocket] Processing message type: health_data_error
19:08:39.774 > [274.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:39.876 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125913492,"threatLevel":0,"type":"heuristics_update"}
19:08:39.902 > [WebSocket] Processing message type: heuristics_update
19:08:39.907 > [274.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:40.010 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":8,"success":false,"timestamp":268034,"type":"health_data_error"}
19:08:40.023 > [WebSocket] Processing message type: health_data_error
19:08:40.029 > [274.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:40.131 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":8,"success":false,"timestamp":268807,"type":"health_data_error"}
19:08:40.145 > [WebSocket] Processing message type: health_data_error
19:08:40.151 > [274.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:40.254 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125914493,"threatLevel":0,"type":"heuristics_update"}
19:08:40.278 > [WebSocket] Processing message type: heuristics_update
19:08:40.284 > [274.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:40.386 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125915494,"threatLevel":0,"type":"heuristics_update"}
19:08:40.412 > [WebSocket] Processing message type: heuristics_update
19:08:40.417 > [274.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:40.520 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125916494,"threatLevel":0,"type":"heuristics_update"}
19:08:40.545 > [WebSocket] Processing message type: heuristics_update
19:08:40.550 > [275.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:40.653 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125916963,"type":"master_key_received"}
19:08:40.666 > [WebSocket] Processing message type: master_key_received
19:08:40.670 > [275.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:40.776 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":271591,"type":"master_key_exchanged"}
19:08:40.792 > [WebSocket] Processing message type: master_key_exchanged
19:08:40.798 > [275.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:40.897 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125917495,"threatLevel":0,"type":"heuristics_update"}
19:08:40.922 > [WebSocket] Processing message type: heuristics_update
19:08:40.928 > [275.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:41.030 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":272270,"type":"symmetric_keys_derived"}
19:08:41.047 > [WebSocket] Processing message type: symmetric_keys_derived
19:08:41.052 > [275.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:41.152 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125918496,"threatLevel":0,"type":"heuristics_update"}
19:08:41.177 > [WebSocket] Processing message type: heuristics_update
19:08:41.183 > [275.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:41.285 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125919496,"threatLevel":0,"type":"heuristics_update"}
19:08:41.311 > [WebSocket] Processing message type: heuristics_update
19:08:41.316 > [275.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:41.419 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125920497,"threatLevel":0,"type":"heuristics_update"}
19:08:41.444 > [WebSocket] Processing message type: heuristics_update
19:08:41.449 > [275.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:41.552 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125921497,"threatLevel":0,"type":"heuristics_update"}
19:08:41.577 > [WebSocket] Processing message type: heuristics_update
19:08:41.582 > [276.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:41.684 > [276.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:41.785 > [276.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:41.886 > [276.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:41.986 > [276.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:42.088 > [276.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:42.189 > [276.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:42.290 > [276.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:42.391 > [276.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:42.492 > [276.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:42.594 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125922499,"threatLevel":0,"type":"heuristics_update"}
19:08:42.618 > [WebSocket] Processing message type: heuristics_update
19:08:42.624 > [277.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:42.726 > [277.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:42.827 > [277.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:42.927 > [277.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:43.029 > [277.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:43.130 > [277.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:43.231 > [277.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:43.331 > [277.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:43.433 > [277.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:43.535 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125923499,"threatLevel":0,"type":"heuristics_update"}
19:08:43.559 > [WebSocket] Processing message type: heuristics_update
19:08:43.565 > [278.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:43.667 > [278.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:43.767 > [278.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:43.869 > [278.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:43.970 > [278.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:44.071 > [278.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:44.171 > [278.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:44.273 > [278.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:44.374 > [278.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:44.475 > [278.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:44.579 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125924499,"threatLevel":0,"type":"heuristics_update"}
19:08:44.604 > [WebSocket] Processing message type: heuristics_update
19:08:44.610 > [279.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:44.711 > [279.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:44.812 > [279.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:44.913 > [279.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:45.014 > [279.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:45.114 > [279.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:45.216 > [279.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:45.317 > [279.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:45.417 > [279.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:45.519 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125925499,"threatLevel":0,"type":"heuristics_update"}
19:08:45.544 > [WebSocket] Processing message type: heuristics_update
19:08:45.551 > [280.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:45.652 > [280.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:45.753 > [280.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:45.854 > [280.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:45.955 > [280.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:46.056 > [280.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:46.157 > [280.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:46.257 > [280.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:46.359 > [280.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:46.460 > [280.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:46.561 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125926501,"threatLevel":0,"type":"heuristics_update"}
19:08:46.586 > [WebSocket] Processing message type: heuristics_update
19:08:46.592 > [281.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:46.694 > [281.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:46.795 > [281.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:46.897 > [281.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:46.996 > [281.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:47.097 > [281.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:47.199 > [281.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:47.299 > [281.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:47.400 > [281.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:47.502 > [281.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:47.603 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125927501,"threatLevel":0,"type":"heuristics_update"}
19:08:47.629 > [WebSocket] Processing message type: heuristics_update
19:08:47.634 > [282.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:47.736 > [282.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:47.836 > [282.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:47.938 > [282.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:08:47.944 > [RETRY] Attempting to send health data (Max retries: 3)
19:08:47.949 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:08:47.955 > Generated health data: HR-64 SPO2-95 STEPS-1453
19:08:47.958 > [ESP32] ========================================
19:08:47.963 > [ESP32] ENCRYPTION PIPELINE START
19:08:47.966 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:08:47.972 > [ESP32] Active Algorithms for this packet:
19:08:47.975 > [ESP32]   + LFSR
19:08:47.978 > [ESP32]   + Tinkerbell
19:08:47.980 > [ESP32]   + Transposition
19:08:47.980 > [ESP32]   - ChaCha20
19:08:47.983 > [ESP32]   - Salsa20
19:08:47.985 > [ESP32] ========================================
19:08:47.988 > [ESP32] MsgKeys: lfsrSeed=0x2025CDD5 tnk[0..3]=1C99E045 trn[0..3]=F56E2CD4
19:08:47.997 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313435334D50
19:08:48.003 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313435334D50000000000000 
19:08:48.011 > [ESP32][LFSR] Initializing - Seed: 0x2025CDD5 SeedBe: 0xD5CD2520 ChaosKey[0..3]: 1C99E045 InitialTap: 0x0029 State: 0x2025CDD5
19:08:48.022 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
19:08:48.030 > 3_After_LFSR (32): 9D9F0816753D10C589FB9BD7FD9E0B2A C09555E97A1AA7CD9A290110F0969947 
19:08:48.035 > [ESP32][LFSR] Keystream (first 16 bytes): D5CD2520411D4395C6C9B6EEC8BE587E
19:08:48.044 > [ESP32][4D] LFSR keystream (first 32 bytes): D5CD2520411D4395C6C9B6EEC8BE587E85C506C44B2E92FED7790110F0969947
19:08:48.052 > [ESP32][TINKERBELL] Input (first 16 bytes): 9D9F0816753D10C589FB9BD7FD9E0B2A Nonce: 0x00000001 Buffer size: 32 bytes
19:08:48.063 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 1C99E045
19:08:48.072 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 60C3589CFA82330C7268D406CA2242FE
19:08:48.080 > 4_After_Tinkerbell (32): FD5C508A8FBF23C9FB934FD137BC49D4 2256EF80C3DB672760D4E6737AC97BC4 
19:08:48.088 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 60C3589CFA82330C7268D406CA2242FE
19:08:48.097 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 60C3589CFA82330C7268D406CA2242FEE2C3BA69B9C1C0EAFAFDE7638A5FE283
19:08:48.108 > 5_After_Transposition (32): 80DBC32256EF672773C97A60D4E67BC4 8A8FBFFD5C50D449D137BCFB934FC923 
19:08:48.116 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:08:48.119 > [ESP32] === HMAC DEBUG INFO ===
19:08:48.121 > [ESP32] HMAC Key being used: 4D2EDC45182B04548A658B3C48D88D83AC77BDF6ACE6D7D086CEDCE67BCEB2F5
19:08:48.130 > [ESP32] HMAC Input length: 45 bytes
19:08:48.132 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000180DBC32256EF672773C97A60D4E67BC48A8FBF
19:08:48.144 > [ESP32] Nonce: 0x00000001
19:08:48.144 > [ESP32] Packet size before HMAC: 61
19:08:48.149 > [ESP32] Computed HMAC Tag: 79B898278F8123A7C68CF6D6BD223F4D
19:08:48.152 > [ESP32] === END HMAC DEBUG ===
19:08:48.155 > 6_Final_Packet (61): 8202180018000408040000000180DBC3 2256EF672773C97A60D4E67BC48A8FBF ...
19:08:48.163 > [RETRY] Attempt 1/3 (nonce: 1)
19:08:48.166 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:48.172 > Sending pipeline data to server (609 bytes)
19:08:48.429 > [HTTP] Response code: 200
19:08:48.429 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:08:48.439 > [RETRY] Health data sent successfully!
19:08:48.442 > ✓ Health data #9 sent successfully
19:08:48.544 > [WebSocket] Received (183 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":14,"serverTime":1770125928284,"type":"security_update"}
19:08:48.561 > [WebSocket] Processing message type: security_update
19:08:48.567 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:08:48.572 > [283.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:48.678 > [WebSocket] Received (636 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:8202180018000408040000000180DBC32256EF672773C97A60D4E67BC48A8FBFFD5C50D449D137BCFB934FC92379B898278F8123A7C68CF6D6BD223F4D","pipeline":{"afterLFSR":"9D9F0816753D10C589FB9BD7FD9E0B2AC09555E97A1AA7CD9A290110F0969947","afterSalt":"48522D36342053504F322D39352053544550532D313435334D50","afterTinkerbell":"FD5C508A8FBF23C9FB934FD137BC49D42256EF80C3DB672760D4E6737AC97BC4","afterTransposition":"80DBC32256EF672773C97A60D4E67BC48A8FBFFD5C50D449D137BCFB934FC923"},"plaintext":"HR-64 SPO2-95 STEPS-1453","serverTime":1770125928284,"timestamp":282575,"type":"encryption_update","ztmEnabled":true}
19:08:48.733 > [WebSocket] Processing message type: encryption_update
19:08:48.738 > [283.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:48.841 > [WebSocket] Received (88 bytes): {"heartRate":64,"spo2":95,"steps":1453,"time":1770125928284,"type":"health_data_update"}
19:08:48.849 > [WebSocket] Processing message type: health_data_update
19:08:48.855 > [283.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:48.963 > [WebSocket] Received (226 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2825,"encryptionTime":0.0,"finalPlaintext":"HR-64 SPO2-95 STEPS-1453","handshakeSuccess":true,"totalTime":0.2825},"type":"session_summary_update"}
19:08:48.985 > [WebSocket] Processing message type: session_summary_update
19:08:48.991 > [283.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:49.097 > [WebSocket] Received (660 bytes): {"decryptionTime":0.2825,"encryptedPacket":"8202180018000408040000000180DBC32256EF672773C97A60D4E67BC48A8FBFFD5C50D449D137BCFB934FC92379B898278F8123A7C68CF6D6BD223F4D","finalPlaintext":"HR-64 SPO2-95 STEPS-1453","healthData":{"heartRate":64,"spo2":95,"steps":1453},"pipeline":{"afterDepad":"48522D36342053504F322D39352053544550532D31343533000000000000","afterLFSR":"48522D36342053504F322D39352053544550532D313435334D50000000000000","afterTinkerbell":"9D9F0816753D10C589FB9BD7FD9E0B2AC09555E97A1AA7CD9A290110F0969947","afterTransposition":"FD5C508A8FBF23C9FB934FD137BC49D42256EF80C3DB672760D4E6737AC97BC4"},"serverTime":1770125928285,"type":"decryption_update"}
19:08:49.155 > [WebSocket] Processing message type: decryption_update
19:08:49.161 > [WebSocket] Server decryption completed
19:08:49.163 > [WebSocket] Health data - HR: 64, SPO2: 95, Steps: 1453
19:08:49.169 > [283.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:49.270 > [WebSocket] Received (648 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":8,"pipeline":{"afterLFSR":"9D9F0816753D10C589FB9BD7FD9E0B2AC09555E97A1AA7CD9A290110F0969947","afterSalt":"48522D36342053504F322D39352053544550532D313435334D50","afterTinkerbell":"FD5C508A8FBF23C9FB934FD137BC49D42256EF80C3DB672760D4E6737AC97BC4","afterTransposition":"80DBC32256EF672773C97A60D4E67BC48A8FBFFD5C50D449D137BCFB934FC923","finalPacket":"8202180018000408040000000180DBC32256EF672773C97A60D4E67BC48A8FBFFD5C50D449D137BCFB934FC92379B898278F8123A7C68CF6D6BD223F4D"},"plaintext":"HR-64 SPO2-95 STEPS-1453","timestamp":282840,"type":"encryption_pipeline","ztmEnabled":true}
19:08:49.329 > [WebSocket] Processing message type: encryption_pipeline
19:08:49.334 > [283.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:49.434 > [WebSocket] Received (158 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Health data #9 sent successfully","state":7,"success":true,"timestamp":282845,"type":"health_data_sent"}
19:08:49.451 > [WebSocket] Processing message type: health_data_sent
19:08:49.454 > [283.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:49.559 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125928502,"threatLevel":0,"type":"heuristics_update"}
19:08:49.584 > [WebSocket] Processing message type: heuristics_update
19:08:49.590 > [284.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:49.691 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125929502,"threatLevel":0,"type":"heuristics_update"}
19:08:49.716 > [WebSocket] Processing message type: heuristics_update
19:08:49.722 > [284.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:49.824 > [284.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:49.925 > [284.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:50.026 > [284.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:50.127 > [284.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:50.228 > [284.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:50.329 > [284.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:50.430 > [284.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:50.531 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125930503,"threatLevel":0,"type":"heuristics_update"}
19:08:50.556 > [WebSocket] Processing message type: heuristics_update
19:08:50.562 > [285.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:50.664 > [285.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:50.764 > [285.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:50.866 > [285.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:50.966 > [285.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:51.067 > [285.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:51.168 > [285.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:51.270 > [285.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:51.370 > [285.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:51.472 > [285.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:51.573 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125931503,"threatLevel":0,"type":"heuristics_update"}
19:08:51.598 > [WebSocket] Processing message type: heuristics_update
19:08:51.604 > [286.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:51.706 > [286.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:51.807 > [286.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:51.907 > [286.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:52.009 > [286.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:52.110 > [286.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:52.211 > [286.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:52.312 > [286.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:52.413 > [286.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:52.513 > [286.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:52.615 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125932504,"threatLevel":0,"type":"heuristics_update"}
19:08:52.641 > [WebSocket] Processing message type: heuristics_update
19:08:52.647 > [287.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:52.747 > [287.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:52.849 > [287.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:52.949 > [287.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:53.050 > [287.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:53.152 > [287.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:53.253 > [287.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:53.354 > [287.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:53.454 > [287.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:53.556 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125933505,"threatLevel":0,"type":"heuristics_update"}
19:08:53.581 > [WebSocket] Processing message type: heuristics_update
19:08:53.587 > [288.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:53.689 > [288.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:53.790 > [288.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:53.890 > [288.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:53.992 > [288.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:54.093 > [288.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:54.194 > [288.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:54.295 > [288.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:54.396 > [288.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:54.497 > [288.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:54.598 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125934506,"threatLevel":0,"type":"heuristics_update"}
19:08:54.623 > [WebSocket] Processing message type: heuristics_update
19:08:54.629 > [289.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:54.731 > [289.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:54.832 > [289.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:54.933 > [289.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:55.034 > [289.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:55.134 > [289.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:55.236 > [289.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:55.337 > [289.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:55.438 > [289.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:55.538 > [289.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:55.642 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125935507,"threatLevel":0,"type":"heuristics_update"}
19:08:55.667 > [WebSocket] Processing message type: heuristics_update
19:08:55.673 > [290.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:55.775 > [290.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:55.876 > [290.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:55.976 > [290.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:56.077 > [290.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:56.179 > [290.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:56.280 > [290.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:56.380 > [290.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:56.482 > [290.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:56.583 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125936507,"threatLevel":0,"type":"heuristics_update"}
19:08:56.608 > [WebSocket] Processing message type: heuristics_update
19:08:56.614 > [291.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:56.715 > [291.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:56.817 > [291.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:56.917 > [291.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:57.018 > [291.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:57.119 > [291.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:57.220 > [291.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:57.321 > [291.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:57.422 > [291.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:57.524 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125937508,"threatLevel":0,"type":"heuristics_update"}
19:08:57.550 > [WebSocket] Processing message type: heuristics_update
19:08:57.555 > [292.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:57.656 > [292.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:57.757 > [292.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:57.858 > [292.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:57.959 > [292.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:58.060 > [292.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:58.161 > [292.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:58.262 > [292.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:58.363 > [292.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:58.465 > [292.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:08:58.470 > [RETRY] Attempting to send health data (Max retries: 3)
19:08:58.475 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:08:58.481 > Generated health data: HR-64 SPO2-95 STEPS-1490
19:08:58.485 > [ESP32] ========================================
19:08:58.490 > [ESP32] ENCRYPTION PIPELINE START
19:08:58.492 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:08:58.498 > [ESP32] Active Algorithms for this packet:
19:08:58.501 > [ESP32]   + LFSR
19:08:58.504 > [ESP32]   + Tinkerbell
19:08:58.507 > [ESP32]   + Transposition
19:08:58.507 > [ESP32]   - ChaCha20
19:08:58.509 > [ESP32]   - Salsa20
19:08:58.512 > [ESP32] ========================================
19:08:58.515 > [ESP32] MsgKeys: lfsrSeed=0x3ED81833 tnk[0..3]=9DE26ECB trn[0..3]=E91DAFB3
19:08:58.523 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313439304D50
19:08:58.529 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313439304D50000000000000 
19:08:58.538 > [ESP32][LFSR] Initializing - Seed: 0x3ED81833 SeedBe: 0x3318D83E ChaosKey[0..3]: 9DE26ECB InitialTap: 0x0029 State: 0x3ED81833
19:08:58.548 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
19:08:58.557 > 3_After_LFSR (32): 7B4AF5088E6EBEEF0726E4A1DC2343BE 57584D9702F34DEECB472317BEC7F915 
19:08:58.563 > [ESP32][LFSR] Keystream (first 16 bytes): 3318D83EBA4EEDBF4814C998E90310EA
19:08:58.571 > [ESP32][4D] LFSR keystream (first 32 bytes): 3318D83EBA4EEDBF4814C998E90310EA12081EBA33C774DE86172317BEC7F915
19:08:58.579 > [ESP32][TINKERBELL] Input (first 16 bytes): 7B4AF5088E6EBEEF0726E4A1DC2343BE Nonce: 0x00000002 Buffer size: 32 bytes
19:08:58.590 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 9DE26ECB
19:08:58.599 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 5B7960600A5B0B2E92BC4D86A1E5BA08
19:08:58.606 > 4_After_Tinkerbell (32): 203395688435B5C1959AA9277DC6F9B6 59842CE115A4C4087B1DDA8E2A1F3B83 
19:08:58.615 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 5B7960600A5B0B2E92BC4D86A1E5BA08
19:08:58.623 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 5B7960600A5B0B2E92BC4D86A1E5BA080EDC6176175789E6B05AF99994D8C296
19:08:58.634 > 5_After_Transposition (32): C67DE12C9568C1B535848EDAA927B6F9 8459C408A415959A1D7B3B831F2A2033 
19:08:58.643 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:08:58.645 > [ESP32] === HMAC DEBUG INFO ===
19:08:58.648 > [ESP32] HMAC Key being used: 4D2EDC45182B04548A658B3C48D88D83AC77BDF6ACE6D7D086CEDCE67BCEB2F5
19:08:58.657 > [ESP32] HMAC Input length: 45 bytes
19:08:58.660 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002C67DE12C9568C1B535848EDAA927B6F98459C4
19:08:58.671 > [ESP32] Nonce: 0x00000002
19:08:58.671 > [ESP32] Packet size before HMAC: 61
19:08:58.676 > [ESP32] Computed HMAC Tag: C1A824116F1778F74F9FA954BDE336F4
19:08:58.679 > [ESP32] === END HMAC DEBUG ===
19:08:58.681 > 6_Final_Packet (61): 82021800180004080400000002C67DE1 2C9568C1B535848EDAA927B6F98459C4 ...
19:08:58.690 > [RETRY] Attempt 1/3 (nonce: 2)
19:08:58.693 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:58.699 > Sending pipeline data to server (609 bytes)
19:08:58.965 > [HTTP] Response code: 400
19:08:58.965 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:58.971 > [HTTP] Request failed with code: 400
19:08:58.973 > [RETRY] Send failed, waiting 100 ms before retry
19:08:59.073 > [RETRY] Attempt 2/3 (nonce: 2)
19:08:59.073 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:59.079 > Sending pipeline data to server (609 bytes)
19:08:59.409 > [HTTP] Response code: 400
19:08:59.410 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:59.416 > [HTTP] Request failed with code: 400
19:08:59.419 > [RETRY] Send failed, waiting 200 ms before retry
19:08:59.617 > [RETRY] Attempt 3/3 (nonce: 2)
19:08:59.617 > POST http://10.249.92.115:8081/health-data with pipeline data
19:08:59.623 > Sending pipeline data to server (609 bytes)
19:08:59.956 > [HTTP] Response code: 400
19:08:59.956 > [HTTP] Error response: {"error":"Decryption failed"}
19:08:59.962 > [HTTP] Request failed with code: 400
19:08:59.964 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:08:59.970 > [RETRY] Consecutive failures: 1
19:08:59.973 > Health data send failed (retry count: 1/3)
19:09:00.076 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125938509,"threatLevel":0,"type":"heuristics_update"}
19:09:00.102 > [WebSocket] Processing message type: heuristics_update
19:09:00.107 > [294.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:00.112 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:00.118 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:09:00.123 > Generated health data: HR-64 SPO2-95 STEPS-1519
19:09:00.126 > [ESP32] ========================================
19:09:00.132 > [ESP32] ENCRYPTION PIPELINE START
19:09:00.134 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:00.140 > [ESP32] Active Algorithms for this packet:
19:09:00.142 > [ESP32]   + LFSR
19:09:00.145 > [ESP32]   + Tinkerbell
19:09:00.148 > [ESP32]   + Transposition
19:09:00.148 > [ESP32]   - ChaCha20
19:09:00.151 > [ESP32]   - Salsa20
19:09:00.154 > [ESP32] ========================================
19:09:00.157 > [ESP32] MsgKeys: lfsrSeed=0x3ED81833 tnk[0..3]=9DE26ECB trn[0..3]=E91DAFB3
19:09:00.165 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313531394D50
19:09:00.171 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313531394D50000000000000 
19:09:00.179 > [ESP32][LFSR] Initializing - Seed: 0x3ED81833 SeedBe: 0x3318D83E ChaosKey[0..3]: 9DE26ECB InitialTap: 0x0029 State: 0x3ED81833
19:09:00.190 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
19:09:00.198 > 3_After_LFSR (32): 7B4AF5088E6EBEEF0726E4A1DC2343BE 57584D9702F245E7CB472317BEC7F915 
19:09:00.204 > [ESP32][LFSR] Keystream (first 16 bytes): 3318D83EBA4EEDBF4814C998E90310EA
19:09:00.212 > [ESP32][4D] LFSR keystream (first 32 bytes): 3318D83EBA4EEDBF4814C998E90310EA12081EBA33C774DE86172317BEC7F915
19:09:00.220 > [ESP32][TINKERBELL] Input (first 16 bytes): 7B4AF5088E6EBEEF0726E4A1DC2343BE Nonce: 0x00000002 Buffer size: 32 bytes
19:09:00.232 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 9DE26ECB
19:09:00.240 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 5B7960600A5B0B2E92BC4D86A1E5BA08
19:09:00.248 > 4_After_Tinkerbell (32): 203395688435B5C1959AA9277DC6F9B6 59842CE115A5CC017B1DDA8E2A1F3B83 
19:09:00.257 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 5B7960600A5B0B2E92BC4D86A1E5BA08
19:09:00.265 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 5B7960600A5B0B2E92BC4D86A1E5BA080EDC6176175789E6B05AF99994D8C296
19:09:00.276 > 5_After_Transposition (32): C67DE12C9568C1B535848EDAA927B6F9 8459CC01A515959A1D7B3B831F2A2033 
19:09:00.284 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:09:00.288 > [ESP32] === HMAC DEBUG INFO ===
19:09:00.290 > [ESP32] HMAC Key being used: 4D2EDC45182B04548A658B3C48D88D83AC77BDF6ACE6D7D086CEDCE67BCEB2F5
19:09:00.298 > [ESP32] HMAC Input length: 45 bytes
19:09:00.301 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002C67DE12C9568C1B535848EDAA927B6F98459CC
19:09:00.312 > [ESP32] Nonce: 0x00000002
19:09:00.312 > [ESP32] Packet size before HMAC: 61
19:09:00.317 > [ESP32] Computed HMAC Tag: 7C94ACAB0B9822BD18A8D35659AE6C5C
19:09:00.320 > [ESP32] === END HMAC DEBUG ===
19:09:00.322 > 6_Final_Packet (61): 82021800180004080400000002C67DE1 2C9568C1B535848EDAA927B6F98459CC ...
19:09:00.332 > [RETRY] Attempt 1/3 (nonce: 2)
19:09:00.334 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:00.340 > Sending pipeline data to server (609 bytes)
19:09:00.680 > [HTTP] Response code: 400
19:09:00.680 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:00.686 > [HTTP] Request failed with code: 400
19:09:00.689 > [RETRY] Send failed, waiting 100 ms before retry
19:09:00.787 > [RETRY] Attempt 2/3 (nonce: 2)
19:09:00.787 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:00.792 > Sending pipeline data to server (609 bytes)
19:09:00.986 > [HTTP] Response code: 400
19:09:00.986 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:00.992 > [HTTP] Request failed with code: 400
19:09:00.994 > [RETRY] Send failed, waiting 200 ms before retry
19:09:01.194 > [RETRY] Attempt 3/3 (nonce: 2)
19:09:01.195 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:01.199 > Sending pipeline data to server (609 bytes)
19:09:01.481 > [HTTP] Response code: 400
19:09:01.482 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:01.486 > [HTTP] Request failed with code: 400
19:09:01.490 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:09:01.496 > [RETRY] Consecutive failures: 2
19:09:01.498 > Health data send failed (retry count: 2/3)
19:09:01.601 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":293378,"type":"health_data_error"}
19:09:01.615 > [WebSocket] Processing message type: health_data_error
19:09:01.621 > [296.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:01.629 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:01.633 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:09:01.640 > Generated health data: HR-64 SPO2-95 STEPS-1495
19:09:01.643 > [ESP32] ========================================
19:09:01.648 > [ESP32] ENCRYPTION PIPELINE START
19:09:01.651 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:01.656 > [ESP32] Active Algorithms for this packet:
19:09:01.659 > [ESP32]   + LFSR
19:09:01.659 > [ESP32]   + Tinkerbell
19:09:01.662 > [ESP32]   + Transposition
19:09:01.665 > [ESP32]   - ChaCha20
19:09:01.667 > [ESP32]   - Salsa20
19:09:01.667 > [ESP32] ========================================
19:09:01.673 > [ESP32] MsgKeys: lfsrSeed=0x3ED81833 tnk[0..3]=9DE26ECB trn[0..3]=E91DAFB3
19:09:01.679 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313439354D50
19:09:01.684 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313439354D50000000000000 
19:09:01.692 > [ESP32][LFSR] Initializing - Seed: 0x3ED81833 SeedBe: 0x3318D83E ChaosKey[0..3]: 9DE26ECB InitialTap: 0x0029 State: 0x3ED81833
19:09:01.704 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
19:09:01.712 > 3_After_LFSR (32): 7B4AF5088E6EBEEF0726E4A1DC2343BE 57584D9702F34DEBCB472317BEC7F915 
19:09:01.721 > [ESP32][LFSR] Keystream (first 16 bytes): 3318D83EBA4EEDBF4814C998E90310EA
19:09:01.726 > [ESP32][4D] LFSR keystream (first 32 bytes): 3318D83EBA4EEDBF4814C998E90310EA12081EBA33C774DE86172317BEC7F915
19:09:01.737 > [ESP32][TINKERBELL] Input (first 16 bytes): 7B4AF5088E6EBEEF0726E4A1DC2343BE Nonce: 0x00000002 Buffer size: 32 bytes
19:09:01.746 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 9DE26ECB
19:09:01.757 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 5B7960600A5B0B2E92BC4D86A1E5BA08
19:09:01.765 > 4_After_Tinkerbell (32): 203395688435B5C1959AA9277DC6F9B6 59842CE115A4C40D7B1DDA8E2A1F3B83 
19:09:01.773 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 5B7960600A5B0B2E92BC4D86A1E5BA08
19:09:01.782 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 5B7960600A5B0B2E92BC4D86A1E5BA080EDC6176175789E6B05AF99994D8C296
19:09:01.790 > 5_After_Transposition (32): C67DE12C9568C1B535848EDAA927B6F9 8459C40DA415959A1D7B3B831F2A2033 
19:09:01.798 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:09:01.804 > [ESP32] === HMAC DEBUG INFO ===
19:09:01.806 > [ESP32] HMAC Key being used: 4D2EDC45182B04548A658B3C48D88D83AC77BDF6ACE6D7D086CEDCE67BCEB2F5
19:09:01.815 > [ESP32] HMAC Input length: 45 bytes
19:09:01.817 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002C67DE12C9568C1B535848EDAA927B6F98459C4
19:09:01.826 > [ESP32] Nonce: 0x00000002
19:09:01.829 > [ESP32] Packet size before HMAC: 61
19:09:01.832 > [ESP32] Computed HMAC Tag: 7A0ABC916637984BC5A03CDD6E0819C6
19:09:01.836 > [ESP32] === END HMAC DEBUG ===
19:09:01.840 > 6_Final_Packet (61): 82021800180004080400000002C67DE1 2C9568C1B535848EDAA927B6F98459C4 ...
19:09:01.848 > [RETRY] Attempt 1/3 (nonce: 2)
19:09:01.851 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:01.856 > Sending pipeline data to server (609 bytes)
19:09:02.197 > [HTTP] Response code: 400
19:09:02.199 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:02.204 > [HTTP] Request failed with code: 400
19:09:02.206 > [RETRY] Send failed, waiting 100 ms before retry
19:09:02.306 > [RETRY] Attempt 2/3 (nonce: 2)
19:09:02.306 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:02.311 > Sending pipeline data to server (609 bytes)
19:09:02.513 > [HTTP] Response code: 400
19:09:02.513 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:02.519 > [HTTP] Request failed with code: 400
19:09:02.522 > [RETRY] Send failed, waiting 200 ms before retry
19:09:02.723 > [RETRY] Attempt 3/3 (nonce: 2)
19:09:02.723 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:02.729 > Sending pipeline data to server (609 bytes)
19:09:02.975 > [HTTP] Response code: 400
19:09:02.975 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:02.980 > [HTTP] Request failed with code: 400
19:09:02.984 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:09:02.989 > [RETRY] Consecutive failures: 3
19:09:02.992 > Health data send failed (retry count: 3/3)
19:09:02.994 > Health data transmission failed after max retries
19:09:03.092 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":293822,"type":"health_data_error"}
19:09:03.107 > [WebSocket] Processing message type: health_data_error
19:09:03.113 > [297.5] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:03.121 > ERROR state - attempting recovery
19:09:03.124 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:03.129 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:09:03.132 > Generated health data: HR-64 SPO2-95 STEPS-1517
19:09:03.138 > [ESP32] ========================================
19:09:03.140 > [ESP32] ENCRYPTION PIPELINE START
19:09:03.143 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:03.148 > [ESP32] Active Algorithms for this packet:
19:09:03.154 > [ESP32]   + LFSR
19:09:03.154 > [ESP32]   + Tinkerbell
19:09:03.157 > [ESP32]   + Transposition
19:09:03.159 > [ESP32]   - ChaCha20
19:09:03.159 > [ESP32]   - Salsa20
19:09:03.162 > [ESP32] ========================================
19:09:03.168 > [ESP32] MsgKeys: lfsrSeed=0x3ED81833 tnk[0..3]=9DE26ECB trn[0..3]=E91DAFB3
19:09:03.174 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313531374D50
19:09:03.180 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313531374D50000000000000 
19:09:03.188 > [ESP32][LFSR] Initializing - Seed: 0x3ED81833 SeedBe: 0x3318D83E ChaosKey[0..3]: 9DE26ECB InitialTap: 0x0029 State: 0x3ED81833
19:09:03.199 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
19:09:03.207 > 3_After_LFSR (32): 7B4AF5088E6EBEEF0726E4A1DC2343BE 57584D9702F245E9CB472317BEC7F915 
19:09:03.215 > [ESP32][LFSR] Keystream (first 16 bytes): 3318D83EBA4EEDBF4814C998E90310EA
19:09:03.220 > [ESP32][4D] LFSR keystream (first 32 bytes): 3318D83EBA4EEDBF4814C998E90310EA12081EBA33C774DE86172317BEC7F915
19:09:03.229 > [ESP32][TINKERBELL] Input (first 16 bytes): 7B4AF5088E6EBEEF0726E4A1DC2343BE Nonce: 0x00000002 Buffer size: 32 bytes
19:09:03.240 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 9DE26ECB
19:09:03.252 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 5B7960600A5B0B2E92BC4D86A1E5BA08
19:09:03.259 > 4_After_Tinkerbell (32): 203395688435B5C1959AA9277DC6F9B6 59842CE115A5CC0F7B1DDA8E2A1F3B83 
19:09:03.268 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 5B7960600A5B0B2E92BC4D86A1E5BA08
19:09:03.273 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 5B7960600A5B0B2E92BC4D86A1E5BA080EDC6176175789E6B05AF99994D8C296
19:09:03.285 > 5_After_Transposition (32): C67DE12C9568C1B535848EDAA927B6F9 8459CC0FA515959A1D7B3B831F2A2033 
19:09:03.294 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:09:03.299 > [ESP32] === HMAC DEBUG INFO ===
19:09:03.301 > [ESP32] HMAC Key being used: 4D2EDC45182B04548A658B3C48D88D83AC77BDF6ACE6D7D086CEDCE67BCEB2F5
19:09:03.310 > [ESP32] HMAC Input length: 45 bytes
19:09:03.312 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002C67DE12C9568C1B535848EDAA927B6F98459CC
19:09:03.321 > [ESP32] Nonce: 0x00000002
19:09:03.323 > [ESP32] Packet size before HMAC: 61
19:09:03.327 > [ESP32] Computed HMAC Tag: 7D9024CB12DC50465EE1F8A5AB59FBA8
19:09:03.332 > [ESP32] === END HMAC DEBUG ===
19:09:03.335 > 6_Final_Packet (61): 82021800180004080400000002C67DE1 2C9568C1B535848EDAA927B6F98459CC ...
19:09:03.342 > [RETRY] Attempt 1/3 (nonce: 2)
19:09:03.346 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:03.351 > Sending pipeline data to server (609 bytes)
19:09:03.732 > [HTTP] Response code: 400
19:09:03.732 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:03.738 > [HTTP] Request failed with code: 400
19:09:03.740 > [RETRY] Send failed, waiting 100 ms before retry
19:09:03.839 > [RETRY] Attempt 2/3 (nonce: 2)
19:09:03.839 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:03.845 > Sending pipeline data to server (609 bytes)
19:09:04.001 > [HTTP] Response code: 400
19:09:04.002 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:04.007 > [HTTP] Request failed with code: 400
19:09:04.010 > [RETRY] Send failed, waiting 200 ms before retry
19:09:04.210 > [RETRY] Attempt 3/3 (nonce: 2)
19:09:04.210 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:04.216 > Sending pipeline data to server (609 bytes)
19:09:04.503 > [HTTP] Response code: 400
19:09:04.503 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:04.508 > [HTTP] Request failed with code: 400
19:09:04.511 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:09:04.516 > [RETRY] Consecutive failures: 4
19:09:04.519 > ✗ Auto-recovery failed - restarting key exchange
19:09:06.622 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125939510,"threatLevel":0,"type":"heuristics_update"}
19:09:06.647 > [WebSocket] Processing message type: heuristics_update
19:09:06.653 > [301.1] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:06.662 > ✓ Public key loaded from NVS
19:09:06.759 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":294368,"type":"health_data_error"}
19:09:06.773 > [WebSocket] Processing message type: health_data_error
19:09:06.777 > [301.2] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:06.882 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125940511,"threatLevel":0,"type":"heuristics_update"}
19:09:06.907 > [WebSocket] Processing message type: heuristics_update
19:09:06.913 > [301.3] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:06.922 > Generating fresh master key from entropy...
19:09:06.924 > Generated master key (32): 70A270DCA6AF244DCDC4BA6049243B7D 6A4791F93C1B064CB66F8262718968FA 
19:09:06.936 > Using reduced master key (byte % 3) for NTRU encryption only
19:09:06.946 > NTRU encrypted master key (502): 0022006E001F0016007E001C00060064 004500780039000C00010074006A0070 ...
19:09:06.954 > POST http://10.249.92.115:8081/master-key
19:09:07.249 > ✓ Master key exchange completed
19:09:07.351 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":295092,"type":"health_data_error"}
19:09:07.365 > [WebSocket] Processing message type: health_data_error
19:09:07.370 > [301.8] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:07.379 > Loading master key from NVS and deriving symmetric keys...
19:09:07.384 > Loaded master key from NVS (32): 70A270DCA6AF244DCDC4BA6049243B7D 6A4791F93C1B064CB66F8262718968FA 
19:09:07.392 > Derived HMAC key (32): 4025ECD64CDBD717DCFF87650039E59A 55A83DB6AEAEA0373CAFD7A3570F758C 
19:09:07.401 > Derived Tinkerbell key (16): 33E768BAA999273DB1F8A3E392ED5E46 
19:09:07.407 > Derived Transposition key (16): 0597E4902D33AA14268EE1A8A49671CF 
19:09:07.412 > ✓ Symmetric keys derived successfully
19:09:07.414 > Nonce tracker reset - new session started
19:09:07.911 > Waiting for server to process master key...
19:09:07.914 > ✓ Symmetric keys ready - starting health data transmission
19:09:08.017 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":295398,"type":"health_data_error"}
19:09:08.031 > [WebSocket] Processing message type: health_data_error
19:09:08.036 > [302.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:08.139 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":295894,"type":"health_data_error"}
19:09:08.154 > [WebSocket] Processing message type: health_data_error
19:09:08.159 > [302.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:08.261 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125941511,"threatLevel":0,"type":"heuristics_update"}
19:09:08.286 > [WebSocket] Processing message type: heuristics_update
19:09:08.292 > [302.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:08.395 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":296610,"type":"health_data_error"}
19:09:08.409 > [WebSocket] Processing message type: health_data_error
19:09:08.414 > [302.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:08.516 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125942512,"threatLevel":0,"type":"heuristics_update"}
19:09:08.542 > [WebSocket] Processing message type: heuristics_update
19:09:08.548 > [302.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:08.653 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":296926,"type":"health_data_error"}
19:09:08.666 > [WebSocket] Processing message type: health_data_error
19:09:08.674 > [303.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:08.774 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":297387,"type":"health_data_error"}
19:09:08.789 > [WebSocket] Processing message type: health_data_error
19:09:08.794 > [303.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:08.896 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125943512,"threatLevel":0,"type":"heuristics_update"}
19:09:08.922 > [WebSocket] Processing message type: heuristics_update
19:09:08.927 > [303.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:09.030 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":298145,"type":"health_data_error"}
19:09:09.044 > [WebSocket] Processing message type: health_data_error
19:09:09.049 > [303.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:09.152 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":298414,"type":"health_data_error"}
19:09:09.165 > [WebSocket] Processing message type: health_data_error
19:09:09.171 > [303.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:09.273 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125944513,"threatLevel":0,"type":"heuristics_update"}
19:09:09.299 > [WebSocket] Processing message type: heuristics_update
19:09:09.304 > [303.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:09.406 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":298915,"type":"health_data_error"}
19:09:09.420 > [WebSocket] Processing message type: health_data_error
19:09:09.426 > [303.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:09.529 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125945514,"threatLevel":0,"type":"heuristics_update"}
19:09:09.557 > [WebSocket] Processing message type: heuristics_update
19:09:09.560 > [304.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:09.661 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125946515,"threatLevel":0,"type":"heuristics_update"}
19:09:09.687 > [WebSocket] Processing message type: heuristics_update
19:09:09.693 > [304.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:09.795 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125947068,"type":"master_key_received"}
19:09:09.809 > [WebSocket] Processing message type: master_key_received
19:09:09.811 > [304.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:09.916 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":301653,"type":"master_key_exchanged"}
19:09:09.933 > [WebSocket] Processing message type: master_key_exchanged
19:09:09.939 > [304.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:10.038 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125947515,"threatLevel":0,"type":"heuristics_update"}
19:09:10.063 > [WebSocket] Processing message type: heuristics_update
19:09:10.069 > [304.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:10.171 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":302323,"type":"symmetric_keys_derived"}
19:09:10.188 > [WebSocket] Processing message type: symmetric_keys_derived
19:09:10.194 > [304.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:10.294 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125948516,"threatLevel":0,"type":"heuristics_update"}
19:09:10.319 > [WebSocket] Processing message type: heuristics_update
19:09:10.325 > [304.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:10.427 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125949517,"threatLevel":0,"type":"heuristics_update"}
19:09:10.452 > [WebSocket] Processing message type: heuristics_update
19:09:10.458 > [304.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:10.560 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125950519,"threatLevel":0,"type":"heuristics_update"}
19:09:10.585 > [WebSocket] Processing message type: heuristics_update
19:09:10.591 > [305.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:10.692 > [305.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:10.792 > [305.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:10.894 > [305.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:10.995 > [305.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:11.096 > [305.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:11.197 > [305.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:11.298 > [305.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:11.399 > [305.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:11.500 > [305.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:11.602 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125951519,"threatLevel":0,"type":"heuristics_update"}
19:09:11.627 > [WebSocket] Processing message type: heuristics_update
19:09:11.632 > [306.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:11.734 > [306.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:11.835 > [306.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:11.936 > [306.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:12.036 > [306.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:12.137 > [306.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:12.239 > [306.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:12.340 > [306.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:12.441 > [306.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:12.543 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125952520,"threatLevel":0,"type":"heuristics_update"}
19:09:12.567 > [WebSocket] Processing message type: heuristics_update
19:09:12.573 > [307.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:12.675 > [307.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:12.776 > [307.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:12.877 > [307.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:12.978 > [307.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:13.079 > [307.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:13.180 > [307.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:13.281 > [307.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:13.382 > [307.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:13.483 > [307.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:13.585 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125953521,"threatLevel":0,"type":"heuristics_update"}
19:09:13.610 > [WebSocket] Processing message type: heuristics_update
19:09:13.616 > [308.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:13.717 > [308.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:13.818 > [308.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:13.919 > [308.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:14.020 > [308.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:14.120 > [308.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:14.222 > [308.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:14.323 > [308.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:14.424 > [308.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:14.525 > [308.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:14.629 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125954521,"threatLevel":0,"type":"heuristics_update"}
19:09:14.654 > [WebSocket] Processing message type: heuristics_update
19:09:14.660 > [309.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:14.761 > [309.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:14.862 > [309.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:14.963 > [309.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:15.064 > [309.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:15.165 > [309.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:15.266 > [309.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:15.367 > [309.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:15.468 > [309.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:15.569 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125955522,"threatLevel":0,"type":"heuristics_update"}
19:09:15.595 > [WebSocket] Processing message type: heuristics_update
19:09:15.600 > [310.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:15.702 > [310.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:15.803 > [310.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:15.904 > [310.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:16.005 > [310.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:16.106 > [310.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:16.207 > [310.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:16.308 > [310.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:16.409 > [310.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:16.510 > [310.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:16.612 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125956523,"threatLevel":0,"type":"heuristics_update"}
19:09:16.637 > [WebSocket] Processing message type: heuristics_update
19:09:16.642 > [311.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:16.744 > [311.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:16.845 > [311.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:16.946 > [311.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:17.047 > [311.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:17.147 > [311.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:17.249 > [311.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:17.350 > [311.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:17.450 > [311.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:17.553 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125957523,"threatLevel":0,"type":"heuristics_update"}
19:09:17.577 > [WebSocket] Processing message type: heuristics_update
19:09:17.583 > [312.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:17.685 > [312.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:17.786 > [312.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:17.887 > [312.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:17.988 > [312.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:17.994 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:17.999 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:09:18.005 > Generated health data: HR-68 SPO2-96 STEPS-1589
19:09:18.008 > [ESP32] ========================================
19:09:18.014 > [ESP32] ENCRYPTION PIPELINE START
19:09:18.017 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:18.022 > [ESP32] Active Algorithms for this packet:
19:09:18.024 > [ESP32]   + LFSR
19:09:18.029 > [ESP32]   + Tinkerbell
19:09:18.030 > [ESP32]   + Transposition
19:09:18.030 > [ESP32]   - ChaCha20
19:09:18.033 > [ESP32]   - Salsa20
19:09:18.036 > [ESP32] ========================================
19:09:18.039 > [ESP32] MsgKeys: lfsrSeed=0x74D95BF3 tnk[0..3]=AC75E0B4 trn[0..3]=EA38CA0B
19:09:18.047 > 1_After_Salt (26): 48522D36382053504F322D3936205354 4550532D313538394D50
19:09:18.053 > 2_After_Padding (32): 48522D36382053504F322D3936205354 4550532D313538394D50000000000000 
19:09:18.061 > [ESP32][LFSR] Initializing - Seed: 0x74D95BF3 SeedBe: 0xF35BD974 ChaosKey[0..3]: AC75E0B4 InitialTap: 0x0029 State: 0x74D95BF3
19:09:18.071 > [ESP32][LFSR] Input (first 16 bytes): 48522D36382053504F322D3936205354 Buffer size: 32 bytes
19:09:18.080 > 3_After_LFSR (32): BB09F44254CFF7455EFF9A90B88A8590 B25CD67727783F60758727E4E7061AC7 
19:09:18.085 > [ESP32][LFSR] Keystream (first 16 bytes): F35BD9746CEFA41511CDB7A98EAAD6C4
19:09:18.094 > [ESP32][4D] LFSR keystream (first 32 bytes): F35BD9746CEFA41511CDB7A98EAAD6C4F70C855A164D075938D727E4E7061AC7
19:09:18.102 > [ESP32][TINKERBELL] Input (first 16 bytes): BB09F44254CFF7455EFF9A90B88A8590 Nonce: 0x00000001 Buffer size: 32 bytes
19:09:18.114 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: AC75E0B4
19:09:18.122 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E8F8D48CC97B0B3BE4F852D0904F13F6
19:09:18.130 > 4_After_Tinkerbell (32): 53F120CE9DB4FC7EBA07C84028C59666 CDE2EB411D26C8F837511F0E4286AF82 
19:09:18.138 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E8F8D48CC97B0B3BE4F852D0904F13F6
19:09:18.147 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E8F8D48CC97B0B3BE4F852D0904F13F67FBE3D363A5EF79842D638EAA580B545
19:09:18.158 > 5_After_Transposition (32): 26C8537E9DF196CEC520BA661D07C840 B4EBCDF828E2FC410E821F5142AF3786 
19:09:18.166 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:09:18.170 > [ESP32] === HMAC DEBUG INFO ===
19:09:18.172 > [ESP32] HMAC Key being used: 4025ECD64CDBD717DCFF87650039E59A55A83DB6AEAEA0373CAFD7A3570F758C
19:09:18.180 > [ESP32] HMAC Input length: 45 bytes
19:09:18.183 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000126C8537E9DF196CEC520BA661D07C840B4EBCD
19:09:18.194 > [ESP32] Nonce: 0x00000001
19:09:18.194 > [ESP32] Packet size before HMAC: 61
19:09:18.199 > [ESP32] Computed HMAC Tag: FBFAF268E8214CB793D58CCBD120FB9C
19:09:18.203 > [ESP32] === END HMAC DEBUG ===
19:09:18.205 > 6_Final_Packet (61): 8202180018000408040000000126C853 7E9DF196CEC520BA661D07C840B4EBCD ...
19:09:18.214 > [RETRY] Attempt 1/3 (nonce: 1)
19:09:18.216 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:18.222 > Sending pipeline data to server (609 bytes)
19:09:18.540 > [HTTP] Response code: 400
19:09:18.540 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:18.546 > [HTTP] Request failed with code: 400
19:09:18.548 > [RETRY] Send failed, waiting 100 ms before retry
19:09:18.649 > [RETRY] Attempt 2/3 (nonce: 1)
19:09:18.649 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:18.654 > Sending pipeline data to server (609 bytes)
19:09:18.986 > [HTTP] Response code: 400
19:09:18.986 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:18.992 > [HTTP] Request failed with code: 400
19:09:18.995 > [RETRY] Send failed, waiting 200 ms before retry
19:09:19.195 > [RETRY] Attempt 3/3 (nonce: 1)
19:09:19.195 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:19.200 > Sending pipeline data to server (609 bytes)
19:09:19.523 > [HTTP] Response code: 400
19:09:19.523 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:19.530 > [HTTP] Request failed with code: 400
19:09:19.532 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:09:19.538 > [RETRY] Consecutive failures: 5
19:09:19.540 > [EMERGENCY] Triggering emergency reset!
19:09:19.542 > [CRYPTO] Resetting cryptographic state
19:09:19.548 > [CRYPTO] Crypto state reset complete
19:09:19.551 > [CRYPTO] Packet counter: 5
19:09:19.554 > [EMERGENCY] Emergency reset complete
19:09:19.557 > Health data send failed (retry count: 1/3)
19:09:19.658 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125958524,"threatLevel":0,"type":"heuristics_update"}
19:09:19.683 > [WebSocket] Processing message type: heuristics_update
19:09:19.688 > [314.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:19.694 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:19.699 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:09:19.705 > Generated health data: HR-65 SPO2-96 STEPS-1615
19:09:19.708 > [ESP32] ========================================
19:09:19.714 > [ESP32] ENCRYPTION PIPELINE START
19:09:19.716 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:19.722 > [ESP32] Active Algorithms for this packet:
19:09:19.724 > [ESP32]   + LFSR
19:09:19.727 > [ESP32]   + Tinkerbell
19:09:19.731 > [ESP32]   + Transposition
19:09:19.731 > [ESP32]   - ChaCha20
19:09:19.733 > [ESP32]   - Salsa20
19:09:19.736 > [ESP32] ========================================
19:09:19.739 > [ESP32] MsgKeys: lfsrSeed=0x74D95BF3 tnk[0..3]=AC75E0B4 trn[0..3]=EA38CA0B
19:09:19.747 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313631354D50
19:09:19.753 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313631354D50000000000000 
19:09:19.761 > [ESP32][LFSR] Initializing - Seed: 0x74D95BF3 SeedBe: 0xF35BD974 ChaosKey[0..3]: AC75E0B4 InitialTap: 0x0029 State: 0x74D95BF3
19:09:19.772 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
19:09:19.780 > 3_After_LFSR (32): BB09F44259CFF7455EFF9A90B88A8590 B25CD677277B366C758727E4E7061AC7 
19:09:19.786 > [ESP32][LFSR] Keystream (first 16 bytes): F35BD9746CEFA41511CDB7A98EAAD6C4
19:09:19.794 > [ESP32][4D] LFSR keystream (first 32 bytes): F35BD9746CEFA41511CDB7A98EAAD6C4F70C855A164D075938D727E4E7061AC7
19:09:19.803 > [ESP32][TINKERBELL] Input (first 16 bytes): BB09F44259CFF7455EFF9A90B88A8590 Nonce: 0x00000001 Buffer size: 32 bytes
19:09:19.814 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: AC75E0B4
19:09:19.822 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E8F8D48CC97B0B3BE4F852D0904F13F6
19:09:19.830 > 4_After_Tinkerbell (32): 53F120CE90B4FC7EBA07C84028C59666 CDE2EB411D25C1F437511F0E4286AF82 
19:09:19.839 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E8F8D48CC97B0B3BE4F852D0904F13F6
19:09:19.847 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E8F8D48CC97B0B3BE4F852D0904F13F67FBE3D363A5EF79842D638EAA580B545
19:09:19.858 > 5_After_Transposition (32): 25C8537E90F196CEC520BA661D07C140 B4EBCDF428E2FC410E821F5142AF3786 
19:09:19.867 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:09:19.869 > [ESP32] === HMAC DEBUG INFO ===
19:09:19.872 > [ESP32] HMAC Key being used: 4025ECD64CDBD717DCFF87650039E59A55A83DB6AEAEA0373CAFD7A3570F758C
19:09:19.881 > [ESP32] HMAC Input length: 45 bytes
19:09:19.883 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000125C8537E90F196CEC520BA661D07C140B4EBCD
19:09:19.894 > [ESP32] Nonce: 0x00000001
19:09:19.894 > [ESP32] Packet size before HMAC: 61
19:09:19.899 > [ESP32] Computed HMAC Tag: 67C4F774FFCC3D0D7C7373FC6A5C7224
19:09:19.903 > [ESP32] === END HMAC DEBUG ===
19:09:19.905 > 6_Final_Packet (61): 8202180018000408040000000125C853 7E90F196CEC520BA661D07C140B4EBCD ...
19:09:19.914 > [RETRY] Attempt 1/3 (nonce: 1)
19:09:19.916 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:19.922 > Sending pipeline data to server (609 bytes)
19:09:20.291 > [HTTP] Response code: 400
19:09:20.292 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:20.297 > [HTTP] Request failed with code: 400
19:09:20.299 > [RETRY] Send failed, waiting 100 ms before retry
19:09:20.400 > [RETRY] Attempt 2/3 (nonce: 1)
19:09:20.400 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:20.405 > Sending pipeline data to server (609 bytes)
19:09:20.527 > [HTTP] Response code: 400
19:09:20.527 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:20.533 > [HTTP] Request failed with code: 400
19:09:20.536 > [RETRY] Send failed, waiting 200 ms before retry
19:09:20.735 > [RETRY] Attempt 3/3 (nonce: 1)
19:09:20.735 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:20.741 > Sending pipeline data to server (609 bytes)
19:09:21.060 > [HTTP] Response code: 400
19:09:21.060 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:21.066 > [HTTP] Request failed with code: 400
19:09:21.069 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:09:21.074 > [RETRY] Consecutive failures: 1
19:09:21.077 > Health data send failed (retry count: 2/3)
19:09:21.180 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":312953,"type":"health_data_error"}
19:09:21.194 > [WebSocket] Processing message type: health_data_error
19:09:21.199 > [315.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:21.208 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:21.213 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:09:21.219 > Generated health data: HR-65 SPO2-96 STEPS-1597
19:09:21.222 > [ESP32] ========================================
19:09:21.228 > [ESP32] ENCRYPTION PIPELINE START
19:09:21.230 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:21.236 > [ESP32] Active Algorithms for this packet:
19:09:21.238 > [ESP32]   + LFSR
19:09:21.238 > [ESP32]   + Tinkerbell
19:09:21.241 > [ESP32]   + Transposition
19:09:21.244 > [ESP32]   - ChaCha20
19:09:21.247 > [ESP32]   - Salsa20
19:09:21.247 > [ESP32] ========================================
19:09:21.253 > [ESP32] MsgKeys: lfsrSeed=0x74D95BF3 tnk[0..3]=AC75E0B4 trn[0..3]=EA38CA0B
19:09:21.258 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313539374D50
19:09:21.264 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313539374D50000000000000 
19:09:21.272 > [ESP32][LFSR] Initializing - Seed: 0x74D95BF3 SeedBe: 0xF35BD974 ChaosKey[0..3]: AC75E0B4 InitialTap: 0x0029 State: 0x74D95BF3
19:09:21.283 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
19:09:21.291 > 3_After_LFSR (32): BB09F44259CFF7455EFF9A90B88A8590 B25CD67727783E6E758727E4E7061AC7 
19:09:21.300 > [ESP32][LFSR] Keystream (first 16 bytes): F35BD9746CEFA41511CDB7A98EAAD6C4
19:09:21.305 > [ESP32][4D] LFSR keystream (first 32 bytes): F35BD9746CEFA41511CDB7A98EAAD6C4F70C855A164D075938D727E4E7061AC7
19:09:21.316 > [ESP32][TINKERBELL] Input (first 16 bytes): BB09F44259CFF7455EFF9A90B88A8590 Nonce: 0x00000001 Buffer size: 32 bytes
19:09:21.325 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: AC75E0B4
19:09:21.336 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E8F8D48CC97B0B3BE4F852D0904F13F6
19:09:21.345 > 4_After_Tinkerbell (32): 53F120CE90B4FC7EBA07C84028C59666 CDE2EB411D26C9F637511F0E4286AF82 
19:09:21.353 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E8F8D48CC97B0B3BE4F852D0904F13F6
19:09:21.361 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E8F8D48CC97B0B3BE4F852D0904F13F67FBE3D363A5EF79842D638EAA580B545
19:09:21.369 > 5_After_Transposition (32): 26C8537E90F196CEC520BA661D07C940 B4EBCDF628E2FC410E821F5142AF3786 
19:09:21.377 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:09:21.383 > [ESP32] === HMAC DEBUG INFO ===
19:09:21.386 > [ESP32] HMAC Key being used: 4025ECD64CDBD717DCFF87650039E59A55A83DB6AEAEA0373CAFD7A3570F758C
19:09:21.394 > [ESP32] HMAC Input length: 45 bytes
19:09:21.397 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000126C8537E90F196CEC520BA661D07C940B4EBCD
19:09:21.405 > [ESP32] Nonce: 0x00000001
19:09:21.407 > [ESP32] Packet size before HMAC: 61
19:09:21.411 > [ESP32] Computed HMAC Tag: 75DDD827F94FC32FD74A7624E5D55C6D
19:09:21.416 > [ESP32] === END HMAC DEBUG ===
19:09:21.419 > 6_Final_Packet (61): 8202180018000408040000000126C853 7E90F196CEC520BA661D07C940B4EBCD ...
19:09:21.428 > [RETRY] Attempt 1/3 (nonce: 1)
19:09:21.430 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:21.436 > Sending pipeline data to server (609 bytes)
19:09:21.779 > [HTTP] Response code: 400
19:09:21.780 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:21.785 > [HTTP] Request failed with code: 400
19:09:21.788 > [RETRY] Send failed, waiting 100 ms before retry
19:09:21.888 > [RETRY] Attempt 2/3 (nonce: 1)
19:09:21.888 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:21.894 > Sending pipeline data to server (609 bytes)
19:09:22.047 > [HTTP] Response code: 400
19:09:22.047 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:22.053 > [HTTP] Request failed with code: 400
19:09:22.056 > [RETRY] Send failed, waiting 200 ms before retry
19:09:22.256 > [RETRY] Attempt 3/3 (nonce: 1)
19:09:22.256 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:22.261 > Sending pipeline data to server (609 bytes)
19:09:22.586 > [HTTP] Response code: 400
19:09:22.586 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:22.592 > [HTTP] Request failed with code: 400
19:09:22.595 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:09:22.601 > [RETRY] Consecutive failures: 2
19:09:22.604 > Health data send failed (retry count: 3/3)
19:09:22.606 > Health data transmission failed after max retries
19:09:22.705 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":313400,"type":"health_data_error"}
19:09:22.719 > [WebSocket] Processing message type: health_data_error
19:09:22.724 > [317.1] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:22.733 > ERROR state - attempting recovery
19:09:22.736 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:22.742 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:09:22.745 > Generated health data: HR-65 SPO2-96 STEPS-1596
19:09:22.749 > [ESP32] ========================================
19:09:22.753 > [ESP32] ENCRYPTION PIPELINE START
19:09:22.755 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:22.761 > [ESP32] Active Algorithms for this packet:
19:09:22.766 > [ESP32]   + LFSR
19:09:22.766 > [ESP32]   + Tinkerbell
19:09:22.769 > [ESP32]   + Transposition
19:09:22.772 > [ESP32]   - ChaCha20
19:09:22.772 > [ESP32]   - Salsa20
19:09:22.774 > [ESP32] ========================================
19:09:22.780 > [ESP32] MsgKeys: lfsrSeed=0x74D95BF3 tnk[0..3]=AC75E0B4 trn[0..3]=EA38CA0B
19:09:22.786 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313539364D50
19:09:22.792 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313539364D50000000000000 
19:09:22.802 > [ESP32][LFSR] Initializing - Seed: 0x74D95BF3 SeedBe: 0xF35BD974 ChaosKey[0..3]: AC75E0B4 InitialTap: 0x0029 State: 0x74D95BF3
19:09:22.811 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
19:09:22.841 > 3_After_LFSR (32): BB09F44259CFF7455EFF9A90B88A8590 B25CD67727783E6F758727E4E7061AC7 
19:09:22.841 > [ESP32][LFSR] Keystream (first 16 bytes): F35BD9746CEFA41511CDB7A98EAAD6C4
19:09:22.841 > [ESP32][4D] LFSR keystream (first 32 bytes): F35BD9746CEFA41511CDB7A98EAAD6C4F70C855A164D075938D727E4E7061AC7
19:09:22.853 > [ESP32][TINKERBELL] Input (first 16 bytes): BB09F44259CFF7455EFF9A90B88A8590 Nonce: 0x00000001 Buffer size: 32 bytes
19:09:22.853 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: AC75E0B4
19:09:22.867 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E8F8D48CC97B0B3BE4F852D0904F13F6
19:09:22.872 > 4_After_Tinkerbell (32): 53F120CE90B4FC7EBA07C84028C59666 CDE2EB411D26C9F737511F0E4286AF82 
19:09:22.880 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E8F8D48CC97B0B3BE4F852D0904F13F6
19:09:22.892 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E8F8D48CC97B0B3BE4F852D0904F13F67FBE3D363A5EF79842D638EAA580B545
19:09:22.897 > 5_After_Transposition (32): 26C8537E90F196CEC520BA661D07C940 B4EBCDF728E2FC410E821F5142AF3786 
19:09:22.905 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:09:22.911 > [ESP32] === HMAC DEBUG INFO ===
19:09:22.913 > [ESP32] HMAC Key being used: 4025ECD64CDBD717DCFF87650039E59A55A83DB6AEAEA0373CAFD7A3570F758C
19:09:22.922 > [ESP32] HMAC Input length: 45 bytes
19:09:22.925 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000126C8537E90F196CEC520BA661D07C940B4EBCD
19:09:22.933 > [ESP32] Nonce: 0x00000001
19:09:22.936 > [ESP32] Packet size before HMAC: 61
19:09:22.939 > [ESP32] Computed HMAC Tag: BCD54BAF1C5A74B26372D8A9DEB11AAD
19:09:22.945 > [ESP32] === END HMAC DEBUG ===
19:09:22.947 > 6_Final_Packet (61): 8202180018000408040000000126C853 7E90F196CEC520BA661D07C940B4EBCD ...
19:09:22.955 > [RETRY] Attempt 1/3 (nonce: 1)
19:09:22.958 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:22.964 > Sending pipeline data to server (609 bytes)
19:09:23.292 > [HTTP] Response code: 400
19:09:23.292 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:23.298 > [HTTP] Request failed with code: 400
19:09:23.300 > [RETRY] Send failed, waiting 100 ms before retry
19:09:23.402 > [RETRY] Attempt 2/3 (nonce: 1)
19:09:23.402 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:23.407 > Sending pipeline data to server (609 bytes)
19:09:23.553 > [HTTP] Response code: 400
19:09:23.554 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:23.558 > [HTTP] Request failed with code: 400
19:09:23.561 > [RETRY] Send failed, waiting 200 ms before retry
19:09:23.761 > [RETRY] Attempt 3/3 (nonce: 1)
19:09:23.761 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:23.766 > Sending pipeline data to server (609 bytes)
19:09:24.072 > [HTTP] Response code: 400
19:09:24.072 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:24.078 > [HTTP] Request failed with code: 400
19:09:24.080 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:09:24.086 > [RETRY] Consecutive failures: 3
19:09:24.089 > ✗ Auto-recovery failed - restarting key exchange
19:09:26.191 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125959525,"threatLevel":0,"type":"heuristics_update"}
19:09:26.215 > [WebSocket] Processing message type: heuristics_update
19:09:26.222 > [320.6] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:26.231 > ✓ Public key loaded from NVS
19:09:26.329 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":313936,"type":"health_data_error"}
19:09:26.342 > [WebSocket] Processing message type: health_data_error
19:09:26.348 > [320.8] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:26.452 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":314704,"type":"health_data_error"}
19:09:26.466 > [WebSocket] Processing message type: health_data_error
19:09:26.472 > [320.9] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:26.480 > Generating fresh master key from entropy...
19:09:26.489 > Generated master key (32): 0A89B233CC5D57CF3BBB5DB675A4E7D7 B9C34D03217BE2849BEA8808020F7090 
19:09:26.494 > Using reduced master key (byte % 3) for NTRU encryption only
19:09:26.504 > NTRU encrypted master key (502): 00220070001F0015007D001B00060062 004600780039000E0000007600680070 ...
19:09:26.513 > POST http://10.249.92.115:8081/master-key
19:09:26.832 > ✓ Master key exchange completed
19:09:26.934 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125960525,"threatLevel":0,"type":"heuristics_update"}
19:09:26.959 > [WebSocket] Processing message type: heuristics_update
19:09:26.964 > [321.4] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:26.970 > Loading master key from NVS and deriving symmetric keys...
19:09:26.975 > Loaded master key from NVS (32): 0A89B233CC5D57CF3BBB5DB675A4E7D7 B9C34D03217BE2849BEA8808020F7090 
19:09:26.986 > Derived HMAC key (32): 9899EC467BA0F0A63B7FA364C67D2B6A 7133D330DA73E9519C17876E43713EBE 
19:09:26.992 > Derived Tinkerbell key (16): 459BDF35BC04A9D146B78CEC218F4EDF 
19:09:26.997 > Derived Transposition key (16): 00706CE36143F8B97CF02FC914D88A0C 
19:09:27.006 > ✓ Symmetric keys derived successfully
19:09:27.009 > Nonce tracker reset - new session started
19:09:27.503 > Waiting for server to process master key...
19:09:27.507 > ✓ Symmetric keys ready - starting health data transmission
19:09:27.609 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":314941,"type":"health_data_error"}
19:09:27.623 > [WebSocket] Processing message type: health_data_error
19:09:27.629 > [322.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:27.732 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":315473,"type":"health_data_error"}
19:09:27.746 > [WebSocket] Processing message type: health_data_error
19:09:27.752 > [322.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:27.854 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125961526,"threatLevel":0,"type":"heuristics_update"}
19:09:27.879 > [WebSocket] Processing message type: heuristics_update
19:09:27.885 > [322.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:27.986 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":316193,"type":"health_data_error"}
19:09:28.001 > [WebSocket] Processing message type: health_data_error
19:09:28.006 > [322.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:28.111 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":316460,"type":"health_data_error"}
19:09:28.125 > [WebSocket] Processing message type: health_data_error
19:09:28.131 > [322.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:28.233 > [322.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:28.335 > [322.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:28.435 > [322.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:28.537 > [322.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:28.637 > [323.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:28.739 > [323.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:28.839 > [323.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:28.940 > [323.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:29.041 > [323.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:29.142 > [323.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:29.244 > [323.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:29.344 > [323.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:29.445 > [323.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:29.546 > [324.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:29.649 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125962526,"threatLevel":0,"type":"heuristics_update"}
19:09:29.673 > [WebSocket] Processing message type: heuristics_update
19:09:29.679 > [324.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:29.781 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":317000,"type":"health_data_error"}
19:09:29.795 > [WebSocket] Processing message type: health_data_error
19:09:29.800 > [324.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:29.904 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":317705,"type":"health_data_error"}
19:09:29.918 > [WebSocket] Processing message type: health_data_error
19:09:29.923 > [324.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:30.026 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125963527,"threatLevel":0,"type":"heuristics_update"}
19:09:30.051 > [WebSocket] Processing message type: heuristics_update
19:09:30.056 > [324.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:30.159 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":317966,"type":"health_data_error"}
19:09:30.172 > [WebSocket] Processing message type: health_data_error
19:09:30.179 > [324.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:30.281 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":318485,"type":"health_data_error"}
19:09:30.295 > [WebSocket] Processing message type: health_data_error
19:09:30.300 > [324.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:30.403 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125964528,"threatLevel":0,"type":"heuristics_update"}
19:09:30.427 > [WebSocket] Processing message type: heuristics_update
19:09:30.434 > [324.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:30.536 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125965529,"threatLevel":0,"type":"heuristics_update"}
19:09:30.561 > [WebSocket] Processing message type: heuristics_update
19:09:30.567 > [325.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:30.669 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125966529,"threatLevel":0,"type":"heuristics_update"}
19:09:30.694 > [WebSocket] Processing message type: heuristics_update
19:09:30.699 > [325.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:30.802 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125966670,"type":"master_key_received"}
19:09:30.815 > [WebSocket] Processing message type: master_key_received
19:09:30.819 > [325.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:30.924 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":321237,"type":"master_key_exchanged"}
19:09:30.940 > [WebSocket] Processing message type: master_key_exchanged
19:09:30.946 > [325.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:31.046 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125967530,"threatLevel":0,"type":"heuristics_update"}
19:09:31.071 > [WebSocket] Processing message type: heuristics_update
19:09:31.077 > [325.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:31.179 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":321916,"type":"symmetric_keys_derived"}
19:09:31.196 > [WebSocket] Processing message type: symmetric_keys_derived
19:09:31.201 > [325.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:31.301 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125968530,"threatLevel":0,"type":"heuristics_update"}
19:09:31.326 > [WebSocket] Processing message type: heuristics_update
19:09:31.332 > [325.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:31.434 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125969531,"threatLevel":0,"type":"heuristics_update"}
19:09:31.459 > [WebSocket] Processing message type: heuristics_update
19:09:31.465 > [325.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:31.566 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125970531,"threatLevel":0,"type":"heuristics_update"}
19:09:31.592 > [WebSocket] Processing message type: heuristics_update
19:09:31.598 > [326.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:31.700 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125971532,"threatLevel":0,"type":"heuristics_update"}
19:09:31.725 > [WebSocket] Processing message type: heuristics_update
19:09:31.731 > [326.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:31.832 > [326.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:31.934 > [326.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:32.035 > [326.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:32.135 > [326.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:32.236 > [326.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:32.338 > [326.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:32.438 > [326.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:32.540 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125972533,"threatLevel":0,"type":"heuristics_update"}
19:09:32.566 > [WebSocket] Processing message type: heuristics_update
19:09:32.571 > [327.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:32.673 > [327.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:32.773 > [327.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:32.875 > [327.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:32.975 > [327.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:33.076 > [327.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:33.178 > [327.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:33.279 > [327.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:33.379 > [327.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:33.481 > [327.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:33.585 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125973534,"threatLevel":0,"type":"heuristics_update"}
19:09:33.609 > [WebSocket] Processing message type: heuristics_update
19:09:33.615 > [328.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:33.716 > [328.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:33.817 > [328.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:33.919 > [328.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:34.020 > [328.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:34.120 > [328.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:34.221 > [328.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:34.323 > [328.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:34.423 > [328.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:34.524 > [328.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:34.626 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125974535,"threatLevel":0,"type":"heuristics_update"}
19:09:34.651 > [WebSocket] Processing message type: heuristics_update
19:09:34.657 > [329.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:34.759 > [329.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:34.860 > [329.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:34.960 > [329.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:35.061 > [329.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:35.162 > [329.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:35.263 > [329.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:35.364 > [329.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:35.465 > [329.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:35.567 > [330.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:35.668 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125975536,"threatLevel":0,"type":"heuristics_update"}
19:09:35.692 > [WebSocket] Processing message type: heuristics_update
19:09:35.699 > [330.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:35.801 > [330.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:35.902 > [330.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:36.002 > [330.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:36.103 > [330.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:36.204 > [330.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:36.305 > [330.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:36.406 > [330.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:36.507 > [330.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:36.609 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125976538,"threatLevel":0,"type":"heuristics_update"}
19:09:36.634 > [WebSocket] Processing message type: heuristics_update
19:09:36.639 > [331.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:36.741 > [331.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:36.842 > [331.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:36.944 > [331.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:37.045 > [331.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:37.146 > [331.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:37.246 > [331.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:37.347 > [331.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:37.449 > [331.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:37.549 > [332.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:37.555 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:37.560 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:09:37.566 > Generated health data: HR-65 SPO2-96 STEPS-1674
19:09:37.569 > [ESP32] ========================================
19:09:37.575 > [ESP32] ENCRYPTION PIPELINE START
19:09:37.577 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:37.583 > [ESP32] Active Algorithms for this packet:
19:09:37.586 > [ESP32]   + LFSR
19:09:37.588 > [ESP32]   + Tinkerbell
19:09:37.591 > [ESP32]   + Transposition
19:09:37.591 > [ESP32]   - ChaCha20
19:09:37.594 > [ESP32]   - Salsa20
19:09:37.597 > [ESP32] ========================================
19:09:37.599 > [ESP32] MsgKeys: lfsrSeed=0x7F99CC8B tnk[0..3]=1469687B trn[0..3]=CA5D379E
19:09:37.608 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313637344D50
19:09:37.614 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313637344D50000000000000 
19:09:37.622 > [ESP32][LFSR] Initializing - Seed: 0x7F99CC8B SeedBe: 0x8BCC997F ChaosKey[0..3]: 1469687B InitialTap: 0x0029 State: 0x7F99CC8B
19:09:37.633 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
19:09:37.642 > 3_After_LFSR (32): C39EB449DE5B260F967FBBC34D0F877D 0A9D59BFA1F9F97FE3777E4A80BE3C3C 
19:09:37.647 > [ESP32][LFSR] Keystream (first 16 bytes): 8BCC997FEB7B755FD94D96FA7B2FD429
19:09:37.655 > [ESP32][4D] LFSR keystream (first 32 bytes): 8BCC997FEB7B755FD94D96FA7B2FD4294FCD0A9290CFCE4BAE277E4A80BE3C3C
19:09:37.663 > [ESP32][TINKERBELL] Input (first 16 bytes): C39EB449DE5B260F967FBBC34D0F877D Nonce: 0x00000001 Buffer size: 32 bytes
19:09:37.675 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 1469687B
19:09:37.684 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FA09BF1A61377AAAA7D2E10781294134
19:09:37.691 > 4_After_Tinkerbell (32): 39970B53BF6C5CA531AD5AC4CC26C649 31FE2A255999FF7CB37A2098F5D3719F 
19:09:37.699 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FA09BF1A61377AAAA7D2E10781294134
19:09:37.708 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FA09BF1A61377AAAA7D2E107812941343B63739AF8600603500D5ED2756D4DA3
19:09:37.719 > 5_After_Transposition (32): BF6C5CA5C45A9739CC26C649252AAD31 5999FF7C530BFE3198209F71F5D37AB3 
19:09:37.727 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:09:37.731 > [ESP32] === HMAC DEBUG INFO ===
19:09:37.733 > [ESP32] HMAC Key being used: 9899EC467BA0F0A63B7FA364C67D2B6A7133D330DA73E9519C17876E43713EBE
19:09:37.741 > [ESP32] HMAC Input length: 45 bytes
19:09:37.745 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001BF6C5CA5C45A9739CC26C649252AAD315999FF
19:09:37.755 > [ESP32] Nonce: 0x00000001
19:09:37.755 > [ESP32] Packet size before HMAC: 61
19:09:37.761 > [ESP32] Computed HMAC Tag: 222BBF4F7A6B6EBBAA5508205432134F
19:09:37.766 > [ESP32] === END HMAC DEBUG ===
19:09:37.766 > 6_Final_Packet (61): 82021800180004080400000001BF6C5C A5C45A9739CC26C649252AAD315999FF ...
19:09:37.786 > [RETRY] Attempt 1/3 (nonce: 1)
19:09:37.786 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:37.786 > Sending pipeline data to server (609 bytes)
19:09:38.111 > [HTTP] Response code: 400
19:09:38.111 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:38.116 > [HTTP] Request failed with code: 400
19:09:38.119 > [RETRY] Send failed, waiting 100 ms before retry
19:09:38.218 > [RETRY] Attempt 2/3 (nonce: 1)
19:09:38.218 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:38.224 > Sending pipeline data to server (609 bytes)
19:09:38.571 > [HTTP] Response code: 400
19:09:38.571 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:38.577 > [HTTP] Request failed with code: 400
19:09:38.580 > [RETRY] Send failed, waiting 200 ms before retry
19:09:38.778 > [RETRY] Attempt 3/3 (nonce: 1)
19:09:38.778 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:38.784 > Sending pipeline data to server (609 bytes)
19:09:39.109 > [HTTP] Response code: 400
19:09:39.109 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:39.115 > [HTTP] Request failed with code: 400
19:09:39.117 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:09:39.123 > [RETRY] Consecutive failures: 4
19:09:39.126 > Health data send failed (retry count: 1/3)
19:09:39.231 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125977538,"threatLevel":0,"type":"heuristics_update"}
19:09:39.256 > [WebSocket] Processing message type: heuristics_update
19:09:39.262 > [333.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:39.268 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:39.273 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:09:39.279 > Generated health data: HR-65 SPO2-96 STEPS-1695
19:09:39.282 > [ESP32] ========================================
19:09:39.288 > [ESP32] ENCRYPTION PIPELINE START
19:09:39.290 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:39.295 > [ESP32] Active Algorithms for this packet:
19:09:39.298 > [ESP32]   + LFSR
19:09:39.301 > [ESP32]   + Tinkerbell
19:09:39.304 > [ESP32]   + Transposition
19:09:39.304 > [ESP32]   - ChaCha20
19:09:39.307 > [ESP32]   - Salsa20
19:09:39.310 > [ESP32] ========================================
19:09:39.313 > [ESP32] MsgKeys: lfsrSeed=0x7F99CC8B tnk[0..3]=1469687B trn[0..3]=CA5D379E
19:09:39.321 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313639354D50
19:09:39.326 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313639354D50000000000000 
19:09:39.335 > [ESP32][LFSR] Initializing - Seed: 0x7F99CC8B SeedBe: 0x8BCC997F ChaosKey[0..3]: 1469687B InitialTap: 0x0029 State: 0x7F99CC8B
19:09:39.346 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
19:09:39.354 > 3_After_LFSR (32): C39EB449DE5B260F967FBBC34D0F877D 0A9D59BFA1F9F77EE3777E4A80BE3C3C 
19:09:39.359 > [ESP32][LFSR] Keystream (first 16 bytes): 8BCC997FEB7B755FD94D96FA7B2FD429
19:09:39.368 > [ESP32][4D] LFSR keystream (first 32 bytes): 8BCC997FEB7B755FD94D96FA7B2FD4294FCD0A9290CFCE4BAE277E4A80BE3C3C
19:09:39.408 > [ESP32][TINKERBELL] Input (first 16 bytes): C39EB449DE5B260F967FBBC34D0F877D Nonce: 0x00000001 Buffer size: 32 bytes
19:09:39.408 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 1469687B
19:09:39.408 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FA09BF1A61377AAAA7D2E10781294134
19:09:39.408 > 4_After_Tinkerbell (32): 39970B53BF6C5CA531AD5AC4CC26C649 31FE2A255999F17DB37A2098F5D3719F 
19:09:39.421 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FA09BF1A61377AAAA7D2E10781294134
19:09:39.421 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FA09BF1A61377AAAA7D2E107812941343B63739AF8600603500D5ED2756D4DA3
19:09:39.445 > 5_After_Transposition (32): BF6C5CA5C45A9739CC26C649252AAD31 5999F17D530BFE3198209F71F5D37AB3 
19:09:39.445 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:09:39.445 > [ESP32] === HMAC DEBUG INFO ===
19:09:39.489 > [ESP32] HMAC Key being used: 9899EC467BA0F0A63B7FA364C67D2B6A7133D330DA73E9519C17876E43713EBE
19:09:39.489 > [ESP32] HMAC Input length: 45 bytes
19:09:39.489 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001BF6C5CA5C45A9739CC26C649252AAD315999F1
19:09:39.489 > [ESP32] Nonce: 0x00000001
19:09:39.489 > [ESP32] Packet size before HMAC: 61
19:09:39.489 > [ESP32] Computed HMAC Tag: F7564A5D0A5AE4DD49853DF9858D99FF
19:09:39.489 > [ESP32] === END HMAC DEBUG ===
19:09:39.489 > 6_Final_Packet (61): 82021800180004080400000001BF6C5C A5C45A9739CC26C649252AAD315999F1 ...
19:09:39.489 > [RETRY] Attempt 1/3 (nonce: 1)
19:09:39.513 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:39.513 > Sending pipeline data to server (609 bytes)
19:09:39.834 > [HTTP] Response code: 400
19:09:39.834 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:39.839 > [HTTP] Request failed with code: 400
19:09:39.843 > [RETRY] Send failed, waiting 100 ms before retry
19:09:39.941 > [RETRY] Attempt 2/3 (nonce: 1)
19:09:39.941 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:39.947 > Sending pipeline data to server (609 bytes)
19:09:40.285 > [HTTP] Response code: 400
19:09:40.285 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:40.291 > [HTTP] Request failed with code: 400
19:09:40.294 > [RETRY] Send failed, waiting 200 ms before retry
19:09:40.493 > [RETRY] Attempt 3/3 (nonce: 1)
19:09:40.493 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:40.499 > Sending pipeline data to server (609 bytes)
19:09:40.856 > [HTTP] Response code: 400
19:09:40.856 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:40.862 > [HTTP] Request failed with code: 400
19:09:40.865 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:09:40.871 > [RETRY] Consecutive failures: 5
19:09:40.873 > [EMERGENCY] Triggering emergency reset!
19:09:40.876 > [CRYPTO] Resetting cryptographic state
19:09:40.882 > [CRYPTO] Crypto state reset complete
19:09:40.885 > [CRYPTO] Packet counter: 6
19:09:40.887 > [EMERGENCY] Emergency reset complete
19:09:40.890 > Health data send failed (retry count: 2/3)
19:09:40.986 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":332524,"type":"health_data_error"}
19:09:41.000 > [WebSocket] Processing message type: health_data_error
19:09:41.006 > [335.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:41.014 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:41.020 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:09:41.025 > Generated health data: HR-65 SPO2-96 STEPS-1719
19:09:41.029 > [ESP32] ========================================
19:09:41.034 > [ESP32] ENCRYPTION PIPELINE START
19:09:41.036 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:41.042 > [ESP32] Active Algorithms for this packet:
19:09:41.045 > [ESP32]   + LFSR
19:09:41.045 > [ESP32]   + Tinkerbell
19:09:41.047 > [ESP32]   + Transposition
19:09:41.050 > [ESP32]   - ChaCha20
19:09:41.054 > [ESP32]   - Salsa20
19:09:41.054 > [ESP32] ========================================
19:09:41.059 > [ESP32] MsgKeys: lfsrSeed=0x7F99CC8B tnk[0..3]=1469687B trn[0..3]=CA5D379E
19:09:41.064 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313731394D50
19:09:41.070 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313731394D50000000000000 
19:09:41.079 > [ESP32][LFSR] Initializing - Seed: 0x7F99CC8B SeedBe: 0x8BCC997F ChaosKey[0..3]: 1469687B InitialTap: 0x0029 State: 0x7F99CC8B
19:09:41.090 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
19:09:41.098 > 3_After_LFSR (32): C39EB449DE5B260F967FBBC34D0F877D 0A9D59BFA1F8FF72E3777E4A80BE3C3C 
19:09:41.106 > [ESP32][LFSR] Keystream (first 16 bytes): 8BCC997FEB7B755FD94D96FA7B2FD429
19:09:41.112 > [ESP32][4D] LFSR keystream (first 32 bytes): 8BCC997FEB7B755FD94D96FA7B2FD4294FCD0A9290CFCE4BAE277E4A80BE3C3C
19:09:41.122 > [ESP32][TINKERBELL] Input (first 16 bytes): C39EB449DE5B260F967FBBC34D0F877D Nonce: 0x00000001 Buffer size: 32 bytes
19:09:41.131 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 1469687B
19:09:41.143 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FA09BF1A61377AAAA7D2E10781294134
19:09:41.151 > 4_After_Tinkerbell (32): 39970B53BF6C5CA531AD5AC4CC26C649 31FE2A255998F971B37A2098F5D3719F 
19:09:41.159 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FA09BF1A61377AAAA7D2E10781294134
19:09:41.167 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FA09BF1A61377AAAA7D2E107812941343B63739AF8600603500D5ED2756D4DA3
19:09:41.175 > 5_After_Transposition (32): BF6C5CA5C45A9739CC26C649252AAD31 5998F971530BFE3198209F71F5D37AB3 
19:09:41.184 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:09:41.189 > [ESP32] === HMAC DEBUG INFO ===
19:09:41.192 > [ESP32] HMAC Key being used: 9899EC467BA0F0A63B7FA364C67D2B6A7133D330DA73E9519C17876E43713EBE
19:09:41.200 > [ESP32] HMAC Input length: 45 bytes
19:09:41.204 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001BF6C5CA5C45A9739CC26C649252AAD315998F9
19:09:41.211 > [ESP32] Nonce: 0x00000001
19:09:41.214 > [ESP32] Packet size before HMAC: 61
19:09:41.217 > [ESP32] Computed HMAC Tag: 5C16D15ED946CDE0348FD52665742718
19:09:41.223 > [ESP32] === END HMAC DEBUG ===
19:09:41.226 > 6_Final_Packet (61): 82021800180004080400000001BF6C5C A5C45A9739CC26C649252AAD315998F9 ...
19:09:41.234 > [RETRY] Attempt 1/3 (nonce: 1)
19:09:41.236 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:41.242 > Sending pipeline data to server (609 bytes)
19:09:41.583 > [HTTP] Response code: 400
19:09:41.583 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:41.589 > [HTTP] Request failed with code: 400
19:09:41.591 > [RETRY] Send failed, waiting 100 ms before retry
19:09:41.691 > [RETRY] Attempt 2/3 (nonce: 1)
19:09:41.691 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:41.697 > Sending pipeline data to server (609 bytes)
19:09:41.847 > [HTTP] Response code: 400
19:09:41.848 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:41.854 > [HTTP] Request failed with code: 400
19:09:41.856 > [RETRY] Send failed, waiting 200 ms before retry
19:09:42.056 > [RETRY] Attempt 3/3 (nonce: 1)
19:09:42.056 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:42.061 > Sending pipeline data to server (609 bytes)
19:09:42.391 > [HTTP] Response code: 400
19:09:42.391 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:42.396 > [HTTP] Request failed with code: 400
19:09:42.399 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:09:42.405 > [RETRY] Consecutive failures: 1
19:09:42.408 > Health data send failed (retry count: 3/3)
19:09:42.410 > Health data transmission failed after max retries
19:09:42.510 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125978539,"threatLevel":0,"type":"heuristics_update"}
19:09:42.536 > [WebSocket] Processing message type: heuristics_update
19:09:42.542 > [336.9] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:42.547 > ERROR state - attempting recovery
19:09:42.550 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:42.555 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:09:42.561 > Generated health data: HR-65 SPO2-96 STEPS-1708
19:09:42.564 > [ESP32] ========================================
19:09:42.569 > [ESP32] ENCRYPTION PIPELINE START
19:09:42.572 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:42.577 > [ESP32] Active Algorithms for this packet:
19:09:42.580 > [ESP32]   + LFSR
19:09:42.583 > [ESP32]   + Tinkerbell
19:09:42.583 > [ESP32]   + Transposition
19:09:42.586 > [ESP32]   - ChaCha20
19:09:42.589 > [ESP32]   - Salsa20
19:09:42.589 > [ESP32] ========================================
19:09:42.594 > [ESP32] MsgKeys: lfsrSeed=0x7F99CC8B tnk[0..3]=1469687B trn[0..3]=CA5D379E
19:09:42.599 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313730384D50
19:09:42.608 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313730384D50000000000000 
19:09:42.614 > [ESP32][LFSR] Initializing - Seed: 0x7F99CC8B SeedBe: 0x8BCC997F ChaosKey[0..3]: 1469687B InitialTap: 0x0029 State: 0x7F99CC8B
19:09:42.624 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
19:09:42.633 > 3_After_LFSR (32): C39EB449DE5B260F967FBBC34D0F877D 0A9D59BFA1F8FE73E3777E4A80BE3C3C 
19:09:42.641 > [ESP32][LFSR] Keystream (first 16 bytes): 8BCC997FEB7B755FD94D96FA7B2FD429
19:09:42.647 > [ESP32][4D] LFSR keystream (first 32 bytes): 8BCC997FEB7B755FD94D96FA7B2FD4294FCD0A9290CFCE4BAE277E4A80BE3C3C
19:09:42.657 > [ESP32][TINKERBELL] Input (first 16 bytes): C39EB449DE5B260F967FBBC34D0F877D Nonce: 0x00000001 Buffer size: 32 bytes
19:09:42.669 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 1469687B
19:09:42.677 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FA09BF1A61377AAAA7D2E10781294134
19:09:42.685 > 4_After_Tinkerbell (32): 39970B53BF6C5CA531AD5AC4CC26C649 31FE2A255998F870B37A2098F5D3719F 
19:09:42.694 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FA09BF1A61377AAAA7D2E10781294134
19:09:42.703 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FA09BF1A61377AAAA7D2E107812941343B63739AF8600603500D5ED2756D4DA3
19:09:42.711 > 5_After_Transposition (32): BF6C5CA5C45A9739CC26C649252AAD31 5998F870530BFE3198209F71F5D37AB3 
19:09:42.719 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:09:42.724 > [ESP32] === HMAC DEBUG INFO ===
19:09:42.727 > [ESP32] HMAC Key being used: 9899EC467BA0F0A63B7FA364C67D2B6A7133D330DA73E9519C17876E43713EBE
19:09:42.736 > [ESP32] HMAC Input length: 45 bytes
19:09:42.739 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001BF6C5CA5C45A9739CC26C649252AAD315998F8
19:09:42.747 > [ESP32] Nonce: 0x00000001
19:09:42.749 > [ESP32] Packet size before HMAC: 61
19:09:42.753 > [ESP32] Computed HMAC Tag: FAA00D4324812E260E70BDC0C864A659
19:09:42.757 > [ESP32] === END HMAC DEBUG ===
19:09:42.761 > 6_Final_Packet (61): 82021800180004080400000001BF6C5C A5C45A9739CC26C649252AAD315998F8 ...
19:09:42.769 > [RETRY] Attempt 1/3 (nonce: 1)
19:09:42.772 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:42.777 > Sending pipeline data to server (609 bytes)
19:09:43.105 > [HTTP] Response code: 400
19:09:43.105 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:43.111 > [HTTP] Request failed with code: 400
19:09:43.114 > [RETRY] Send failed, waiting 100 ms before retry
19:09:43.213 > [RETRY] Attempt 2/3 (nonce: 1)
19:09:43.213 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:43.218 > Sending pipeline data to server (609 bytes)
19:09:43.373 > [HTTP] Response code: 400
19:09:43.373 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:43.379 > [HTTP] Request failed with code: 400
19:09:43.381 > [RETRY] Send failed, waiting 200 ms before retry
19:09:43.580 > [RETRY] Attempt 3/3 (nonce: 1)
19:09:43.580 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:43.585 > Sending pipeline data to server (609 bytes)
19:09:43.917 > [HTTP] Response code: 400
19:09:43.917 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:43.923 > [HTTP] Request failed with code: 400
19:09:43.926 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:09:43.931 > [RETRY] Consecutive failures: 2
19:09:43.933 > ✗ Auto-recovery failed - restarting key exchange
19:09:46.036 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":332985,"type":"health_data_error"}
19:09:46.050 > [WebSocket] Processing message type: health_data_error
19:09:46.056 > [340.5] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:46.064 > ✓ Public key loaded from NVS
19:09:46.162 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":333523,"type":"health_data_error"}
19:09:46.177 > [WebSocket] Processing message type: health_data_error
19:09:46.182 > [340.6] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:46.286 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125979541,"threatLevel":0,"type":"heuristics_update"}
19:09:46.311 > [WebSocket] Processing message type: heuristics_update
19:09:46.317 > [340.7] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:46.325 > Generating fresh master key from entropy...
19:09:46.327 > Generated master key (32): F8845A4DF39965B246A06506011EDA9B E4107F52A2C37E9DC89F31D44E0563A6 
19:09:46.341 > Using reduced master key (byte % 3) for NTRU encryption only
19:09:46.349 > NTRU encrypted master key (502): 0023006E001E0017007D001B00080063 00450078003B000C00010074006A0070 ...
19:09:46.357 > POST http://10.249.92.115:8081/master-key
19:09:46.623 > ✓ Master key exchange completed
19:09:46.724 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":334247,"type":"health_data_error"}
19:09:46.738 > [WebSocket] Processing message type: health_data_error
19:09:46.743 > [341.1] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:46.752 > Loading master key from NVS and deriving symmetric keys...
19:09:46.758 > Loaded master key from NVS (32): F8845A4DF39965B246A06506011EDA9B E4107F52A2C37E9DC89F31D44E0563A6 
19:09:46.766 > Derived HMAC key (32): BC72E26D3679CE2A68624864CB4E695A 0E397AE9B7B068A9B63608494C8EB04D 
19:09:46.774 > Derived Tinkerbell key (16): 4C29704777EFB6CBEA92EB39D9F286F2 
19:09:46.780 > Derived Transposition key (16): 131930CEC1F9C385494928D99EA154B4 
19:09:46.785 > ✓ Symmetric keys derived successfully
19:09:46.788 > Nonce tracker reset - new session started
19:09:47.284 > Waiting for server to process master key...
19:09:47.288 > ✓ Symmetric keys ready - starting health data transmission
19:09:47.390 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":334699,"type":"health_data_error"}
19:09:47.404 > [WebSocket] Processing message type: health_data_error
19:09:47.409 > [341.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:47.512 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125980541,"threatLevel":0,"type":"heuristics_update"}
19:09:47.538 > [WebSocket] Processing message type: heuristics_update
19:09:47.542 > [341.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:47.646 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":335270,"type":"health_data_error"}
19:09:47.659 > [WebSocket] Processing message type: health_data_error
19:09:47.665 > [342.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:47.767 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125981542,"threatLevel":0,"type":"heuristics_update"}
19:09:47.792 > [WebSocket] Processing message type: heuristics_update
19:09:47.798 > [342.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:47.901 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":335997,"type":"health_data_error"}
19:09:47.914 > [WebSocket] Processing message type: health_data_error
19:09:47.920 > [342.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:48.025 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":336261,"type":"health_data_error"}
19:09:48.039 > [WebSocket] Processing message type: health_data_error
19:09:48.045 > [342.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:48.147 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":336805,"type":"health_data_error"}
19:09:48.161 > [WebSocket] Processing message type: health_data_error
19:09:48.167 > [342.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:48.269 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125982543,"threatLevel":0,"type":"heuristics_update"}
19:09:48.295 > [WebSocket] Processing message type: heuristics_update
19:09:48.300 > [342.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:48.403 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":337519,"type":"health_data_error"}
19:09:48.416 > [WebSocket] Processing message type: health_data_error
19:09:48.422 > [342.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:48.524 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":337786,"type":"health_data_error"}
19:09:48.538 > [WebSocket] Processing message type: health_data_error
19:09:48.544 > [342.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:48.647 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125983544,"threatLevel":0,"type":"heuristics_update"}
19:09:48.672 > [WebSocket] Processing message type: heuristics_update
19:09:48.677 > [343.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:48.779 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":338331,"type":"health_data_error"}
19:09:48.794 > [WebSocket] Processing message type: health_data_error
19:09:48.799 > [343.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:48.902 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125984545,"threatLevel":0,"type":"heuristics_update"}
19:09:48.927 > [WebSocket] Processing message type: heuristics_update
19:09:48.933 > [343.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:49.034 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125985546,"threatLevel":0,"type":"heuristics_update"}
19:09:49.059 > [WebSocket] Processing message type: heuristics_update
19:09:49.065 > [343.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:49.167 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770125986481,"type":"master_key_received"}
19:09:49.181 > [WebSocket] Processing message type: master_key_received
19:09:49.184 > [343.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:49.289 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125986547,"threatLevel":0,"type":"heuristics_update"}
19:09:49.314 > [WebSocket] Processing message type: heuristics_update
19:09:49.320 > [343.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:49.422 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":341028,"type":"master_key_exchanged"}
19:09:49.439 > [WebSocket] Processing message type: master_key_exchanged
19:09:49.445 > [343.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:49.545 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":341697,"type":"symmetric_keys_derived"}
19:09:49.561 > [WebSocket] Processing message type: symmetric_keys_derived
19:09:49.567 > [344.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:49.666 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125987548,"threatLevel":0,"type":"heuristics_update"}
19:09:49.692 > [WebSocket] Processing message type: heuristics_update
19:09:49.697 > [344.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:49.800 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125988549,"threatLevel":0,"type":"heuristics_update"}
19:09:49.825 > [WebSocket] Processing message type: heuristics_update
19:09:49.831 > [344.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:49.932 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125989549,"threatLevel":0,"type":"heuristics_update"}
19:09:49.958 > [WebSocket] Processing message type: heuristics_update
19:09:49.962 > [344.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:50.065 > [344.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:50.166 > [344.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:50.267 > [344.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:50.367 > [344.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:50.469 > [344.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:50.569 > [345.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:50.672 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125990549,"threatLevel":0,"type":"heuristics_update"}
19:09:50.697 > [WebSocket] Processing message type: heuristics_update
19:09:50.703 > [345.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:50.804 > [345.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:50.905 > [345.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:51.006 > [345.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:51.107 > [345.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:51.208 > [345.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:51.309 > [345.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:51.410 > [345.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:51.511 > [345.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:51.613 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125991550,"threatLevel":0,"type":"heuristics_update"}
19:09:51.638 > [WebSocket] Processing message type: heuristics_update
19:09:51.642 > [346.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:51.745 > [346.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:51.846 > [346.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:51.947 > [346.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:52.047 > [346.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:52.149 > [346.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:52.250 > [346.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:52.350 > [346.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:52.452 > [346.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:52.553 > [347.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:52.655 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125992551,"threatLevel":0,"type":"heuristics_update"}
19:09:52.680 > [WebSocket] Processing message type: heuristics_update
19:09:52.685 > [347.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:52.787 > [347.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:52.888 > [347.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:52.989 > [347.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:53.090 > [347.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:53.190 > [347.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:53.292 > [347.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:53.393 > [347.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:53.494 > [347.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:53.597 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125993551,"threatLevel":0,"type":"heuristics_update"}
19:09:53.623 > [WebSocket] Processing message type: heuristics_update
19:09:53.629 > [348.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:53.730 > [348.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:53.831 > [348.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:53.932 > [348.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:54.033 > [348.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:54.134 > [348.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:54.235 > [348.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:54.336 > [348.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:54.436 > [348.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:54.538 > [348.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:54.639 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125994552,"threatLevel":0,"type":"heuristics_update"}
19:09:54.665 > [WebSocket] Processing message type: heuristics_update
19:09:54.670 > [349.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:54.772 > [349.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:54.873 > [349.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:54.974 > [349.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:55.075 > [349.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:55.175 > [349.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:55.276 > [349.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:55.378 > [349.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:55.479 > [349.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:55.580 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125995552,"threatLevel":0,"type":"heuristics_update"}
19:09:55.605 > [WebSocket] Processing message type: heuristics_update
19:09:55.611 > [350.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:55.713 > [350.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:55.814 > [350.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:55.915 > [350.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:56.016 > [350.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:56.117 > [350.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:56.217 > [350.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:56.319 > [350.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:56.420 > [350.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:56.521 > [350.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:56.622 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125996553,"threatLevel":0,"type":"heuristics_update"}
19:09:56.647 > [WebSocket] Processing message type: heuristics_update
19:09:56.653 > [351.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:56.755 > [351.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:56.856 > [351.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:56.957 > [351.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:57.058 > [351.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:57.159 > [351.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:57.260 > [351.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:57.361 > [351.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:57.366 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:57.372 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:09:57.377 > Generated health data: HR-65 SPO2-96 STEPS-1762
19:09:57.381 > [ESP32] ========================================
19:09:57.386 > [ESP32] ENCRYPTION PIPELINE START
19:09:57.389 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:57.394 > [ESP32] Active Algorithms for this packet:
19:09:57.397 > [ESP32]   + LFSR
19:09:57.400 > [ESP32]   + Tinkerbell
19:09:57.403 > [ESP32]   + Transposition
19:09:57.403 > [ESP32]   - ChaCha20
19:09:57.405 > [ESP32]   - Salsa20
19:09:57.408 > [ESP32] ========================================
19:09:57.411 > [ESP32] MsgKeys: lfsrSeed=0x14377E2A tnk[0..3]=5068E22D trn[0..3]=DC59C6AA
19:09:57.419 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313736324D50
19:09:57.425 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313736324D50000000000000 
19:09:57.433 > [ESP32][LFSR] Initializing - Seed: 0x14377E2A SeedBe: 0x2A7E3714 ChaosKey[0..3]: 5068E22D InitialTap: 0x0029 State: 0x14377E2A
19:09:57.444 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
19:09:57.453 > 3_After_LFSR (32): 622C1A226B81E0066CB534A4505BFEF6 E8C33B87BF47EA2BE22E64EC9B248B85 
19:09:57.458 > [ESP32][LFSR] Keystream (first 16 bytes): 2A7E37145EA1B3562387199D667BADA2
19:09:57.466 > [ESP32][4D] LFSR keystream (first 32 bytes): 2A7E37145EA1B3562387199D667BADA2AD9368AA8E70DC19AF7E64EC9B248B85
19:09:57.475 > [ESP32][TINKERBELL] Input (first 16 bytes): 622C1A226B81E0066CB534A4505BFEF6 Nonce: 0x00000001 Buffer size: 32 bytes
19:09:57.486 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5068E22D
19:09:57.495 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A36D05F7B81B296129205AF8D25D15F6
19:09:57.503 > 4_After_Tinkerbell (32): C1411FD5D39AC96745956E5C8206EB00 635E4C1AA06068DA4125015B2BF0C03A 
19:09:57.511 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A36D05F7B81B296129205AF8D25D15F6
19:09:57.520 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A36D05F7B81B296129205AF8D25D15F68B9D779D1F2782F1A30B65B7B0D44BBF
19:09:57.530 > 5_After_Transposition (32): D39A41C1068200EB015B254145954C1A 68DAC03A2BF0A0601FD5635E5C6EC967 
19:09:57.539 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:09:57.541 > [ESP32] === HMAC DEBUG INFO ===
19:09:57.545 > [ESP32] HMAC Key being used: BC72E26D3679CE2A68624864CB4E695A0E397AE9B7B068A9B63608494C8EB04D
19:09:57.553 > [ESP32] HMAC Input length: 45 bytes
19:09:57.556 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001D39A41C1068200EB015B254145954C1A68DAC0
19:09:57.567 > [ESP32] Nonce: 0x00000001
19:09:57.567 > [ESP32] Packet size before HMAC: 61
19:09:57.572 > [ESP32] Computed HMAC Tag: 4EC31808EAB251E85C31D46A0BF15033
19:09:57.575 > [ESP32] === END HMAC DEBUG ===
19:09:57.578 > 6_Final_Packet (61): 82021800180004080400000001D39A41 C1068200EB015B254145954C1A68DAC0 ...
19:09:57.587 > [RETRY] Attempt 1/3 (nonce: 1)
19:09:57.589 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:57.594 > Sending pipeline data to server (609 bytes)
19:09:57.907 > [HTTP] Response code: 400
19:09:57.909 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:57.914 > [HTTP] Request failed with code: 400
19:09:57.917 > [RETRY] Send failed, waiting 100 ms before retry
19:09:58.016 > [RETRY] Attempt 2/3 (nonce: 1)
19:09:58.017 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:58.022 > Sending pipeline data to server (609 bytes)
19:09:58.362 > [HTTP] Response code: 400
19:09:58.363 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:58.369 > [HTTP] Request failed with code: 400
19:09:58.371 > [RETRY] Send failed, waiting 200 ms before retry
19:09:58.569 > [RETRY] Attempt 3/3 (nonce: 1)
19:09:58.569 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:58.575 > Sending pipeline data to server (609 bytes)
19:09:58.901 > [HTTP] Response code: 400
19:09:58.901 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:58.907 > [HTTP] Request failed with code: 400
19:09:58.909 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:09:58.915 > [RETRY] Consecutive failures: 3
19:09:58.917 > Health data send failed (retry count: 1/3)
19:09:59.023 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125997554,"threatLevel":0,"type":"heuristics_update"}
19:09:59.047 > [WebSocket] Processing message type: heuristics_update
19:09:59.054 > [353.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:09:59.059 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:59.064 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:09:59.070 > Generated health data: HR-65 SPO2-96 STEPS-1812
19:09:59.073 > [ESP32] ========================================
19:09:59.079 > [ESP32] ENCRYPTION PIPELINE START
19:09:59.081 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:59.087 > [ESP32] Active Algorithms for this packet:
19:09:59.090 > [ESP32]   + LFSR
19:09:59.092 > [ESP32]   + Tinkerbell
19:09:59.095 > [ESP32]   + Transposition
19:09:59.095 > [ESP32]   - ChaCha20
19:09:59.098 > [ESP32]   - Salsa20
19:09:59.101 > [ESP32] ========================================
19:09:59.104 > [ESP32] MsgKeys: lfsrSeed=0x14377E2A tnk[0..3]=5068E22D trn[0..3]=DC59C6AA
19:09:59.112 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313831324D50
19:09:59.118 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313831324D50000000000000 
19:09:59.126 > [ESP32][LFSR] Initializing - Seed: 0x14377E2A SeedBe: 0x2A7E3714 ChaosKey[0..3]: 5068E22D InitialTap: 0x0029 State: 0x14377E2A
19:09:59.136 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
19:09:59.145 > 3_After_LFSR (32): 622C1A226B81E0066CB534A4505BFEF6 E8C33B87BF48ED2BE22E64EC9B248B85 
19:09:59.151 > [ESP32][LFSR] Keystream (first 16 bytes): 2A7E37145EA1B3562387199D667BADA2
19:09:59.159 > [ESP32][4D] LFSR keystream (first 32 bytes): 2A7E37145EA1B3562387199D667BADA2AD9368AA8E70DC19AF7E64EC9B248B85
19:09:59.167 > [ESP32][TINKERBELL] Input (first 16 bytes): 622C1A226B81E0066CB534A4505BFEF6 Nonce: 0x00000001 Buffer size: 32 bytes
19:09:59.179 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5068E22D
19:09:59.186 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A36D05F7B81B296129205AF8D25D15F6
19:09:59.195 > 4_After_Tinkerbell (32): C1411FD5D39AC96745956E5C8206EB00 635E4C1AA06F6FDA4125015B2BF0C03A 
19:09:59.204 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A36D05F7B81B296129205AF8D25D15F6
19:09:59.212 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A36D05F7B81B296129205AF8D25D15F68B9D779D1F2782F1A30B65B7B0D44BBF
19:09:59.223 > 5_After_Transposition (32): D39A41C1068200EB015B254145954C1A 6FDAC03A2BF0A06F1FD5635E5C6EC967 
19:09:59.231 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:09:59.234 > [ESP32] === HMAC DEBUG INFO ===
19:09:59.236 > [ESP32] HMAC Key being used: BC72E26D3679CE2A68624864CB4E695A0E397AE9B7B068A9B63608494C8EB04D
19:09:59.245 > [ESP32] HMAC Input length: 45 bytes
19:09:59.247 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001D39A41C1068200EB015B254145954C1A6FDAC0
19:09:59.259 > [ESP32] Nonce: 0x00000001
19:09:59.259 > [ESP32] Packet size before HMAC: 61
19:09:59.264 > [ESP32] Computed HMAC Tag: 98A6FDF47098035782FDD6BD34BCC67B
19:09:59.267 > [ESP32] === END HMAC DEBUG ===
19:09:59.270 > 6_Final_Packet (61): 82021800180004080400000001D39A41 C1068200EB015B254145954C1A6FDAC0 ...
19:09:59.278 > [RETRY] Attempt 1/3 (nonce: 1)
19:09:59.281 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:59.286 > Sending pipeline data to server (609 bytes)
19:09:59.635 > [HTTP] Response code: 400
19:09:59.635 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:59.640 > [HTTP] Request failed with code: 400
19:09:59.642 > [RETRY] Send failed, waiting 100 ms before retry
19:09:59.743 > [RETRY] Attempt 2/3 (nonce: 1)
19:09:59.743 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:59.748 > Sending pipeline data to server (609 bytes)
19:09:59.903 > [HTTP] Response code: 400
19:09:59.904 > [HTTP] Error response: {"error":"Decryption failed"}
19:09:59.909 > [HTTP] Request failed with code: 400
19:09:59.912 > [RETRY] Send failed, waiting 200 ms before retry
19:10:00.110 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:00.111 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:00.116 > Sending pipeline data to server (609 bytes)
19:10:00.424 > [HTTP] Response code: 400
19:10:00.424 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:00.429 > [HTTP] Request failed with code: 400
19:10:00.432 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:00.438 > [RETRY] Consecutive failures: 4
19:10:00.440 > Health data send failed (retry count: 2/3)
19:10:00.542 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":352322,"type":"health_data_error"}
19:10:00.557 > [WebSocket] Processing message type: health_data_error
19:10:00.563 > [355.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:00.571 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:00.577 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:00.582 > Generated health data: HR-65 SPO2-96 STEPS-1788
19:10:00.585 > [ESP32] ========================================
19:10:00.591 > [ESP32] ENCRYPTION PIPELINE START
19:10:00.594 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:00.599 > [ESP32] Active Algorithms for this packet:
19:10:00.602 > [ESP32]   + LFSR
19:10:00.602 > [ESP32]   + Tinkerbell
19:10:00.604 > [ESP32]   + Transposition
19:10:00.607 > [ESP32]   - ChaCha20
19:10:00.610 > [ESP32]   - Salsa20
19:10:00.610 > [ESP32] ========================================
19:10:00.615 > [ESP32] MsgKeys: lfsrSeed=0x14377E2A tnk[0..3]=5068E22D trn[0..3]=DC59C6AA
19:10:00.622 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313738384D50
19:10:00.627 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313738384D50000000000000 
19:10:00.635 > [ESP32][LFSR] Initializing - Seed: 0x14377E2A SeedBe: 0x2A7E3714 ChaosKey[0..3]: 5068E22D InitialTap: 0x0029 State: 0x14377E2A
19:10:00.646 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
19:10:00.654 > 3_After_LFSR (32): 622C1A226B81E0066CB534A4505BFEF6 E8C33B87BF47E421E22E64EC9B248B85 
19:10:00.663 > [ESP32][LFSR] Keystream (first 16 bytes): 2A7E37145EA1B3562387199D667BADA2
19:10:00.668 > [ESP32][4D] LFSR keystream (first 32 bytes): 2A7E37145EA1B3562387199D667BADA2AD9368AA8E70DC19AF7E64EC9B248B85
19:10:00.680 > [ESP32][TINKERBELL] Input (first 16 bytes): 622C1A226B81E0066CB534A4505BFEF6 Nonce: 0x00000001 Buffer size: 32 bytes
19:10:00.688 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5068E22D
19:10:00.699 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A36D05F7B81B296129205AF8D25D15F6
19:10:00.707 > 4_After_Tinkerbell (32): C1411FD5D39AC96745956E5C8206EB00 635E4C1AA06066D04125015B2BF0C03A 
19:10:00.716 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A36D05F7B81B296129205AF8D25D15F6
19:10:00.724 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A36D05F7B81B296129205AF8D25D15F68B9D779D1F2782F1A30B65B7B0D44BBF
19:10:00.732 > 5_After_Transposition (32): D39A41C1068200EB015B254145954C1A 66D0C03A2BF0A0601FD5635E5C6EC967 
19:10:00.740 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:00.746 > [ESP32] === HMAC DEBUG INFO ===
19:10:00.749 > [ESP32] HMAC Key being used: BC72E26D3679CE2A68624864CB4E695A0E397AE9B7B068A9B63608494C8EB04D
19:10:00.757 > [ESP32] HMAC Input length: 45 bytes
19:10:00.760 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001D39A41C1068200EB015B254145954C1A66D0C0
19:10:00.769 > [ESP32] Nonce: 0x00000001
19:10:00.772 > [ESP32] Packet size before HMAC: 61
19:10:00.774 > [ESP32] Computed HMAC Tag: FC36712387C5B37E4C76A9BFA5B6177C
19:10:00.779 > [ESP32] === END HMAC DEBUG ===
19:10:00.782 > 6_Final_Packet (61): 82021800180004080400000001D39A41 C1068200EB015B254145954C1A66D0C0 ...
19:10:00.790 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:00.794 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:00.799 > Sending pipeline data to server (609 bytes)
19:10:00.927 > [HTTP] Response code: 400
19:10:00.927 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:00.933 > [HTTP] Request failed with code: 400
19:10:00.936 > [RETRY] Send failed, waiting 100 ms before retry
19:10:01.036 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:01.036 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:01.042 > Sending pipeline data to server (609 bytes)
19:10:01.376 > [HTTP] Response code: 400
19:10:01.376 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:01.381 > [HTTP] Request failed with code: 400
19:10:01.384 > [RETRY] Send failed, waiting 200 ms before retry
19:10:01.583 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:01.583 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:01.589 > Sending pipeline data to server (609 bytes)
19:10:01.924 > [HTTP] Response code: 400
19:10:01.924 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:01.930 > [HTTP] Request failed with code: 400
19:10:01.932 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:01.938 > [RETRY] Consecutive failures: 5
19:10:01.941 > [EMERGENCY] Triggering emergency reset!
19:10:01.944 > [CRYPTO] Resetting cryptographic state
19:10:01.949 > [CRYPTO] Crypto state reset complete
19:10:01.952 > [CRYPTO] Packet counter: 7
19:10:01.955 > [EMERGENCY] Emergency reset complete
19:10:01.958 > Health data send failed (retry count: 3/3)
19:10:01.961 > Health data transmission failed after max retries
19:10:02.065 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":352777,"type":"health_data_error"}
19:10:02.079 > [WebSocket] Processing message type: health_data_error
19:10:02.084 > [356.5] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:02.092 > ERROR state - attempting recovery
19:10:02.096 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:02.101 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:02.104 > Generated health data: HR-65 SPO2-96 STEPS-1817
19:10:02.110 > [ESP32] ========================================
19:10:02.112 > [ESP32] ENCRYPTION PIPELINE START
19:10:02.115 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:02.120 > [ESP32] Active Algorithms for this packet:
19:10:02.126 > [ESP32]   + LFSR
19:10:02.126 > [ESP32]   + Tinkerbell
19:10:02.129 > [ESP32]   + Transposition
19:10:02.132 > [ESP32]   - ChaCha20
19:10:02.132 > [ESP32]   - Salsa20
19:10:02.135 > [ESP32] ========================================
19:10:02.140 > [ESP32] MsgKeys: lfsrSeed=0x14377E2A tnk[0..3]=5068E22D trn[0..3]=DC59C6AA
19:10:02.146 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313831374D50
19:10:02.151 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313831374D50000000000000 
19:10:02.160 > [ESP32][LFSR] Initializing - Seed: 0x14377E2A SeedBe: 0x2A7E3714 ChaosKey[0..3]: 5068E22D InitialTap: 0x0029 State: 0x14377E2A
19:10:02.171 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
19:10:02.179 > 3_After_LFSR (32): 622C1A226B81E0066CB534A4505BFEF6 E8C33B87BF48ED2EE22E64EC9B248B85 
19:10:02.188 > [ESP32][LFSR] Keystream (first 16 bytes): 2A7E37145EA1B3562387199D667BADA2
19:10:02.193 > [ESP32][4D] LFSR keystream (first 32 bytes): 2A7E37145EA1B3562387199D667BADA2AD9368AA8E70DC19AF7E64EC9B248B85
19:10:02.202 > [ESP32][TINKERBELL] Input (first 16 bytes): 622C1A226B81E0066CB534A4505BFEF6 Nonce: 0x00000001 Buffer size: 32 bytes
19:10:02.213 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5068E22D
19:10:02.223 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A36D05F7B81B296129205AF8D25D15F6
19:10:02.232 > 4_After_Tinkerbell (32): C1411FD5D39AC96745956E5C8206EB00 635E4C1AA06F6FDF4125015B2BF0C03A 
19:10:02.240 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A36D05F7B81B296129205AF8D25D15F6
19:10:02.246 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A36D05F7B81B296129205AF8D25D15F68B9D779D1F2782F1A30B65B7B0D44BBF
19:10:02.257 > 5_After_Transposition (32): D39A41C1068200EB015B254145954C1A 6FDFC03A2BF0A06F1FD5635E5C6EC967 
19:10:02.264 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:02.271 > [ESP32] === HMAC DEBUG INFO ===
19:10:02.273 > [ESP32] HMAC Key being used: BC72E26D3679CE2A68624864CB4E695A0E397AE9B7B068A9B63608494C8EB04D
19:10:02.282 > [ESP32] HMAC Input length: 45 bytes
19:10:02.285 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001D39A41C1068200EB015B254145954C1A6FDFC0
19:10:02.293 > [ESP32] Nonce: 0x00000001
19:10:02.296 > [ESP32] Packet size before HMAC: 61
19:10:02.299 > [ESP32] Computed HMAC Tag: 1CEA2703F0352AB8FB4929E497A865F1
19:10:02.304 > [ESP32] === END HMAC DEBUG ===
19:10:02.307 > 6_Final_Packet (61): 82021800180004080400000001D39A41 C1068200EB015B254145954C1A6FDFC0 ...
19:10:02.315 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:02.318 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:02.324 > Sending pipeline data to server (609 bytes)
19:10:02.690 > [HTTP] Response code: 400
19:10:02.690 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:02.696 > [HTTP] Request failed with code: 400
19:10:02.699 > [RETRY] Send failed, waiting 100 ms before retry
19:10:02.799 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:02.799 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:02.804 > Sending pipeline data to server (609 bytes)
19:10:02.921 > [HTTP] Response code: 400
19:10:02.922 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:02.927 > [HTTP] Request failed with code: 400
19:10:02.930 > [RETRY] Send failed, waiting 200 ms before retry
19:10:03.129 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:03.129 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:03.135 > Sending pipeline data to server (609 bytes)
19:10:03.441 > [HTTP] Response code: 400
19:10:03.441 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:03.447 > [HTTP] Request failed with code: 400
19:10:03.449 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:03.455 > [RETRY] Consecutive failures: 1
19:10:03.458 > ✗ Auto-recovery failed - restarting key exchange
19:10:05.560 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125998554,"threatLevel":0,"type":"heuristics_update"}
19:10:05.585 > [WebSocket] Processing message type: heuristics_update
19:10:05.591 > [360.0] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:05.599 > ✓ Public key loaded from NVS
19:10:05.697 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":353315,"type":"health_data_error"}
19:10:05.711 > [WebSocket] Processing message type: health_data_error
19:10:05.716 > [360.1] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:05.821 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770125999554,"threatLevel":0,"type":"heuristics_update"}
19:10:05.846 > [WebSocket] Processing message type: heuristics_update
19:10:05.851 > [360.3] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:05.860 > Generating fresh master key from entropy...
19:10:05.863 > Generated master key (32): E2716E10EE727D68C983CE6300C4BB31 BD13FAEE7903E1822A0D426885A1E13B 
19:10:05.875 > Using reduced master key (byte % 3) for NTRU encryption only
19:10:05.883 > NTRU encrypted master key (502): 0022007000200016007E001B00080064 00440079003B000C000000750069006F ...
19:10:05.891 > POST http://10.249.92.115:8081/master-key
19:10:06.199 > ✓ Master key exchange completed
19:10:06.300 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":354049,"type":"health_data_error"}
19:10:06.314 > [WebSocket] Processing message type: health_data_error
19:10:06.319 > [360.7] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:06.328 > Loading master key from NVS and deriving symmetric keys...
19:10:06.334 > Loaded master key from NVS (32): E2716E10EE727D68C983CE6300C4BB31 BD13FAEE7903E1822A0D426885A1E13B 
19:10:06.342 > Derived HMAC key (32): 6067E80EAB8C186688324646A32727A8 0D8DABF37B3B29E53080DEC7ADFDD8C4 
19:10:06.350 > Derived Tinkerbell key (16): AADCAACC01ADD3CCA768285C44C481F1 
19:10:06.356 > Derived Transposition key (16): 7BC51954323799475619E8ABC1E2F146 
19:10:06.361 > ✓ Symmetric keys derived successfully
19:10:06.364 > Nonce tracker reset - new session started
19:10:06.860 > Waiting for server to process master key...
19:10:06.863 > ✓ Symmetric keys ready - starting health data transmission
19:10:06.965 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":354317,"type":"health_data_error"}
19:10:06.979 > [WebSocket] Processing message type: health_data_error
19:10:06.984 > [361.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:07.087 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":354838,"type":"health_data_error"}
19:10:07.102 > [WebSocket] Processing message type: health_data_error
19:10:07.108 > [361.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:07.209 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126000555,"threatLevel":0,"type":"heuristics_update"}
19:10:07.235 > [WebSocket] Processing message type: heuristics_update
19:10:07.240 > [361.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:07.343 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":355342,"type":"health_data_error"}
19:10:07.357 > [WebSocket] Processing message type: health_data_error
19:10:07.362 > [361.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:07.465 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":355790,"type":"health_data_error"}
19:10:07.479 > [WebSocket] Processing message type: health_data_error
19:10:07.484 > [361.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:07.589 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126001556,"threatLevel":0,"type":"heuristics_update"}
19:10:07.615 > [WebSocket] Processing message type: heuristics_update
19:10:07.620 > [362.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:07.722 > [362.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:07.823 > [362.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:07.924 > [362.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:08.025 > [362.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:08.126 > [362.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:08.227 > [362.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:08.329 > [362.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:08.429 > [362.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:08.530 > [362.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:08.631 > [363.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:08.732 > [363.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:08.833 > [363.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:08.934 > [363.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:09.035 > [363.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:09.137 > [363.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:09.238 > [363.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:09.339 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":356338,"type":"health_data_error"}
19:10:09.354 > [WebSocket] Processing message type: health_data_error
19:10:09.359 > [363.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:09.462 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126002557,"threatLevel":0,"type":"heuristics_update"}
19:10:09.486 > [WebSocket] Processing message type: heuristics_update
19:10:09.492 > [363.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:09.595 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":357105,"type":"health_data_error"}
19:10:09.609 > [WebSocket] Processing message type: health_data_error
19:10:09.615 > [364.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:09.716 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":357335,"type":"health_data_error"}
19:10:09.731 > [WebSocket] Processing message type: health_data_error
19:10:09.737 > [364.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:09.840 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":357855,"type":"health_data_error"}
19:10:09.854 > [WebSocket] Processing message type: health_data_error
19:10:09.859 > [364.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:09.961 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126003558,"threatLevel":0,"type":"heuristics_update"}
19:10:09.987 > [WebSocket] Processing message type: heuristics_update
19:10:09.993 > [364.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:10.095 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126004559,"threatLevel":0,"type":"heuristics_update"}
19:10:10.120 > [WebSocket] Processing message type: heuristics_update
19:10:10.126 > [364.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:10.228 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126005560,"threatLevel":0,"type":"heuristics_update"}
19:10:10.258 > [WebSocket] Processing message type: heuristics_update
19:10:10.258 > [364.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:10.361 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770126006021,"type":"master_key_received"}
19:10:10.375 > [WebSocket] Processing message type: master_key_received
19:10:10.377 > [364.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:10.483 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":360606,"type":"master_key_exchanged"}
19:10:10.499 > [WebSocket] Processing message type: master_key_exchanged
19:10:10.505 > [364.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:10.604 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126006561,"threatLevel":0,"type":"heuristics_update"}
19:10:10.630 > [WebSocket] Processing message type: heuristics_update
19:10:10.636 > [365.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:10.738 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":361274,"type":"symmetric_keys_derived"}
19:10:10.754 > [WebSocket] Processing message type: symmetric_keys_derived
19:10:10.760 > [365.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:10.860 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126007562,"threatLevel":0,"type":"heuristics_update"}
19:10:10.886 > [WebSocket] Processing message type: heuristics_update
19:10:10.891 > [365.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:10.992 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126008563,"threatLevel":0,"type":"heuristics_update"}
19:10:11.018 > [WebSocket] Processing message type: heuristics_update
19:10:11.024 > [365.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:11.126 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126009566,"threatLevel":0,"type":"heuristics_update"}
19:10:11.151 > [WebSocket] Processing message type: heuristics_update
19:10:11.157 > [365.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:11.259 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126010575,"threatLevel":0,"type":"heuristics_update"}
19:10:11.284 > [WebSocket] Processing message type: heuristics_update
19:10:11.290 > [365.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:11.391 > [365.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:11.492 > [365.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:11.594 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126011575,"threatLevel":0,"type":"heuristics_update"}
19:10:11.619 > [WebSocket] Processing message type: heuristics_update
19:10:11.624 > [366.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:11.726 > [366.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:11.827 > [366.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:11.928 > [366.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:12.029 > [366.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:12.130 > [366.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:12.232 > [366.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:12.332 > [366.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:12.433 > [366.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:12.534 > [366.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:12.635 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126012576,"threatLevel":0,"type":"heuristics_update"}
19:10:12.661 > [WebSocket] Processing message type: heuristics_update
19:10:12.667 > [367.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:12.768 > [367.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:12.869 > [367.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:12.970 > [367.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:13.071 > [367.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:13.173 > [367.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:13.273 > [367.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:13.374 > [367.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:13.475 > [367.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:13.576 > [368.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:13.679 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126013577,"threatLevel":0,"type":"heuristics_update"}
19:10:13.704 > [WebSocket] Processing message type: heuristics_update
19:10:13.710 > [368.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:13.811 > [368.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:13.912 > [368.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:14.013 > [368.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:14.114 > [368.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:14.215 > [368.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:14.316 > [368.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:14.418 > [368.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:14.517 > [368.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:14.620 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126014578,"threatLevel":0,"type":"heuristics_update"}
19:10:14.645 > [WebSocket] Processing message type: heuristics_update
19:10:14.650 > [369.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:14.752 > [369.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:14.853 > [369.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:14.954 > [369.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:15.055 > [369.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:15.156 > [369.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:15.257 > [369.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:15.358 > [369.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:15.459 > [369.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:15.560 > [370.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:15.661 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126015579,"threatLevel":0,"type":"heuristics_update"}
19:10:15.686 > [WebSocket] Processing message type: heuristics_update
19:10:15.693 > [370.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:15.794 > [370.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:15.896 > [370.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:15.996 > [370.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:16.097 > [370.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:16.198 > [370.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:16.299 > [370.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:16.400 > [370.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:16.501 > [370.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:16.603 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126016580,"threatLevel":0,"type":"heuristics_update"}
19:10:16.628 > [WebSocket] Processing message type: heuristics_update
19:10:16.633 > [371.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:16.735 > [371.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:16.836 > [371.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:16.937 > [371.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:16.942 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:16.949 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:16.954 > Generated health data: HR-66 SPO2-96 STEPS-1897
19:10:16.958 > [ESP32] ========================================
19:10:16.963 > [ESP32] ENCRYPTION PIPELINE START
19:10:16.965 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:16.971 > [ESP32] Active Algorithms for this packet:
19:10:16.973 > [ESP32]   + LFSR
19:10:16.977 > [ESP32]   + Tinkerbell
19:10:16.979 > [ESP32]   + Transposition
19:10:16.979 > [ESP32]   - ChaCha20
19:10:16.982 > [ESP32]   - Salsa20
19:10:16.985 > [ESP32] ========================================
19:10:16.988 > [ESP32] MsgKeys: lfsrSeed=0x2985EAAF tnk[0..3]=44B9BF0E trn[0..3]=ECBA9844
19:10:16.997 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313839374D50
19:10:17.002 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313839374D50000000000000 
19:10:17.010 > [ESP32][LFSR] Initializing - Seed: 0x2985EAAF SeedBe: 0xAFEA8529 ChaosKey[0..3]: 44B9BF0E InitialTap: 0x0029 State: 0x2985EAAF
19:10:17.021 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
19:10:17.029 > 3_After_LFSR (32): E7B8A81FFD8BB9831FD7DF6EFF8BD1F2 9B3BC6635C8B2078F360DD453E0862DC 
19:10:17.035 > [ESP32][LFSR] Keystream (first 16 bytes): AFEA8529CBABEAD350E5F257C9AB82A6
19:10:17.043 > [ESP32][4D] LFSR keystream (first 32 bytes): AFEA8529CBABEAD350E5F257C9AB82A6DE6B954E6DB3194FBE30DD453E0862DC
19:10:17.052 > [ESP32][TINKERBELL] Input (first 16 bytes): E7B8A81FFD8BB9831FD7DF6EFF8BD1F2 Nonce: 0x00000001 Buffer size: 32 bytes
19:10:17.063 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 44B9BF0E
19:10:17.071 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 71D03044B5C0F061225DFB2AFA562210
19:10:17.080 > 4_After_Tinkerbell (32): 9668985B484B49E23D8A244405DDF3E2 CA28065516BE7E108EB28FED73E99D51 
19:10:17.088 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 71D03044B5C0F061225DFB2AFA562210
19:10:17.096 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 71D03044B5C0F061225DFB2AFA5622105113C0364A355E687DD252A84DE1FF8D
19:10:17.107 > 5_After_Transposition (32): 8EB28F0628CAE2495516BE5B484BF3E2 0544DD243D8A519D966898ED73E9107E 
19:10:17.116 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:17.118 > [ESP32] === HMAC DEBUG INFO ===
19:10:17.121 > [ESP32] HMAC Key being used: 6067E80EAB8C186688324646A32727A80D8DABF37B3B29E53080DEC7ADFDD8C4
19:10:17.129 > [ESP32] HMAC Input length: 45 bytes
19:10:17.132 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000018EB28F0628CAE2495516BE5B484BF3E20544DD
19:10:17.144 > [ESP32] Nonce: 0x00000001
19:10:17.144 > [ESP32] Packet size before HMAC: 61
19:10:17.149 > [ESP32] Computed HMAC Tag: 9E4C0386F58AFE1F31F4A249314880CF
19:10:17.152 > [ESP32] === END HMAC DEBUG ===
19:10:17.154 > 6_Final_Packet (61): 820218001800040804000000018EB28F 0628CAE2495516BE5B484BF3E20544DD ...
19:10:17.163 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:17.165 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:17.172 > Sending pipeline data to server (609 bytes)
19:10:17.444 > [HTTP] Response code: 400
19:10:17.444 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:17.449 > [HTTP] Request failed with code: 400
19:10:17.452 > [RETRY] Send failed, waiting 100 ms before retry
19:10:17.551 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:17.551 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:17.556 > Sending pipeline data to server (609 bytes)
19:10:17.714 > [HTTP] Response code: 400
19:10:17.714 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:17.721 > [HTTP] Request failed with code: 400
19:10:17.722 > [RETRY] Send failed, waiting 200 ms before retry
19:10:17.922 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:17.922 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:17.927 > Sending pipeline data to server (609 bytes)
19:10:18.205 > [HTTP] Response code: 400
19:10:18.205 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:18.212 > [HTTP] Request failed with code: 400
19:10:18.214 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:18.220 > [RETRY] Consecutive failures: 2
19:10:18.222 > Health data send failed (retry count: 1/3)
19:10:18.327 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":371858,"type":"health_data_error"}
19:10:18.341 > [WebSocket] Processing message type: health_data_error
19:10:18.347 > [372.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:18.355 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:18.361 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:18.366 > Generated health data: HR-66 SPO2-96 STEPS-1899
19:10:18.370 > [ESP32] ========================================
19:10:18.375 > [ESP32] ENCRYPTION PIPELINE START
19:10:18.377 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:18.384 > [ESP32] Active Algorithms for this packet:
19:10:18.386 > [ESP32]   + LFSR
19:10:18.386 > [ESP32]   + Tinkerbell
19:10:18.389 > [ESP32]   + Transposition
19:10:18.392 > [ESP32]   - ChaCha20
19:10:18.394 > [ESP32]   - Salsa20
19:10:18.394 > [ESP32] ========================================
19:10:18.400 > [ESP32] MsgKeys: lfsrSeed=0x2985EAAF tnk[0..3]=44B9BF0E trn[0..3]=ECBA9844
19:10:18.405 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313839394D50
19:10:18.411 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313839394D50000000000000 
19:10:18.420 > [ESP32][LFSR] Initializing - Seed: 0x2985EAAF SeedBe: 0xAFEA8529 ChaosKey[0..3]: 44B9BF0E InitialTap: 0x0029 State: 0x2985EAAF
19:10:18.431 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
19:10:18.439 > 3_After_LFSR (32): E7B8A81FFD8BB9831FD7DF6EFF8BD1F2 9B3BC6635C8B2076F360DD453E0862DC 
19:10:18.447 > [ESP32][LFSR] Keystream (first 16 bytes): AFEA8529CBABEAD350E5F257C9AB82A6
19:10:18.454 > [ESP32][4D] LFSR keystream (first 32 bytes): AFEA8529CBABEAD350E5F257C9AB82A6DE6B954E6DB3194FBE30DD453E0862DC
19:10:18.463 > [ESP32][TINKERBELL] Input (first 16 bytes): E7B8A81FFD8BB9831FD7DF6EFF8BD1F2 Nonce: 0x00000001 Buffer size: 32 bytes
19:10:18.472 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 44B9BF0E
19:10:18.483 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 71D03044B5C0F061225DFB2AFA562210
19:10:18.492 > 4_After_Tinkerbell (32): 9668985B484B49E23D8A244405DDF3E2 CA28065516BE7E1E8EB28FED73E99D51 
19:10:18.500 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 71D03044B5C0F061225DFB2AFA562210
19:10:18.509 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 71D03044B5C0F061225DFB2AFA5622105113C0364A355E687DD252A84DE1FF8D
19:10:18.517 > 5_After_Transposition (32): 8EB28F0628CAE2495516BE5B484BF3E2 0544DD243D8A519D966898ED73E91E7E 
19:10:18.525 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:18.531 > [ESP32] === HMAC DEBUG INFO ===
19:10:18.533 > [ESP32] HMAC Key being used: 6067E80EAB8C186688324646A32727A80D8DABF37B3B29E53080DEC7ADFDD8C4
19:10:18.541 > [ESP32] HMAC Input length: 45 bytes
19:10:18.544 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000018EB28F0628CAE2495516BE5B484BF3E20544DD
19:10:18.553 > [ESP32] Nonce: 0x00000001
19:10:18.556 > [ESP32] Packet size before HMAC: 61
19:10:18.557 > [ESP32] Computed HMAC Tag: BD195E090C1EB1E0A58399A5DA840E1D
19:10:18.564 > [ESP32] === END HMAC DEBUG ===
19:10:18.567 > 6_Final_Packet (61): 820218001800040804000000018EB28F 0628CAE2495516BE5B484BF3E20544DD ...
19:10:18.574 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:18.577 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:18.583 > Sending pipeline data to server (609 bytes)
19:10:18.941 > [HTTP] Response code: 400
19:10:18.941 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:18.947 > [HTTP] Request failed with code: 400
19:10:18.950 > [RETRY] Send failed, waiting 100 ms before retry
19:10:19.048 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:19.048 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:19.054 > Sending pipeline data to server (609 bytes)
19:10:19.200 > [HTTP] Response code: 400
19:10:19.201 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:19.206 > [HTTP] Request failed with code: 400
19:10:19.209 > [RETRY] Send failed, waiting 200 ms before retry
19:10:19.409 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:19.409 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:19.415 > Sending pipeline data to server (609 bytes)
19:10:19.733 > [HTTP] Response code: 400
19:10:19.733 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:19.739 > [HTTP] Request failed with code: 400
19:10:19.742 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:19.748 > [RETRY] Consecutive failures: 3
19:10:19.750 > Health data send failed (retry count: 2/3)
19:10:19.852 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126017580,"threatLevel":0,"type":"heuristics_update"}
19:10:19.876 > [WebSocket] Processing message type: heuristics_update
19:10:19.882 > [374.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:19.888 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:19.894 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:19.899 > Generated health data: HR-69 SPO2-96 STEPS-1881
19:10:19.902 > [ESP32] ========================================
19:10:19.907 > [ESP32] ENCRYPTION PIPELINE START
19:10:19.910 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:19.915 > [ESP32] Active Algorithms for this packet:
19:10:19.919 > [ESP32]   + LFSR
19:10:19.921 > [ESP32]   + Tinkerbell
19:10:19.924 > [ESP32]   + Transposition
19:10:19.924 > [ESP32]   - ChaCha20
19:10:19.926 > [ESP32]   - Salsa20
19:10:19.930 > [ESP32] ========================================
19:10:19.932 > [ESP32] MsgKeys: lfsrSeed=0x2985EAAF tnk[0..3]=44B9BF0E trn[0..3]=ECBA9844
19:10:19.941 > 1_After_Salt (26): 48522D36392053504F322D3936205354 4550532D313838314D50
19:10:19.946 > 2_After_Padding (32): 48522D36392053504F322D3936205354 4550532D313838314D50000000000000 
19:10:19.954 > [ESP32][LFSR] Initializing - Seed: 0x2985EAAF SeedBe: 0xAFEA8529 ChaosKey[0..3]: 44B9BF0E InitialTap: 0x0029 State: 0x2985EAAF
19:10:19.966 > [ESP32][LFSR] Input (first 16 bytes): 48522D36392053504F322D3936205354 Buffer size: 32 bytes
19:10:19.974 > 3_After_LFSR (32): E7B8A81FF28BB9831FD7DF6EFF8BD1F2 9B3BC6635C8B217EF360DD453E0862DC 
19:10:19.980 > [ESP32][LFSR] Keystream (first 16 bytes): AFEA8529CBABEAD350E5F257C9AB82A6
19:10:19.987 > [ESP32][4D] LFSR keystream (first 32 bytes): AFEA8529CBABEAD350E5F257C9AB82A6DE6B954E6DB3194FBE30DD453E0862DC
19:10:19.997 > [ESP32][TINKERBELL] Input (first 16 bytes): E7B8A81FF28BB9831FD7DF6EFF8BD1F2 Nonce: 0x00000001 Buffer size: 32 bytes
19:10:20.007 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 44B9BF0E
19:10:20.015 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 71D03044B5C0F061225DFB2AFA562210
19:10:20.024 > 4_After_Tinkerbell (32): 9668985B474B49E23D8A244405DDF3E2 CA28065516BE7F168EB28FED73E99D51 
19:10:20.032 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 71D03044B5C0F061225DFB2AFA562210
19:10:20.040 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 71D03044B5C0F061225DFB2AFA5622105113C0364A355E687DD252A84DE1FF8D
19:10:20.052 > 5_After_Transposition (32): 8EB28F0628CAE2495516BE5B474BF3E2 0544DD243D8A519D966898ED73E9167F 
19:10:20.060 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:20.063 > [ESP32] === HMAC DEBUG INFO ===
19:10:20.065 > [ESP32] HMAC Key being used: 6067E80EAB8C186688324646A32727A80D8DABF37B3B29E53080DEC7ADFDD8C4
19:10:20.074 > [ESP32] HMAC Input length: 45 bytes
19:10:20.076 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000018EB28F0628CAE2495516BE5B474BF3E20544DD
19:10:20.088 > [ESP32] Nonce: 0x00000001
19:10:20.088 > [ESP32] Packet size before HMAC: 61
19:10:20.092 > [ESP32] Computed HMAC Tag: 4052C8BBC51232233C22ACAB46543A00
19:10:20.096 > [ESP32] === END HMAC DEBUG ===
19:10:20.099 > 6_Final_Packet (61): 820218001800040804000000018EB28F 0628CAE2495516BE5B474BF3E20544DD ...
19:10:20.107 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:20.110 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:20.115 > Sending pipeline data to server (609 bytes)
19:10:20.464 > [HTTP] Response code: 400
19:10:20.465 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:20.470 > [HTTP] Request failed with code: 400
19:10:20.473 > [RETRY] Send failed, waiting 100 ms before retry
19:10:20.574 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:20.574 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:20.579 > Sending pipeline data to server (609 bytes)
19:10:20.731 > [HTTP] Response code: 400
19:10:20.731 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:20.736 > [HTTP] Request failed with code: 400
19:10:20.739 > [RETRY] Send failed, waiting 200 ms before retry
19:10:20.939 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:20.939 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:20.944 > Sending pipeline data to server (609 bytes)
19:10:21.219 > [HTTP] Response code: 400
19:10:21.219 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:21.224 > [HTTP] Request failed with code: 400
19:10:21.227 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:21.233 > [RETRY] Consecutive failures: 4
19:10:21.235 > Health data send failed (retry count: 3/3)
19:10:21.238 > Health data transmission failed after max retries
19:10:21.339 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":372129,"type":"health_data_error"}
19:10:21.353 > [WebSocket] Processing message type: health_data_error
19:10:21.358 > [375.8] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:21.366 > ERROR state - attempting recovery
19:10:21.369 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:21.374 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:21.377 > Generated health data: HR-66 SPO2-96 STEPS-1911
19:10:21.383 > [ESP32] ========================================
19:10:21.386 > [ESP32] ENCRYPTION PIPELINE START
19:10:21.388 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:21.394 > [ESP32] Active Algorithms for this packet:
19:10:21.399 > [ESP32]   + LFSR
19:10:21.399 > [ESP32]   + Tinkerbell
19:10:21.403 > [ESP32]   + Transposition
19:10:21.405 > [ESP32]   - ChaCha20
19:10:21.405 > [ESP32]   - Salsa20
19:10:21.408 > [ESP32] ========================================
19:10:21.413 > [ESP32] MsgKeys: lfsrSeed=0x2985EAAF tnk[0..3]=44B9BF0E trn[0..3]=ECBA9844
19:10:21.419 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313931314D50
19:10:21.425 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313931314D50000000000000 
19:10:21.433 > [ESP32][LFSR] Initializing - Seed: 0x2985EAAF SeedBe: 0xAFEA8529 ChaosKey[0..3]: 44B9BF0E InitialTap: 0x0029 State: 0x2985EAAF
19:10:21.444 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
19:10:21.453 > 3_After_LFSR (32): E7B8A81FFD8BB9831FD7DF6EFF8BD1F2 9B3BC6635C8A287EF360DD453E0862DC 
19:10:21.461 > [ESP32][LFSR] Keystream (first 16 bytes): AFEA8529CBABEAD350E5F257C9AB82A6
19:10:21.466 > [ESP32][4D] LFSR keystream (first 32 bytes): AFEA8529CBABEAD350E5F257C9AB82A6DE6B954E6DB3194FBE30DD453E0862DC
19:10:21.475 > [ESP32][TINKERBELL] Input (first 16 bytes): E7B8A81FFD8BB9831FD7DF6EFF8BD1F2 Nonce: 0x00000001 Buffer size: 32 bytes
19:10:21.485 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 44B9BF0E
19:10:21.497 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 71D03044B5C0F061225DFB2AFA562210
19:10:21.505 > 4_After_Tinkerbell (32): 9668985B484B49E23D8A244405DDF3E2 CA28065516BF76168EB28FED73E99D51 
19:10:21.514 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 71D03044B5C0F061225DFB2AFA562210
19:10:21.519 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 71D03044B5C0F061225DFB2AFA5622105113C0364A355E687DD252A84DE1FF8D
19:10:21.530 > 5_After_Transposition (32): 8EB28F0628CAE2495516BF5B484BF3E2 0544DD243D8A519D966898ED73E91676 
19:10:21.539 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:21.544 > [ESP32] === HMAC DEBUG INFO ===
19:10:21.547 > [ESP32] HMAC Key being used: 6067E80EAB8C186688324646A32727A80D8DABF37B3B29E53080DEC7ADFDD8C4
19:10:21.555 > [ESP32] HMAC Input length: 45 bytes
19:10:21.558 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000018EB28F0628CAE2495516BF5B484BF3E20544DD
19:10:21.566 > [ESP32] Nonce: 0x00000001
19:10:21.569 > [ESP32] Packet size before HMAC: 61
19:10:21.572 > [ESP32] Computed HMAC Tag: 7E20A3F4EF6345B1D50E57421C575967
19:10:21.577 > [ESP32] === END HMAC DEBUG ===
19:10:21.580 > 6_Final_Packet (61): 820218001800040804000000018EB28F 0628CAE2495516BF5B484BF3E20544DD ...
19:10:21.588 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:21.591 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:21.597 > Sending pipeline data to server (609 bytes)
19:10:21.986 > [HTTP] Response code: 400
19:10:21.986 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:21.992 > [HTTP] Request failed with code: 400
19:10:21.995 > [RETRY] Send failed, waiting 100 ms before retry
19:10:22.094 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:22.094 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:22.099 > Sending pipeline data to server (609 bytes)
19:10:22.438 > [HTTP] Response code: 400
19:10:22.438 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:22.444 > [HTTP] Request failed with code: 400
19:10:22.446 > [RETRY] Send failed, waiting 200 ms before retry
19:10:22.646 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:22.646 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:22.651 > Sending pipeline data to server (609 bytes)
19:10:22.973 > [HTTP] Response code: 400
19:10:22.974 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:22.979 > [HTTP] Request failed with code: 400
19:10:22.982 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:22.988 > [RETRY] Consecutive failures: 5
19:10:22.990 > [EMERGENCY] Triggering emergency reset!
19:10:22.994 > [CRYPTO] Resetting cryptographic state
19:10:22.999 > [CRYPTO] Crypto state reset complete
19:10:23.002 > [CRYPTO] Packet counter: 8
19:10:23.004 > [EMERGENCY] Emergency reset complete
19:10:23.008 > ✗ Auto-recovery failed - restarting key exchange
19:10:25.104 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":372620,"type":"health_data_error"}
19:10:25.118 > [WebSocket] Processing message type: health_data_error
19:10:25.124 > [379.5] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:25.132 > ✓ Public key loaded from NVS
19:10:25.231 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126018581,"threatLevel":0,"type":"heuristics_update"}
19:10:25.256 > [WebSocket] Processing message type: heuristics_update
19:10:25.262 > [379.7] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:25.364 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":373356,"type":"health_data_error"}
19:10:25.378 > [WebSocket] Processing message type: health_data_error
19:10:25.384 > [379.8] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:25.392 > Generating fresh master key from entropy...
19:10:25.400 > Generated master key (32): 114EAB3D3405A446BD12C1A199F8D077 1FEEB4CB6896373B915246D4AD186846 
19:10:25.407 > Using reduced master key (byte % 3) for NTRU encryption only
19:10:25.417 > NTRU encrypted master key (502): 0023006E001E0016007E001D00080063 00440077003A000E0000007600690070 ...
19:10:25.425 > POST http://10.249.92.115:8081/master-key
19:10:25.774 > ✓ Master key exchange completed
19:10:25.875 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":373615,"type":"health_data_error"}
19:10:25.889 > [WebSocket] Processing message type: health_data_error
19:10:25.895 > [380.3] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:25.903 > Loading master key from NVS and deriving symmetric keys...
19:10:25.909 > Loaded master key from NVS (32): 114EAB3D3405A446BD12C1A199F8D077 1FEEB4CB6896373B915246D4AD186846 
19:10:25.918 > Derived HMAC key (32): 3B71FC912B34FBC83D57D282B30349B8 8D25D08801350C897A4F23348396E95D 
19:10:25.926 > Derived Tinkerbell key (16): 4C70E40A11A25773DA5B79DF2835D757 
19:10:25.931 > Derived Transposition key (16): 1B8DA39EE8E15C68C6E14BAB4D9DAB65 
19:10:25.936 > ✓ Symmetric keys derived successfully
19:10:25.940 > Nonce tracker reset - new session started
19:10:26.436 > Waiting for server to process master key...
19:10:26.439 > ✓ Symmetric keys ready - starting health data transmission
19:10:26.541 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126019581,"threatLevel":0,"type":"heuristics_update"}
19:10:26.566 > [WebSocket] Processing message type: heuristics_update
19:10:26.572 > [381.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:26.674 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":374148,"type":"health_data_error"}
19:10:26.688 > [WebSocket] Processing message type: health_data_error
19:10:26.694 > [381.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:26.796 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":374879,"type":"health_data_error"}
19:10:26.810 > [WebSocket] Processing message type: health_data_error
19:10:26.816 > [381.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:26.918 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126020581,"threatLevel":0,"type":"heuristics_update"}
19:10:26.944 > [WebSocket] Processing message type: heuristics_update
19:10:26.949 > [381.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:27.054 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":375146,"type":"health_data_error"}
19:10:27.067 > [WebSocket] Processing message type: health_data_error
19:10:27.074 > [381.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:27.176 > [381.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:27.276 > [381.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:27.377 > [381.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:27.479 > [381.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:27.580 > [382.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:27.681 > [382.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:27.782 > [382.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:27.883 > [382.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:27.984 > [382.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:28.085 > [382.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:28.186 > [382.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:28.286 > [382.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:28.389 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":375633,"type":"health_data_error"}
19:10:28.402 > [WebSocket] Processing message type: health_data_error
19:10:28.408 > [382.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:28.511 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126021582,"threatLevel":0,"type":"heuristics_update"}
19:10:28.537 > [WebSocket] Processing message type: heuristics_update
19:10:28.542 > [382.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:28.644 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":376401,"type":"health_data_error"}
19:10:28.658 > [WebSocket] Processing message type: health_data_error
19:10:28.664 > [383.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:28.766 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":376853,"type":"health_data_error"}
19:10:28.780 > [WebSocket] Processing message type: health_data_error
19:10:28.786 > [383.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:28.888 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126022582,"threatLevel":0,"type":"heuristics_update"}
19:10:28.913 > [WebSocket] Processing message type: heuristics_update
19:10:28.919 > [383.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:29.021 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":377389,"type":"health_data_error"}
19:10:29.035 > [WebSocket] Processing message type: health_data_error
19:10:29.040 > [383.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:29.142 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126023583,"threatLevel":0,"type":"heuristics_update"}
19:10:29.168 > [WebSocket] Processing message type: heuristics_update
19:10:29.173 > [383.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:29.277 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126024584,"threatLevel":0,"type":"heuristics_update"}
19:10:29.302 > [WebSocket] Processing message type: heuristics_update
19:10:29.308 > [383.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:29.409 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770126025534,"type":"master_key_received"}
19:10:29.423 > [WebSocket] Processing message type: master_key_received
19:10:29.426 > [383.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:29.531 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126025585,"threatLevel":0,"type":"heuristics_update"}
19:10:29.556 > [WebSocket] Processing message type: heuristics_update
19:10:29.562 > [384.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:29.664 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":380182,"type":"master_key_exchanged"}
19:10:29.681 > [WebSocket] Processing message type: master_key_exchanged
19:10:29.686 > [384.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:29.786 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":380850,"type":"symmetric_keys_derived"}
19:10:29.804 > [WebSocket] Processing message type: symmetric_keys_derived
19:10:29.810 > [384.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:29.910 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126026586,"threatLevel":0,"type":"heuristics_update"}
19:10:29.935 > [WebSocket] Processing message type: heuristics_update
19:10:29.941 > [384.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.044 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126027587,"threatLevel":0,"type":"heuristics_update"}
19:10:30.069 > [WebSocket] Processing message type: heuristics_update
19:10:30.074 > [384.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.176 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126028588,"threatLevel":0,"type":"heuristics_update"}
19:10:30.201 > [WebSocket] Processing message type: heuristics_update
19:10:30.207 > [384.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.309 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126029589,"threatLevel":0,"type":"heuristics_update"}
19:10:30.333 > [WebSocket] Processing message type: heuristics_update
19:10:30.340 > [384.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.441 > [384.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.542 > [385.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.644 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126030590,"threatLevel":0,"type":"heuristics_update"}
19:10:30.670 > [WebSocket] Processing message type: heuristics_update
19:10:30.675 > [385.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.777 > [385.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.877 > [385.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.979 > [385.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.080 > [385.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.180 > [385.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.281 > [385.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.383 > [385.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.484 > [385.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.584 > [386.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.686 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126031590,"threatLevel":0,"type":"heuristics_update"}
19:10:31.711 > [WebSocket] Processing message type: heuristics_update
19:10:31.717 > [386.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.819 > [386.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.920 > [386.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.021 > [386.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.121 > [386.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.223 > [386.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.323 > [386.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.425 > [386.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.525 > [386.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.629 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126032590,"threatLevel":0,"type":"heuristics_update"}
19:10:32.654 > [WebSocket] Processing message type: heuristics_update
19:10:32.660 > [387.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.761 > [387.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.863 > [387.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.964 > [387.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.065 > [387.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.166 > [387.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.267 > [387.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.367 > [387.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.469 > [387.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.570 > [388.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.671 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126033591,"threatLevel":0,"type":"heuristics_update"}
19:10:33.696 > [WebSocket] Processing message type: heuristics_update
19:10:33.702 > [388.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.804 > [388.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.905 > [388.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.005 > [388.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.106 > [388.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.207 > [388.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.308 > [388.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.409 > [388.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.511 > [388.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.612 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126034591,"threatLevel":0,"type":"heuristics_update"}
19:10:34.638 > [WebSocket] Processing message type: heuristics_update
19:10:34.643 > [389.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.744 > [389.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.846 > [389.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.946 > [389.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.047 > [389.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.149 > [389.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.250 > [389.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.350 > [389.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.452 > [389.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.553 > [390.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.654 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126035592,"threatLevel":0,"type":"heuristics_update"}
19:10:35.680 > [WebSocket] Processing message type: heuristics_update
19:10:35.685 > [390.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.786 > [390.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.888 > [390.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.989 > [390.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.090 > [390.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.191 > [390.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.291 > [390.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.393 > [390.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.493 > [390.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.499 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:36.504 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:36.510 > Generated health data: HR-66 SPO2-96 STEPS-1998
19:10:36.513 > [ESP32] ========================================
19:10:36.519 > [ESP32] ENCRYPTION PIPELINE START
19:10:36.522 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:36.527 > [ESP32] Active Algorithms for this packet:
19:10:36.530 > [ESP32]   + LFSR
19:10:36.533 > [ESP32]   + Tinkerbell
19:10:36.535 > [ESP32]   + Transposition
19:10:36.535 > [ESP32]   - ChaCha20
19:10:36.538 > [ESP32]   - Salsa20
19:10:36.541 > [ESP32] ========================================
19:10:36.544 > [ESP32] MsgKeys: lfsrSeed=0xC42B5A2D tnk[0..3]=1C422297 trn[0..3]=60A33ABD
19:10:36.553 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313939384D50
19:10:36.557 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313939384D50000000000000 
19:10:36.566 > [ESP32][LFSR] Initializing - Seed: 0xC42B5A2D SeedBe: 0x2D5A2BC4 ChaosKey[0..3]: 1C422297 InitialTap: 0x0029 State: 0xC42B5A2D
19:10:36.577 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
19:10:36.585 > 3_After_LFSR (32): 650806F2F7A9900F4BD6DDEBF525587D D20CF8AD8FBAFFE89BC21862848C1E33 
19:10:36.591 > [ESP32][LFSR] Keystream (first 16 bytes): 2D5A2BC4C189C35F04E4F0D2C3050B29
19:10:36.600 > [ESP32][4D] LFSR keystream (first 32 bytes): 2D5A2BC4C189C35F04E4F0D2C3050B29975CAB80BE83C6D0D6921862848C1E33
19:10:36.608 > [ESP32][TINKERBELL] Input (first 16 bytes): 650806F2F7A9900F4BD6DDEBF525587D Nonce: 0x00000001 Buffer size: 32 bytes
19:10:36.619 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 1C422297
19:10:36.628 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 712B0B98631FBF8FB8B9FD036ADFF4BB
19:10:36.635 > 4_After_Tinkerbell (32): 14230D6A94B62F80F36F20E89FFAACC6 D46BD6DD56632AF4898A12D3B34CF59D 
19:10:36.644 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 712B0B98631FBF8FB8B9FD036ADFF4BB
19:10:36.653 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 712B0B98631FBF8FB8B9FD036ADFF4BB06672E70D9D9D51C12480AB137C0EBAE
19:10:36.663 > 5_After_Transposition (32): 14230D6AC6ACFA9FD38A128956632AF4 9DB34CF5802FB694D46BD6DDF3206FE8 
19:10:36.672 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:36.674 > [ESP32] === HMAC DEBUG INFO ===
19:10:36.677 > [ESP32] HMAC Key being used: 3B71FC912B34FBC83D57D282B30349B88D25D08801350C897A4F23348396E95D
19:10:36.686 > [ESP32] HMAC Input length: 45 bytes
19:10:36.689 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000114230D6AC6ACFA9FD38A128956632AF49DB34C
19:10:36.699 > [ESP32] Nonce: 0x00000001
19:10:36.699 > [ESP32] Packet size before HMAC: 61
19:10:36.705 > [ESP32] Computed HMAC Tag: 3E25C5538A011585B2E5223641DE16C2
19:10:36.708 > [ESP32] === END HMAC DEBUG ===
19:10:36.711 > 6_Final_Packet (61): 8202180018000408040000000114230D 6AC6ACFA9FD38A128956632AF49DB34C ...
19:10:36.719 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:36.722 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:36.727 > Sending pipeline data to server (609 bytes)
19:10:37.014 > [HTTP] Response code: 400
19:10:37.014 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:37.020 > [HTTP] Request failed with code: 400
19:10:37.023 > [RETRY] Send failed, waiting 100 ms before retry
19:10:37.121 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:37.122 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:37.126 > Sending pipeline data to server (609 bytes)
19:10:37.250 > [HTTP] Response code: 400
19:10:37.250 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:37.256 > [HTTP] Request failed with code: 400
19:10:37.259 > [RETRY] Send failed, waiting 200 ms before retry
19:10:37.457 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:37.457 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:37.462 > Sending pipeline data to server (609 bytes)
19:10:37.781 > [HTTP] Response code: 400
19:10:37.781 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:37.786 > [HTTP] Request failed with code: 400
19:10:37.790 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:37.795 > [RETRY] Consecutive failures: 1
19:10:37.797 > Health data send failed (retry count: 1/3)
19:10:37.903 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126036592,"threatLevel":0,"type":"heuristics_update"}
19:10:37.927 > [WebSocket] Processing message type: heuristics_update
19:10:37.934 > [392.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:37.939 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:37.945 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:37.950 > Generated health data: HR-66 SPO2-96 STEPS-1988
19:10:37.953 > [ESP32] ========================================
19:10:37.959 > [ESP32] ENCRYPTION PIPELINE START
19:10:37.961 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:37.967 > [ESP32] Active Algorithms for this packet:
19:10:37.970 > [ESP32]   + LFSR
19:10:37.973 > [ESP32]   + Tinkerbell
19:10:37.975 > [ESP32]   + Transposition
19:10:37.975 > [ESP32]   - ChaCha20
19:10:37.978 > [ESP32]   - Salsa20
19:10:37.981 > [ESP32] ========================================
19:10:37.984 > [ESP32] MsgKeys: lfsrSeed=0xC42B5A2D tnk[0..3]=1C422297 trn[0..3]=60A33ABD
19:10:37.992 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313938384D50
19:10:37.998 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313938384D50000000000000 
19:10:38.006 > [ESP32][LFSR] Initializing - Seed: 0xC42B5A2D SeedBe: 0x2D5A2BC4 ChaosKey[0..3]: 1C422297 InitialTap: 0x0029 State: 0xC42B5A2D
19:10:38.017 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
19:10:38.025 > 3_After_LFSR (32): 650806F2F7A9900F4BD6DDEBF525587D D20CF8AD8FBAFEE89BC21862848C1E33 
19:10:38.031 > [ESP32][LFSR] Keystream (first 16 bytes): 2D5A2BC4C189C35F04E4F0D2C3050B29
19:10:38.040 > [ESP32][4D] LFSR keystream (first 32 bytes): 2D5A2BC4C189C35F04E4F0D2C3050B29975CAB80BE83C6D0D6921862848C1E33
19:10:38.047 > [ESP32][TINKERBELL] Input (first 16 bytes): 650806F2F7A9900F4BD6DDEBF525587D Nonce: 0x00000001 Buffer size: 32 bytes
19:10:38.059 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 1C422297
19:10:38.067 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 712B0B98631FBF8FB8B9FD036ADFF4BB
19:10:38.075 > 4_After_Tinkerbell (32): 14230D6A94B62F80F36F20E89FFAACC6 D46BD6DD56632BF4898A12D3B34CF59D 
19:10:38.083 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 712B0B98631FBF8FB8B9FD036ADFF4BB
19:10:38.092 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 712B0B98631FBF8FB8B9FD036ADFF4BB06672E70D9D9D51C12480AB137C0EBAE
19:10:38.104 > 5_After_Transposition (32): 14230D6AC6ACFA9FD38A128956632BF4 9DB34CF5802FB694D46BD6DDF3206FE8 
19:10:38.111 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:38.114 > [ESP32] === HMAC DEBUG INFO ===
19:10:38.117 > [ESP32] HMAC Key being used: 3B71FC912B34FBC83D57D282B30349B88D25D08801350C897A4F23348396E95D
19:10:38.125 > [ESP32] HMAC Input length: 45 bytes
19:10:38.128 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000114230D6AC6ACFA9FD38A128956632BF49DB34C
19:10:38.139 > [ESP32] Nonce: 0x00000001
19:10:38.139 > [ESP32] Packet size before HMAC: 61
19:10:38.145 > [ESP32] Computed HMAC Tag: 2DCB2AD115015F417766EE8C51583ECA
19:10:38.147 > [ESP32] === END HMAC DEBUG ===
19:10:38.150 > 6_Final_Packet (61): 8202180018000408040000000114230D 6AC6ACFA9FD38A128956632BF49DB34C ...
19:10:38.159 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:38.161 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:38.167 > Sending pipeline data to server (609 bytes)
19:10:38.507 > [HTTP] Response code: 400
19:10:38.507 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:38.512 > [HTTP] Request failed with code: 400
19:10:38.515 > [RETRY] Send failed, waiting 100 ms before retry
19:10:38.615 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:38.615 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:38.620 > Sending pipeline data to server (609 bytes)
19:10:39.011 > [HTTP] Response code: 400
19:10:39.011 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:39.017 > [HTTP] Request failed with code: 400
19:10:39.020 > [RETRY] Send failed, waiting 200 ms before retry
19:10:39.220 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:39.220 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:39.225 > Sending pipeline data to server (609 bytes)
19:10:39.539 > [HTTP] Response code: 400
19:10:39.539 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:39.544 > [HTTP] Request failed with code: 400
19:10:39.547 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:39.552 > [RETRY] Consecutive failures: 2
19:10:39.555 > Health data send failed (retry count: 2/3)
19:10:39.657 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":391430,"type":"health_data_error"}
19:10:39.671 > [WebSocket] Processing message type: health_data_error
19:10:39.676 > [394.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:39.685 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:39.690 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:39.696 > Generated health data: HR-66 SPO2-96 STEPS-2002
19:10:39.699 > [ESP32] ========================================
19:10:39.704 > [ESP32] ENCRYPTION PIPELINE START
19:10:39.708 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:39.713 > [ESP32] Active Algorithms for this packet:
19:10:39.715 > [ESP32]   + LFSR
19:10:39.715 > [ESP32]   + Tinkerbell
19:10:39.719 > [ESP32]   + Transposition
19:10:39.721 > [ESP32]   - ChaCha20
19:10:39.724 > [ESP32]   - Salsa20
19:10:39.724 > [ESP32] ========================================
19:10:39.729 > [ESP32] MsgKeys: lfsrSeed=0xC42B5A2D tnk[0..3]=1C422297 trn[0..3]=60A33ABD
19:10:39.735 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D323030324D50
19:10:39.741 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D323030324D50000000000000 
19:10:39.749 > [ESP32][LFSR] Initializing - Seed: 0xC42B5A2D SeedBe: 0x2D5A2BC4 ChaosKey[0..3]: 1C422297 InitialTap: 0x0029 State: 0xC42B5A2D
19:10:39.760 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
19:10:39.769 > 3_After_LFSR (32): 650806F2F7A9900F4BD6DDEBF525587D D20CF8AD8CB3F6E29BC21862848C1E33 
19:10:39.776 > [ESP32][LFSR] Keystream (first 16 bytes): 2D5A2BC4C189C35F04E4F0D2C3050B29
19:10:39.782 > [ESP32][4D] LFSR keystream (first 32 bytes): 2D5A2BC4C189C35F04E4F0D2C3050B29975CAB80BE83C6D0D6921862848C1E33
19:10:39.793 > [ESP32][TINKERBELL] Input (first 16 bytes): 650806F2F7A9900F4BD6DDEBF525587D Nonce: 0x00000001 Buffer size: 32 bytes
19:10:39.802 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 1C422297
19:10:39.813 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 712B0B98631FBF8FB8B9FD036ADFF4BB
19:10:39.821 > 4_After_Tinkerbell (32): 14230D6A94B62F80F36F20E89FFAACC6 D46BD6DD556A23FE898A12D3B34CF59D 
19:10:39.829 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 712B0B98631FBF8FB8B9FD036ADFF4BB
19:10:39.838 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 712B0B98631FBF8FB8B9FD036ADFF4BB06672E70D9D9D51C12480AB137C0EBAE
19:10:39.846 > 5_After_Transposition (32): 14230D6AC6ACFA9FD38A1289556A23FE 9DB34CF5802FB694D46BD6DDF3206FE8 
19:10:39.854 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:39.860 > [ESP32] === HMAC DEBUG INFO ===
19:10:39.863 > [ESP32] HMAC Key being used: 3B71FC912B34FBC83D57D282B30349B88D25D08801350C897A4F23348396E95D
19:10:39.871 > [ESP32] HMAC Input length: 45 bytes
19:10:39.874 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000114230D6AC6ACFA9FD38A1289556A23FE9DB34C
19:10:39.882 > [ESP32] Nonce: 0x00000001
19:10:39.885 > [ESP32] Packet size before HMAC: 61
19:10:39.888 > [ESP32] Computed HMAC Tag: 95289A8D96F2DF0A268E1732138E5963
19:10:39.893 > [ESP32] === END HMAC DEBUG ===
19:10:39.895 > 6_Final_Packet (61): 8202180018000408040000000114230D 6AC6ACFA9FD38A1289556A23FE9DB34C ...
19:10:39.905 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:39.907 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:39.912 > Sending pipeline data to server (609 bytes)
19:10:40.272 > [HTTP] Response code: 400
19:10:40.272 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:40.277 > [HTTP] Request failed with code: 400
19:10:40.280 > [RETRY] Send failed, waiting 100 ms before retry
19:10:40.380 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:40.380 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:40.386 > Sending pipeline data to server (609 bytes)
19:10:40.529 > [HTTP] Response code: 400
19:10:40.529 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:40.534 > [HTTP] Request failed with code: 400
19:10:40.536 > [RETRY] Send failed, waiting 200 ms before retry
19:10:40.737 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:40.737 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:40.743 > Sending pipeline data to server (609 bytes)
19:10:41.030 > [HTTP] Response code: 400
19:10:41.031 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:41.036 > [HTTP] Request failed with code: 400
19:10:41.039 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:41.044 > [RETRY] Consecutive failures: 3
19:10:41.047 > Health data send failed (retry count: 3/3)
19:10:41.049 > Health data transmission failed after max retries
19:10:41.150 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":391665,"type":"health_data_error"}
19:10:41.164 > [WebSocket] Processing message type: health_data_error
19:10:41.170 > [395.6] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:41.178 > ERROR state - attempting recovery
19:10:41.181 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:41.186 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:41.189 > Generated health data: HR-66 SPO2-96 STEPS-1995
19:10:41.194 > [ESP32] ========================================
19:10:41.197 > [ESP32] ENCRYPTION PIPELINE START
19:10:41.200 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:41.205 > [ESP32] Active Algorithms for this packet:
19:10:41.211 > [ESP32]   + LFSR
19:10:41.211 > [ESP32]   + Tinkerbell
19:10:41.214 > [ESP32]   + Transposition
19:10:41.217 > [ESP32]   - ChaCha20
19:10:41.217 > [ESP32]   - Salsa20
19:10:41.220 > [ESP32] ========================================
19:10:41.225 > [ESP32] MsgKeys: lfsrSeed=0xC42B5A2D tnk[0..3]=1C422297 trn[0..3]=60A33ABD
19:10:41.231 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313939354D50
19:10:41.236 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313939354D50000000000000 
19:10:41.245 > [ESP32][LFSR] Initializing - Seed: 0xC42B5A2D SeedBe: 0x2D5A2BC4 ChaosKey[0..3]: 1C422297 InitialTap: 0x0029 State: 0xC42B5A2D
19:10:41.255 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
19:10:41.264 > 3_After_LFSR (32): 650806F2F7A9900F4BD6DDEBF525587D D20CF8AD8FBAFFE59BC21862848C1E33 
19:10:41.273 > [ESP32][LFSR] Keystream (first 16 bytes): 2D5A2BC4C189C35F04E4F0D2C3050B29
19:10:41.278 > [ESP32][4D] LFSR keystream (first 32 bytes): 2D5A2BC4C189C35F04E4F0D2C3050B29975CAB80BE83C6D0D6921862848C1E33
19:10:41.286 > [ESP32][TINKERBELL] Input (first 16 bytes): 650806F2F7A9900F4BD6DDEBF525587D Nonce: 0x00000001 Buffer size: 32 bytes
19:10:41.297 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 1C422297
19:10:41.309 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 712B0B98631FBF8FB8B9FD036ADFF4BB
19:10:41.316 > 4_After_Tinkerbell (32): 14230D6A94B62F80F36F20E89FFAACC6 D46BD6DD56632AF9898A12D3B34CF59D 
19:10:41.325 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 712B0B98631FBF8FB8B9FD036ADFF4BB
19:10:41.331 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 712B0B98631FBF8FB8B9FD036ADFF4BB06672E70D9D9D51C12480AB137C0EBAE
19:10:41.342 > 5_After_Transposition (32): 14230D6AC6ACFA9FD38A128956632AF9 9DB34CF5802FB694D46BD6DDF3206FE8 
19:10:41.350 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:41.355 > [ESP32] === HMAC DEBUG INFO ===
19:10:41.358 > [ESP32] HMAC Key being used: 3B71FC912B34FBC83D57D282B30349B88D25D08801350C897A4F23348396E95D
19:10:41.367 > [ESP32] HMAC Input length: 45 bytes
19:10:41.370 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000114230D6AC6ACFA9FD38A128956632AF99DB34C
19:10:41.377 > [ESP32] Nonce: 0x00000001
19:10:41.380 > [ESP32] Packet size before HMAC: 61
19:10:41.383 > [ESP32] Computed HMAC Tag: 54CC35DAF73D342D11FFF44777E21F3E
19:10:41.389 > [ESP32] === END HMAC DEBUG ===
19:10:41.392 > 6_Final_Packet (61): 8202180018000408040000000114230D 6AC6ACFA9FD38A128956632AF99DB34C ...
19:10:41.400 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:41.403 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:41.409 > Sending pipeline data to server (609 bytes)
19:10:41.786 > [HTTP] Response code: 400
19:10:41.786 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:41.792 > [HTTP] Request failed with code: 400
19:10:41.795 > [RETRY] Send failed, waiting 100 ms before retry
19:10:41.895 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:41.896 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:41.900 > Sending pipeline data to server (609 bytes)
19:10:42.054 > [HTTP] Response code: 400
19:10:42.054 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:42.060 > [HTTP] Request failed with code: 400
19:10:42.062 > [RETRY] Send failed, waiting 200 ms before retry
19:10:42.262 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:42.262 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:42.267 > Sending pipeline data to server (609 bytes)
19:10:42.549 > [HTTP] Response code: 400
19:10:42.549 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:42.554 > [HTTP] Request failed with code: 400
19:10:42.557 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:42.563 > [RETRY] Consecutive failures: 4
19:10:42.566 > ✗ Auto-recovery failed - restarting key exchange
19:10:44.669 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126037593,"threatLevel":0,"type":"heuristics_update"}
19:10:44.694 > [WebSocket] Processing message type: heuristics_update
19:10:44.699 > [399.1] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:44.709 > ✓ Public key loaded from NVS
19:10:44.806 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":392196,"type":"health_data_error"}
19:10:44.820 > [WebSocket] Processing message type: health_data_error
19:10:44.825 > [399.2] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:44.930 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":392922,"type":"health_data_error"}
19:10:44.944 > [WebSocket] Processing message type: health_data_error
19:10:44.949 > [399.4] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:44.957 > Generating fresh master key from entropy...
19:10:44.967 > Generated master key (32): 1770C219B63B5AB4A205BCBC13E4B24B 46B15DC2D3C88211AA1432527DA3E471 
19:10:44.972 > Using reduced master key (byte % 3) for NTRU encryption only
19:10:44.982 > NTRU encrypted master key (502): 0023006F00200016007F001D00060062 00440079003B000E000100740069006E ...
19:10:44.991 > POST http://10.249.92.115:8081/master-key
19:10:45.307 > ✓ Master key exchange completed
19:10:45.409 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126038594,"threatLevel":0,"type":"heuristics_update"}
19:10:45.435 > [WebSocket] Processing message type: heuristics_update
19:10:45.440 > [399.8] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:45.445 > Loading master key from NVS and deriving symmetric keys...
19:10:45.451 > Loaded master key from NVS (32): 1770C219B63B5AB4A205BCBC13E4B24B 46B15DC2D3C88211AA1432527DA3E471 
19:10:45.516 > Derived HMAC key (32): 39DAB9A5A5D76B1D48DEC64EA6E6DFBD 1914F461FB05B920E29000DBA563343E 
19:10:45.516 > Derived Tinkerbell key (16): 545BB0BED98EF0E34DCE86079A2B22B8 
19:10:45.516 > Derived Transposition key (16): B224885B5D976375EE8AC1D11D883BD0 
19:10:45.516 > ✓ Symmetric keys derived successfully
19:10:45.516 > Nonce tracker reset - new session started
19:10:45.979 > Waiting for server to process master key...
19:10:45.982 > ✓ Symmetric keys ready - starting health data transmission
19:10:46.085 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":393426,"type":"health_data_error"}
19:10:46.098 > [WebSocket] Processing message type: health_data_error
19:10:46.104 > [400.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:46.208 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":393954,"type":"health_data_error"}
19:10:46.221 > [WebSocket] Processing message type: health_data_error
19:10:46.227 > [400.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:46.330 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126039594,"threatLevel":0,"type":"heuristics_update"}
19:10:46.355 > [WebSocket] Processing message type: heuristics_update
19:10:46.361 > [400.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:46.462 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":394687,"type":"health_data_error"}
19:10:46.477 > [WebSocket] Processing message type: health_data_error
19:10:46.482 > [400.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:46.584 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":394944,"type":"health_data_error"}
19:10:46.599 > [WebSocket] Processing message type: health_data_error
19:10:46.604 > [401.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:46.710 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126040595,"threatLevel":0,"type":"heuristics_update"}
19:10:46.735 > [WebSocket] Processing message type: heuristics_update
19:10:46.741 > [401.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:46.842 > [401.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:46.942 > [401.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:47.045 > [401.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:47.145 > [401.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:47.247 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":395446,"type":"health_data_error"}
19:10:47.261 > [WebSocket] Processing message type: health_data_error
19:10:47.266 > [401.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:47.370 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126041596,"threatLevel":0,"type":"heuristics_update"}
19:10:47.395 > [WebSocket] Processing message type: heuristics_update
19:10:47.400 > [401.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:47.503 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":396202,"type":"health_data_error"}
19:10:47.517 > [WebSocket] Processing message type: health_data_error
19:10:47.523 > [401.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:47.625 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":396469,"type":"health_data_error"}
19:10:47.640 > [WebSocket] Processing message type: health_data_error
19:10:47.645 > [402.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:47.747 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":396964,"type":"health_data_error"}
19:10:47.762 > [WebSocket] Processing message type: health_data_error
19:10:47.767 > [402.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:47.869 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126042597,"threatLevel":0,"type":"heuristics_update"}
19:10:47.895 > [WebSocket] Processing message type: heuristics_update
19:10:47.900 > [402.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:48.003 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126043597,"threatLevel":0,"type":"heuristics_update"}
19:10:48.027 > [WebSocket] Processing message type: heuristics_update
19:10:48.033 > [402.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:48.136 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126044598,"threatLevel":0,"type":"heuristics_update"}
19:10:48.161 > [WebSocket] Processing message type: heuristics_update
19:10:48.167 > [402.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:48.269 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770126045105,"type":"master_key_received"}
19:10:48.282 > [WebSocket] Processing message type: master_key_received
19:10:48.285 > [402.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:48.391 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":399716,"type":"master_key_exchanged"}
19:10:48.407 > [WebSocket] Processing message type: master_key_exchanged
19:10:48.413 > [402.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:48.513 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126045605,"threatLevel":0,"type":"heuristics_update"}
19:10:48.538 > [WebSocket] Processing message type: heuristics_update
19:10:48.543 > [402.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:48.646 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":400394,"type":"symmetric_keys_derived"}
19:10:48.663 > [WebSocket] Processing message type: symmetric_keys_derived
19:10:48.668 > [403.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:48.767 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126046606,"threatLevel":0,"type":"heuristics_update"}
19:10:48.792 > [WebSocket] Processing message type: heuristics_update
19:10:48.798 > [403.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:48.901 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126047607,"threatLevel":0,"type":"heuristics_update"}
19:10:48.926 > [WebSocket] Processing message type: heuristics_update
19:10:48.933 > [403.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:49.034 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126048608,"threatLevel":0,"type":"heuristics_update"}
19:10:49.059 > [WebSocket] Processing message type: heuristics_update
19:10:49.064 > [403.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:49.166 > [403.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:49.267 > [403.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:49.368 > [403.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:49.469 > [403.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:49.570 > [404.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:49.672 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126049608,"threatLevel":0,"type":"heuristics_update"}
19:10:49.697 > [WebSocket] Processing message type: heuristics_update
19:10:49.703 > [404.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:49.804 > [404.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:49.905 > [404.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:50.006 > [404.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:50.107 > [404.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:50.208 > [404.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:50.309 > [404.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:50.410 > [404.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:50.511 > [404.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:50.612 > [405.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:50.713 > [405.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:50.814 > [405.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:50.916 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126050609,"threatLevel":0,"type":"heuristics_update"}
19:10:50.941 > [WebSocket] Processing message type: heuristics_update
19:10:50.947 > [405.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:51.048 > [405.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:51.149 > [405.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:51.250 > [405.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:51.351 > [405.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:51.451 > [405.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:51.553 > [406.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:51.655 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126051612,"threatLevel":0,"type":"heuristics_update"}
19:10:51.680 > [WebSocket] Processing message type: heuristics_update
19:10:51.686 > [406.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:51.788 > [406.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:51.888 > [406.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:51.989 > [406.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:52.090 > [406.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:52.191 > [406.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:52.292 > [406.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:52.392 > [406.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:52.494 > [406.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:52.595 > [407.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:52.699 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126052612,"threatLevel":0,"type":"heuristics_update"}
19:10:52.724 > [WebSocket] Processing message type: heuristics_update
19:10:52.730 > [407.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:52.831 > [407.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:52.932 > [407.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:53.033 > [407.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:53.134 > [407.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:53.235 > [407.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:53.336 > [407.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:53.437 > [407.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:53.538 > [408.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:53.639 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126053612,"threatLevel":0,"type":"heuristics_update"}
19:10:53.665 > [WebSocket] Processing message type: heuristics_update
19:10:53.670 > [408.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:53.772 > [408.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:53.873 > [408.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:53.974 > [408.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:54.074 > [408.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:54.176 > [408.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:54.277 > [408.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:54.378 > [408.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:54.479 > [408.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:54.580 > [409.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:54.682 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126054613,"threatLevel":0,"type":"heuristics_update"}
19:10:54.707 > [WebSocket] Processing message type: heuristics_update
19:10:54.712 > [409.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:54.814 > [409.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:54.915 > [409.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:55.015 > [409.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:55.117 > [409.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:55.217 > [409.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:55.319 > [409.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:55.420 > [409.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:55.521 > [409.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:55.622 > [410.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:55.724 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126055614,"threatLevel":0,"type":"heuristics_update"}
19:10:55.751 > [WebSocket] Processing message type: heuristics_update
19:10:55.754 > [410.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:55.856 > [410.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:55.956 > [410.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:56.058 > [410.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:56.064 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:56.070 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:56.075 > Generated health data: HR-66 SPO2-96 STEPS-2073
19:10:56.078 > [ESP32] ========================================
19:10:56.083 > [ESP32] ENCRYPTION PIPELINE START
19:10:56.085 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:56.091 > [ESP32] Active Algorithms for this packet:
19:10:56.096 > [ESP32]   + LFSR
19:10:56.099 > [ESP32]   + Tinkerbell
19:10:56.103 > [ESP32]   + Transposition
19:10:56.103 > [ESP32]   - ChaCha20
19:10:56.103 > [ESP32]   - Salsa20
19:10:56.106 > [ESP32] ========================================
19:10:56.109 > [ESP32] MsgKeys: lfsrSeed=0xE9079067 tnk[0..3]=E4B3D081 trn[0..3]=ED10F1CB
19:10:56.118 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D323037334D50
19:10:56.122 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D323037334D50000000000000 
19:10:56.130 > [ESP32][LFSR] Initializing - Seed: 0xE9079067 SeedBe: 0x679007E9 ChaosKey[0..3]: E4B3D081 InitialTap: 0x0029 State: 0xE9079067
19:10:56.142 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
19:10:56.150 > 3_After_LFSR (32): 2FC22ADFDB5F38CD37A159F69DAB0FE0 D7E3682AE38BE2F00D89F2D87DA719CC 
19:10:56.156 > [ESP32][LFSR] Keystream (first 16 bytes): 679007E9ED7F6B9D789374CFAB8B5CB4
19:10:56.166 > [ESP32][4D] LFSR keystream (first 32 bytes): 679007E9ED7F6B9D789374CFAB8B5CB492B33B07D1BBD5C340D9F2D87DA719CC
19:10:56.178 > [ESP32][TINKERBELL] Input (first 16 bytes): 2FC22ADFDB5F38CD37A159F69DAB0FE0 Nonce: 0x00000001 Buffer size: 32 bytes
19:10:56.185 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: E4B3D081
19:10:56.192 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FF3C0FAF34D36A1DA03D38F672E386E8
19:10:56.200 > 4_After_Tinkerbell (32): D0FE2570EF8C52D0979C6100EF488908 F20A4637AB78C0E57B41AA4E2A9F06DE 
19:10:56.209 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FF3C0FAF34D36A1DA03D38F672E386E8
19:10:56.217 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FF3C0FAF34D36A1DA03D38F672E386E825E92E1D48F3221576C8589657381F12
19:10:56.228 > 5_After_Transposition (32): 78F28C61EFAA70C09F7B4825EF460006 FE0A4EE5D097AB529C4137DE08D02A89 
19:10:56.236 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:56.239 > [ESP32] === HMAC DEBUG INFO ===
19:10:56.241 > [ESP32] HMAC Key being used: 39DAB9A5A5D76B1D48DEC64EA6E6DFBD1914F461FB05B920E29000DBA563343E
19:10:56.250 > [ESP32] HMAC Input length: 45 bytes
19:10:56.262 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000178F28C61EFAA70C09F7B4825EF460006FE0A4E
19:10:56.264 > [ESP32] Nonce: 0x00000001
19:10:56.264 > [ESP32] Packet size before HMAC: 61
19:10:56.271 > [ESP32] Computed HMAC Tag: A67A42C016C2B737EB5E31259BCA03EB
19:10:56.272 > [ESP32] === END HMAC DEBUG ===
19:10:56.277 > 6_Final_Packet (61): 8202180018000408040000000178F28C 61EFAA70C09F7B4825EF460006FE0A4E ...
19:10:56.284 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:56.288 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:56.291 > Sending pipeline data to server (609 bytes)
19:10:56.555 > [HTTP] Response code: 400
19:10:56.556 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:56.561 > [HTTP] Request failed with code: 400
19:10:56.564 > [RETRY] Send failed, waiting 100 ms before retry
19:10:56.662 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:56.663 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:56.668 > Sending pipeline data to server (609 bytes)
19:10:56.817 > [HTTP] Response code: 400
19:10:56.817 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:56.823 > [HTTP] Request failed with code: 400
19:10:56.826 > [RETRY] Send failed, waiting 200 ms before retry
19:10:57.027 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:57.027 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:57.033 > Sending pipeline data to server (609 bytes)
19:10:57.313 > [HTTP] Response code: 400
19:10:57.313 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:57.318 > [HTTP] Request failed with code: 400
19:10:57.321 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:57.327 > [RETRY] Consecutive failures: 5
19:10:57.329 > [EMERGENCY] Triggering emergency reset!
19:10:57.332 > [CRYPTO] Resetting cryptographic state
19:10:57.338 > [CRYPTO] Crypto state reset complete
19:10:57.340 > [CRYPTO] Packet counter: 9
19:10:57.343 > [EMERGENCY] Emergency reset complete
19:10:57.346 > Health data send failed (retry count: 1/3)
19:10:57.445 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":410971,"type":"health_data_error"}
19:10:57.459 > [WebSocket] Processing message type: health_data_error
19:10:57.465 > [411.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:57.472 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:57.479 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:57.484 > Generated health data: HR-66 SPO2-96 STEPS-2095
19:10:57.486 > [ESP32] ========================================
19:10:57.492 > [ESP32] ENCRYPTION PIPELINE START
19:10:57.495 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:57.500 > [ESP32] Active Algorithms for this packet:
19:10:57.504 > [ESP32]   + LFSR
19:10:57.504 > [ESP32]   + Tinkerbell
19:10:57.506 > [ESP32]   + Transposition
19:10:57.509 > [ESP32]   - ChaCha20
19:10:57.511 > [ESP32]   - Salsa20
19:10:57.511 > [ESP32] ========================================
19:10:57.517 > [ESP32] MsgKeys: lfsrSeed=0xE9079067 tnk[0..3]=E4B3D081 trn[0..3]=ED10F1CB
19:10:57.523 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D323039354D50
19:10:57.529 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D323039354D50000000000000 
19:10:57.536 > [ESP32][LFSR] Initializing - Seed: 0xE9079067 SeedBe: 0x679007E9 ChaosKey[0..3]: E4B3D081 InitialTap: 0x0029 State: 0xE9079067
19:10:57.548 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
19:10:57.556 > 3_After_LFSR (32): 2FC22ADFDB5F38CD37A159F69DAB0FE0 D7E3682AE38BECF60D89F2D87DA719CC 
19:10:57.564 > [ESP32][LFSR] Keystream (first 16 bytes): 679007E9ED7F6B9D789374CFAB8B5CB4
19:10:57.569 > [ESP32][4D] LFSR keystream (first 32 bytes): 679007E9ED7F6B9D789374CFAB8B5CB492B33B07D1BBD5C340D9F2D87DA719CC
19:10:57.581 > [ESP32][TINKERBELL] Input (first 16 bytes): 2FC22ADFDB5F38CD37A159F69DAB0FE0 Nonce: 0x00000001 Buffer size: 32 bytes
19:10:57.590 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: E4B3D081
19:10:57.601 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FF3C0FAF34D36A1DA03D38F672E386E8
19:10:57.609 > 4_After_Tinkerbell (32): D0FE2570EF8C52D0979C6100EF488908 F20A4637AB78CEE37B41AA4E2A9F06DE 
19:10:57.617 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FF3C0FAF34D36A1DA03D38F672E386E8
19:10:57.626 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FF3C0FAF34D36A1DA03D38F672E386E825E92E1D48F3221576C8589657381F12
19:10:57.633 > 5_After_Transposition (32): 78F28C61EFAA70CE9F7B4825EF460006 FE0A4EE3D097AB529C4137DE08D02A89 
19:10:57.643 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:57.648 > [ESP32] === HMAC DEBUG INFO ===
19:10:57.650 > [ESP32] HMAC Key being used: 39DAB9A5A5D76B1D48DEC64EA6E6DFBD1914F461FB05B920E29000DBA563343E
19:10:57.659 > [ESP32] HMAC Input length: 45 bytes
19:10:57.662 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000178F28C61EFAA70CE9F7B4825EF460006FE0A4E
19:10:57.671 > [ESP32] Nonce: 0x00000001
19:10:57.673 > [ESP32] Packet size before HMAC: 61
19:10:57.676 > [ESP32] Computed HMAC Tag: 3F00EBB15CE07D88E7BE9D95D484B1D1
19:10:57.681 > [ESP32] === END HMAC DEBUG ===
19:10:57.684 > 6_Final_Packet (61): 8202180018000408040000000178F28C 61EFAA70CE9F7B4825EF460006FE0A4E ...
19:10:57.692 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:57.695 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:57.701 > Sending pipeline data to server (609 bytes)
19:10:57.813 > [HTTP] Response code: 400
19:10:57.814 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:57.819 > [HTTP] Request failed with code: 400
19:10:57.822 > [RETRY] Send failed, waiting 100 ms before retry
19:10:57.921 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:57.922 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:57.928 > Sending pipeline data to server (609 bytes)
19:10:58.081 > [HTTP] Response code: 400
19:10:58.081 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:58.086 > [HTTP] Request failed with code: 400
19:10:58.090 > [RETRY] Send failed, waiting 200 ms before retry
19:10:58.289 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:58.289 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:58.294 > Sending pipeline data to server (609 bytes)
19:10:58.573 > [HTTP] Response code: 400
19:10:58.574 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:58.579 > [HTTP] Request failed with code: 400
19:10:58.582 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:10:58.588 > [RETRY] Consecutive failures: 1
19:10:58.590 > Health data send failed (retry count: 2/3)
19:10:58.694 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126056614,"threatLevel":0,"type":"heuristics_update"}
19:10:58.718 > [WebSocket] Processing message type: heuristics_update
19:10:58.724 > [413.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:58.730 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:58.735 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:10:58.741 > Generated health data: HR-66 SPO2-96 STEPS-2086
19:10:58.744 > [ESP32] ========================================
19:10:58.749 > [ESP32] ENCRYPTION PIPELINE START
19:10:58.752 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:58.757 > [ESP32] Active Algorithms for this packet:
19:10:58.760 > [ESP32]   + LFSR
19:10:58.762 > [ESP32]   + Tinkerbell
19:10:58.765 > [ESP32]   + Transposition
19:10:58.765 > [ESP32]   - ChaCha20
19:10:58.768 > [ESP32]   - Salsa20
19:10:58.771 > [ESP32] ========================================
19:10:58.774 > [ESP32] MsgKeys: lfsrSeed=0xE9079067 tnk[0..3]=E4B3D081 trn[0..3]=ED10F1CB
19:10:58.782 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D323038364D50
19:10:58.788 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D323038364D50000000000000 
19:10:58.796 > [ESP32][LFSR] Initializing - Seed: 0xE9079067 SeedBe: 0x679007E9 ChaosKey[0..3]: E4B3D081 InitialTap: 0x0029 State: 0xE9079067
19:10:58.807 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
19:10:58.816 > 3_After_LFSR (32): 2FC22ADFDB5F38CD37A159F69DAB0FE0 D7E3682AE38BEDF50D89F2D87DA719CC 
19:10:58.821 > [ESP32][LFSR] Keystream (first 16 bytes): 679007E9ED7F6B9D789374CFAB8B5CB4
19:10:58.830 > [ESP32][4D] LFSR keystream (first 32 bytes): 679007E9ED7F6B9D789374CFAB8B5CB492B33B07D1BBD5C340D9F2D87DA719CC
19:10:58.838 > [ESP32][TINKERBELL] Input (first 16 bytes): 2FC22ADFDB5F38CD37A159F69DAB0FE0 Nonce: 0x00000001 Buffer size: 32 bytes
19:10:58.849 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: E4B3D081
19:10:58.858 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FF3C0FAF34D36A1DA03D38F672E386E8
19:10:58.866 > 4_After_Tinkerbell (32): D0FE2570EF8C52D0979C6100EF488908 F20A4637AB78CFE07B41AA4E2A9F06DE 
19:10:58.874 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FF3C0FAF34D36A1DA03D38F672E386E8
19:10:58.882 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FF3C0FAF34D36A1DA03D38F672E386E825E92E1D48F3221576C8589657381F12
19:10:58.893 > 5_After_Transposition (32): 78F28C61EFAA70CF9F7B4825EF460006 FE0A4EE0D097AB529C4137DE08D02A89 
19:10:58.902 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:10:58.904 > [ESP32] === HMAC DEBUG INFO ===
19:10:58.908 > [ESP32] HMAC Key being used: 39DAB9A5A5D76B1D48DEC64EA6E6DFBD1914F461FB05B920E29000DBA563343E
19:10:58.916 > [ESP32] HMAC Input length: 45 bytes
19:10:58.918 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000178F28C61EFAA70CF9F7B4825EF460006FE0A4E
19:10:58.929 > [ESP32] Nonce: 0x00000001
19:10:58.929 > [ESP32] Packet size before HMAC: 61
19:10:58.935 > [ESP32] Computed HMAC Tag: DBDA1E407A601921D21D0708704B48AA
19:10:58.937 > [ESP32] === END HMAC DEBUG ===
19:10:58.941 > 6_Final_Packet (61): 8202180018000408040000000178F28C 61EFAA70CF9F7B4825EF460006FE0A4E ...
19:10:58.949 > [RETRY] Attempt 1/3 (nonce: 1)
19:10:58.952 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:58.957 > Sending pipeline data to server (609 bytes)
19:10:59.298 > [HTTP] Response code: 400
19:10:59.298 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:59.304 > [HTTP] Request failed with code: 400
19:10:59.307 > [RETRY] Send failed, waiting 100 ms before retry
19:10:59.406 > [RETRY] Attempt 2/3 (nonce: 1)
19:10:59.406 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:59.412 > Sending pipeline data to server (609 bytes)
19:10:59.576 > [HTTP] Response code: 400
19:10:59.576 > [HTTP] Error response: {"error":"Decryption failed"}
19:10:59.582 > [HTTP] Request failed with code: 400
19:10:59.585 > [RETRY] Send failed, waiting 200 ms before retry
19:10:59.784 > [RETRY] Attempt 3/3 (nonce: 1)
19:10:59.784 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:59.789 > Sending pipeline data to server (609 bytes)
19:11:00.104 > [HTTP] Response code: 400
19:11:00.104 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:00.108 > [HTTP] Request failed with code: 400
19:11:00.111 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:11:00.116 > [RETRY] Consecutive failures: 2
19:11:00.119 > Health data send failed (retry count: 3/3)
19:11:00.122 > Health data transmission failed after max retries
19:11:00.221 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":411233,"type":"health_data_error"}
19:11:00.235 > [WebSocket] Processing message type: health_data_error
19:11:00.241 > [414.6] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:00.249 > ERROR state - attempting recovery
19:11:00.252 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:00.258 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:11:00.260 > Generated health data: HR-66 SPO2-96 STEPS-2114
19:11:00.265 > [ESP32] ========================================
19:11:00.268 > [ESP32] ENCRYPTION PIPELINE START
19:11:00.271 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:11:00.277 > [ESP32] Active Algorithms for this packet:
19:11:00.283 > [ESP32]   + LFSR
19:11:00.283 > [ESP32]   + Tinkerbell
19:11:00.285 > [ESP32]   + Transposition
19:11:00.288 > [ESP32]   - ChaCha20
19:11:00.288 > [ESP32]   - Salsa20
19:11:00.291 > [ESP32] ========================================
19:11:00.296 > [ESP32] MsgKeys: lfsrSeed=0xE9079067 tnk[0..3]=E4B3D081 trn[0..3]=ED10F1CB
19:11:00.302 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D323131344D50
19:11:00.308 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D323131344D50000000000000 
19:11:00.316 > [ESP32][LFSR] Initializing - Seed: 0xE9079067 SeedBe: 0x679007E9 ChaosKey[0..3]: E4B3D081 InitialTap: 0x0029 State: 0xE9079067
19:11:00.327 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
19:11:00.335 > 3_After_LFSR (32): 2FC22ADFDB5F38CD37A159F69DAB0FE0 D7E3682AE38AE4F70D89F2D87DA719CC 
19:11:00.344 > [ESP32][LFSR] Keystream (first 16 bytes): 679007E9ED7F6B9D789374CFAB8B5CB4
19:11:00.349 > [ESP32][4D] LFSR keystream (first 32 bytes): 679007E9ED7F6B9D789374CFAB8B5CB492B33B07D1BBD5C340D9F2D87DA719CC
19:11:00.358 > [ESP32][TINKERBELL] Input (first 16 bytes): 2FC22ADFDB5F38CD37A159F69DAB0FE0 Nonce: 0x00000001 Buffer size: 32 bytes
19:11:00.368 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: E4B3D081
19:11:00.380 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FF3C0FAF34D36A1DA03D38F672E386E8
19:11:00.388 > 4_After_Tinkerbell (32): D0FE2570EF8C52D0979C6100EF488908 F20A4637AB79C6E27B41AA4E2A9F06DE 
19:11:00.396 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FF3C0FAF34D36A1DA03D38F672E386E8
19:11:00.402 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FF3C0FAF34D36A1DA03D38F672E386E825E92E1D48F3221576C8589657381F12
19:11:00.413 > 5_After_Transposition (32): 79F28C61EFAA70C69F7B4825EF460006 FE0A4EE2D097AB529C4137DE08D02A89 
19:11:00.421 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:11:00.427 > [ESP32] === HMAC DEBUG INFO ===
19:11:00.430 > [ESP32] HMAC Key being used: 39DAB9A5A5D76B1D48DEC64EA6E6DFBD1914F461FB05B920E29000DBA563343E
19:11:00.438 > [ESP32] HMAC Input length: 45 bytes
19:11:00.441 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000179F28C61EFAA70C69F7B4825EF460006FE0A4E
19:11:00.449 > [ESP32] Nonce: 0x00000001
19:11:00.452 > [ESP32] Packet size before HMAC: 61
19:11:00.455 > [ESP32] Computed HMAC Tag: 3B637C8FCC1DAF42F140EC6E723FE1CC
19:11:00.460 > [ESP32] === END HMAC DEBUG ===
19:11:00.462 > 6_Final_Packet (61): 8202180018000408040000000179F28C 61EFAA70C69F7B4825EF460006FE0A4E ...
19:11:00.471 > [RETRY] Attempt 1/3 (nonce: 1)
19:11:00.474 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:00.480 > Sending pipeline data to server (609 bytes)
19:11:00.831 > [HTTP] Response code: 400
19:11:00.831 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:00.836 > [HTTP] Request failed with code: 400
19:11:00.839 > [RETRY] Send failed, waiting 100 ms before retry
19:11:00.938 > [RETRY] Attempt 2/3 (nonce: 1)
19:11:00.938 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:00.943 > Sending pipeline data to server (609 bytes)
19:11:01.091 > [HTTP] Response code: 400
19:11:01.092 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:01.097 > [HTTP] Request failed with code: 400
19:11:01.100 > [RETRY] Send failed, waiting 200 ms before retry
19:11:01.298 > [RETRY] Attempt 3/3 (nonce: 1)
19:11:01.298 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:01.304 > Sending pipeline data to server (609 bytes)
19:11:01.586 > [HTTP] Response code: 400
19:11:01.586 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:01.592 > [HTTP] Request failed with code: 400
19:11:01.594 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:11:01.600 > [RETRY] Consecutive failures: 3
19:11:01.603 > ✗ Auto-recovery failed - restarting key exchange
19:11:03.705 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":411728,"type":"health_data_error"}
19:11:03.719 > [WebSocket] Processing message type: health_data_error
19:11:03.724 > [418.1] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:03.733 > ✓ Public key loaded from NVS
19:11:03.832 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126057615,"threatLevel":0,"type":"heuristics_update"}
19:11:03.857 > [WebSocket] Processing message type: heuristics_update
19:11:03.863 > [418.3] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:03.965 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":412230,"type":"health_data_error"}
19:11:03.979 > [WebSocket] Processing message type: health_data_error
19:11:03.985 > [418.4] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:03.993 > Generating fresh master key from entropy...
19:11:04.002 > Generated master key (32): A2210642E18B8D69B4D1517F1D485BC4 9FDD0F0042A49CA757B5FFBF6205B078 
19:11:04.007 > Using reduced master key (byte % 3) for NTRU encryption only
19:11:04.016 > NTRU encrypted master key (502): 0021006E001E0015007D001C00060062 004400790039000D000200740069006F ...
19:11:04.026 > POST http://10.249.92.115:8081/master-key
19:11:04.342 > ✓ Master key exchange completed
19:11:04.443 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":412497,"type":"health_data_error"}
19:11:04.457 > [WebSocket] Processing message type: health_data_error
19:11:04.462 > [418.9] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:04.471 > Loading master key from NVS and deriving symmetric keys...
19:11:04.476 > Loaded master key from NVS (32): A2210642E18B8D69B4D1517F1D485BC4 9FDD0F0042A49CA757B5FFBF6205B078 
19:11:04.484 > Derived HMAC key (32): 6DC02BA66E5FE7562E26F0DB4128536D 88194E592BAD51B20B9F8FE7219A2F93 
19:11:04.493 > Derived Tinkerbell key (16): 6F57CC5F34DBDF5A895F6A39C62A4374 
19:11:04.498 > Derived Transposition key (16): CE1FE3FD26646F8803843EB4DD0E6344 
19:11:04.504 > ✓ Symmetric keys derived successfully
19:11:04.506 > Nonce tracker reset - new session started
19:11:05.002 > Waiting for server to process master key...
19:11:05.006 > ✓ Symmetric keys ready - starting health data transmission
19:11:05.108 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":412990,"type":"health_data_error"}
19:11:05.122 > [WebSocket] Processing message type: health_data_error
19:11:05.128 > [419.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:05.231 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126058616,"threatLevel":0,"type":"heuristics_update"}
19:11:05.256 > [WebSocket] Processing message type: heuristics_update
19:11:05.261 > [419.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:05.364 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":413714,"type":"health_data_error"}
19:11:05.378 > [WebSocket] Processing message type: health_data_error
19:11:05.384 > [419.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:05.486 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":413992,"type":"health_data_error"}
19:11:05.500 > [WebSocket] Processing message type: health_data_error
19:11:05.506 > [419.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:05.611 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126059616,"threatLevel":0,"type":"heuristics_update"}
19:11:05.636 > [WebSocket] Processing message type: heuristics_update
19:11:05.641 > [420.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:05.742 > [420.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:05.844 > [420.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:05.944 > [420.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:06.046 > [420.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:06.146 > [420.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:06.248 > [420.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:06.349 > [420.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:06.449 > [420.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:06.552 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":414519,"type":"health_data_error"}
19:11:06.565 > [WebSocket] Processing message type: health_data_error
19:11:06.570 > [421.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:06.674 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126060617,"threatLevel":0,"type":"heuristics_update"}
19:11:06.699 > [WebSocket] Processing message type: heuristics_update
19:11:06.705 > [421.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:06.807 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":415246,"type":"health_data_error"}
19:11:06.821 > [WebSocket] Processing message type: health_data_error
19:11:06.827 > [421.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:06.929 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":415508,"type":"health_data_error"}
19:11:06.943 > [WebSocket] Processing message type: health_data_error
19:11:06.949 > [421.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:07.051 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":416002,"type":"health_data_error"}
19:11:07.065 > [WebSocket] Processing message type: health_data_error
19:11:07.071 > [421.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:07.173 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126061617,"threatLevel":0,"type":"heuristics_update"}
19:11:07.198 > [WebSocket] Processing message type: heuristics_update
19:11:07.204 > [421.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:07.306 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126062618,"threatLevel":0,"type":"heuristics_update"}
19:11:07.331 > [WebSocket] Processing message type: heuristics_update
19:11:07.336 > [421.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:07.440 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126063619,"threatLevel":0,"type":"heuristics_update"}
19:11:07.465 > [WebSocket] Processing message type: heuristics_update
19:11:07.470 > [421.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:07.571 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770126064114,"type":"master_key_received"}
19:11:07.586 > [WebSocket] Processing message type: master_key_received
19:11:07.589 > [422.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:07.694 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":418750,"type":"master_key_exchanged"}
19:11:07.711 > [WebSocket] Processing message type: master_key_exchanged
19:11:07.716 > [422.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:07.816 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126064620,"threatLevel":0,"type":"heuristics_update"}
19:11:07.841 > [WebSocket] Processing message type: heuristics_update
19:11:07.846 > [422.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:07.949 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":419418,"type":"symmetric_keys_derived"}
19:11:07.966 > [WebSocket] Processing message type: symmetric_keys_derived
19:11:07.971 > [422.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:08.070 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126065620,"threatLevel":0,"type":"heuristics_update"}
19:11:08.096 > [WebSocket] Processing message type: heuristics_update
19:11:08.102 > [422.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:08.204 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126066621,"threatLevel":0,"type":"heuristics_update"}
19:11:08.230 > [WebSocket] Processing message type: heuristics_update
19:11:08.235 > [422.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:08.336 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126067621,"threatLevel":0,"type":"heuristics_update"}
19:11:08.362 > [WebSocket] Processing message type: heuristics_update
19:11:08.368 > [422.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:08.469 > [422.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:08.570 > [423.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:08.671 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126068622,"threatLevel":0,"type":"heuristics_update"}
19:11:08.696 > [WebSocket] Processing message type: heuristics_update
19:11:08.703 > [423.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:08.804 > [423.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:08.905 > [423.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:09.006 > [423.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:09.108 > [423.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:09.209 > [423.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:09.309 > [423.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:09.410 > [423.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:09.511 > [423.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:09.613 > [424.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:09.714 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126069623,"threatLevel":0,"type":"heuristics_update"}
19:11:09.739 > [WebSocket] Processing message type: heuristics_update
19:11:09.745 > [424.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:09.847 > [424.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:09.947 > [424.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:10.049 > [424.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:10.150 > [424.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:10.250 > [424.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:10.351 > [424.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:10.452 > [424.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:10.553 > [425.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:10.655 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126070624,"threatLevel":0,"type":"heuristics_update"}
19:11:10.680 > [WebSocket] Processing message type: heuristics_update
19:11:10.686 > [425.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:10.788 > [425.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:10.889 > [425.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:10.989 > [425.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:11.091 > [425.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:11.191 > [425.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:11.292 > [425.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:11.394 > [425.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:11.494 > [425.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:11.595 > [426.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:11.699 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126071624,"threatLevel":0,"type":"heuristics_update"}
19:11:11.724 > [WebSocket] Processing message type: heuristics_update
19:11:11.730 > [426.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:11.832 > [426.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:11.933 > [426.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:12.033 > [426.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:12.135 > [426.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:12.235 > [426.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:12.336 > [426.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:12.438 > [426.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:12.539 > [427.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:12.639 > [427.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:12.741 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126072625,"threatLevel":0,"type":"heuristics_update"}
19:11:12.767 > [WebSocket] Processing message type: heuristics_update
19:11:12.771 > [427.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:12.873 > [427.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:12.975 > [427.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:13.075 > [427.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:13.176 > [427.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:13.277 > [427.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:13.378 > [427.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:13.480 > [427.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:13.581 > [428.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:13.682 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126073626,"threatLevel":0,"type":"heuristics_update"}
19:11:13.707 > [WebSocket] Processing message type: heuristics_update
19:11:13.713 > [428.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:13.815 > [428.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:13.915 > [428.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:14.016 > [428.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:14.117 > [428.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:14.219 > [428.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:14.319 > [428.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:14.420 > [428.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:14.521 > [428.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:14.622 > [429.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:14.724 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126074626,"threatLevel":0,"type":"heuristics_update"}
19:11:14.749 > [WebSocket] Processing message type: heuristics_update
19:11:14.755 > [429.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:14.856 > [429.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:14.958 > [429.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:15.058 > [429.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:15.064 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:15.069 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:11:15.075 > Generated health data: HR-67 SPO2-96 STEPS-2167
19:11:15.078 > [ESP32] ========================================
19:11:15.084 > [ESP32] ENCRYPTION PIPELINE START
19:11:15.086 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:11:15.091 > [ESP32] Active Algorithms for this packet:
19:11:15.095 > [ESP32]   + LFSR
19:11:15.098 > [ESP32]   + Tinkerbell
19:11:15.100 > [ESP32]   + Transposition
19:11:15.100 > [ESP32]   - ChaCha20
19:11:15.103 > [ESP32]   - Salsa20
19:11:15.105 > [ESP32] ========================================
19:11:15.108 > [ESP32] MsgKeys: lfsrSeed=0x7F0B9E69 tnk[0..3]=14BF0C91 trn[0..3]=01CA19E4
19:11:15.116 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D323136374D50
19:11:15.122 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D323136374D50000000000000 
19:11:15.131 > [ESP32][LFSR] Initializing - Seed: 0x7F0B9E69 SeedBe: 0x699E0B7F ChaosKey[0..3]: 14BF0C91 InitialTap: 0x0029 State: 0x7F0B9E69
19:11:15.142 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
19:11:15.151 > 3_After_LFSR (32): 21CC264979D408270BCAFE6E47A20D67 11D66D1F4DD5876FFAE092296791BC9D 
19:11:15.156 > [ESP32][LFSR] Keystream (first 16 bytes): 699E0B7F4EF45B7744F8D35771825E33
19:11:15.164 > [ESP32][4D] LFSR keystream (first 32 bytes): 699E0B7F4EF45B7744F8D35771825E3354863E327FE4B158B7B092296791BC9D
19:11:15.173 > [ESP32][TINKERBELL] Input (first 16 bytes): 21CC264979D408270BCAFE6E47A20D67 Nonce: 0x00000001 Buffer size: 32 bytes
19:11:15.184 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 14BF0C91
19:11:15.192 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9A37FD5A396F001E48457EAD5B16186B
19:11:15.200 > 4_After_Tinkerbell (32): BBFBDB1340BB0839438F80C31CB4150C E8251D4F6F3F2AE9792C0D1A9F82579F 
19:11:15.209 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9A37FD5A396F001E48457EAD5B16186B
19:11:15.217 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 9A37FD5A396F001E48457EAD5B16186BF9F3705022EAAD8683CC9F33F813EB02
19:11:15.227 > 5_After_Transposition (32): B41CC32C0D79150CBB4013251DE80839 BBFBDB1A829F2AE9438F804F3F6F579F 
19:11:15.237 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:11:15.239 > [ESP32] === HMAC DEBUG INFO ===
19:11:15.242 > [ESP32] HMAC Key being used: 6DC02BA66E5FE7562E26F0DB4128536D88194E592BAD51B20B9F8FE7219A2F93
19:11:15.250 > [ESP32] HMAC Input length: 45 bytes
19:11:15.254 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001B41CC32C0D79150CBB4013251DE80839BBFBDB
19:11:15.264 > [ESP32] Nonce: 0x00000001
19:11:15.264 > [ESP32] Packet size before HMAC: 61
19:11:15.270 > [ESP32] Computed HMAC Tag: 33BE64DC6F9CD4FEE3803A2A21914C9E
19:11:15.273 > [ESP32] === END HMAC DEBUG ===
19:11:15.275 > 6_Final_Packet (61): 82021800180004080400000001B41CC3 2C0D79150CBB4013251DE80839BBFBDB ...
19:11:15.284 > [RETRY] Attempt 1/3 (nonce: 1)
19:11:15.286 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:15.292 > Sending pipeline data to server (609 bytes)
19:11:15.596 > [HTTP] Response code: 400
19:11:15.596 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:15.602 > [HTTP] Request failed with code: 400
19:11:15.604 > [RETRY] Send failed, waiting 100 ms before retry
19:11:15.703 > [RETRY] Attempt 2/3 (nonce: 1)
19:11:15.704 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:15.709 > Sending pipeline data to server (609 bytes)
19:11:15.879 > [HTTP] Response code: 400
19:11:15.879 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:15.885 > [HTTP] Request failed with code: 400
19:11:15.888 > [RETRY] Send failed, waiting 200 ms before retry
19:11:16.086 > [RETRY] Attempt 3/3 (nonce: 1)
19:11:16.086 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:16.092 > Sending pipeline data to server (609 bytes)
19:11:16.389 > [HTTP] Response code: 400
19:11:16.390 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:16.395 > [HTTP] Request failed with code: 400
19:11:16.398 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:11:16.404 > [RETRY] Consecutive failures: 4
19:11:16.406 > Health data send failed (retry count: 1/3)
19:11:16.512 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":430013,"type":"health_data_error"}
19:11:16.526 > [WebSocket] Processing message type: health_data_error
19:11:16.532 > [430.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:16.540 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:16.546 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:11:16.551 > Generated health data: HR-67 SPO2-96 STEPS-2157
19:11:16.554 > [ESP32] ========================================
19:11:16.560 > [ESP32] ENCRYPTION PIPELINE START
19:11:16.563 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:11:16.568 > [ESP32] Active Algorithms for this packet:
19:11:16.571 > [ESP32]   + LFSR
19:11:16.571 > [ESP32]   + Tinkerbell
19:11:16.574 > [ESP32]   + Transposition
19:11:16.576 > [ESP32]   - ChaCha20
19:11:16.580 > [ESP32]   - Salsa20
19:11:16.580 > [ESP32] ========================================
19:11:16.584 > [ESP32] MsgKeys: lfsrSeed=0x7F0B9E69 tnk[0..3]=14BF0C91 trn[0..3]=01CA19E4
19:11:16.591 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D323135374D50
19:11:16.595 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D323135374D50000000000000 
19:11:16.604 > [ESP32][LFSR] Initializing - Seed: 0x7F0B9E69 SeedBe: 0x699E0B7F ChaosKey[0..3]: 14BF0C91 InitialTap: 0x0029 State: 0x7F0B9E69
19:11:16.615 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
19:11:16.624 > 3_After_LFSR (32): 21CC264979D408270BCAFE6E47A20D67 11D66D1F4DD5846FFAE092296791BC9D 
19:11:16.632 > [ESP32][LFSR] Keystream (first 16 bytes): 699E0B7F4EF45B7744F8D35771825E33
19:11:16.638 > [ESP32][4D] LFSR keystream (first 32 bytes): 699E0B7F4EF45B7744F8D35771825E3354863E327FE4B158B7B092296791BC9D
19:11:16.648 > [ESP32][TINKERBELL] Input (first 16 bytes): 21CC264979D408270BCAFE6E47A20D67 Nonce: 0x00000001 Buffer size: 32 bytes
19:11:16.657 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 14BF0C91
19:11:16.668 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9A37FD5A396F001E48457EAD5B16186B
19:11:16.676 > 4_After_Tinkerbell (32): BBFBDB1340BB0839438F80C31CB4150C E8251D4F6F3F29E9792C0D1A9F82579F 
19:11:16.684 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9A37FD5A396F001E48457EAD5B16186B
19:11:16.693 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 9A37FD5A396F001E48457EAD5B16186BF9F3705022EAAD8683CC9F33F813EB02
19:11:16.701 > 5_After_Transposition (32): B41CC32C0D79150CBB4013251DE80839 BBFBDB1A829F29E9438F804F3F6F579F 
19:11:16.710 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:11:16.716 > [ESP32] === HMAC DEBUG INFO ===
19:11:16.718 > [ESP32] HMAC Key being used: 6DC02BA66E5FE7562E26F0DB4128536D88194E592BAD51B20B9F8FE7219A2F93
19:11:16.726 > [ESP32] HMAC Input length: 45 bytes
19:11:16.729 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001B41CC32C0D79150CBB4013251DE80839BBFBDB
19:11:16.737 > [ESP32] Nonce: 0x00000001
19:11:16.740 > [ESP32] Packet size before HMAC: 61
19:11:16.743 > [ESP32] Computed HMAC Tag: F48A15244DCEFCBE9F7E219E6CA176FB
19:11:16.749 > [ESP32] === END HMAC DEBUG ===
19:11:16.751 > 6_Final_Packet (61): 82021800180004080400000001B41CC3 2C0D79150CBB4013251DE80839BBFBDB ...
19:11:16.760 > [RETRY] Attempt 1/3 (nonce: 1)
19:11:16.763 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:16.768 > Sending pipeline data to server (609 bytes)
19:11:17.119 > [HTTP] Response code: 400
19:11:17.119 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:17.125 > [HTTP] Request failed with code: 400
19:11:17.128 > [RETRY] Send failed, waiting 100 ms before retry
19:11:17.226 > [RETRY] Attempt 2/3 (nonce: 1)
19:11:17.228 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:17.233 > Sending pipeline data to server (609 bytes)
19:11:17.380 > [HTTP] Response code: 400
19:11:17.381 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:17.386 > [HTTP] Request failed with code: 400
19:11:17.389 > [RETRY] Send failed, waiting 200 ms before retry
19:11:17.589 > [RETRY] Attempt 3/3 (nonce: 1)
19:11:17.589 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:17.595 > Sending pipeline data to server (609 bytes)
19:11:17.884 > [HTTP] Response code: 400
19:11:17.884 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:17.890 > [HTTP] Request failed with code: 400
19:11:17.893 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:11:17.898 > [RETRY] Consecutive failures: 5
19:11:17.901 > [EMERGENCY] Triggering emergency reset!
19:11:17.904 > [CRYPTO] Resetting cryptographic state
19:11:17.910 > [CRYPTO] Crypto state reset complete
19:11:17.912 > [CRYPTO] Packet counter: 10
19:11:17.915 > [EMERGENCY] Emergency reset complete
19:11:17.918 > Health data send failed (retry count: 2/3)
19:11:18.013 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770126075628,"threatLevel":0,"type":"heuristics_update"}
19:11:18.038 > [WebSocket] Processing message type: heuristics_update
19:11:18.044 > [432.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:18.049 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:18.054 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:11:18.060 > Generated health data: HR-67 SPO2-96 STEPS-2205
19:11:18.063 > [ESP32] ========================================
19:11:18.068 > [ESP32] ENCRYPTION PIPELINE START
19:11:18.071 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:11:18.076 > [ESP32] Active Algorithms for this packet:
19:11:18.079 > [ESP32]   + LFSR
19:11:18.082 > [ESP32]   + Tinkerbell
19:11:18.085 > [ESP32]   + Transposition
19:11:18.085 > [ESP32]   - ChaCha20
19:11:18.088 > [ESP32]   - Salsa20
19:11:18.091 > [ESP32] ========================================
19:11:18.093 > [ESP32] MsgKeys: lfsrSeed=0x7F0B9E69 tnk[0..3]=14BF0C91 trn[0..3]=01CA19E4
19:11:18.102 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D323230354D50
19:11:18.108 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D323230354D50000000000000 
19:11:18.116 > [ESP32][LFSR] Initializing - Seed: 0x7F0B9E69 SeedBe: 0x699E0B7F ChaosKey[0..3]: 14BF0C91 InitialTap: 0x0029 State: 0x7F0B9E69
19:11:18.126 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
19:11:18.136 > 3_After_LFSR (32): 21CC264979D408270BCAFE6E47A20D67 11D66D1F4DD6816DFAE092296791BC9D 
19:11:18.141 > [ESP32][LFSR] Keystream (first 16 bytes): 699E0B7F4EF45B7744F8D35771825E33
19:11:18.149 > [ESP32][4D] LFSR keystream (first 32 bytes): 699E0B7F4EF45B7744F8D35771825E3354863E327FE4B158B7B092296791BC9D
19:11:18.156 > [ESP32][TINKERBELL] Input (first 16 bytes): 21CC264979D408270BCAFE6E47A20D67 Nonce: 0x00000001 Buffer size: 32 bytes
19:11:18.169 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 14BF0C91
19:11:18.177 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9A37FD5A396F001E48457EAD5B16186B
19:11:18.185 > 4_After_Tinkerbell (32): BBFBDB1340BB0839438F80C31CB4150C E8251D4F6F3C2CEB792C0D1A9F82579F 
19:11:18.194 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9A37FD5A396F001E48457EAD5B16186B
19:11:18.202 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 9A37FD5A396F001E48457EAD5B16186BF9F3705022EAAD8683CC9F33F813EB02
19:11:18.213 > 5_After_Transposition (32): B41CC32C0D79150CBB4013251DE80839 BBFBDB1A829F2CEB438F804F3C6F579F 
19:11:18.221 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:11:18.223 > [ESP32] === HMAC DEBUG INFO ===
19:11:18.227 > [ESP32] HMAC Key being used: 6DC02BA66E5FE7562E26F0DB4128536D88194E592BAD51B20B9F8FE7219A2F93
19:11:18.235 > [ESP32] HMAC Input length: 45 bytes
19:11:18.238 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001B41CC32C0D79150CBB4013251DE80839BBFBDB
19:11:18.249 > [ESP32] Nonce: 0x00000001
19:11:18.249 > [ESP32] Packet size before HMAC: 61
19:11:18.255 > [ESP32] Computed HMAC Tag: 55F079629BB19DDA2EAC20E92E3E2955
19:11:18.258 > [ESP32] === END HMAC DEBUG ===
19:11:18.260 > 6_Final_Packet (61): 82021800180004080400000001B41CC3 2C0D79150CBB4013251DE80839BBFBDB ...
19:11:18.268 > [RETRY] Attempt 1/3 (nonce: 1)
19:11:18.271 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:18.277 > Sending pipeline data to server (609 bytes)
19:11:18.381 > [HTTP] Response code: 400
19:11:18.382 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:18.386 > [HTTP] Request failed with code: 400
19:11:18.389 > [RETRY] Send failed, waiting 100 ms before retry
19:11:18.488 > [RETRY] Attempt 2/3 (nonce: 1)
19:11:18.488 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:18.494 > Sending pipeline data to server (609 bytes)
19:11:18.645 > [HTTP] Response code: 400
19:11:18.645 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:18.650 > [HTTP] Request failed with code: 400
19:11:18.653 > [RETRY] Send failed, waiting 200 ms before retry
19:11:18.852 > [RETRY] Attempt 3/3 (nonce: 1)
19:11:18.852 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:18.858 > Sending pipeline data to server (609 bytes)
19:11:19.137 > [HTTP] Response code: 400
19:11:19.137 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:19.142 > [HTTP] Request failed with code: 400
19:11:19.144 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:11:19.150 > [RETRY] Consecutive failures: 1
19:11:19.152 > Health data send failed (retry count: 3/3)
19:11:19.156 > Health data transmission failed after max retries
19:11:19.255 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":430295,"type":"health_data_error"}
19:11:19.268 > [WebSocket] Processing message type: health_data_error
19:11:19.274 > [433.7] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:11:19.283 > ERROR state - attempting recovery
19:11:19.285 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:19.291 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:11:19.294 > Generated health data: HR-67 SPO2-96 STEPS-2167
19:11:19.299 > [ESP32] ========================================
19:11:19.302 > [ESP32] ENCRYPTION PIPELINE START
19:11:19.305 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:11:19.311 > [ESP32] Active Algorithms for this packet:
19:11:19.316 > [ESP32]   + LFSR
19:11:19.316 > [ESP32]   + Tinkerbell
19:11:19.318 > [ESP32]   + Transposition
19:11:19.321 > [ESP32]   - ChaCha20
19:11:19.321 > [ESP32]   - Salsa20
19:11:19.324 > [ESP32] ========================================
19:11:19.329 > [ESP32] MsgKeys: lfsrSeed=0x7F0B9E69 tnk[0..3]=14BF0C91 trn[0..3]=01CA19E4
19:11:19.335 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D323136374D50
19:11:19.341 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D323136374D50000000000000 
19:11:19.349 > [ESP32][LFSR] Initializing - Seed: 0x7F0B9E69 SeedBe: 0x699E0B7F ChaosKey[0..3]: 14BF0C91 InitialTap: 0x0029 State: 0x7F0B9E69
19:11:19.360 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
19:11:19.369 > 3_After_LFSR (32): 21CC264979D408270BCAFE6E47A20D67 11D66D1F4DD5876FFAE092296791BC9D 
19:11:19.376 > [ESP32][LFSR] Keystream (first 16 bytes): 699E0B7F4EF45B7744F8D35771825E33
19:11:19.383 > [ESP32][4D] LFSR keystream (first 32 bytes): 699E0B7F4EF45B7744F8D35771825E3354863E327FE4B158B7B092296791BC9D
19:11:19.391 > [ESP32][TINKERBELL] Input (first 16 bytes): 21CC264979D408270BCAFE6E47A20D67 Nonce: 0x00000001 Buffer size: 32 bytes
19:11:19.402 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 14BF0C91
19:11:19.413 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9A37FD5A396F001E48457EAD5B16186B
19:11:19.421 > 4_After_Tinkerbell (32): BBFBDB1340BB0839438F80C31CB4150C E8251D4F6F3F2AE9792C0D1A9F82579F 
19:11:19.429 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9A37FD5A396F001E48457EAD5B16186B
19:11:19.436 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 9A37FD5A396F001E48457EAD5B16186BF9F3705022EAAD8683CC9F33F813EB02
19:11:19.446 > 5_After_Transposition (32): B41CC32C0D79150CBB4013251DE80839 BBFBDB1A829F2AE9438F804F3F6F579F 
19:11:19.455 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:11:19.460 > [ESP32] === HMAC DEBUG INFO ===
19:11:19.463 > [ESP32] HMAC Key being used: 6DC02BA66E5FE7562E26F0DB4128536D88194E592BAD51B20B9F8FE7219A2F93
19:11:19.472 > [ESP32] HMAC Input length: 45 bytes
19:11:19.474 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001B41CC32C0D79150CBB4013251DE80839BBFBDB
19:11:19.483 > [ESP32] Nonce: 0x00000001
19:11:19.485 > [ESP32] Packet size before HMAC: 61
19:11:19.487 > [ESP32] Computed HMAC Tag: 33BE64DC6F9CD4FEE3803A2A21914C9E
19:11:19.494 > [ESP32] === END HMAC DEBUG ===
19:11:19.496 > 6_Final_Packet (61): 82021800180004080400000001B41CC3 2C0D79150CBB4013251DE80839BBFBDB ...
19:11:19.505 > [RETRY] Attempt 1/3 (nonce: 1)
19:11:19.508 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:19.514 > Sending pipeline data to server (609 bytes)
19:11:19.858 > [HTTP] Response code: 400
19:11:19.858 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:19.863 > [HTTP] Request failed with code: 400
19:11:19.866 > [RETRY] Send failed, waiting 100 ms before retry
19:11:19.969 > [RETRY] Attempt 2/3 (nonce: 1)
19:11:19.969 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:19.974 > Sending pipeline data to server (609 bytes)
19:11:20.178 > [HTTP] Response code: 400
19:11:20.178 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:20.183 > [HTTP] Request failed with code: 400
19:11:20.186 > [RETRY] Send failed, waiting 200 ms before retry
19:11:20.385 > [RETRY] Attempt 3/3 (nonce: 1)
19:11:20.385 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:20.391 > Sending pipeline data to server (609 bytes)
19:11:20.664 > [HTTP] Response code: 400
19:11:20.665 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:20.670 > [HTTP] Request failed with code: 400
19:11:20.673 > [RETRY] All retry attempts failed - rolled back nonce to 0
19:11:20.678 > [RETRY] Consecutive failures: 2
19:11:20.681 > ✗ Auto-recovery failed - restarting key exchange
