19:08:50.393 > ets Jul 29 2019 12:21:46
19:08:50.394 > 
19:08:50.394 > rst:0x1 (POWERON_RESET),boot:0x13 (SPI_FAST_FLASH_BOOT)
19:08:50.399 > configsip: 0, SPIWP:0xee
19:08:50.402 > clk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00
19:08:50.408 > mode:DIO, clock div:2
19:08:50.410 > load:0x3fff0030,len:1184
19:08:50.413 > load:0x40078000,len:13232
19:08:50.416 > load:0x40080400,len:3028
19:08:50.416 > entry 0x400805e4
19:08:51.851 > === XenoCipher ESP32 Booting ===
19:08:51.854 > Free heap: 292976 bytes
19:08:51.854 > Nonce counter reset for new session
19:08:51.856 > [ZTM] Forced NORMAL mode on startup - waiting for server ZTM activation
19:08:51.865 > [ZTM] (Previous ZTM settings in NVS are ignored to prevent mode desync)
19:08:51.870 > [RECIPE] Recipe map version: 1
19:08:51.873 > [RECIPE] Mapping: 1=FULL_STACK 2=CHACHA_HEAVY 3=SALSA_LIGHT 4=CHAOS_ONLY 5=STREAM_FOCUS
19:08:51.882 > [1.1] STATE: INIT_NVS | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:51.891 > ✓ NVS initialized
19:08:51.984 > [1.2] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:51.990 > Connecting to motorola edge 40_6753
19:08:52.193 > [WiFi] STA Start
19:08:52.306 > [1.5] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:52.406 > [1.6] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:52.506 > [1.7] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:52.606 > [1.8] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:52.706 > [1.9] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:52.806 > [2.0] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:52.906 > [2.1] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:53.006 > [2.2] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:53.106 > [2.3] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:53.206 > [2.4] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:53.306 > [2.5] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:53.406 > [2.6] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:53.503 > [WiFi] Connected to AP
19:08:53.504 > [2.7] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:53.530 > [WiFi] Got IP: 10.249.92.171
19:08:53.530 > [WebSocket] Initialized - Server: 10.249.92.115:8081/api/ws
19:08:53.606 > [2.8] STATE: CONNECT_WIFI | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:53.612 > ✓ WiFi connected! IP: 10.249.92.171
19:08:53.706 > [2.9] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:53.715 > ✓ Public key loaded from NVS
19:08:53.811 > [3.0] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:53.911 > [3.1] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:53.920 > Generating fresh master key from entropy...
19:08:53.927 > Generated master key (32): 3D5D3BB6324126096E14D68E6AD0F442 BD51377A42EF9179789EBB8F976959A7 
19:08:53.933 > Using reduced master key (byte % 3) for NTRU encryption only
19:08:53.942 > NTRU encrypted master key (502): 004300000032001A006D000500050009 00110055007E004E0057002200280027 ...
19:08:53.951 > POST http://10.249.92.115:8081/master-key
19:08:54.223 > ✓ Master key exchange completed
19:08:54.324 > [3.5] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:08:54.333 > Loading master key from NVS and deriving symmetric keys...
19:08:54.336 > Loaded master key from NVS (32): 3D5D3BB6324126096E14D68E6AD0F442 BD51377A42EF9179789EBB8F976959A7 
19:08:54.347 > Derived HMAC key (32): 5390FD2C355DECCD4646B53F7FB01889 3668969E9F065305BD138FA7F9E4B4FE 
19:08:54.352 > Derived Tinkerbell key (16): 15F0014337D6F8C975F4635067F3C6D4 
19:08:54.358 > Derived Transposition key (16): AA64A15E4C23746C4A90F7F456B2CC1A 
19:08:54.366 > ✓ Symmetric keys derived successfully
19:08:54.369 > Nonce tracker reset - new session started
19:08:54.873 > Waiting for server to process master key...
19:08:54.876 > ✓ Symmetric keys ready - starting health data transmission
19:08:54.973 > [4.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:55.074 > [4.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:55.174 > [4.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:55.274 > [4.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:55.374 > [4.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:55.474 > [4.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:55.574 > [4.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:55.674 > [4.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:55.774 > [5.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:55.890 > [5.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:55.992 > [5.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:56.094 > [5.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:56.195 > [5.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:56.295 > [5.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:08:56.397 > [WebSocket] ========================================[WebSocket] CONNECTED to: /api/ws
19:08:56.403 > [WebSocket] WebSocket connection established[WebSocket] Ready to receive ZTM activation requests[WebSocket] ========================================[WebSocket] Sent hello message (hello_from_esp32)
19:08:56.419 > [5.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:56.525 > [WebSocket] Received (151 bytes): {"message":"Connected to XenoCipher Server","serverTime":1770298735910,"sessionId":"1770298735910-41","totalClients":2,"type":"connection_established"}
19:08:56.538 > [WebSocket] Processing message type: connection_established
19:08:56.544 > [WebSocket] Connection established - Session: 1770298735910-41
19:08:56.550 > [5.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:56.658 > [WebSocket] Received (112 bytes): {"message":"ESP32 connection acknowledged","serverTime":1770298736411,"status":"ready","type":"esp32_connected"}
19:08:56.668 > [WebSocket] Processing message type: esp32_connected
19:08:56.674 > [5.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:56.779 > [6.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:56.880 > [6.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:56.981 > [6.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:57.082 > [6.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:57.183 > [6.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:57.284 > [6.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:57.385 > [6.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:57.486 > [6.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:57.587 > [6.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:57.688 > [6.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:57.789 > [7.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:57.890 > [7.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:57.991 > [7.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:58.092 > [7.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:58.192 > [7.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:58.294 > [7.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:58.395 > [7.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:58.496 > [7.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:58.597 > [7.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:58.698 > [7.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:58.799 > [8.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:58.900 > [8.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:59.001 > [8.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:59.102 > [8.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:59.203 > [8.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:59.304 > [8.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:59.405 > [8.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:59.506 > [8.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:59.607 > [8.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:59.708 > [8.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:59.809 > [9.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:08:59.910 > [9.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:00.010 > [9.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:00.112 > [9.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:00.213 > [9.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:00.314 > [9.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:00.415 > [9.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:00.516 > [9.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:00.617 > [9.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:00.718 > [9.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:00.818 > [10.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:00.920 > [10.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:01.021 > [10.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:01.122 > [10.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:01.223 > [10.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:01.324 > [10.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:01.425 > [10.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:01.526 > [10.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:01.627 > [10.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:01.728 > [10.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:01.828 > [11.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:01.930 > [11.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:02.030 > [11.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:02.132 > [11.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:02.233 > [11.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:02.333 > [11.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:02.435 > [11.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:02.536 > [11.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:02.637 > [11.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:02.738 > [11.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:02.838 > [12.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:02.940 > [12.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:03.040 > [12.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:03.142 > [12.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:03.242 > [12.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:03.344 > [12.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:03.444 > [12.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:03.545 > [12.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:03.647 > [12.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:03.747 > [12.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:03.849 > [13.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:03.949 > [13.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:04.051 > [13.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:04.152 > [13.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:04.252 > [13.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:04.354 > [13.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:04.454 > [13.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:04.556 > [13.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:04.656 > [13.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:04.758 > [13.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:04.858 > [14.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:04.959 > [14.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:09:04.964 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:04.971 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:09:04.988 > Generated health data: HR-60 SPO2-95 STEPS-93
19:09:04.990 > [ESP32] ========================================
19:09:04.995 > [ESP32] ENCRYPTION PIPELINE START
19:09:04.998 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:09:05.006 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:09:05.012 > [ESP32] ========================================
19:09:05.018 > [ESP32] MsgKeys: lfsrSeed=0x3BB0E6F0 tnk[0..3]=7DBF8E86 trn[0..3]=5EB42891
19:09:05.024 > 1_After_Salt (24): 48522D36302053504F322D3935205354 4550532D39334D50
19:09:05.029 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D39334D500000000000000000 
19:09:05.038 > [ESP32][LFSR] Initializing - Seed: 0x3BB0E6F0 SeedBe: 0xF0E6B03B ChaosKey[0..3]: 7DBF8E86 InitialTap: 0x0029 State: 0x3BB0E6F0
19:09:05.048 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:09:05.056 > 3_After_LFSR (32): B8B49D0D7FAE9D9B6BD5504343CC1391 252F5EE1CEABEEC5FC70BD02C280FE47 
19:09:05.063 > [ESP32][LFSR] Keystream (first 16 bytes): F0E6B03B4F8ECECB24E77D7A76EC40C5
19:09:05.070 > [ESP32][4D] LFSR keystream (first 32 bytes): F0E6B03B4F8ECECB24E77D7A76EC40C5607F0DCCF798A395FC70BD02C280FE47
19:09:05.079 > [ESP32][TINKERBELL] Input (first 16 bytes): B8B49D0D7FAE9D9B6BD5504343CC1391 Nonce: 0x00000001 Buffer size: 32 bytes
19:09:05.090 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 7DBF8E86
19:09:05.101 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A9175C2AE370F4324A2160ED06317F85
19:09:05.107 > 4_After_Tinkerbell (32): 11A3C1279CDE69A921F430AE45FD6C14 B11749550E1AB4C48FB2E773AD54E801 
19:09:05.115 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A9175C2AE370F4324A2160ED06317F85
19:09:05.123 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A9175C2AE370F4324A2160ED06317F85943817B4C0B15A0173C25A716FD41646
19:09:05.135 > 5_After_Transposition (32): 17DE490EAE111AA99CE8018F21C1E769 FD4554C4B4B230A35514B16CF47327AD 
19:09:05.142 > [ESP32] === HMAC DEBUG INFO ===
19:09:05.145 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:09:05.154 > [ESP32] HMAC Input length: 44 bytes
19:09:05.156 > [ESP32] HMAC Input (first 32 bytes): 81021600160004080000000117DE490EAE111AA99CE8018F21C1E769FD4554C4
19:09:05.164 > [ESP32] Nonce: 0x00000001
19:09:05.168 > [ESP32] Packet size before HMAC: 60
19:09:05.171 > [ESP32] Computed HMAC Tag: 21B2BC0110D5E35652CB2D9AFC53C4E6
19:09:05.176 > [ESP32] === END HMAC DEBUG ===
19:09:05.179 > 6_Final_Packet (60): 81021600160004080000000117DE490E AE111AA99CE8018F21C1E769FD4554C4 ...
19:09:05.187 > [RETRY] Attempt 1/3 (nonce: 1)
19:09:05.190 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:05.197 > Sending pipeline data to server (601 bytes)
19:09:05.486 > [HTTP] Response code: 200
19:09:05.486 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:09:05.498 > [RETRY] Health data sent successfully!
19:09:05.501 > ✓ Health data #1 sent successfully
19:09:05.603 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":1,"serverTime":1770298745273,"type":"security_update"}
19:09:05.621 > [WebSocket] Processing message type: security_update
19:09:05.626 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:09:05.631 > [14.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:05.736 > [WebSocket] Received (628 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:81021600160004080000000117DE490EAE111AA99CE8018F21C1E769FD4554C4B4B230A35514B16CF47327AD21B2BC0110D5E35652CB2D9AFC53C4E6","pipeline":{"afterLFSR":"B8B49D0D7FAE9D9B6BD5504343CC1391252F5EE1CEABEEC5FC70BD02C280FE47","afterSalt":"48522D36302053504F322D39352053544550532D39334D50","afterTinkerbell":"11A3C1279CDE69A921F430AE45FD6C14B11749550E1AB4C48FB2E773AD54E801","afterTransposition":"17DE490EAE111AA99CE8018F21C1E769FD4554C4B4B230A35514B16CF47327AD"},"plaintext":"HR-60 SPO2-95 STEPS-93","serverTime":1770298745273,"timestamp":14377,"type":"encryption_update","ztmEnabled":false}
19:09:05.791 > [WebSocket] Processing message type: encryption_update
19:09:05.797 > [15.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:05.899 > [WebSocket] Received (86 bytes): {"heartRate":60,"spo2":95,"steps":93,"time":1770298745273,"type":"health_data_update"}
19:09:05.907 > [WebSocket] Processing message type: health_data_update
19:09:05.913 > [15.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:06.021 > [WebSocket] Received (224 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3601,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-93","handshakeSuccess":true,"totalTime":0.3601},"type":"session_summary_update"}
19:09:06.043 > [WebSocket] Processing message type: session_summary_update
19:09:06.046 > [15.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:06.153 > [WebSocket] Received (654 bytes): {"decryptionTime":0.3601,"encryptedPacket":"81021600160004080000000117DE490EAE111AA99CE8018F21C1E769FD4554C4B4B230A35514B16CF47327AD21B2BC0110D5E35652CB2D9AFC53C4E6","finalPlaintext":"HR-60 SPO2-95 STEPS-93","healthData":{"heartRate":60,"spo2":95,"steps":93},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D39330000000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D39334D500000000000000000","afterTinkerbell":"B8B49D0D7FAE9D9B6BD5504343CC1391252F5EE1CEABEEC5FC70BD02C280FE47","afterTransposition":"11A3C1279CDE69A921F430AE45FD6C14B11749550E1AB4C48FB2E773AD54E801"},"serverTime":1770298745274,"type":"decryption_update"}
19:09:06.212 > [WebSocket] Processing message type: decryption_update
19:09:06.218 > [WebSocket] Server decryption completed
19:09:06.220 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 93
19:09:06.226 > [15.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:06.327 > [WebSocket] Received (640 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":0,"pipeline":{"afterLFSR":"B8B49D0D7FAE9D9B6BD5504343CC1391252F5EE1CEABEEC5FC70BD02C280FE47","afterSalt":"48522D36302053504F322D39352053544550532D39334D50","afterTinkerbell":"11A3C1279CDE69A921F430AE45FD6C14B11749550E1AB4C48FB2E773AD54E801","afterTransposition":"17DE490EAE111AA99CE8018F21C1E769FD4554C4B4B230A35514B16CF47327AD","finalPacket":"81021600160004080000000117DE490EAE111AA99CE8018F21C1E769FD4554C4B4B230A35514B16CF47327AD21B2BC0110D5E35652CB2D9AFC53C4E6"},"plaintext":"HR-60 SPO2-95 STEPS-93","timestamp":14668,"type":"encryption_pipeline","ztmEnabled":false}
19:09:06.386 > [WebSocket] Processing message type: encryption_pipeline
19:09:06.388 > [15.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:06.490 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":0,"message":"Health data #1 sent successfully","state":7,"success":true,"timestamp":14673,"type":"health_data_sent"}
19:09:06.507 > [WebSocket] Processing message type: health_data_sent
19:09:06.509 > [15.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:06.612 > [15.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:06.713 > [15.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:06.813 > [16.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:06.915 > [16.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:07.016 > [16.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:07.117 > [16.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:07.218 > [16.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:07.319 > [16.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:07.419 > [16.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:07.521 > [16.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:07.621 > [16.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:07.722 > [16.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:07.824 > [17.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:07.925 > [17.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:08.025 > [17.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:08.126 > [17.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:08.228 > [17.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:08.329 > [17.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:08.429 > [17.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:08.530 > [17.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:08.631 > [17.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:08.732 > [17.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:08.833 > [18.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:08.935 > [18.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:09.036 > [18.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:09.137 > [18.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:09.237 > [18.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:09.339 > [18.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:09.439 > [18.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:09.541 > [18.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:09.641 > [18.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:09.742 > [18.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:09.843 > [19.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:09.945 > [19.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:10.045 > [19.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:10.147 > [19.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:10.248 > [19.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:10.348 > [19.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:10.450 > [19.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:10.550 > [19.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:10.652 > [19.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:10.753 > [19.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:10.854 > [20.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:10.955 > [20.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:11.056 > [20.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:11.156 > [20.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:11.258 > [20.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:11.358 > [20.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:11.459 > [20.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:11.560 > [20.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:11.661 > [20.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:11.762 > [20.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:11.864 > [21.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:11.965 > [21.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:12.066 > [21.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:12.166 > [21.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:12.267 > [21.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:12.369 > [21.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:12.470 > [21.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:12.571 > [21.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:12.672 > [21.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:12.772 > [22.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:12.874 > [22.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:12.974 > [22.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:13.075 > [22.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:13.177 > [22.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:13.277 > [22.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:13.378 > [22.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:13.479 > [22.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:13.580 > [22.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:13.682 > [22.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:13.782 > [23.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:13.883 > [23.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:13.984 > [23.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:14.085 > [23.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:14.186 > [23.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:14.288 > [23.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:14.388 > [23.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:14.490 > [23.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:14.590 > [23.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:14.692 > [23.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:14.792 > [24.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:14.893 > [24.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:14.994 > [24.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:15.095 > [24.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:15.197 > [24.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:15.297 > [24.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:15.398 > [24.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:15.499 > [24.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:09:15.505 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:15.510 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:09:15.527 > Generated health data: HR-60 SPO2-95 STEPS-156
19:09:15.530 > [ESP32] ========================================
19:09:15.536 > [ESP32] ENCRYPTION PIPELINE START
19:09:15.538 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:09:15.546 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:09:15.552 > [ESP32] ========================================
19:09:15.558 > [ESP32] MsgKeys: lfsrSeed=0xA8FF9E73 tnk[0..3]=CABF4CED trn[0..3]=B6559938
19:09:15.563 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3135364D50
19:09:15.569 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3135364D5000000000000000 
19:09:15.577 > [ESP32][LFSR] Initializing - Seed: 0xA8FF9E73 SeedBe: 0x739EFFA8 ChaosKey[0..3]: CABF4CED InitialTap: 0x0029 State: 0xA8FF9E73
19:09:15.588 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:09:15.597 > 3_After_LFSR (32): 3BCCD29EEA490DFB1EC4E6CD8C7451EE FCCED9536E16388CC1922A958D7986C1 
19:09:15.605 > [ESP32][LFSR] Keystream (first 16 bytes): 739EFFA8DA695EAB51F6CBF4B95402BA
19:09:15.610 > [ESP32][4D] LFSR keystream (first 32 bytes): 739EFFA8DA695EAB51F6CBF4B95402BAB99E8A7E5F230EC191922A958D7986C1
19:09:15.618 > [ESP32][TINKERBELL] Input (first 16 bytes): 3BCCD29EEA490DFB1EC4E6CD8C7451EE Nonce: 0x00000002 Buffer size: 32 bytes
19:09:15.630 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: CABF4CED
19:09:15.640 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FF171D7B9D382A2DD8D1FB174E90AE39
19:09:15.649 > 4_After_Tinkerbell (32): C4DBCFE5777127D6C6151DDAC2E4FFD7 FC07BE4ED6D834D521E8309DF77B87B2 
19:09:15.654 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FF171D7B9D382A2DD8D1FB174E90AE39
19:09:15.663 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FF171D7B9D382A2DD8D1FB174E90AE3900C9671DB8CE0C59E07A1A087A020173
19:09:15.674 > 5_After_Transposition (32): D64E77C6D8DA34FCD7C27B30BE211D07 C4E571F7FFE4279D87CFD5DBB215E8D6 
19:09:15.682 > [ESP32] === HMAC DEBUG INFO ===
19:09:15.685 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:09:15.694 > [ESP32] HMAC Input length: 44 bytes
19:09:15.697 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000002D64E77C6D8DA34FCD7C27B30BE211D07C4E571F7
19:09:15.705 > [ESP32] Nonce: 0x00000002
19:09:15.708 > [ESP32] Packet size before HMAC: 60
19:09:15.710 > [ESP32] Computed HMAC Tag: 8821B5B45C524CEBDC99B714562F6FF2
19:09:15.716 > [ESP32] === END HMAC DEBUG ===
19:09:15.719 > 6_Final_Packet (60): 810217001700040800000002D64E77C6 D8DA34FCD7C27B30BE211D07C4E571F7 ...
19:09:15.727 > [RETRY] Attempt 1/3 (nonce: 2)
19:09:15.729 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:15.736 > Sending pipeline data to server (604 bytes)
19:09:16.001 > [HTTP] Response code: 200
19:09:16.001 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:09:16.013 > [RETRY] Health data sent successfully!
19:09:16.016 > ✓ Health data #2 sent successfully
19:09:16.118 > [WebSocket] Received (631 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:810217001700040800000002D64E77C6D8DA34FCD7C27B30BE211D07C4E571F7FFE4279D87CFD5DBB215E8D68821B5B45C524CEBDC99B714562F6FF2","pipeline":{"afterLFSR":"3BCCD29EEA490DFB1EC4E6CD8C7451EEFCCED9536E16388CC1922A958D7986C1","afterSalt":"48522D36302053504F322D39352053544550532D3135364D50","afterTinkerbell":"C4DBCFE5777127D6C6151DDAC2E4FFD7FC07BE4ED6D834D521E8309DF77B87B2","afterTransposition":"D64E77C6D8DA34FCD7C27B30BE211D07C4E571F7FFE4279D87CFD5DBB215E8D6"},"plaintext":"HR-60 SPO2-95 STEPS-156","serverTime":1770298755825,"timestamp":24918,"type":"encryption_update","ztmEnabled":false}
19:09:16.173 > [WebSocket] Processing message type: encryption_update
19:09:16.178 > [25.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:16.282 > [WebSocket] Received (87 bytes): {"heartRate":60,"spo2":95,"steps":156,"time":1770298755825,"type":"health_data_update"}
19:09:16.290 > [WebSocket] Processing message type: health_data_update
19:09:16.295 > [25.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:16.404 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2505,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-156","handshakeSuccess":true,"totalTime":0.2505},"type":"session_summary_update"}
19:09:16.426 > [WebSocket] Processing message type: session_summary_update
19:09:16.432 > [25.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:16.537 > [WebSocket] Received (656 bytes): {"decryptionTime":0.2505,"encryptedPacket":"810217001700040800000002D64E77C6D8DA34FCD7C27B30BE211D07C4E571F7FFE4279D87CFD5DBB215E8D68821B5B45C524CEBDC99B714562F6FF2","finalPlaintext":"HR-60 SPO2-95 STEPS-156","healthData":{"heartRate":60,"spo2":95,"steps":156},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D31353600000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D3135364D5000000000000000","afterTinkerbell":"3BCCD29EEA490DFB1EC4E6CD8C7451EEFCCED9536E16388CC1922A958D7986C1","afterTransposition":"C4DBCFE5777127D6C6151DDAC2E4FFD7FC07BE4ED6D834D521E8309DF77B87B2"},"serverTime":1770298755826,"type":"decryption_update"}
19:09:16.594 > [WebSocket] Processing message type: decryption_update
19:09:16.600 > [WebSocket] Server decryption completed
19:09:16.603 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 156
19:09:16.609 > [25.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:16.710 > [WebSocket] Received (643 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":1,"pipeline":{"afterLFSR":"3BCCD29EEA490DFB1EC4E6CD8C7451EEFCCED9536E16388CC1922A958D7986C1","afterSalt":"48522D36302053504F322D39352053544550532D3135364D50","afterTinkerbell":"C4DBCFE5777127D6C6151DDAC2E4FFD7FC07BE4ED6D834D521E8309DF77B87B2","afterTransposition":"D64E77C6D8DA34FCD7C27B30BE211D07C4E571F7FFE4279D87CFD5DBB215E8D6","finalPacket":"810217001700040800000002D64E77C6D8DA34FCD7C27B30BE211D07C4E571F7FFE4279D87CFD5DBB215E8D68821B5B45C524CEBDC99B714562F6FF2"},"plaintext":"HR-60 SPO2-95 STEPS-156","timestamp":25183,"type":"encryption_pipeline","ztmEnabled":false}
19:09:16.768 > [WebSocket] Processing message type: encryption_pipeline
19:09:16.771 > [26.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:16.873 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Health data #2 sent successfully","state":7,"success":true,"timestamp":25187,"type":"health_data_sent"}
19:09:16.890 > [WebSocket] Processing message type: health_data_sent
19:09:16.892 > [26.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:16.995 > [26.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:17.096 > [26.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:17.197 > [26.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:17.297 > [26.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:17.398 > [26.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:17.500 > [26.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:17.600 > [26.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:17.702 > [26.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:17.803 > [27.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:17.904 > [27.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:18.004 > [27.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:18.106 > [27.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:18.206 > [27.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:18.307 > [27.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:18.407 > [27.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:18.509 > [27.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:18.610 > [27.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:18.711 > [27.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:18.812 > [28.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:18.913 > [28.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:19.014 > [28.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:19.115 > [28.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:19.216 > [28.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:19.317 > [28.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:19.419 > [28.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:19.519 > [28.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:19.620 > [28.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:19.721 > [28.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:19.823 > [29.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:19.923 > [29.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:20.024 > [29.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:20.125 > [29.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:20.225 > [29.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:20.327 > [29.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:20.428 > [29.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:20.530 > [29.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:20.630 > [29.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:20.731 > [29.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:20.833 > [30.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:20.933 > [30.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:21.034 > [30.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:21.135 > [30.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:21.236 > [30.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:21.337 > [30.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:21.438 > [30.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:21.539 > [30.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:21.640 > [30.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:21.741 > [30.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:21.842 > [31.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:21.942 > [31.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:22.044 > [31.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:22.145 > [31.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:22.247 > [31.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:22.347 > [31.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:22.448 > [31.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:22.549 > [31.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:22.650 > [31.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:22.751 > [31.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:22.852 > [32.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:22.953 > [32.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:23.055 > [32.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:23.156 > [32.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:23.257 > [32.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:23.357 > [32.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:23.458 > [32.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:23.559 > [32.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:23.660 > [32.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:23.761 > [32.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:23.862 > [33.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:23.963 > [33.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:24.065 > [33.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:24.165 > [33.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:24.266 > [33.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:24.367 > [33.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:24.468 > [33.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:24.570 > [33.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:24.671 > [33.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:24.772 > [34.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:24.872 > [34.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:24.973 > [34.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:25.074 > [34.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:25.174 > [34.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:25.275 > [34.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:25.377 > [34.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:25.478 > [34.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:25.579 > [34.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:25.680 > [34.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:25.781 > [35.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:25.881 > [35.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:25.983 > [35.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:26.084 > [35.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:09:26.089 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:26.095 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:09:26.112 > Generated health data: HR-60 SPO2-95 STEPS-205
19:09:26.114 > [ESP32] ========================================
19:09:26.120 > [ESP32] ENCRYPTION PIPELINE START
19:09:26.123 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:09:26.131 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:09:26.137 > [ESP32] ========================================
19:09:26.142 > [ESP32] MsgKeys: lfsrSeed=0xC81F711A tnk[0..3]=CF820CD4 trn[0..3]=5A6D05C1
19:09:26.148 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3230354D50
19:09:26.154 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3230354D5000000000000000 
19:09:26.162 > [ESP32][LFSR] Initializing - Seed: 0xC81F711A SeedBe: 0x1A711FC8 ChaosKey[0..3]: CF820CD4 InitialTap: 0x0029 State: 0xC81F711A
19:09:26.172 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:09:26.181 > 3_After_LFSR (32): 522332FE24ECD8CC16D1A8A570E7B65C A6BCE02E30D429C046DFA2BC1C674252 
19:09:26.190 > [ESP32][LFSR] Keystream (first 16 bytes): 1A711FC814CC8B9C59E3859C45C7E508
19:09:26.195 > [ESP32][4D] LFSR keystream (first 32 bytes): 1A711FC814CC8B9C59E3859C45C7E508E3ECB30302E41C8D16DFA2BC1C674252
19:09:26.203 > [ESP32][TINKERBELL] Input (first 16 bytes): 522332FE24ECD8CC16D1A8A570E7B65C Nonce: 0x00000003 Buffer size: 32 bytes
19:09:26.215 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: CF820CD4
19:09:26.225 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B9180666F0D17F13AF09BD1D38DFBA6D
19:09:26.234 > 4_After_Tinkerbell (32): EB3B3498D43DA7DFB9D815B848380C31 DBCC4DA4CEA630A4510C2DFEA0F8CD93 
19:09:26.240 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B9180666F0D17F13AF09BD1D38DFBA6D
19:09:26.248 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): B9180666F0D17F13AF09BD1D38DFBA6D7D70AD8AFE72196417D38F42BC9F8FC1
19:09:26.259 > 5_After_Transposition (32): F8A4984DA7A03DB83BFE38DFDB51CE48 30CCB90CD82D34A4A615D4CDEB310C93 
19:09:26.267 > [ESP32] === HMAC DEBUG INFO ===
19:09:26.270 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:09:26.278 > [ESP32] HMAC Input length: 44 bytes
19:09:26.281 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000003F8A4984DA7A03DB83BFE38DFDB51CE4830CCB90C
19:09:26.289 > [ESP32] Nonce: 0x00000003
19:09:26.293 > [ESP32] Packet size before HMAC: 60
19:09:26.295 > [ESP32] Computed HMAC Tag: 40021E80012A806DFE9311EFCC3D00E8
19:09:26.301 > [ESP32] === END HMAC DEBUG ===
19:09:26.304 > 6_Final_Packet (60): 810217001700040800000003F8A4984D A7A03DB83BFE38DFDB51CE4830CCB90C ...
19:09:26.312 > [RETRY] Attempt 1/3 (nonce: 3)
19:09:26.314 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:26.322 > Sending pipeline data to server (604 bytes)
19:09:26.513 > [HTTP] Response code: 200
19:09:26.513 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:09:26.523 > [RETRY] Health data sent successfully!
19:09:26.526 > ✓ Health data #3 sent successfully
19:09:26.627 > [WebSocket] Received (631 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:810217001700040800000003F8A4984DA7A03DB83BFE38DFDB51CE4830CCB90CD82D34A4A615D4CDEB310C9340021E80012A806DFE9311EFCC3D00E8","pipeline":{"afterLFSR":"522332FE24ECD8CC16D1A8A570E7B65CA6BCE02E30D429C046DFA2BC1C674252","afterSalt":"48522D36302053504F322D39352053544550532D3230354D50","afterTinkerbell":"EB3B3498D43DA7DFB9D815B848380C31DBCC4DA4CEA630A4510C2DFEA0F8CD93","afterTransposition":"F8A4984DA7A03DB83BFE38DFDB51CE4830CCB90CD82D34A4A615D4CDEB310C93"},"plaintext":"HR-60 SPO2-95 STEPS-205","serverTime":1770298766394,"timestamp":35503,"type":"encryption_update","ztmEnabled":false}
19:09:26.682 > [WebSocket] Processing message type: encryption_update
19:09:26.688 > [35.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:26.791 > [WebSocket] Received (87 bytes): {"heartRate":60,"spo2":95,"steps":205,"time":1770298766394,"type":"health_data_update"}
19:09:26.801 > [WebSocket] Processing message type: health_data_update
19:09:26.805 > [36.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:26.914 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2446,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-205","handshakeSuccess":true,"totalTime":0.2446},"type":"session_summary_update"}
19:09:26.935 > [WebSocket] Processing message type: session_summary_update
19:09:26.941 > [36.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:27.046 > [WebSocket] Received (656 bytes): {"decryptionTime":0.2446,"encryptedPacket":"810217001700040800000003F8A4984DA7A03DB83BFE38DFDB51CE4830CCB90CD82D34A4A615D4CDEB310C9340021E80012A806DFE9311EFCC3D00E8","finalPlaintext":"HR-60 SPO2-95 STEPS-205","healthData":{"heartRate":60,"spo2":95,"steps":205},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D32303500000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D3230354D5000000000000000","afterTinkerbell":"522332FE24ECD8CC16D1A8A570E7B65CA6BCE02E30D429C046DFA2BC1C674252","afterTransposition":"EB3B3498D43DA7DFB9D815B848380C31DBCC4DA4CEA630A4510C2DFEA0F8CD93"},"serverTime":1770298766395,"type":"decryption_update"}
19:09:27.104 > [WebSocket] Processing message type: decryption_update
19:09:27.110 > [WebSocket] Server decryption completed
19:09:27.112 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 205
19:09:27.118 > [36.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:27.219 > [WebSocket] Received (643 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":2,"pipeline":{"afterLFSR":"522332FE24ECD8CC16D1A8A570E7B65CA6BCE02E30D429C046DFA2BC1C674252","afterSalt":"48522D36302053504F322D39352053544550532D3230354D50","afterTinkerbell":"EB3B3498D43DA7DFB9D815B848380C31DBCC4DA4CEA630A4510C2DFEA0F8CD93","afterTransposition":"F8A4984DA7A03DB83BFE38DFDB51CE4830CCB90CD82D34A4A615D4CDEB310C93","finalPacket":"810217001700040800000003F8A4984DA7A03DB83BFE38DFDB51CE4830CCB90CD82D34A4A615D4CDEB310C9340021E80012A806DFE9311EFCC3D00E8"},"plaintext":"HR-60 SPO2-95 STEPS-205","timestamp":35696,"type":"encryption_pipeline","ztmEnabled":false}
19:09:27.277 > [WebSocket] Processing message type: encryption_pipeline
19:09:27.280 > [36.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:27.381 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Health data #3 sent successfully","state":7,"success":true,"timestamp":35700,"type":"health_data_sent"}
19:09:27.398 > [WebSocket] Processing message type: health_data_sent
19:09:27.401 > [36.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:27.507 > [WebSocket] Received (493 bytes): {"activatedAt":1770298766651,"active":true,"epoch":1,"heuristics":{"cpuUsage":20.0,"decryptFailures":0,"entropy":7.5,"hmacFailures":0,"latency":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"lastCommitNonce":0,"lastSeenNonce":1016,"lastSwitchReason":"ZTM activated - baseline recipe","message":"Zero Trust Mode activated successfully","pendingProposals":0,"recipe":"CHAOS_ONLY","serverTime":1770298766651,"success":true,"threatLevel":0,"type":"ztm_activation_acknowledged"}
19:09:27.551 > [WebSocket] Processing message type: ztm_activation_acknowledged
19:09:27.556 > [WebSocket] ========================================
19:09:27.562 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged, fromFrontend: NO)
19:09:27.571 > [WebSocket] ========================================
19:09:27.574 > [ZTM] Settings saved successfully
19:09:27.576 > [WebSocket] ✓ ZTM activated successfully
19:09:27.581 > [WebSocket] ✓ Normal Mode encryption STOPPED
19:09:27.585 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
19:09:27.590 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
19:09:27.592 > [WebSocket] ========================================
19:09:27.598 > [WebSocket] Received server ack - not sending duplicate ack (prevents loop)
19:09:27.606 > [36.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:27.709 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":36783,"type":"ztm_activated"}
19:09:27.726 > [WebSocket] Processing message type: ztm_activated
19:09:27.728 > [36.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:27.832 > [WebSocket] Received (314 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":1016,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298767658,"threatLevel":0,"type":"heuristics_update"}
19:09:27.859 > [WebSocket] Processing message type: heuristics_update
19:09:27.864 > [37.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:27.974 > [37.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:28.075 > [37.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:28.176 > [37.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:28.277 > [37.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:28.378 > [37.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:28.479 > [37.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:28.579 > [37.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:28.681 > [WebSocket] Received (314 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":1016,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298768672,"threatLevel":0,"type":"heuristics_update"}
19:09:28.709 > [WebSocket] Processing message type: heuristics_update
19:09:28.715 > [37.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:28.824 > [38.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:28.925 > [38.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:29.026 > [38.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:29.127 > [38.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:29.228 > [38.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:29.328 > [38.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:29.430 > [38.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:29.531 > [38.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:29.632 > [38.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:29.733 > [WebSocket] Received (314 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":1016,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298769680,"threatLevel":0,"type":"heuristics_update"}
19:09:29.762 > [WebSocket] Processing message type: heuristics_update
19:09:29.767 > [38.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:29.876 > [39.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:29.977 > [39.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:30.078 > [39.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:30.179 > [39.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:30.280 > [39.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:30.381 > [39.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:30.482 > [39.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:30.583 > [39.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:30.684 > [39.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:30.785 > [WebSocket] Received (314 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":1016,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298770690,"threatLevel":0,"type":"heuristics_update"}
19:09:30.814 > [WebSocket] Processing message type: heuristics_update
19:09:30.818 > [40.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:30.929 > [40.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:31.029 > [40.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:31.130 > [40.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:31.231 > [40.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:31.332 > [40.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:31.433 > [40.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:31.534 > [40.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:31.635 > [40.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:31.739 > [WebSocket] Received (314 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":1016,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298771700,"threatLevel":0,"type":"heuristics_update"}
19:09:31.767 > [WebSocket] Processing message type: heuristics_update
19:09:31.772 > [41.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:31.881 > [41.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:31.982 > [41.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:32.083 > [41.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:32.184 > [41.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:32.285 > [41.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:32.386 > [41.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:32.487 > [41.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:32.588 > [41.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:32.689 > [41.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:32.790 > [WebSocket] Received (314 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":1016,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298772709,"threatLevel":0,"type":"heuristics_update"}
19:09:32.818 > [WebSocket] Processing message type: heuristics_update
19:09:32.823 > [42.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:32.933 > [42.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:33.034 > [42.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:33.135 > [42.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:33.236 > [42.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:33.337 > [42.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:33.438 > [42.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:33.539 > [42.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:33.639 > [42.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:33.741 > [WebSocket] Received (314 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":1016,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298773720,"threatLevel":0,"type":"heuristics_update"}
19:09:33.770 > [WebSocket] Processing message type: heuristics_update
19:09:33.775 > [43.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:33.885 > [43.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:33.986 > [43.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:34.087 > [43.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:34.188 > [43.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:34.289 > [43.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:34.390 > [43.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:34.491 > [43.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:34.591 > [43.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:34.693 > [43.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:34.795 > [WebSocket] Received (314 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":1016,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298774729,"threatLevel":0,"type":"heuristics_update"}
19:09:34.822 > [WebSocket] Processing message type: heuristics_update
19:09:34.828 > [44.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:34.937 > [44.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:35.038 > [44.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:35.139 > [44.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:35.239 > [44.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:35.340 > [44.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:35.442 > [44.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:35.542 > [44.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:35.644 > [44.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:35.744 > [44.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:35.847 > [WebSocket] Received (314 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":1016,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298775740,"threatLevel":0,"type":"heuristics_update"}
19:09:35.874 > [WebSocket] Processing message type: heuristics_update
19:09:35.880 > [45.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:35.989 > [45.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:36.089 > [45.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:36.190 > [45.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:36.291 > [45.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:36.393 > [45.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:36.493 > [45.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:36.595 > [45.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:09:36.600 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:36.606 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 4 for all retry attempts (saved: 3)
19:09:36.622 > Generated health data: HR-60 SPO2-95 STEPS-245
19:09:36.625 > [ESP32] ========================================
19:09:36.631 > [ESP32] ENCRYPTION PIPELINE START
19:09:36.633 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:36.639 > [ESP32] Active Algorithms for this packet:
19:09:36.642 > [ESP32]   + LFSR
19:09:36.644 > [ESP32]   + Tinkerbell
19:09:36.647 > [ESP32]   + Transposition
19:09:36.647 > [ESP32]   - ChaCha20
19:09:36.650 > [ESP32]   - Salsa20
19:09:36.653 > [ESP32] ========================================
19:09:36.656 > [ESP32] MsgKeys: lfsrSeed=0xF24AC112 tnk[0..3]=286607CD trn[0..3]=0B37C3C2
19:09:36.664 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3234354D50
19:09:36.670 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3234354D5000000000000000 
19:09:36.678 > [ESP32][LFSR] Initializing - Seed: 0xF24AC112 SeedBe: 0x12C14AF2 ChaosKey[0..3]: 286607CD InitialTap: 0x0029 State: 0xF24AC112
19:09:36.689 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:09:36.698 > 3_After_LFSR (32): 5A9367C4E3CCE9907F7B2E52FB2DDB04 0FF817AA6F5D95571956120B13AC7931 
19:09:36.703 > [ESP32][LFSR] Keystream (first 16 bytes): 12C14AF2D3ECBAC03049036BCE0D8850
19:09:36.711 > [ESP32][4D] LFSR keystream (first 32 bytes): 12C14AF2D3ECBAC03049036BCE0D88504AA844875D69A01A4956120B13AC7931
19:09:36.720 > [ESP32][TINKERBELL] Input (first 16 bytes): 5A9367C4E3CCE9907F7B2E52FB2DDB04 Nonce: 0x00000004 Buffer size: 32 bytes
19:09:36.730 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000004 Counter: 0 (must start at 0) Key[0..3]: 286607CD
19:09:36.739 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 345162AFCDD4273F09BC668BD9CB551D
19:09:36.747 > 4_After_Tinkerbell (32): 6EC2056B2E18CEAF76C748D922E68E19 7A5565E01D00531217B1C0F4BAA9A530 
19:09:36.756 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 345162AFCDD4273F09BC668BD9CB551D
19:09:36.764 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 345162AFCDD4273F09BC668BD9CB551D75AD724A725DC6450EE7D2FFA905DC01
19:09:36.775 > 5_After_Transposition (32): 180519AFC0F4302E12E68E00C71D55D9 176EBACEE0A56B7AC253B12248A96576 
19:09:36.783 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000004
19:09:36.786 > [ESP32] === HMAC DEBUG INFO ===
19:09:36.789 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:09:36.798 > [ESP32] HMAC Input length: 45 bytes
19:09:36.800 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000004180519AFC0F4302E12E68E00C71D55D9176EBA
19:09:36.811 > [ESP32] Nonce: 0x00000004
19:09:36.811 > [ESP32] Packet size before HMAC: 61
19:09:36.817 > [ESP32] Computed HMAC Tag: 8F560DE0D7D1A8932EE425D6FC235FFA
19:09:36.820 > [ESP32] === END HMAC DEBUG ===
19:09:36.823 > 6_Final_Packet (61): 82021700170004080400000004180519 AFC0F4302E12E68E00C71D55D9176EBA ...
19:09:36.831 > [RETRY] Attempt 1/3 (nonce: 4)
19:09:36.833 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:36.839 > Sending pipeline data to server (605 bytes)
19:09:37.026 > [HTTP] Response code: 200
19:09:37.026 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:09:37.039 > [RETRY] Health data sent successfully!
19:09:37.041 > ✓ Health data #4 sent successfully
19:09:37.142 > [WebSocket] Received (314 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":1016,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298776755,"threatLevel":0,"type":"heuristics_update"}
19:09:37.171 > [WebSocket] Processing message type: heuristics_update
19:09:37.176 > [46.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:37.276 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":4,"serverTime":1770298776919,"type":"security_update"}
19:09:37.293 > [WebSocket] Processing message type: security_update
19:09:37.298 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:09:37.303 > [46.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:37.408 > [WebSocket] Received (632 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:82021700170004080400000004180519AFC0F4302E12E68E00C71D55D9176EBACEE0A56B7AC253B12248A965768F560DE0D7D1A8932EE425D6FC235FFA","pipeline":{"afterLFSR":"5A9367C4E3CCE9907F7B2E52FB2DDB040FF817AA6F5D95571956120B13AC7931","afterSalt":"48522D36302053504F322D39352053544550532D3234354D50","afterTinkerbell":"6EC2056B2E18CEAF76C748D922E68E197A5565E01D00531217B1C0F4BAA9A530","afterTransposition":"180519AFC0F4302E12E68E00C71D55D9176EBACEE0A56B7AC253B12248A96576"},"plaintext":"HR-60 SPO2-95 STEPS-245","serverTime":1770298776919,"timestamp":46014,"type":"encryption_update","ztmEnabled":true}
19:09:37.463 > [WebSocket] Processing message type: encryption_update
19:09:37.469 > [46.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:37.571 > [WebSocket] Received (87 bytes): {"heartRate":60,"spo2":95,"steps":245,"time":1770298776919,"type":"health_data_update"}
19:09:37.579 > [WebSocket] Processing message type: health_data_update
19:09:37.585 > [46.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:37.693 > [WebSocket] Received (223 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.323,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-245","handshakeSuccess":true,"totalTime":0.323},"type":"session_summary_update"}
19:09:37.716 > [WebSocket] Processing message type: session_summary_update
19:09:37.719 > [46.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:37.826 > [WebSocket] Received (657 bytes): {"decryptionTime":0.323,"encryptedPacket":"82021700170004080400000004180519AFC0F4302E12E68E00C71D55D9176EBACEE0A56B7AC253B12248A965768F560DE0D7D1A8932EE425D6FC235FFA","finalPlaintext":"HR-60 SPO2-95 STEPS-245","healthData":{"heartRate":60,"spo2":95,"steps":245},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D32343500000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D3234354D5000000000000000","afterTinkerbell":"5A9367C4E3CCE9907F7B2E52FB2DDB040FF817AA6F5D95571956120B13AC7931","afterTransposition":"6EC2056B2E18CEAF76C748D922E68E197A5565E01D00531217B1C0F4BAA9A530"},"serverTime":1770298776920,"type":"decryption_update"}
19:09:37.884 > [WebSocket] Processing message type: decryption_update
19:09:37.890 > [WebSocket] Server decryption completed
19:09:37.892 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 245
19:09:37.898 > [47.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:38.000 > [WebSocket] Received (644 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":3,"pipeline":{"afterLFSR":"5A9367C4E3CCE9907F7B2E52FB2DDB040FF817AA6F5D95571956120B13AC7931","afterSalt":"48522D36302053504F322D39352053544550532D3234354D50","afterTinkerbell":"6EC2056B2E18CEAF76C748D922E68E197A5565E01D00531217B1C0F4BAA9A530","afterTransposition":"180519AFC0F4302E12E68E00C71D55D9176EBACEE0A56B7AC253B12248A96576","finalPacket":"82021700170004080400000004180519AFC0F4302E12E68E00C71D55D9176EBACEE0A56B7AC253B12248A965768F560DE0D7D1A8932EE425D6FC235FFA"},"plaintext":"HR-60 SPO2-95 STEPS-245","timestamp":46209,"type":"encryption_pipeline","ztmEnabled":true}
19:09:38.058 > [WebSocket] Processing message type: encryption_pipeline
19:09:38.064 > [47.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:38.163 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Health data #4 sent successfully","state":7,"success":true,"timestamp":46214,"type":"health_data_sent"}
19:09:38.180 > [WebSocket] Processing message type: health_data_sent
19:09:38.183 > [47.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:38.286 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298777765,"threatLevel":0,"type":"heuristics_update"}
19:09:38.314 > [WebSocket] Processing message type: heuristics_update
19:09:38.319 > [47.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:38.429 > [47.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:38.529 > [47.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:38.631 > [47.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:38.732 > [47.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:38.833 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298778775,"threatLevel":0,"type":"heuristics_update"}
19:09:38.861 > [WebSocket] Processing message type: heuristics_update
19:09:38.866 > [48.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:38.975 > [48.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:39.076 > [48.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:39.177 > [48.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:39.279 > [48.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:39.379 > [48.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:39.481 > [48.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:39.582 > [48.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:39.682 > [48.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:39.783 > [49.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:39.886 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298779785,"threatLevel":0,"type":"heuristics_update"}
19:09:39.913 > [WebSocket] Processing message type: heuristics_update
19:09:39.919 > [49.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:40.029 > [49.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:40.130 > [49.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:40.230 > [49.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:40.332 > [49.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:40.431 > [49.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:40.533 > [49.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:40.634 > [49.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:40.735 > [49.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:40.837 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298780796,"threatLevel":0,"type":"heuristics_update"}
19:09:40.865 > [WebSocket] Processing message type: heuristics_update
19:09:40.871 > [50.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:40.969 > [50.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:41.070 > [50.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:41.172 > [50.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:41.272 > [50.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:41.373 > [50.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:41.474 > [50.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:41.575 > [50.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:41.676 > [50.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:41.777 > [51.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:41.882 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298781802,"threatLevel":0,"type":"heuristics_update"}
19:09:41.909 > [WebSocket] Processing message type: heuristics_update
19:09:41.915 > [51.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:42.014 > [51.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:42.115 > [51.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:42.215 > [51.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:42.316 > [51.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:42.418 > [51.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:42.518 > [51.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:42.620 > [51.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:42.721 > [51.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:42.822 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298782808,"threatLevel":0,"type":"heuristics_update"}
19:09:42.850 > [WebSocket] Processing message type: heuristics_update
19:09:42.856 > [52.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:42.965 > [52.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:43.065 > [52.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:43.166 > [52.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:43.267 > [52.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:43.369 > [52.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:43.470 > [52.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:43.570 > [52.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:43.672 > [52.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:43.772 > [53.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:43.874 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298783824,"threatLevel":0,"type":"heuristics_update"}
19:09:43.902 > [WebSocket] Processing message type: heuristics_update
19:09:43.908 > [53.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:44.006 > [53.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:44.108 > [53.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:44.208 > [53.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:44.309 > [53.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:44.411 > [53.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:44.512 > [53.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:44.612 > [53.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:44.714 > [53.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:44.814 > [54.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:44.916 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298784835,"threatLevel":0,"type":"heuristics_update"}
19:09:44.944 > [WebSocket] Processing message type: heuristics_update
19:09:44.950 > [54.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:45.058 > [54.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:45.159 > [54.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:45.261 > [54.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:45.362 > [54.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:45.463 > [54.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:45.563 > [54.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:45.665 > [54.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:45.766 > [54.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:45.867 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298785844,"threatLevel":0,"type":"heuristics_update"}
19:09:45.894 > [WebSocket] Processing message type: heuristics_update
19:09:45.901 > [55.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:46.010 > [55.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:46.110 > [55.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:46.211 > [55.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:46.312 > [55.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:46.413 > [55.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:46.515 > [55.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:46.615 > [55.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:46.716 > [55.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:46.817 > [56.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:46.921 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298786856,"threatLevel":0,"type":"heuristics_update"}
19:09:46.949 > [WebSocket] Processing message type: heuristics_update
19:09:46.955 > [56.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:47.064 > [56.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:09:47.069 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:47.075 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 5 for all retry attempts (saved: 4)
19:09:47.091 > Generated health data: HR-60 SPO2-95 STEPS-315
19:09:47.094 > [ESP32] ========================================
19:09:47.099 > [ESP32] ENCRYPTION PIPELINE START
19:09:47.102 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:47.108 > [ESP32] Active Algorithms for this packet:
19:09:47.111 > [ESP32]   + LFSR
19:09:47.113 > [ESP32]   + Tinkerbell
19:09:47.116 > [ESP32]   + Transposition
19:09:47.116 > [ESP32]   - ChaCha20
19:09:47.119 > [ESP32]   - Salsa20
19:09:47.122 > [ESP32] ========================================
19:09:47.125 > [ESP32] MsgKeys: lfsrSeed=0xC6889FC5 tnk[0..3]=4E176ACA trn[0..3]=3DF81BA5
19:09:47.133 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3331354D50
19:09:47.138 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3331354D5000000000000000 
19:09:47.147 > [ESP32][LFSR] Initializing - Seed: 0xC6889FC5 SeedBe: 0xC59F88C6 ChaosKey[0..3]: 4E176ACA InitialTap: 0x0029 State: 0xC6889FC5
19:09:47.158 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:09:47.166 > 3_After_LFSR (32): 8DCDA5F0A53B6AC986196D8B3845222E FF4C7E0B898E7B3077895EDE5D2781A8 
19:09:47.172 > [ESP32][LFSR] Keystream (first 16 bytes): C59F88C6951B3999C92B40B20D65717A
19:09:47.180 > [ESP32][4D] LFSR keystream (first 32 bytes): C59F88C6951B3999C92B40B20D65717ABA1C2D26BABF4E7D27895EDE5D2781A8
19:09:47.188 > [ESP32][TINKERBELL] Input (first 16 bytes): 8DCDA5F0A53B6AC986196D8B3845222E Nonce: 0x00000005 Buffer size: 32 bytes
19:09:47.199 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000005 Counter: 0 (must start at 0) Key[0..3]: 4E176ACA
19:09:47.208 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9A7F27F707BB05F54E5391A646399A73
19:09:47.216 > 4_After_Tinkerbell (32): 17B28207A2806F3CC84AFC2D7E7CB85D 444990DF61923AC3A127CF0E1F8BE13F 
19:09:47.225 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9A7F27F707BB05F54E5391A646399A73
19:09:47.233 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 9A7F27F707BB05F54E5391A646399A73BB05EED4E81C41F3D6AE91D042AC6097
19:09:47.244 > 5_After_Transposition (32): 4ACF173C7CC3E127073A80442D92A190 8B49C8B8A25D3F82B20E1F6F61DFFC7E 
19:09:47.253 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000005
19:09:47.254 > [ESP32] === HMAC DEBUG INFO ===
19:09:47.258 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:09:47.266 > [ESP32] HMAC Input length: 45 bytes
19:09:47.268 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000054ACF173C7CC3E127073A80442D92A1908B49C8
19:09:47.280 > [ESP32] Nonce: 0x00000005
19:09:47.280 > [ESP32] Packet size before HMAC: 61
19:09:47.286 > [ESP32] Computed HMAC Tag: 8B756B1B930F43197AFC4661A327F63E
19:09:47.289 > [ESP32] === END HMAC DEBUG ===
19:09:47.291 > 6_Final_Packet (61): 820217001700040804000000054ACF17 3C7CC3E127073A80442D92A1908B49C8 ...
19:09:47.299 > [RETRY] Attempt 1/3 (nonce: 5)
19:09:47.302 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:47.308 > Sending pipeline data to server (605 bytes)
19:09:47.541 > [HTTP] Response code: 200
19:09:47.541 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:09:47.554 > [RETRY] Health data sent successfully!
19:09:47.557 > ✓ Health data #5 sent successfully
19:09:47.656 > [WebSocket] Received (632 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820217001700040804000000054ACF173C7CC3E127073A80442D92A1908B49C8B8A25D3F82B20E1F6F61DFFC7E8B756B1B930F43197AFC4661A327F63E","pipeline":{"afterLFSR":"8DCDA5F0A53B6AC986196D8B3845222EFF4C7E0B898E7B3077895EDE5D2781A8","afterSalt":"48522D36302053504F322D39352053544550532D3331354D50","afterTinkerbell":"17B28207A2806F3CC84AFC2D7E7CB85D444990DF61923AC3A127CF0E1F8BE13F","afterTransposition":"4ACF173C7CC3E127073A80442D92A1908B49C8B8A25D3F82B20E1F6F61DFFC7E"},"plaintext":"HR-60 SPO2-95 STEPS-315","serverTime":1770298787377,"timestamp":56483,"type":"encryption_update","ztmEnabled":true}
19:09:47.712 > [WebSocket] Processing message type: encryption_update
19:09:47.717 > [56.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:47.820 > [WebSocket] Received (87 bytes): {"heartRate":60,"spo2":95,"steps":315,"time":1770298787377,"type":"health_data_update"}
19:09:47.828 > [WebSocket] Processing message type: health_data_update
19:09:47.833 > [57.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:47.941 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3372,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-315","handshakeSuccess":true,"totalTime":0.3372},"type":"session_summary_update"}
19:09:47.963 > [WebSocket] Processing message type: session_summary_update
19:09:47.969 > [57.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:48.074 > [WebSocket] Received (658 bytes): {"decryptionTime":0.3372,"encryptedPacket":"820217001700040804000000054ACF173C7CC3E127073A80442D92A1908B49C8B8A25D3F82B20E1F6F61DFFC7E8B756B1B930F43197AFC4661A327F63E","finalPlaintext":"HR-60 SPO2-95 STEPS-315","healthData":{"heartRate":60,"spo2":95,"steps":315},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D33313500000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D3331354D5000000000000000","afterTinkerbell":"8DCDA5F0A53B6AC986196D8B3845222EFF4C7E0B898E7B3077895EDE5D2781A8","afterTransposition":"17B28207A2806F3CC84AFC2D7E7CB85D444990DF61923AC3A127CF0E1F8BE13F"},"serverTime":1770298787378,"type":"decryption_update"}
19:09:48.132 > [WebSocket] Processing message type: decryption_update
19:09:48.138 > [WebSocket] Server decryption completed
19:09:48.141 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 315
19:09:48.146 > [57.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:48.247 > [WebSocket] Received (644 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":4,"pipeline":{"afterLFSR":"8DCDA5F0A53B6AC986196D8B3845222EFF4C7E0B898E7B3077895EDE5D2781A8","afterSalt":"48522D36302053504F322D39352053544550532D3331354D50","afterTinkerbell":"17B28207A2806F3CC84AFC2D7E7CB85D444990DF61923AC3A127CF0E1F8BE13F","afterTransposition":"4ACF173C7CC3E127073A80442D92A1908B49C8B8A25D3F82B20E1F6F61DFFC7E","finalPacket":"820217001700040804000000054ACF173C7CC3E127073A80442D92A1908B49C8B8A25D3F82B20E1F6F61DFFC7E8B756B1B930F43197AFC4661A327F63E"},"plaintext":"HR-60 SPO2-95 STEPS-315","timestamp":56725,"type":"encryption_pipeline","ztmEnabled":true}
19:09:48.306 > [WebSocket] Processing message type: encryption_pipeline
19:09:48.312 > [57.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:48.411 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Health data #5 sent successfully","state":7,"success":true,"timestamp":56730,"type":"health_data_sent"}
19:09:48.427 > [WebSocket] Processing message type: health_data_sent
19:09:48.430 > [57.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:48.532 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298787866,"threatLevel":0,"type":"heuristics_update"}
19:09:48.560 > [WebSocket] Processing message type: heuristics_update
19:09:48.566 > [57.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:48.676 > [57.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:48.776 > [58.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:48.880 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298788868,"threatLevel":0,"type":"heuristics_update"}
19:09:48.908 > [WebSocket] Processing message type: heuristics_update
19:09:48.914 > [58.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:49.022 > [58.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:49.123 > [58.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:49.224 > [58.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:49.325 > [58.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:49.426 > [58.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:49.527 > [58.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:49.628 > [58.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:49.729 > [58.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:49.830 > [59.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:49.932 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298789883,"threatLevel":0,"type":"heuristics_update"}
19:09:49.960 > [WebSocket] Processing message type: heuristics_update
19:09:49.965 > [59.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:50.074 > [59.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:50.175 > [59.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:50.276 > [59.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:50.377 > [59.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:50.477 > [59.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:50.579 > [59.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:50.680 > [59.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:50.781 > [60.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:50.881 > [60.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:50.984 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298790894,"threatLevel":0,"type":"heuristics_update"}
19:09:51.011 > [WebSocket] Processing message type: heuristics_update
19:09:51.018 > [60.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:51.126 > [60.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:51.226 > [60.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:51.328 > [60.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:51.429 > [60.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:51.530 > [60.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:51.631 > [60.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:51.733 > [60.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:51.833 > [61.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:51.935 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298791900,"threatLevel":0,"type":"heuristics_update"}
19:09:51.962 > [WebSocket] Processing message type: heuristics_update
19:09:51.968 > [61.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:52.077 > [61.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:52.179 > [61.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:52.280 > [61.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:52.380 > [61.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:52.481 > [61.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:52.583 > [61.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:52.683 > [61.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:52.784 > [62.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:52.885 > [62.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:52.987 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298792913,"threatLevel":0,"type":"heuristics_update"}
19:09:53.015 > [WebSocket] Processing message type: heuristics_update
19:09:53.020 > [62.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:53.129 > [62.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:53.229 > [62.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:53.331 > [62.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:53.432 > [62.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:53.533 > [62.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:53.634 > [62.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:53.735 > [62.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:53.836 > [63.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:53.940 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298793927,"threatLevel":0,"type":"heuristics_update"}
19:09:53.968 > [WebSocket] Processing message type: heuristics_update
19:09:53.973 > [63.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:54.082 > [63.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:54.183 > [63.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:54.284 > [63.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:54.385 > [63.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:54.486 > [63.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:54.587 > [63.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:54.687 > [63.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:54.789 > [64.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:54.889 > [64.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:54.992 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298794937,"threatLevel":0,"type":"heuristics_update"}
19:09:55.019 > [WebSocket] Processing message type: heuristics_update
19:09:55.025 > [64.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:55.134 > [64.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:55.235 > [64.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:55.336 > [64.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:55.438 > [64.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:55.538 > [64.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:55.639 > [64.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:55.740 > [64.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:55.841 > [65.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:55.943 > [65.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:56.044 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298795948,"threatLevel":0,"type":"heuristics_update"}
19:09:56.071 > [WebSocket] Processing message type: heuristics_update
19:09:56.077 > [65.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:56.176 > [65.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:56.277 > [65.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:56.378 > [65.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:56.479 > [65.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:56.581 > [65.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:56.681 > [65.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:56.782 > [66.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:56.883 > [66.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:56.984 > [66.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:57.086 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298796958,"threatLevel":0,"type":"heuristics_update"}
19:09:57.114 > [WebSocket] Processing message type: heuristics_update
19:09:57.119 > [66.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:57.228 > [66.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:57.330 > [66.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:57.431 > [66.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:57.531 > [66.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:57.631 > [66.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:09:57.638 > [RETRY] Attempting to send health data (Max retries: 3)
19:09:57.643 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 6 for all retry attempts (saved: 5)
19:09:57.660 > Generated health data: HR-61 SPO2-95 STEPS-359
19:09:57.663 > [ESP32] ========================================
19:09:57.667 > [ESP32] ENCRYPTION PIPELINE START
19:09:57.671 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:09:57.675 > [ESP32] Active Algorithms for this packet:
19:09:57.679 > [ESP32]   + LFSR
19:09:57.682 > [ESP32]   + Tinkerbell
19:09:57.685 > [ESP32]   + Transposition
19:09:57.685 > [ESP32]   - ChaCha20
19:09:57.687 > [ESP32]   - Salsa20
19:09:57.690 > [ESP32] ========================================
19:09:57.693 > [ESP32] MsgKeys: lfsrSeed=0x8E3838DB tnk[0..3]=72D0676A trn[0..3]=3E34F18B
19:09:57.701 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3335394D50
19:09:57.707 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3335394D5000000000000000 
19:09:57.715 > [ESP32][LFSR] Initializing - Seed: 0x8E3838DB SeedBe: 0xDB38388E ChaosKey[0..3]: 72D0676A InitialTap: 0x0029 State: 0x8E3838DB
19:09:57.725 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:09:57.735 > 3_After_LFSR (32): 936A15B8021B0CA6C5CB4F1F8661AC84 0A307116A301066C6341EA354BE208F0 
19:09:57.740 > [ESP32][LFSR] Keystream (first 16 bytes): DB38388E333B5FF68AF96226B341FFD0
19:09:57.749 > [ESP32][4D] LFSR keystream (first 32 bytes): DB38388E333B5FF68AF96226B341FFD04F60223B90343F213341EA354BE208F0
19:09:57.757 > [ESP32][TINKERBELL] Input (first 16 bytes): 936A15B8021B0CA6C5CB4F1F8661AC84 Nonce: 0x00000006 Buffer size: 32 bytes
19:09:57.768 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000006 Counter: 0 (must start at 0) Key[0..3]: 72D0676A
19:09:57.776 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 808D8249190605674DDCD26A9447D82D
19:09:57.785 > 4_After_Tinkerbell (32): 13E797F11B1D09C188179D75122674A9 A36B29B3622C9043BED93C9A0EBC90EC 
19:09:57.793 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 808D8249190605674DDCD26A9447D82D
19:09:57.801 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 808D8249190605674DDCD26A9447D82DA95B58A5C12D962FDD98D6AF455E981C
19:09:57.813 > 5_After_Transposition (32): 9D26889097A9B374ECE7C12C179ABE90 29D96B431D12F11B753C1362090EA3BC 
19:09:57.821 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000006
19:09:57.824 > [ESP32] === HMAC DEBUG INFO ===
19:09:57.826 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:09:57.835 > [ESP32] HMAC Input length: 45 bytes
19:09:57.837 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000069D26889097A9B374ECE7C12C179ABE9029D96B
19:09:57.849 > [ESP32] Nonce: 0x00000006
19:09:57.849 > [ESP32] Packet size before HMAC: 61
19:09:57.854 > [ESP32] Computed HMAC Tag: 46AF2B6378436724AAE113AACDBE97AE
19:09:57.857 > [ESP32] === END HMAC DEBUG ===
19:09:57.860 > 6_Final_Packet (61): 820217001700040804000000069D2688 9097A9B374ECE7C12C179ABE9029D96B ...
19:09:57.868 > [RETRY] Attempt 1/3 (nonce: 6)
19:09:57.871 > POST http://10.249.92.115:8081/health-data with pipeline data
19:09:57.876 > Sending pipeline data to server (605 bytes)
19:09:58.071 > [HTTP] Response code: 200
19:09:58.071 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:09:58.083 > [RETRY] Health data sent successfully!
19:09:58.085 > ✓ Health data #6 sent successfully
19:09:58.187 > [WebSocket] Received (632 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820217001700040804000000069D26889097A9B374ECE7C12C179ABE9029D96B431D12F11B753C1362090EA3BC46AF2B6378436724AAE113AACDBE97AE","pipeline":{"afterLFSR":"936A15B8021B0CA6C5CB4F1F8661AC840A307116A301066C6341EA354BE208F0","afterSalt":"48522D36312053504F322D39352053544550532D3335394D50","afterTinkerbell":"13E797F11B1D09C188179D75122674A9A36B29B3622C9043BED93C9A0EBC90EC","afterTransposition":"9D26889097A9B374ECE7C12C179ABE9029D96B431D12F11B753C1362090EA3BC"},"plaintext":"HR-61 SPO2-95 STEPS-359","serverTime":1770298797947,"timestamp":67052,"type":"encryption_update","ztmEnabled":true}
19:09:58.242 > [WebSocket] Processing message type: encryption_update
19:09:58.248 > [67.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:58.351 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":359,"time":1770298797947,"type":"health_data_update"}
19:09:58.360 > [WebSocket] Processing message type: health_data_update
19:09:58.365 > [67.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:58.473 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2572,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-359","handshakeSuccess":true,"totalTime":0.2572},"type":"session_summary_update"}
19:09:58.495 > [WebSocket] Processing message type: session_summary_update
19:09:58.501 > [67.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:58.606 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2572,"encryptedPacket":"820217001700040804000000069D26889097A9B374ECE7C12C179ABE9029D96B431D12F11B753C1362090EA3BC46AF2B6378436724AAE113AACDBE97AE","finalPlaintext":"HR-61 SPO2-95 STEPS-359","healthData":{"heartRate":61,"spo2":95,"steps":359},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D33353900000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3335394D5000000000000000","afterTinkerbell":"936A15B8021B0CA6C5CB4F1F8661AC840A307116A301066C6341EA354BE208F0","afterTransposition":"13E797F11B1D09C188179D75122674A9A36B29B3622C9043BED93C9A0EBC90EC"},"serverTime":1770298797948,"type":"decryption_update"}
19:09:58.664 > [WebSocket] Processing message type: decryption_update
19:09:58.669 > [WebSocket] Server decryption completed
19:09:58.672 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 359
19:09:58.678 > [67.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:58.780 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298797971,"threatLevel":0,"type":"heuristics_update"}
19:09:58.807 > [WebSocket] Processing message type: heuristics_update
19:09:58.813 > [68.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:58.922 > [WebSocket] Received (644 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":5,"pipeline":{"afterLFSR":"936A15B8021B0CA6C5CB4F1F8661AC840A307116A301066C6341EA354BE208F0","afterSalt":"48522D36312053504F322D39352053544550532D3335394D50","afterTinkerbell":"13E797F11B1D09C188179D75122674A9A36B29B3622C9043BED93C9A0EBC90EC","afterTransposition":"9D26889097A9B374ECE7C12C179ABE9029D96B431D12F11B753C1362090EA3BC","finalPacket":"820217001700040804000000069D26889097A9B374ECE7C12C179ABE9029D96B431D12F11B753C1362090EA3BC46AF2B6378436724AAE113AACDBE97AE"},"plaintext":"HR-61 SPO2-95 STEPS-359","timestamp":67254,"type":"encryption_pipeline","ztmEnabled":true}
19:09:58.981 > [WebSocket] Processing message type: encryption_pipeline
19:09:58.986 > [68.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:59.085 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Health data #6 sent successfully","state":7,"success":true,"timestamp":67259,"type":"health_data_sent"}
19:09:59.102 > [WebSocket] Processing message type: health_data_sent
19:09:59.104 > [68.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:59.210 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298798983,"threatLevel":0,"type":"heuristics_update"}
19:09:59.238 > [WebSocket] Processing message type: heuristics_update
19:09:59.244 > [68.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:59.353 > [68.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:59.455 > [68.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:59.554 > [68.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:59.656 > [68.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:59.757 > [68.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:59.858 > [69.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:09:59.959 > [69.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:00.060 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298799990,"threatLevel":0,"type":"heuristics_update"}
19:10:00.088 > [WebSocket] Processing message type: heuristics_update
19:10:00.093 > [69.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:00.203 > [69.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:00.305 > [69.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:00.405 > [69.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:00.506 > [69.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:00.606 > [69.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:00.708 > [69.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:00.809 > [70.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:00.910 > [70.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:01.011 > [70.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:01.113 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298800997,"threatLevel":0,"type":"heuristics_update"}
19:10:01.140 > [WebSocket] Processing message type: heuristics_update
19:10:01.146 > [70.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:01.255 > [70.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:01.356 > [70.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:01.457 > [70.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:01.558 > [70.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:01.659 > [70.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:01.760 > [70.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:01.861 > [71.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:01.962 > [71.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:02.063 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298802008,"threatLevel":0,"type":"heuristics_update"}
19:10:02.091 > [WebSocket] Processing message type: heuristics_update
19:10:02.097 > [71.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:02.206 > [71.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:02.306 > [71.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:02.408 > [71.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:02.509 > [71.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:02.610 > [71.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:02.710 > [71.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:02.811 > [72.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:02.913 > [72.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:03.014 > [72.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:03.116 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298803022,"threatLevel":0,"type":"heuristics_update"}
19:10:03.143 > [WebSocket] Processing message type: heuristics_update
19:10:03.149 > [72.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:03.258 > [72.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:03.359 > [72.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:03.460 > [72.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:03.561 > [72.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:03.662 > [72.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:03.763 > [72.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:03.863 > [73.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:03.965 > [73.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:04.069 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298804031,"threatLevel":0,"type":"heuristics_update"}
19:10:04.097 > [WebSocket] Processing message type: heuristics_update
19:10:04.102 > [73.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:04.211 > [73.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:04.311 > [73.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:04.413 > [73.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:04.514 > [73.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:04.615 > [73.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:04.715 > [73.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:04.817 > [74.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:04.917 > [74.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:05.019 > [74.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:05.120 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298805043,"threatLevel":0,"type":"heuristics_update"}
19:10:05.148 > [WebSocket] Processing message type: heuristics_update
19:10:05.154 > [74.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:05.263 > [74.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:05.363 > [74.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:05.464 > [74.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:05.566 > [74.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:05.667 > [74.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:05.768 > [75.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:05.869 > [75.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:05.970 > [75.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:06.070 > [75.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:06.172 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298806056,"threatLevel":0,"type":"heuristics_update"}
19:10:06.200 > [WebSocket] Processing message type: heuristics_update
19:10:06.206 > [75.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:06.304 > [75.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:06.406 > [75.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:06.507 > [75.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:06.608 > [75.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:06.709 > [75.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:06.809 > [76.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:06.910 > [76.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:07.012 > [76.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:07.114 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298807068,"threatLevel":0,"type":"heuristics_update"}
19:10:07.141 > [WebSocket] Processing message type: heuristics_update
19:10:07.146 > [76.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:07.256 > [76.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:07.357 > [76.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:07.458 > [76.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:07.559 > [76.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:07.660 > [76.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:07.761 > [76.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:07.861 > [77.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:07.963 > [77.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:08.064 > [77.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:08.165 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298808078,"threatLevel":0,"type":"heuristics_update"}
19:10:08.194 > [WebSocket] Processing message type: heuristics_update
19:10:08.199 > [77.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:10:08.207 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:08.212 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 7 for all retry attempts (saved: 6)
19:10:08.229 > Generated health data: HR-61 SPO2-95 STEPS-411
19:10:08.232 > [ESP32] ========================================
19:10:08.237 > [ESP32] ENCRYPTION PIPELINE START
19:10:08.240 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:08.243 > [ESP32] Active Algorithms for this packet:
19:10:08.249 > [ESP32]   + LFSR
19:10:08.249 > [ESP32]   + Tinkerbell
19:10:08.252 > [ESP32]   + Transposition
19:10:08.254 > [ESP32]   - ChaCha20
19:10:08.257 > [ESP32]   - Salsa20
19:10:08.257 > [ESP32] ========================================
19:10:08.262 > [ESP32] MsgKeys: lfsrSeed=0x99D10E4E tnk[0..3]=304957C7 trn[0..3]=74F9C2FD
19:10:08.268 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3431314D50
19:10:08.273 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3431314D5000000000000000 
19:10:08.282 > [ESP32][LFSR] Initializing - Seed: 0x99D10E4E SeedBe: 0x4E0ED199 ChaosKey[0..3]: 304957C7 InitialTap: 0x0029 State: 0x99D10E4E
19:10:08.293 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:10:08.302 > 3_After_LFSR (32): 065CFCAF4AC9109EE8B0F4AB0ED8D308 5190E61AFAA5B870456AB98A88C6C38E 
19:10:08.310 > [ESP32][LFSR] Keystream (first 16 bytes): 4E0ED1997BE943CEA782D9923BF8805C
19:10:08.315 > [ESP32][4D] LFSR keystream (first 32 bytes): 4E0ED1997BE943CEA782D9923BF8805C14C0B537CE94893D156AB98A88C6C38E
19:10:08.326 > [ESP32][TINKERBELL] Input (first 16 bytes): 065CFCAF4AC9109EE8B0F4AB0ED8D308 Nonce: 0x00000007 Buffer size: 32 bytes
19:10:08.335 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000007 Counter: 0 (must start at 0) Key[0..3]: 304957C7
19:10:08.346 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 4979FB437D172FEF9DE92B53990A60A7
19:10:08.354 > 4_After_Tinkerbell (32): 4F2507EC37DE3F717559DFF897D2B3AF BEED8F3EBACEA3AE806706CBACB24AF4 
19:10:08.362 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 4979FB437D172FEF9DE92B53990A60A7
19:10:08.368 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 4979FB437D172FEF9DE92B53990A60A7EF7D6924406B1BDEC50DBF412474897A
19:10:08.379 > 5_After_Transposition (32): 59AF677507B3D2CBB2F4BA4F71F8DF3E 3F97CEECBEAC06A34A37DEED80AE258F 
19:10:08.387 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000007
19:10:08.393 > [ESP32] === HMAC DEBUG INFO ===
19:10:08.396 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:10:08.405 > [ESP32] HMAC Input length: 45 bytes
19:10:08.406 > [ESP32] HMAC Input (first 32 bytes): 8202170017000408040000000759AF677507B3D2CBB2F4BA4F71F8DF3E3F97CE
19:10:08.416 > [ESP32] Nonce: 0x00000007
19:10:08.418 > [ESP32] Packet size before HMAC: 61
19:10:08.421 > [ESP32] Computed HMAC Tag: 78BBF7806FD3773A17568D5640D6559A
19:10:08.427 > [ESP32] === END HMAC DEBUG ===
19:10:08.429 > 6_Final_Packet (61): 8202170017000408040000000759AF67 7507B3D2CBB2F4BA4F71F8DF3E3F97CE ...
19:10:08.438 > [RETRY] Attempt 1/3 (nonce: 7)
19:10:08.440 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:08.445 > Sending pipeline data to server (605 bytes)
19:10:08.590 > [HTTP] Response code: 200
19:10:08.591 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:10:08.603 > [RETRY] Health data sent successfully!
19:10:08.606 > ✓ Health data #7 sent successfully
19:10:08.707 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":3,"serverTime":1770298808518,"type":"security_update"}
19:10:08.723 > [WebSocket] Processing message type: security_update
19:10:08.729 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:10:08.735 > [77.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:08.840 > [WebSocket] Received (632 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:8202170017000408040000000759AF677507B3D2CBB2F4BA4F71F8DF3E3F97CEECBEAC06A34A37DEED80AE258F78BBF7806FD3773A17568D5640D6559A","pipeline":{"afterLFSR":"065CFCAF4AC9109EE8B0F4AB0ED8D3085190E61AFAA5B870456AB98A88C6C38E","afterSalt":"48522D36312053504F322D39352053544550532D3431314D50","afterTinkerbell":"4F2507EC37DE3F717559DFF897D2B3AFBEED8F3EBACEA3AE806706CBACB24AF4","afterTransposition":"59AF677507B3D2CBB2F4BA4F71F8DF3E3F97CEECBEAC06A34A37DEED80AE258F"},"plaintext":"HR-61 SPO2-95 STEPS-411","serverTime":1770298808518,"timestamp":77627,"type":"encryption_update","ztmEnabled":true}
19:10:08.895 > [WebSocket] Processing message type: encryption_update
19:10:08.902 > [78.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:09.003 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":411,"time":1770298808518,"type":"health_data_update"}
19:10:09.011 > [WebSocket] Processing message type: health_data_update
19:10:09.017 > [78.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:09.125 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2409,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-411","handshakeSuccess":true,"totalTime":0.2409},"type":"session_summary_update"}
19:10:09.147 > [WebSocket] Processing message type: session_summary_update
19:10:09.152 > [78.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:09.258 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2409,"encryptedPacket":"8202170017000408040000000759AF677507B3D2CBB2F4BA4F71F8DF3E3F97CEECBEAC06A34A37DEED80AE258F78BBF7806FD3773A17568D5640D6559A","finalPlaintext":"HR-61 SPO2-95 STEPS-411","healthData":{"heartRate":61,"spo2":95,"steps":411},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D34313100000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3431314D5000000000000000","afterTinkerbell":"065CFCAF4AC9109EE8B0F4AB0ED8D3085190E61AFAA5B870456AB98A88C6C38E","afterTransposition":"4F2507EC37DE3F717559DFF897D2B3AFBEED8F3EBACEA3AE806706CBACB24AF4"},"serverTime":1770298808519,"type":"decryption_update"}
19:10:09.316 > [WebSocket] Processing message type: decryption_update
19:10:09.321 > [WebSocket] Server decryption completed
19:10:09.324 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 411
19:10:09.329 > [78.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:09.431 > [WebSocket] Received (644 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":6,"pipeline":{"afterLFSR":"065CFCAF4AC9109EE8B0F4AB0ED8D3085190E61AFAA5B870456AB98A88C6C38E","afterSalt":"48522D36312053504F322D39352053544550532D3431314D50","afterTinkerbell":"4F2507EC37DE3F717559DFF897D2B3AFBEED8F3EBACEA3AE806706CBACB24AF4","afterTransposition":"59AF677507B3D2CBB2F4BA4F71F8DF3E3F97CEECBEAC06A34A37DEED80AE258F","finalPacket":"8202170017000408040000000759AF677507B3D2CBB2F4BA4F71F8DF3E3F97CEECBEAC06A34A37DEED80AE258F78BBF7806FD3773A17568D5640D6559A"},"plaintext":"HR-61 SPO2-95 STEPS-411","timestamp":77774,"type":"encryption_pipeline","ztmEnabled":true}
19:10:09.489 > [WebSocket] Processing message type: encryption_pipeline
19:10:09.495 > [78.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:09.593 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Health data #7 sent successfully","state":7,"success":true,"timestamp":77779,"type":"health_data_sent"}
19:10:09.611 > [WebSocket] Processing message type: health_data_sent
19:10:09.614 > [78.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:09.716 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298809089,"threatLevel":0,"type":"heuristics_update"}
19:10:09.744 > [WebSocket] Processing message type: heuristics_update
19:10:09.750 > [78.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:09.859 > [79.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:09.960 > [79.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:10.061 > [79.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:10.163 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298810098,"threatLevel":0,"type":"heuristics_update"}
19:10:10.190 > [WebSocket] Processing message type: heuristics_update
19:10:10.195 > [79.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:10.304 > [79.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:10.406 > [79.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:10.506 > [79.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:10.608 > [79.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:10.709 > [79.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:10.809 > [80.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:10.911 > [80.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:11.011 > [80.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:11.112 > [80.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:11.215 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298811111,"threatLevel":0,"type":"heuristics_update"}
19:10:11.242 > [WebSocket] Processing message type: heuristics_update
19:10:11.247 > [80.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:11.356 > [80.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:11.458 > [80.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:11.559 > [80.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:11.659 > [80.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:11.761 > [80.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:11.861 > [81.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:11.963 > [81.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:12.063 > [81.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:12.165 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298812121,"threatLevel":0,"type":"heuristics_update"}
19:10:12.193 > [WebSocket] Processing message type: heuristics_update
19:10:12.199 > [81.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:12.308 > [81.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:12.408 > [81.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:12.509 > [81.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:12.611 > [81.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:12.711 > [81.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:12.812 > [82.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:12.913 > [82.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:13.015 > [82.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:13.115 > [82.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:13.217 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298813132,"threatLevel":0,"type":"heuristics_update"}
19:10:13.245 > [WebSocket] Processing message type: heuristics_update
19:10:13.250 > [82.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:13.360 > [82.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:13.460 > [82.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:13.561 > [82.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:13.662 > [82.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:13.763 > [82.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:13.865 > [83.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:13.965 > [83.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:14.066 > [83.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:14.171 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298814144,"threatLevel":0,"type":"heuristics_update"}
19:10:14.199 > [WebSocket] Processing message type: heuristics_update
19:10:14.204 > [83.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:14.314 > [83.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:14.415 > [83.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:14.515 > [83.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:14.617 > [83.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:14.718 > [83.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:14.819 > [84.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:14.920 > [84.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:15.020 > [84.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:15.121 > [84.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:15.223 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298815153,"threatLevel":0,"type":"heuristics_update"}
19:10:15.251 > [WebSocket] Processing message type: heuristics_update
19:10:15.256 > [84.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:15.366 > [84.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:15.467 > [84.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:15.568 > [84.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:15.669 > [84.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:15.770 > [85.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:15.871 > [85.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:15.972 > [85.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:16.073 > [85.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:16.174 > [85.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:16.276 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298816168,"threatLevel":0,"type":"heuristics_update"}
19:10:16.303 > [WebSocket] Processing message type: heuristics_update
19:10:16.309 > [85.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:16.408 > [85.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:16.509 > [85.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:16.609 > [85.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:16.711 > [85.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:16.812 > [86.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:16.912 > [86.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:17.013 > [86.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:17.114 > [86.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:17.217 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298817175,"threatLevel":0,"type":"heuristics_update"}
19:10:17.244 > [WebSocket] Processing message type: heuristics_update
19:10:17.250 > [86.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:17.359 > [86.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:17.459 > [86.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:17.560 > [86.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:17.662 > [86.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:17.762 > [86.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:17.863 > [87.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:17.965 > [87.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:18.064 > [87.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:18.166 > [87.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:18.268 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298818184,"threatLevel":0,"type":"heuristics_update"}
19:10:18.296 > [WebSocket] Processing message type: heuristics_update
19:10:18.302 > [87.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:18.410 > [87.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:18.511 > [87.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:18.612 > [87.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:10:18.618 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:18.623 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 8 for all retry attempts (saved: 7)
19:10:18.640 > Generated health data: HR-61 SPO2-95 STEPS-460
19:10:18.643 > [ESP32] ========================================
19:10:18.649 > [ESP32] ENCRYPTION PIPELINE START
19:10:18.652 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:18.656 > [ESP32] Active Algorithms for this packet:
19:10:18.659 > [ESP32]   + LFSR
19:10:18.663 > [ESP32]   + Tinkerbell
19:10:18.665 > [ESP32]   + Transposition
19:10:18.665 > [ESP32]   - ChaCha20
19:10:18.668 > [ESP32]   - Salsa20
19:10:18.670 > [ESP32] ========================================
19:10:18.672 > [ESP32] MsgKeys: lfsrSeed=0xC4CA120F tnk[0..3]=47234CFE trn[0..3]=A55B01EF
19:10:18.682 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3436304D50
19:10:18.687 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3436304D5000000000000000 
19:10:18.695 > [ESP32][LFSR] Initializing - Seed: 0xC4CA120F SeedBe: 0x0F12CAC4 ChaosKey[0..3]: 47234CFE InitialTap: 0x0029 State: 0xC4CA120F
19:10:18.707 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:10:18.715 > 3_After_LFSR (32): 4740E7F2703AA583DAD9C9571B527985 269CC7BCB60A020DAAC7708D0C14139D 
19:10:18.720 > [ESP32][LFSR] Keystream (first 16 bytes): 0F12CAC4411AF6D395EBE46E2E722AD1
19:10:18.729 > [ESP32][4D] LFSR keystream (first 32 bytes): 0F12CAC4411AF6D395EBE46E2E722AD163CC9491823C3240FAC7708D0C14139D
19:10:18.737 > [ESP32][TINKERBELL] Input (first 16 bytes): 4740E7F2703AA583DAD9C9571B527985 Nonce: 0x00000008 Buffer size: 32 bytes
19:10:18.749 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000008 Counter: 0 (must start at 0) Key[0..3]: 47234CFE
19:10:18.757 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 49746DAEC7A0051D624ED831C793C750
19:10:18.765 > 4_After_Tinkerbell (32): 0E348A5CB79AA09EB8971166DCC1BED5 9975CF888507B4128051DF81A05F659B 
19:10:18.773 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 49746DAEC7A0051D624ED831C793C750
19:10:18.781 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 49746DAEC7A0051D624ED831C793C750BFE90834330DB61F2A96AF0CAC4B7606
19:10:18.793 > 5_After_Transposition (32): 9E65B88881A09ADC3451756697C199DF BE85CF0EB48AB7D507115F12809B5CA0 
19:10:18.801 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000008
19:10:18.804 > [ESP32] === HMAC DEBUG INFO ===
19:10:18.807 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:10:18.815 > [ESP32] HMAC Input length: 45 bytes
19:10:18.817 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000089E65B88881A09ADC3451756697C199DFBE85CF
19:10:18.828 > [ESP32] Nonce: 0x00000008
19:10:18.828 > [ESP32] Packet size before HMAC: 61
19:10:18.834 > [ESP32] Computed HMAC Tag: EFD472CBE38EE4EC518AEDBC71B803B5
19:10:18.837 > [ESP32] === END HMAC DEBUG ===
19:10:18.839 > 6_Final_Packet (61): 820217001700040804000000089E65B8 8881A09ADC3451756697C199DFBE85CF ...
19:10:18.848 > [RETRY] Attempt 1/3 (nonce: 8)
19:10:18.851 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:18.857 > Sending pipeline data to server (605 bytes)
19:10:19.120 > [HTTP] Response code: 200
19:10:19.120 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:10:19.133 > [RETRY] Health data sent successfully!
19:10:19.135 > ✓ Health data #8 sent successfully
19:10:19.237 > [WebSocket] Received (632 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820217001700040804000000089E65B88881A09ADC3451756697C199DFBE85CF0EB48AB7D507115F12809B5CA0EFD472CBE38EE4EC518AEDBC71B803B5","pipeline":{"afterLFSR":"4740E7F2703AA583DAD9C9571B527985269CC7BCB60A020DAAC7708D0C14139D","afterSalt":"48522D36312053504F322D39352053544550532D3436304D50","afterTinkerbell":"0E348A5CB79AA09EB8971166DCC1BED59975CF888507B4128051DF81A05F659B","afterTransposition":"9E65B88881A09ADC3451756697C199DFBE85CF0EB48AB7D507115F12809B5CA0"},"plaintext":"HR-61 SPO2-95 STEPS-460","serverTime":1770298818953,"timestamp":88033,"type":"encryption_update","ztmEnabled":true}
19:10:19.293 > [WebSocket] Processing message type: encryption_update
19:10:19.299 > [88.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:19.402 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":460,"time":1770298818953,"type":"health_data_update"}
19:10:19.410 > [WebSocket] Processing message type: health_data_update
19:10:19.416 > [88.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:19.524 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2707,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-460","handshakeSuccess":true,"totalTime":0.2707},"type":"session_summary_update"}
19:10:19.546 > [WebSocket] Processing message type: session_summary_update
19:10:19.551 > [88.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:19.656 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2707,"encryptedPacket":"820217001700040804000000089E65B88881A09ADC3451756697C199DFBE85CF0EB48AB7D507115F12809B5CA0EFD472CBE38EE4EC518AEDBC71B803B5","finalPlaintext":"HR-61 SPO2-95 STEPS-460","healthData":{"heartRate":61,"spo2":95,"steps":460},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D34363000000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3436304D5000000000000000","afterTinkerbell":"4740E7F2703AA583DAD9C9571B527985269CC7BCB60A020DAAC7708D0C14139D","afterTransposition":"0E348A5CB79AA09EB8971166DCC1BED59975CF888507B4128051DF81A05F659B"},"serverTime":1770298818954,"type":"decryption_update"}
19:10:19.714 > [WebSocket] Processing message type: decryption_update
19:10:19.720 > [WebSocket] Server decryption completed
19:10:19.723 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 460
19:10:19.729 > [88.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:19.830 > [WebSocket] Received (644 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":7,"pipeline":{"afterLFSR":"4740E7F2703AA583DAD9C9571B527985269CC7BCB60A020DAAC7708D0C14139D","afterSalt":"48522D36312053504F322D39352053544550532D3436304D50","afterTinkerbell":"0E348A5CB79AA09EB8971166DCC1BED59975CF888507B4128051DF81A05F659B","afterTransposition":"9E65B88881A09ADC3451756697C199DFBE85CF0EB48AB7D507115F12809B5CA0","finalPacket":"820217001700040804000000089E65B88881A09ADC3451756697C199DFBE85CF0EB48AB7D507115F12809B5CA0EFD472CBE38EE4EC518AEDBC71B803B5"},"plaintext":"HR-61 SPO2-95 STEPS-460","timestamp":88304,"type":"encryption_pipeline","ztmEnabled":true}
19:10:19.888 > [WebSocket] Processing message type: encryption_pipeline
19:10:19.893 > [89.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:19.993 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Health data #8 sent successfully","state":7,"success":true,"timestamp":88309,"type":"health_data_sent"}
19:10:20.010 > [WebSocket] Processing message type: health_data_sent
19:10:20.012 > [89.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:20.115 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298819190,"threatLevel":0,"type":"heuristics_update"}
19:10:20.143 > [WebSocket] Processing message type: heuristics_update
19:10:20.148 > [89.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:20.260 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298820200,"threatLevel":0,"type":"heuristics_update"}
19:10:20.289 > [WebSocket] Processing message type: heuristics_update
19:10:20.294 > [89.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:20.404 > [89.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:20.504 > [89.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:20.605 > [89.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:20.706 > [89.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:20.808 > [90.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:20.909 > [90.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:21.009 > [90.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:21.110 > [90.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:21.211 > [90.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:21.313 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298821209,"threatLevel":0,"type":"heuristics_update"}
19:10:21.341 > [WebSocket] Processing message type: heuristics_update
19:10:21.346 > [90.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:21.455 > [90.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:21.556 > [90.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:21.657 > [90.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:21.759 > [90.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:21.859 > [91.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:21.961 > [91.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:22.061 > [91.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:22.163 > [91.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:22.264 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298822220,"threatLevel":0,"type":"heuristics_update"}
19:10:22.292 > [WebSocket] Processing message type: heuristics_update
19:10:22.297 > [91.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:22.406 > [91.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:22.507 > [91.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:22.608 > [91.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:22.709 > [91.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:22.810 > [92.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:22.911 > [92.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:23.012 > [92.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:23.114 > [92.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:23.215 > [92.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:23.316 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298823225,"threatLevel":0,"type":"heuristics_update"}
19:10:23.343 > [WebSocket] Processing message type: heuristics_update
19:10:23.349 > [92.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:23.458 > [92.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:23.559 > [92.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:23.660 > [92.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:23.761 > [92.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:23.862 > [93.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:23.963 > [93.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:24.064 > [93.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:24.165 > [93.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:24.267 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298824229,"threatLevel":0,"type":"heuristics_update"}
19:10:24.295 > [WebSocket] Processing message type: heuristics_update
19:10:24.300 > [93.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:24.409 > [93.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:24.510 > [93.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:24.610 > [93.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:24.712 > [93.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:24.813 > [94.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:24.914 > [94.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:25.015 > [94.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:25.116 > [94.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:25.217 > [94.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:25.321 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298825238,"threatLevel":0,"type":"heuristics_update"}
19:10:25.349 > [WebSocket] Processing message type: heuristics_update
19:10:25.354 > [94.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:25.463 > [94.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:25.564 > [94.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:25.665 > [94.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:25.766 > [94.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:25.868 > [95.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:25.968 > [95.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:26.069 > [95.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:26.170 > [95.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:26.271 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298826249,"threatLevel":0,"type":"heuristics_update"}
19:10:26.300 > [WebSocket] Processing message type: heuristics_update
19:10:26.306 > [95.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:26.405 > [95.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:26.504 > [95.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:26.606 > [95.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:26.706 > [95.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:26.808 > [96.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:26.909 > [96.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:27.011 > [96.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:27.111 > [96.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:27.213 > [96.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:27.314 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298827264,"threatLevel":0,"type":"heuristics_update"}
19:10:27.342 > [WebSocket] Processing message type: heuristics_update
19:10:27.347 > [96.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:27.456 > [96.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:27.557 > [96.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:27.658 > [96.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:27.759 > [96.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:27.861 > [97.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:27.961 > [97.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:28.062 > [97.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:28.164 > [97.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:28.264 > [97.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:28.366 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298828277,"threatLevel":0,"type":"heuristics_update"}
19:10:28.393 > [WebSocket] Processing message type: heuristics_update
19:10:28.399 > [97.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:28.508 > [97.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:28.609 > [97.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:28.710 > [97.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:28.811 > [98.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:28.912 > [98.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:29.012 > [98.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:29.114 > [98.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:29.215 > [98.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:10:29.221 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:29.226 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 9 for all retry attempts (saved: 8)
19:10:29.242 > Generated health data: HR-61 SPO2-95 STEPS-530
19:10:29.245 > [ESP32] ========================================
19:10:29.251 > [ESP32] ENCRYPTION PIPELINE START
19:10:29.253 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:29.259 > [ESP32] Active Algorithms for this packet:
19:10:29.262 > [ESP32]   + LFSR
19:10:29.265 > [ESP32]   + Tinkerbell
19:10:29.268 > [ESP32]   + Transposition
19:10:29.268 > [ESP32]   - ChaCha20
19:10:29.271 > [ESP32]   - Salsa20
19:10:29.274 > [ESP32] ========================================
19:10:29.276 > [ESP32] MsgKeys: lfsrSeed=0x56CA34D5 tnk[0..3]=D1DF6BD6 trn[0..3]=34A0F89D
19:10:29.285 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3533304D50
19:10:29.290 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3533304D5000000000000000 
19:10:29.298 > [ESP32][LFSR] Initializing - Seed: 0x56CA34D5 SeedBe: 0xD534CA56 ChaosKey[0..3]: D1DF6BD6 InitialTap: 0x0029 State: 0x56CA34D5
19:10:29.310 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:10:29.317 > 3_After_LFSR (32): 9D66E7607D1C0AB379C58766DDC9836D 378DEDEAFBD87F6DDCA924B9751395F6 
19:10:29.323 > [ESP32][LFSR] Keystream (first 16 bytes): D534CA564C3C59E336F7AA5FE8E9D039
19:10:29.332 > [ESP32][4D] LFSR keystream (first 32 bytes): D534CA564C3C59E336F7AA5FE8E9D03972DDBEC7CEEB4F208CA924B9751395F6
19:10:29.340 > [ESP32][TINKERBELL] Input (first 16 bytes): 9D66E7607D1C0AB379C58766DDC9836D Nonce: 0x00000009 Buffer size: 32 bytes
19:10:29.351 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000009 Counter: 0 (must start at 0) Key[0..3]: D1DF6BD6
19:10:29.359 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E67FEA145F4FA656A31E3F5611004DF9
19:10:29.368 > 4_After_Tinkerbell (32): 7B190D742253ACE5DADBB830CCC9CE94 8EA27C81011E0C5F452DF1C885A81928 
19:10:29.376 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E67FEA145F4FA656A31E3F5611004DF9
19:10:29.384 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E67FEA145F4FA656A31E3F5611004DF9B92F916BFAC673329984D571F0BB8CDE
19:10:29.395 > 5_After_Transposition (32): 2DE522C8F1947BACC90D288130CC4519 85A28EDAB801CEDB74191E7CA8530C5F 
19:10:29.404 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000009
19:10:29.407 > [ESP32] === HMAC DEBUG INFO ===
19:10:29.409 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:10:29.418 > [ESP32] HMAC Input length: 45 bytes
19:10:29.421 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000092DE522C8F1947BACC90D288130CC451985A28E
19:10:29.432 > [ESP32] Nonce: 0x00000009
19:10:29.432 > [ESP32] Packet size before HMAC: 61
19:10:29.437 > [ESP32] Computed HMAC Tag: 74AC0D576B320709EA667B5B32BADE78
19:10:29.440 > [ESP32] === END HMAC DEBUG ===
19:10:29.443 > 6_Final_Packet (61): 820217001700040804000000092DE522 C8F1947BACC90D288130CC451985A28E ...
19:10:29.451 > [RETRY] Attempt 1/3 (nonce: 9)
19:10:29.454 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:29.459 > Sending pipeline data to server (605 bytes)
19:10:29.650 > [HTTP] Response code: 200
19:10:29.652 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:10:29.664 > [RETRY] Health data sent successfully!
19:10:29.668 > ✓ Health data #9 sent successfully
19:10:29.770 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298829284,"threatLevel":0,"type":"heuristics_update"}
19:10:29.798 > [WebSocket] Processing message type: heuristics_update
19:10:29.803 > [99.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:29.903 > [WebSocket] Received (632 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820217001700040804000000092DE522C8F1947BACC90D288130CC451985A28EDAB801CEDB74191E7CA8530C5F74AC0D576B320709EA667B5B32BADE78","pipeline":{"afterLFSR":"9D66E7607D1C0AB379C58766DDC9836D378DEDEAFBD87F6DDCA924B9751395F6","afterSalt":"48522D36312053504F322D39352053544550532D3533304D50","afterTinkerbell":"7B190D742253ACE5DADBB830CCC9CE948EA27C81011E0C5F452DF1C885A81928","afterTransposition":"2DE522C8F1947BACC90D288130CC451985A28EDAB801CEDB74191E7CA8530C5F"},"plaintext":"HR-61 SPO2-95 STEPS-530","serverTime":1770298829538,"timestamp":98636,"type":"encryption_update","ztmEnabled":true}
19:10:29.959 > [WebSocket] Processing message type: encryption_update
19:10:29.965 > [99.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.066 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":530,"time":1770298829538,"type":"health_data_update"}
19:10:30.075 > [WebSocket] Processing message type: health_data_update
19:10:30.080 > [99.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.189 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2503,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-530","handshakeSuccess":true,"totalTime":0.2503},"type":"session_summary_update"}
19:10:30.210 > [WebSocket] Processing message type: session_summary_update
19:10:30.216 > [99.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.321 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2503,"encryptedPacket":"820217001700040804000000092DE522C8F1947BACC90D288130CC451985A28EDAB801CEDB74191E7CA8530C5F74AC0D576B320709EA667B5B32BADE78","finalPlaintext":"HR-61 SPO2-95 STEPS-530","healthData":{"heartRate":61,"spo2":95,"steps":530},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D35333000000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3533304D5000000000000000","afterTinkerbell":"9D66E7607D1C0AB379C58766DDC9836D378DEDEAFBD87F6DDCA924B9751395F6","afterTransposition":"7B190D742253ACE5DADBB830CCC9CE948EA27C81011E0C5F452DF1C885A81928"},"serverTime":1770298829539,"type":"decryption_update"}
19:10:30.379 > [WebSocket] Processing message type: decryption_update
19:10:30.385 > [WebSocket] Server decryption completed
19:10:30.387 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 530
19:10:30.393 > [99.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.495 > [WebSocket] Received (644 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":8,"pipeline":{"afterLFSR":"9D66E7607D1C0AB379C58766DDC9836D378DEDEAFBD87F6DDCA924B9751395F6","afterSalt":"48522D36312053504F322D39352053544550532D3533304D50","afterTinkerbell":"7B190D742253ACE5DADBB830CCC9CE948EA27C81011E0C5F452DF1C885A81928","afterTransposition":"2DE522C8F1947BACC90D288130CC451985A28EDAB801CEDB74191E7CA8530C5F","finalPacket":"820217001700040804000000092DE522C8F1947BACC90D288130CC451985A28EDAB801CEDB74191E7CA8530C5F74AC0D576B320709EA667B5B32BADE78"},"plaintext":"HR-61 SPO2-95 STEPS-530","timestamp":98836,"type":"encryption_pipeline","ztmEnabled":true}
19:10:30.552 > [WebSocket] Processing message type: encryption_pipeline
19:10:30.558 > [99.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.657 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Health data #9 sent successfully","state":7,"success":true,"timestamp":98842,"type":"health_data_sent"}
19:10:30.673 > [WebSocket] Processing message type: health_data_sent
19:10:30.677 > [99.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.779 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298830290,"threatLevel":0,"type":"heuristics_update"}
19:10:30.808 > [WebSocket] Processing message type: heuristics_update
19:10:30.813 > [100.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:30.923 > [100.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.023 > [100.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.124 > [100.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.225 > [100.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.326 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298831301,"threatLevel":0,"type":"heuristics_update"}
19:10:31.354 > [WebSocket] Processing message type: heuristics_update
19:10:31.360 > [100.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.469 > [100.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.569 > [100.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.671 > [100.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.772 > [101.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.873 > [101.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:31.974 > [101.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.075 > [101.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.176 > [101.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.277 > [101.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.379 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298832312,"threatLevel":0,"type":"heuristics_update"}
19:10:32.406 > [WebSocket] Processing message type: heuristics_update
19:10:32.412 > [101.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.511 > [101.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.612 > [101.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.713 > [101.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.814 > [102.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:32.915 > [102.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.016 > [102.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.117 > [102.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.218 > [102.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.319 > [102.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.420 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298833319,"threatLevel":0,"type":"heuristics_update"}
19:10:33.448 > [WebSocket] Processing message type: heuristics_update
19:10:33.454 > [102.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.563 > [102.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.664 > [102.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.765 > [102.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.866 > [103.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:33.967 > [103.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.068 > [103.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.169 > [103.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.269 > [103.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.373 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298834328,"threatLevel":0,"type":"heuristics_update"}
19:10:34.402 > [WebSocket] Processing message type: heuristics_update
19:10:34.408 > [103.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.517 > [103.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.618 > [103.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.719 > [103.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.819 > [104.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:34.921 > [104.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.022 > [104.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.122 > [104.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.224 > [104.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.324 > [104.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.426 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298835341,"threatLevel":0,"type":"heuristics_update"}
19:10:35.455 > [WebSocket] Processing message type: heuristics_update
19:10:35.460 > [104.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.568 > [104.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.670 > [104.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.770 > [105.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.871 > [105.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:35.973 > [105.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.073 > [105.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.174 > [105.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.275 > [105.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.378 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298836352,"threatLevel":0,"type":"heuristics_update"}
19:10:36.404 > [WebSocket] Processing message type: heuristics_update
19:10:36.411 > [105.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.510 > [105.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.611 > [105.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.712 > [105.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.813 > [106.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:36.914 > [106.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:37.015 > [106.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:37.116 > [106.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:37.217 > [106.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:37.318 > [106.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:37.419 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298837364,"threatLevel":0,"type":"heuristics_update"}
19:10:37.447 > [WebSocket] Processing message type: heuristics_update
19:10:37.452 > [106.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:37.561 > [106.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:37.662 > [106.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:37.764 > [106.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:37.865 > [107.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:37.966 > [107.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:38.067 > [107.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:38.168 > [107.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:38.268 > [107.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:38.369 > [107.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:38.472 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298838366,"threatLevel":0,"type":"heuristics_update"}
19:10:38.499 > [WebSocket] Processing message type: heuristics_update
19:10:38.505 > [107.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:38.614 > [107.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:38.715 > [107.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:38.816 > [108.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:38.917 > [108.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:39.018 > [108.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:39.119 > [108.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:39.220 > [108.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:39.320 > [108.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:39.424 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298839377,"threatLevel":0,"type":"heuristics_update"}
19:10:39.452 > [WebSocket] Processing message type: heuristics_update
19:10:39.459 > [108.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:39.567 > [108.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:39.668 > [108.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:10:39.673 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:39.679 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 10 for all retry attempts (saved: 9)
19:10:39.695 > Generated health data: HR-61 SPO2-95 STEPS-558
19:10:39.701 > [ESP32] ========================================
19:10:39.704 > [ESP32] ENCRYPTION PIPELINE START
19:10:39.707 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:39.712 > [ESP32] Active Algorithms for this packet:
19:10:39.715 > [ESP32]   + LFSR
19:10:39.717 > [ESP32]   + Tinkerbell
19:10:39.720 > [ESP32]   + Transposition
19:10:39.720 > [ESP32]   - ChaCha20
19:10:39.723 > [ESP32]   - Salsa20
19:10:39.726 > [ESP32] ========================================
19:10:39.728 > [ESP32] MsgKeys: lfsrSeed=0x8392F198 tnk[0..3]=AE50EE40 trn[0..3]=D38C2949
19:10:39.737 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3535384D50
19:10:39.743 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3535384D5000000000000000 
19:10:39.751 > [ESP32][LFSR] Initializing - Seed: 0x8392F198 SeedBe: 0x98F19283 ChaosKey[0..3]: AE50EE40 InitialTap: 0x0029 State: 0x8392F198
19:10:39.762 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:10:39.770 > 3_After_LFSR (32): D0A3BFB5A2961988906BD8A259832D80 52DB216E4FF4B7F2B40C935620E5C44C 
19:10:39.776 > [ESP32][LFSR] Keystream (first 16 bytes): 98F1928393B64AD8DF59F59B6CA37ED4
19:10:39.784 > [ESP32][4D] LFSR keystream (first 32 bytes): 98F1928393B64AD8DF59F59B6CA37ED4178B72437AC18FBFE40C935620E5C44C
19:10:39.793 > [ESP32][TINKERBELL] Input (first 16 bytes): D0A3BFB5A2961988906BD8A259832D80 Nonce: 0x0000000A Buffer size: 32 bytes
19:10:39.804 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x0000000A Counter: 0 (must start at 0) Key[0..3]: AE50EE40
19:10:39.812 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 571B343B15C596D538A30D64CB82B1AC
19:10:39.821 > 4_After_Tinkerbell (32): 87B88B8EB7538F5DA8C8D5C692019C2C 69B8973FD5ED4576BA92C1F168085C2F 
19:10:39.829 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 571B343B15C596D538A30D64CB82B1AC
19:10:39.837 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 571B343B15C596D538A30D64CB82B1AC3B63B6519A19F2840E9E52A748ED9863
19:10:39.848 > 5_After_Transposition (32): D592B8B7A8768E9C8BB85CED5D0845C6 2FC8C197D592018F2CF1BA8753693F68 
19:10:39.857 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x0000000A
19:10:39.859 > [ESP32] === HMAC DEBUG INFO ===
19:10:39.862 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:10:39.870 > [ESP32] HMAC Input length: 45 bytes
19:10:39.873 > [ESP32] HMAC Input (first 32 bytes): 8202170017000408040000000AD592B8B7A8768E9C8BB85CED5D0845C62FC8C1
19:10:39.884 > [ESP32] Nonce: 0x0000000A
19:10:39.884 > [ESP32] Packet size before HMAC: 61
19:10:39.890 > [ESP32] Computed HMAC Tag: 7E8CCE4E54C523ABDF6A2D8A9C8E822C
19:10:39.892 > [ESP32] === END HMAC DEBUG ===
19:10:39.895 > 6_Final_Packet (61): 8202170017000408040000000AD592B8 B7A8768E9C8BB85CED5D0845C62FC8C1 ...
19:10:39.903 > [RETRY] Attempt 1/3 (nonce: 10)
19:10:39.907 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:39.912 > Sending pipeline data to server (606 bytes)
19:10:40.179 > [HTTP] Response code: 200
19:10:40.179 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:10:40.191 > [RETRY] Health data sent successfully!
19:10:40.194 > ✓ Health data #10 sent successfully
19:10:40.293 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":6,"serverTime":1770298840002,"type":"security_update"}
19:10:40.310 > [WebSocket] Processing message type: security_update
19:10:40.315 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:10:40.322 > [109.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:40.428 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:8202170017000408040000000AD592B8B7A8768E9C8BB85CED5D0845C62FC8C197D592018F2CF1BA8753693F687E8CCE4E54C523ABDF6A2D8A9C8E822C","pipeline":{"afterLFSR":"D0A3BFB5A2961988906BD8A259832D8052DB216E4FF4B7F2B40C935620E5C44C","afterSalt":"48522D36312053504F322D39352053544550532D3535384D50","afterTinkerbell":"87B88B8EB7538F5DA8C8D5C692019C2C69B8973FD5ED4576BA92C1F168085C2F","afterTransposition":"D592B8B7A8768E9C8BB85CED5D0845C62FC8C197D592018F2CF1BA8753693F68"},"plaintext":"HR-61 SPO2-95 STEPS-558","serverTime":1770298840002,"timestamp":109089,"type":"encryption_update","ztmEnabled":true}
19:10:40.482 > [WebSocket] Processing message type: encryption_update
19:10:40.489 > [109.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:40.590 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":558,"time":1770298840002,"type":"health_data_update"}
19:10:40.599 > [WebSocket] Processing message type: health_data_update
19:10:40.604 > [109.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:40.712 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2582,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-558","handshakeSuccess":true,"totalTime":0.2582},"type":"session_summary_update"}
19:10:40.734 > [WebSocket] Processing message type: session_summary_update
19:10:40.740 > [109.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:40.845 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2582,"encryptedPacket":"8202170017000408040000000AD592B8B7A8768E9C8BB85CED5D0845C62FC8C197D592018F2CF1BA8753693F687E8CCE4E54C523ABDF6A2D8A9C8E822C","finalPlaintext":"HR-61 SPO2-95 STEPS-558","healthData":{"heartRate":61,"spo2":95,"steps":558},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D35353800000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3535384D5000000000000000","afterTinkerbell":"D0A3BFB5A2961988906BD8A259832D8052DB216E4FF4B7F2B40C935620E5C44C","afterTransposition":"87B88B8EB7538F5DA8C8D5C692019C2C69B8973FD5ED4576BA92C1F168085C2F"},"serverTime":1770298840003,"type":"decryption_update"}
19:10:40.903 > [WebSocket] Processing message type: decryption_update
19:10:40.909 > [WebSocket] Server decryption completed
19:10:40.912 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 558
19:10:40.917 > [110.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:41.018 > [WebSocket] Received (645 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":9,"pipeline":{"afterLFSR":"D0A3BFB5A2961988906BD8A259832D8052DB216E4FF4B7F2B40C935620E5C44C","afterSalt":"48522D36312053504F322D39352053544550532D3535384D50","afterTinkerbell":"87B88B8EB7538F5DA8C8D5C692019C2C69B8973FD5ED4576BA92C1F168085C2F","afterTransposition":"D592B8B7A8768E9C8BB85CED5D0845C62FC8C197D592018F2CF1BA8753693F68","finalPacket":"8202170017000408040000000AD592B8B7A8768E9C8BB85CED5D0845C62FC8C197D592018F2CF1BA8753693F687E8CCE4E54C523ABDF6A2D8A9C8E822C"},"plaintext":"HR-61 SPO2-95 STEPS-558","timestamp":109364,"type":"encryption_pipeline","ztmEnabled":true}
19:10:41.076 > [WebSocket] Processing message type: encryption_pipeline
19:10:41.082 > [110.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:41.181 > [WebSocket] Received (159 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Health data #10 sent successfully","state":7,"success":true,"timestamp":109368,"type":"health_data_sent"}
19:10:41.198 > [WebSocket] Processing message type: health_data_sent
19:10:41.201 > [110.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:41.306 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":10,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298840386,"threatLevel":0,"type":"heuristics_update"}
19:10:41.333 > [WebSocket] Processing message type: heuristics_update
19:10:41.339 > [110.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:41.448 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":10,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298841395,"threatLevel":0,"type":"heuristics_update"}
19:10:41.476 > [WebSocket] Processing message type: heuristics_update
19:10:41.482 > [110.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:41.591 > [110.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:41.691 > [110.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:41.793 > [111.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:41.894 > [111.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:41.995 > [111.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:42.096 > [111.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:42.197 > [111.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:42.298 > [111.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:42.398 > [111.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:42.501 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":10,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298842406,"threatLevel":0,"type":"heuristics_update"}
19:10:42.528 > [WebSocket] Processing message type: heuristics_update
19:10:42.533 > [111.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:42.643 > [111.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:42.743 > [111.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:42.845 > [112.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:42.946 > [112.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:43.047 > [112.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:43.147 > [112.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:43.249 > [112.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:43.350 > [112.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:43.451 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":10,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298843421,"threatLevel":0,"type":"heuristics_update"}
19:10:43.480 > [WebSocket] Processing message type: heuristics_update
19:10:43.485 > [112.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:43.594 > [112.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:43.694 > [112.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:43.795 > [113.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:43.896 > [113.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:43.998 > [113.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:44.098 > [113.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:44.199 > [113.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:44.301 > [113.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:44.402 > [113.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:44.504 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":10,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298844434,"threatLevel":0,"type":"heuristics_update"}
19:10:44.531 > [WebSocket] Processing message type: heuristics_update
19:10:44.537 > [113.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:44.645 > [113.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:44.746 > [113.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:44.847 > [114.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:44.948 > [114.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:45.049 > [114.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:45.150 > [114.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:45.252 > [114.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:45.352 > [114.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:45.457 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":10,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298845443,"threatLevel":0,"type":"heuristics_update"}
19:10:45.484 > [WebSocket] Processing message type: heuristics_update
19:10:45.490 > [114.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:45.599 > [114.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:45.699 > [114.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:45.801 > [115.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:45.901 > [115.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:46.002 > [115.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:46.104 > [115.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:46.204 > [115.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:46.306 > [115.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:46.407 > [115.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:46.508 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":10,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298846456,"threatLevel":0,"type":"heuristics_update"}
19:10:46.536 > [WebSocket] Processing message type: heuristics_update
19:10:46.542 > [115.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:46.651 > [115.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:46.752 > [115.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:46.852 > [116.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:46.953 > [116.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:47.055 > [116.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:47.156 > [116.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:47.257 > [116.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:47.357 > [116.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:47.459 > [116.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:47.561 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":10,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298847463,"threatLevel":0,"type":"heuristics_update"}
19:10:47.588 > [WebSocket] Processing message type: heuristics_update
19:10:47.593 > [116.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:47.703 > [116.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:47.804 > [117.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:47.905 > [117.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:48.006 > [117.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:48.107 > [117.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:48.208 > [117.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:48.309 > [117.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:48.410 > [117.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:48.511 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":10,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298848472,"threatLevel":0,"type":"heuristics_update"}
19:10:48.539 > [WebSocket] Processing message type: heuristics_update
19:10:48.545 > [117.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:48.654 > [117.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:48.755 > [117.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:48.854 > [118.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:48.957 > [118.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:49.058 > [118.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:49.158 > [118.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:49.260 > [118.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:49.361 > [118.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:49.461 > [118.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:49.563 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":10,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298849482,"threatLevel":0,"type":"heuristics_update"}
19:10:49.591 > [WebSocket] Processing message type: heuristics_update
19:10:49.597 > [118.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:49.705 > [118.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:49.807 > [119.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:49.906 > [119.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:50.008 > [119.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:50.109 > [119.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:50.211 > [119.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:10:50.216 > [RETRY] Attempting to send health data (Max retries: 3)
19:10:50.221 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 11 for all retry attempts (saved: 10)
19:10:50.238 > Generated health data: HR-61 SPO2-95 STEPS-632
19:10:50.244 > [ESP32] ========================================
19:10:50.247 > [ESP32] ENCRYPTION PIPELINE START
19:10:50.249 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:10:50.254 > [ESP32] Active Algorithms for this packet:
19:10:50.258 > [ESP32]   + LFSR
19:10:50.260 > [ESP32]   + Tinkerbell
19:10:50.263 > [ESP32]   + Transposition
19:10:50.266 > [ESP32]   - ChaCha20
19:10:50.266 > [ESP32]   - Salsa20
19:10:50.269 > [ESP32] ========================================
19:10:50.271 > [ESP32] MsgKeys: lfsrSeed=0x7D806B70 tnk[0..3]=55461C6C trn[0..3]=F9B07E46
19:10:50.279 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3633324D50
19:10:50.285 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3633324D5000000000000000 
19:10:50.293 > [ESP32][LFSR] Initializing - Seed: 0x7D806B70 SeedBe: 0x706B807D ChaosKey[0..3]: 55461C6C InitialTap: 0x0029 State: 0x7D806B70
19:10:50.305 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:10:50.313 > 3_After_LFSR (32): 3839AD4B49A81D6C15C70C7C5B131693 C67388752F09D54D41E8F64582D5875F 
19:10:50.319 > [ESP32][LFSR] Keystream (first 16 bytes): 706B807D78884E3C5AF521456E3345C7
19:10:50.327 > [ESP32][4D] LFSR keystream (first 32 bytes): 706B807D78884E3C5AF521456E3345C78323DB58193AE70011E8F64582D5875F
19:10:50.336 > [ESP32][TINKERBELL] Input (first 16 bytes): 3839AD4B49A81D6C15C70C7C5B131693 Nonce: 0x0000000B Buffer size: 32 bytes
19:10:50.346 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x0000000B Counter: 0 (must start at 0) Key[0..3]: 55461C6C
19:10:50.358 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 11A308D2516B158A689A75C20F0B851F
19:10:50.363 > 4_After_Tinkerbell (32): 299AA59918C308E67D5D79BE5418938C F7F95ABFE741C3F20351890322F441E4 
19:10:50.371 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 11A308D2516B158A689A75C20F0B851F
19:10:50.380 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 11A308D2516B158A689A75C20F0B851F318AD2CAC84816BF42B97F46A021C6BB
19:10:50.391 > 5_After_Transposition (32): 7D0318BF225DE741C3BE08C354512979 9389F7F29AF48CE65A18F903A5E44199 
19:10:50.399 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x0000000B
19:10:50.402 > [ESP32] === HMAC DEBUG INFO ===
19:10:50.404 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:10:50.413 > [ESP32] HMAC Input length: 45 bytes
19:10:50.416 > [ESP32] HMAC Input (first 32 bytes): 8202170017000408040000000B7D0318BF225DE741C3BE08C3545129799389F7
19:10:50.427 > [ESP32] Nonce: 0x0000000B
19:10:50.429 > [ESP32] Packet size before HMAC: 61
19:10:50.432 > [ESP32] Computed HMAC Tag: C9403F5B90A4C6CF69D0184110EF1599
19:10:50.438 > [ESP32] === END HMAC DEBUG ===
19:10:50.441 > 6_Final_Packet (61): 8202170017000408040000000B7D0318 BF225DE741C3BE08C3545129799389F7 ...
19:10:50.446 > [RETRY] Attempt 1/3 (nonce: 11)
19:10:50.449 > POST http://10.249.92.115:8081/health-data with pipeline data
19:10:50.454 > Sending pipeline data to server (606 bytes)
19:10:50.705 > [HTTP] Response code: 200
19:10:50.705 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:10:50.716 > [RETRY] Health data sent successfully!
19:10:50.719 > ✓ Health data #11 sent successfully
19:10:50.820 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":10,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298850492,"threatLevel":0,"type":"heuristics_update"}
19:10:50.848 > [WebSocket] Processing message type: heuristics_update
19:10:50.853 > [120.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:50.952 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:8202170017000408040000000B7D0318BF225DE741C3BE08C3545129799389F7F29AF48CE65A18F903A5E44199C9403F5B90A4C6CF69D0184110EF1599","pipeline":{"afterLFSR":"3839AD4B49A81D6C15C70C7C5B131693C67388752F09D54D41E8F64582D5875F","afterSalt":"48522D36312053504F322D39352053544550532D3633324D50","afterTinkerbell":"299AA59918C308E67D5D79BE5418938CF7F95ABFE741C3F20351890322F441E4","afterTransposition":"7D0318BF225DE741C3BE08C3545129799389F7F29AF48CE65A18F903A5E44199"},"plaintext":"HR-61 SPO2-95 STEPS-632","serverTime":1770298850561,"timestamp":119632,"type":"encryption_update","ztmEnabled":true}
19:10:51.009 > [WebSocket] Processing message type: encryption_update
19:10:51.014 > [120.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:51.116 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":632,"time":1770298850561,"type":"health_data_update"}
19:10:51.124 > [WebSocket] Processing message type: health_data_update
19:10:51.130 > [120.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:51.237 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2637,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-632","handshakeSuccess":true,"totalTime":0.2637},"type":"session_summary_update"}
19:10:51.260 > [WebSocket] Processing message type: session_summary_update
19:10:51.266 > [120.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:51.371 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2637,"encryptedPacket":"8202170017000408040000000B7D0318BF225DE741C3BE08C3545129799389F7F29AF48CE65A18F903A5E44199C9403F5B90A4C6CF69D0184110EF1599","finalPlaintext":"HR-61 SPO2-95 STEPS-632","healthData":{"heartRate":61,"spo2":95,"steps":632},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D36333200000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3633324D5000000000000000","afterTinkerbell":"3839AD4B49A81D6C15C70C7C5B131693C67388752F09D54D41E8F64582D5875F","afterTransposition":"299AA59918C308E67D5D79BE5418938CF7F95ABFE741C3F20351890322F441E4"},"serverTime":1770298850562,"type":"decryption_update"}
19:10:51.428 > [WebSocket] Processing message type: decryption_update
19:10:51.434 > [WebSocket] Server decryption completed
19:10:51.437 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 632
19:10:51.443 > [120.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:51.544 > [WebSocket] Received (646 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":10,"pipeline":{"afterLFSR":"3839AD4B49A81D6C15C70C7C5B131693C67388752F09D54D41E8F64582D5875F","afterSalt":"48522D36312053504F322D39352053544550532D3633324D50","afterTinkerbell":"299AA59918C308E67D5D79BE5418938CF7F95ABFE741C3F20351890322F441E4","afterTransposition":"7D0318BF225DE741C3BE08C3545129799389F7F29AF48CE65A18F903A5E44199","finalPacket":"8202170017000408040000000B7D0318BF225DE741C3BE08C3545129799389F7F29AF48CE65A18F903A5E44199C9403F5B90A4C6CF69D0184110EF1599"},"plaintext":"HR-61 SPO2-95 STEPS-632","timestamp":119890,"type":"encryption_pipeline","ztmEnabled":true}
19:10:51.602 > [WebSocket] Processing message type: encryption_pipeline
19:10:51.608 > [120.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:51.706 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Health data #11 sent successfully","state":7,"success":true,"timestamp":119895,"type":"health_data_sent"}
19:10:51.724 > [WebSocket] Processing message type: health_data_sent
19:10:51.726 > [120.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:51.832 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":11,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298851500,"threatLevel":0,"type":"heuristics_update"}
19:10:51.860 > [WebSocket] Processing message type: heuristics_update
19:10:51.865 > [121.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:51.975 > [121.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:52.076 > [121.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:52.175 > [121.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:52.277 > [121.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:52.378 > [121.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:52.479 > [121.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:52.582 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":11,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298852513,"threatLevel":0,"type":"heuristics_update"}
19:10:52.609 > [WebSocket] Processing message type: heuristics_update
19:10:52.614 > [121.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:52.724 > [121.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:52.824 > [122.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:52.925 > [122.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:53.027 > [122.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:53.128 > [122.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:53.228 > [122.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:53.329 > [122.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:53.431 > [122.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:53.531 > [122.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:53.633 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":11,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298853527,"threatLevel":0,"type":"heuristics_update"}
19:10:53.661 > [WebSocket] Processing message type: heuristics_update
19:10:53.667 > [122.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:53.776 > [123.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:53.876 > [123.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:53.977 > [123.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:54.078 > [123.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:54.180 > [123.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:54.281 > [123.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:54.381 > [123.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:54.483 > [123.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:54.584 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":11,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298854536,"threatLevel":0,"type":"heuristics_update"}
19:10:54.612 > [WebSocket] Processing message type: heuristics_update
19:10:54.617 > [123.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:54.727 > [123.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:54.827 > [124.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:54.929 > [124.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:55.029 > [124.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:55.130 > [124.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:55.231 > [124.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:55.332 > [124.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:55.434 > [124.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:55.534 > [124.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:55.636 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":11,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298855550,"threatLevel":0,"type":"heuristics_update"}
19:10:55.664 > [WebSocket] Processing message type: heuristics_update
19:10:55.669 > [124.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:55.779 > [125.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:55.879 > [125.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:55.980 > [125.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:56.081 > [125.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:56.181 > [125.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:56.284 > [125.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:56.384 > [125.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:56.485 > [125.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:56.589 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":11,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298856559,"threatLevel":0,"type":"heuristics_update"}
19:10:56.617 > [WebSocket] Processing message type: heuristics_update
19:10:56.623 > [125.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:56.731 > [125.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:56.833 > [126.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:56.933 > [126.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:57.034 > [126.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:57.135 > [126.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:57.236 > [126.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:57.338 > [126.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:57.438 > [126.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:57.539 > [126.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:57.641 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":11,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298857572,"threatLevel":0,"type":"heuristics_update"}
19:10:57.668 > [WebSocket] Processing message type: heuristics_update
19:10:57.674 > [126.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:57.783 > [127.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:57.884 > [127.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:57.985 > [127.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:58.086 > [127.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:58.187 > [127.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:58.288 > [127.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:58.389 > [127.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:58.490 > [127.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:58.591 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":11,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298858579,"threatLevel":0,"type":"heuristics_update"}
19:10:58.620 > [WebSocket] Processing message type: heuristics_update
19:10:58.625 > [127.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:58.734 > [127.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:58.835 > [128.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:58.936 > [128.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:59.036 > [128.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:59.138 > [128.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:59.239 > [128.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:59.340 > [128.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:59.441 > [128.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:59.543 > [128.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:59.643 > [WebSocket] Received (312 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":11,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298859585,"threatLevel":0,"type":"heuristics_update"}
19:10:59.672 > [WebSocket] Processing message type: heuristics_update
19:10:59.677 > [128.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:10:59.787 > [WebSocket] Received (249 bytes): {"payload":{"epoch":2,"proposalId":"be4d849a-f920-4bb3-bf7b-00000051a20651c7394","proposedAt":"2026-02-05T13:40:59Z","targetRecipe":"FULL_STACK"},"signature":"7412eeb7b20c0e29ab8e85b21f7c285902f7880912e4449edcde2c4ac3af2e55","type":"switch_propose"}
19:10:59.809 > [WebSocket] Processing message type: switch_propose
19:10:59.814 > [WS_RX] switch_propose (new format) proposalId=be4d849a-f920-4bb3-bf7b-00000051a20651c7394 targetRecipe=FULL_STACK epoch=2
19:10:59.826 > [ZTM] Master key is zero - reloading from NVS
19:10:59.828 > [ZTM] Successfully reloaded master key from NVS
19:10:59.834 > [ZTM] Master key (first 16 bytes): 3D5D3BB6324126096E14D68E6AD0F442
19:10:59.840 > [ZTM] HMAC verify: canonical={"epoch":2,"proposalId":"be4d849a-f920-4bb3-bf7b-00000051a20651c7394","proposedAt":"2026-02-05T13:40:59Z","targetRecipe":"FULL_STACK"}
19:10:59.853 > [ZTM] HMAC verify: computed=7412eeb7b20c0e29ab8e85b21f7c285902f7880912e4449edcde2c4ac3af2e55 expected=7412eeb7b20c0e29ab8e85b21f7c285902f7880912e4449edcde2c4ac3af2e55
19:10:59.868 > [EPOCH_UPDATE] Updating from 1 to 2 (from switch_propose)\n[ACK_SENT] proposalId=be4d849a-f920-4bb3-bf7b-00000051a20651c7394 epoch=2 lastSeenNonce=0
19:10:59.882 > [ACK_SENT] payload={"deviceId":"f9641d44","epoch":2,"lastSeenNonce":0,"proposalId":"be4d849a-f920-4bb3-bf7b-00000051a20651c7394","ready":true} signature=3002d0ddbd6c3299f431b45096fc128235ec0379c575d46546a92141dee2b294
19:10:59.901 > [PROPOSE_ACCEPT] proposalId=be4d849a-f920-4bb3-bf7b-00000051a20651c7394 epoch=2 targetRecipe=FULL_STACK\n[129.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:11:00.015 > [WebSocket] Received (210 bytes): {"pending":true,"proposalId":"be4d849a-f920-4bb3-bf7b-00000051a20651c7394","reason":"Manual switch request","recipe":"FULL_STACK","serverTime":1770298859634,"success":true,"type":"adaptive_switch_acknowledged"}
19:11:00.034 > [WebSocket] Processing message type: adaptive_switch_acknowledged
19:11:00.040 > [WebSocket] ========================================
19:11:00.045 > [WebSocket] Received message type: adaptive_switch_acknowledged
19:11:00.050 > [WebSocket] Mode from message: 'ztm'
19:11:00.053 > [WebSocket] Recipe from message: 'FULL_STACK'
19:11:00.059 > [WebSocket] Current gZTMEnabled: TRUE
19:11:00.062 > [WebSocket] Current gCurrentMode: ZTM
19:11:00.065 > [WebSocket] Current gCurrentRecipe: CHAOS_ONLY
19:11:00.068 > [WebSocket] ========================================
19:11:00.073 > [WebSocket] Parsed newMode: ZTM, newRecipe: FULL_STACK
19:11:00.079 > [WebSocket] Waiting for switch_propose from server for recipe FULL_STACK
19:11:00.084 > [129.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:11:00.188 > [WebSocket] Received (246 bytes): {"payload":{"commitNonce":8589934593,"committedAt":"2026-02-05T13:40:59Z","epoch":2,"proposalId":"be4d849a-f920-4bb3-bf7b-00000051a20651c7394"},"signature":"8f701e8b3463726e4d4f70a27e187266bc2f0bca7de2df3e110bc43919925fd9","type":"switch_commit"}
19:11:00.209 > [WebSocket] Processing message type: switch_commit
19:11:00.214 > [WS_RX] switch_commit (new format) proposalId=be4d849a-f920-4bb3-bf7b-00000051a20651c7394 commitNonce=8589934593
19:11:00.224 > [ZTM] Master key (first 16 bytes): 3D5D3BB6324126096E14D68E6AD0F442
19:11:00.232 > [ZTM] HMAC verify: canonical={"commitNonce":8589934593,"committedAt":"2026-02-05T13:40:59Z","epoch":2,"proposalId":"be4d849a-f920-4bb3-bf7b-00000051a20651c7394"}
19:11:00.246 > [ZTM] HMAC verify: computed=8f701e8b3463726e4d4f70a27e187266bc2f0bca7de2df3e110bc43919925fd9 expected=8f701e8b3463726e4d4f70a27e187266bc2f0bca7de2df3e110bc43919925fd9
19:11:00.260 > [COMMIT_RECEIVED] proposalId=be4d849a-f920-4bb3-bf7b-00000051a20651c7394 commitNonce=8589934593 epoch=2
19:11:00.268 > [129.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:11:00.376 > [WebSocket] Received (116 bytes): {"proposalId":"be4d849a-f920-4bb3-bf7b-00000051a20651c7394","serverTime":1770298859870,"type":"switch_ack_received"}
19:11:00.386 > [WebSocket] Processing message type: switch_ack_received
19:11:00.392 > [129.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:11:00.498 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Mode: ztm, Recipe: FULL_STACK","state":7,"success":true,"timestamp":129262,"type":"mode_changed_pending"}
19:11:00.514 > [WebSocket] Processing message type: mode_changed_pending
19:11:00.517 > [129.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:11:00.620 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":11,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298860595,"threatLevel":0,"type":"heuristics_update"}
19:11:00.650 > [WebSocket] Processing message type: heuristics_update
19:11:00.654 > [129.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:11:00.763 > [129.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:11:00.768 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:00.773 > [BOUNDARY_CHECK] SwitchState=3 PendingActive=1 CommitNonce=8589934593\n[BOUNDARY_CHECK] nextTxNonce=8589934593 commitNonce=8589934593 (epoch=2 packet=1)\n[SWITCH] commit boundary reached — applying recipe proposalId=be4d849a-f920-4bb3-bf7b-00000051a20651c7394
19:11:00.795 > [SWITCH] applyRecipe: FULL_STACK
19:11:00.801 > [ZTM] Settings saved successfully
19:11:00.804 > [SWITCH] Protocol complete — returning to NORMAL state. Applied recipe at nonce: 8589934593
19:11:00.815 > [DONE_SENT] proposalId=be4d849a-f920-4bb3-bf7b-00000051a20651c7394 commitNonce=8589934593 epoch=2
19:11:00.824 > [SWITCH_DONE] Recipe switch completed at nonce=8589934593
19:11:00.827 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:11:00.832 > Generated health data: HR-62 SPO2-95 STEPS-682
19:11:00.838 > [ESP32] ========================================
19:11:00.841 > [ESP32] ENCRYPTION PIPELINE START
19:11:00.844 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: FULL_STACK
19:11:00.849 > [ESP32] Active Algorithms for this packet:
19:11:00.851 > [ESP32]   + LFSR
19:11:00.855 > [ESP32]   + Tinkerbell
19:11:00.858 > [ESP32]   + Transposition
19:11:00.860 > [ESP32]   + ChaCha20
19:11:00.860 > [ESP32]   + Salsa20
19:11:00.862 > [ESP32] ========================================
19:11:00.866 > [ESP32] MsgKeys: lfsrSeed=0x3BB0E6F0 tnk[0..3]=7DBF8E86 trn[0..3]=5EB42891
19:11:00.874 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3638324D50
19:11:00.879 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3638324D5000000000000000 
19:11:00.888 > [ESP32][LFSR] Initializing - Seed: 0x3BB0E6F0 SeedBe: 0xF0E6B03B ChaosKey[0..3]: 7DBF8E86 InitialTap: 0x0029 State: 0x3BB0E6F0
19:11:00.899 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:11:00.908 > 3_After_LFSR (32): B8B49D0D7DAE9D9B6BD5504343CC1391 252F5EE1C1A091D8AC70BD02C280FE47 
19:11:00.912 > [ESP32][LFSR] Keystream (first 16 bytes): F0E6B03B4F8ECECB24E77D7A76EC40C5
19:11:00.921 > [ESP32][4D] LFSR keystream (first 32 bytes): F0E6B03B4F8ECECB24E77D7A76EC40C5607F0DCCF798A395FC70BD02C280FE47
19:11:00.929 > [ESP32][TINKERBELL] Input (first 16 bytes): B8B49D0D7DAE9D9B6BD5504343CC1391 Nonce: 0x00000001 Buffer size: 32 bytes
19:11:00.941 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 7DBF8E86
19:11:00.952 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A9175C2AE370F4324A2160ED06317F85
19:11:00.958 > 4_After_Tinkerbell (32): 11A3C1279EDE69A921F430AE45FD6C14 B11749550111CBD9DFB2E773AD54E801 
19:11:00.965 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A9175C2AE370F4324A2160ED06317F85
19:11:00.975 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A9175C2AE370F4324A2160ED06317F85943817B4C0B15A0173C25A716FD41646
19:11:00.985 > 5_After_Transposition (32): 17DE4901AE1111A99EE801DF21C1E769 FD4554D9CBB230A35514B16CF47327AD 
19:11:00.994 > [ESP32][CHACHA20] Initializing - Nonce: 0x00000001
19:11:00.996 > [ESP32][CHACHA20] Key (first 8 bytes): 5390FD2C355DECCD
19:11:01.001 > [ESP32][CHACHA20] Full Nonce (12 bytes): 010000000000000000000000
19:11:01.007 > [ESP32][CHACHA20] Input (first 16 bytes): 17DE4901AE1111A99EE801DF21C1E769
19:11:01.016 > 6_After_ChaCha20 (32): 60CFC673E2C43ED322F12AACC585F3F2 0EDF13FDC34F077F6410BA83476C2E16 
19:11:01.021 > [ESP32][CHACHA20] Encryption complete - Output size: 32 bytes
19:11:01.027 > [ESP32][SALSA20] Initializing - Nonce: 0x00000001
19:11:01.032 > [ESP32][SALSA20] Key (first 8 bytes): 5390FD2C355DECCD
19:11:01.038 > [ESP32][SALSA20] Full Nonce (8 bytes): 0100000000000000
19:11:01.040 > [ESP32][SALSA20] Input (first 16 bytes): 60CFC673E2C43ED322F12AACC585F3F2
19:11:01.049 > 7_After_Salsa20 (32): 79CC29FC3D3988B0F987AFD1AF4BD8F0 1FDE485C53F9D2DB71B109D887BE5542 
19:11:01.058 > [ESP32][SALSA20] Encryption complete - Output size: 32 bytes
19:11:01.063 > [ESP32][4B] recipeId=1 (FULL_STACK) nonce=0x00000001
19:11:01.066 > [ESP32] === HMAC DEBUG INFO ===
19:11:01.069 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:11:01.076 > [ESP32] HMAC Input length: 45 bytes
19:11:01.079 > [ESP32] HMAC Input (first 32 bytes): 8202170017000408010000000179CC29FC3D3988B0F987AFD1AF4BD8F01FDE48
19:11:01.087 > [ESP32] Nonce: 0x00000001
19:11:01.091 > [ESP32] Packet size before HMAC: 61
19:11:01.093 > [ESP32] Computed HMAC Tag: 9AA60FAE93DFF3F91E93B50738215D69
19:11:01.099 > [ESP32] === END HMAC DEBUG ===
19:11:01.101 > 6_Final_Packet (61): 8202170017000408010000000179CC29 FC3D3988B0F987AFD1AF4BD8F01FDE48 ...
19:11:01.110 > [RETRY] Attempt 1/3 (nonce: 1)
19:11:01.113 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:01.119 > Sending pipeline data to server (771 bytes)
19:11:01.429 > [HTTP] Response code: 200
19:11:01.429 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:11:01.441 > [RETRY] Health data sent successfully!
19:11:01.444 > ✓ Health data #12 sent successfully
19:11:01.547 > [WebSocket] Received (411 bytes): {"activatedAt":1770298766651,"active":true,"epoch":2,"heuristics":{"cpuUsage":20.0,"decryptFailures":0,"entropy":7.5,"hmacFailures":0,"latency":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"lastCommitNonce":8589934593,"lastSeenNonce":11,"lastSwitchReason":"Committed via switch_done","pendingProposals":0,"recipe":"FULL_STACK","serverTime":1770298860818,"threatLevel":0,"type":"ztm_status"}
19:11:01.583 > [WebSocket] Processing message type: ztm_status
19:11:01.588 > [130.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:01.690 > [WebSocket] Received (134 bytes): {"proposalId":"be4d849a-f920-4bb3-bf7b-00000051a20651c7394","serverTime":1770298860818,"status":"committed","type":"switch_committed"}
19:11:01.704 > [WebSocket] Processing message type: switch_committed
19:11:01.707 > [130.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:01.812 > [WebSocket] Received (798 bytes): {"currentRecipe":"FULL_STACK","encData":"ENC_DATA:8202170017000408010000000179CC29FC3D3988B0F987AFD1AF4BD8F01FDE485C53F9D2DB71B109D887BE55429AA60FAE93DFF3F91E93B50738215D69","pipeline":{"afterChaCha20":"60CFC673E2C43ED322F12AACC585F3F20EDF13FDC34F077F6410BA83476C2E16","afterLFSR":"B8B49D0D7DAE9D9B6BD5504343CC1391252F5EE1C1A091D8AC70BD02C280FE47","afterSalsa20":"79CC29FC3D3988B0F987AFD1AF4BD8F01FDE485C53F9D2DB71B109D887BE5542","afterSalt":"48522D36322053504F322D39352053544550532D3638324D50","afterTinkerbell":"11A3C1279EDE69A921F430AE45FD6C14B11749550111CBD9DFB2E773AD54E801","afterTransposition":"17DE4901AE1111A99EE801DF21C1E769FD4554D9CBB230A35514B16CF47327AD"},"plaintext":"HR-62 SPO2-95 STEPS-682","serverTime":1770298861204,"timestamp":130303,"type":"encryption_update","ztmEnabled":true}
19:11:01.885 > [WebSocket] Processing message type: encryption_update
19:11:01.888 > [131.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:01.997 > [WebSocket] Received (87 bytes): {"heartRate":62,"spo2":95,"steps":682,"time":1770298861204,"type":"health_data_update"}
19:11:02.005 > [WebSocket] Processing message type: health_data_update
19:11:02.010 > [131.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:02.119 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3442,"encryptionTime":0.0,"finalPlaintext":"HR-62 SPO2-95 STEPS-682","handshakeSuccess":true,"totalTime":0.3442},"type":"session_summary_update"}
19:11:02.141 > [WebSocket] Processing message type: session_summary_update
19:11:02.147 > [131.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:02.252 > [WebSocket] Received (658 bytes): {"decryptionTime":0.3442,"encryptedPacket":"8202170017000408010000000179CC29FC3D3988B0F987AFD1AF4BD8F01FDE485C53F9D2DB71B109D887BE55429AA60FAE93DFF3F91E93B50738215D69","finalPlaintext":"HR-62 SPO2-95 STEPS-682","healthData":{"heartRate":62,"spo2":95,"steps":682},"pipeline":{"afterDepad":"48522D36322053504F322D39352053544550532D36383200000000000000","afterLFSR":"48522D36322053504F322D39352053544550532D3638324D5000000000000000","afterTinkerbell":"B8B49D0D7DAE9D9B6BD5504343CC1391252F5EE1C1A091D8AC70BD02C280FE47","afterTransposition":"11A3C1279EDE69A921F430AE45FD6C14B11749550111CBD9DFB2E773AD54E801"},"serverTime":1770298861204,"type":"decryption_update"}
19:11:02.310 > [WebSocket] Processing message type: decryption_update
19:11:02.315 > [WebSocket] Server decryption completed
19:11:02.318 > [WebSocket] Health data - HR: 62, SPO2: 95, Steps: 682
19:11:02.324 > [131.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:02.427 > [WebSocket] Received (811 bytes): {"currentRecipe":"FULL_STACK","deviceId":"f9641d44","healthSendCount":11,"pipeline":{"afterChaCha20":"60CFC673E2C43ED322F12AACC585F3F20EDF13FDC34F077F6410BA83476C2E16","afterLFSR":"B8B49D0D7DAE9D9B6BD5504343CC1391252F5EE1C1A091D8AC70BD02C280FE47","afterSalsa20":"79CC29FC3D3988B0F987AFD1AF4BD8F01FDE485C53F9D2DB71B109D887BE5542","afterSalt":"48522D36322053504F322D39352053544550532D3638324D50","afterTinkerbell":"11A3C1279EDE69A921F430AE45FD6C14B11749550111CBD9DFB2E773AD54E801","afterTransposition":"17DE4901AE1111A99EE801DF21C1E769FD4554D9CBB230A35514B16CF47327AD","finalPacket":"8202170017000408010000000179CC29FC3D3988B0F987AFD1AF4BD8F01FDE485C53F9D2DB71B109D887BE55429AA60FAE93DFF3F91E93B50738215D69"},"plaintext":"HR-62 SPO2-95 STEPS-682","timestamp":130614,"type":"encryption_pipeline","ztmEnabled":true}
19:11:02.499 > [WebSocket] Processing message type: encryption_pipeline
19:11:02.504 > [131.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:02.611 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Health data #12 sent successfully","state":7,"success":true,"timestamp":130619,"type":"health_data_sent"}
19:11:02.629 > [WebSocket] Processing message type: health_data_sent
19:11:02.631 > [131.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:02.734 > [WebSocket] Received (320 bytes): {"currentRecipe":"FULL_STACK","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298861606,"threatLevel":0,"type":"heuristics_update"}
19:11:02.764 > [WebSocket] Processing message type: heuristics_update
19:11:02.767 > [131.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:02.877 > [WebSocket] Received (320 bytes): {"currentRecipe":"FULL_STACK","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298862618,"threatLevel":0,"type":"heuristics_update"}
19:11:02.908 > [WebSocket] Processing message type: heuristics_update
19:11:02.910 > [132.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:03.019 > [132.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:03.120 > [132.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:03.221 > [132.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:03.322 > [132.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:03.423 > [132.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:03.524 > [132.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:03.625 > [132.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:03.727 > [WebSocket] Received (320 bytes): {"currentRecipe":"FULL_STACK","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298863623,"threatLevel":0,"type":"heuristics_update"}
19:11:03.757 > [WebSocket] Processing message type: heuristics_update
19:11:03.760 > [132.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:03.869 > [133.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:03.971 > [133.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:04.071 > [133.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:04.173 > [133.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:04.273 > [133.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:04.374 > [133.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:04.474 > [133.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:04.576 > [133.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:04.678 > [WebSocket] Received (320 bytes): {"currentRecipe":"FULL_STACK","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298864635,"threatLevel":0,"type":"heuristics_update"}
19:11:04.708 > [WebSocket] Processing message type: heuristics_update
19:11:04.711 > [133.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:04.820 > [134.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:04.921 > [134.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:05.022 > [134.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:05.123 > [134.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:05.224 > [134.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:05.325 > [134.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:05.426 > [134.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:05.527 > [134.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:05.627 > [134.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:05.729 > [WebSocket] Received (320 bytes): {"currentRecipe":"FULL_STACK","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298865647,"threatLevel":0,"type":"heuristics_update"}
19:11:05.760 > [WebSocket] Processing message type: heuristics_update
19:11:05.763 > [134.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:05.872 > [135.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:05.973 > [135.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:06.074 > [135.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:06.175 > [135.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:06.276 > [135.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:06.376 > [135.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:06.478 > [135.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:06.578 > [135.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:06.680 > [135.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:06.783 > [WebSocket] Received (250 bytes): {"payload":{"epoch":3,"proposalId":"8d113f71-a9b0-49bc-bc96-0000007340d360bda694","proposedAt":"2026-02-05T13:41:06Z","targetRecipe":"CHAOS_ONLY"},"signature":"ccb8302e3fac12851d6ca14474e462dfc616c26d9044d4560857e2bd51dfe73c","type":"switch_propose"}
19:11:06.806 > [WebSocket] Processing message type: switch_propose
19:11:06.811 > [WS_RX] switch_propose (new format) proposalId=8d113f71-a9b0-49bc-bc96-0000007340d360bda694 targetRecipe=CHAOS_ONLY epoch=3
19:11:06.823 > [ZTM] Master key (first 16 bytes): 3D5D3BB6324126096E14D68E6AD0F442
19:11:06.828 > [ZTM] HMAC verify: canonical={"epoch":3,"proposalId":"8d113f71-a9b0-49bc-bc96-0000007340d360bda694","proposedAt":"2026-02-05T13:41:06Z","targetRecipe":"CHAOS_ONLY"}
19:11:06.842 > [ZTM] HMAC verify: computed=ccb8302e3fac12851d6ca14474e462dfc616c26d9044d4560857e2bd51dfe73c expected=ccb8302e3fac12851d6ca14474e462dfc616c26d9044d4560857e2bd51dfe73c
19:11:06.856 > [EPOCH_UPDATE] Updating from 2 to 3 (from switch_propose)\n[ACK_SENT] proposalId=8d113f71-a9b0-49bc-bc96-0000007340d360bda694 epoch=3 lastSeenNonce=0
19:11:06.871 > [ACK_SENT] payload={"deviceId":"f9641d44","epoch":3,"lastSeenNonce":0,"proposalId":"8d113f71-a9b0-49bc-bc96-0000007340d360bda694","ready":true} signature=0aa475536a15d062c232a67d084b86837f09bd99b57e8eb48364186f534b90b4
19:11:06.891 > [PROPOSE_ACCEPT] proposalId=8d113f71-a9b0-49bc-bc96-0000007340d360bda694 epoch=3 targetRecipe=CHAOS_ONLY\n[136.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:07.009 > [WebSocket] Received (320 bytes): {"currentRecipe":"FULL_STACK","epoch":3,"lastCommitNonce":8589934593,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298866657,"threatLevel":0,"type":"heuristics_update"}
19:11:07.039 > [WebSocket] Processing message type: heuristics_update
19:11:07.041 > [136.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:07.152 > [WebSocket] Received (248 bytes): {"payload":{"commitNonce":12884901889,"committedAt":"2026-02-05T13:41:06Z","epoch":3,"proposalId":"8d113f71-a9b0-49bc-bc96-0000007340d360bda694"},"signature":"3fc54fe650fe9ba98f1e2c211731a0810465e9c5a8e2cb37f53bef65e61f67ae","type":"switch_commit"}
19:11:07.174 > [WebSocket] Processing message type: switch_commit
19:11:07.180 > [WS_RX] switch_commit (new format) proposalId=8d113f71-a9b0-49bc-bc96-0000007340d360bda694 commitNonce=12884901889
19:11:07.191 > [ZTM] Master key (first 16 bytes): 3D5D3BB6324126096E14D68E6AD0F442
19:11:07.196 > [ZTM] HMAC verify: canonical={"commitNonce":12884901889,"committedAt":"2026-02-05T13:41:06Z","epoch":3,"proposalId":"8d113f71-a9b0-49bc-bc96-0000007340d360bda694"}
19:11:07.210 > [ZTM] HMAC verify: computed=3fc54fe650fe9ba98f1e2c211731a0810465e9c5a8e2cb37f53bef65e61f67ae expected=3fc54fe650fe9ba98f1e2c211731a0810465e9c5a8e2cb37f53bef65e61f67ae
19:11:07.224 > [COMMIT_RECEIVED] proposalId=8d113f71-a9b0-49bc-bc96-0000007340d360bda694 commitNonce=12884901889 epoch=3
19:11:07.232 > [136.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:07.339 > [WebSocket] Received (117 bytes): {"proposalId":"8d113f71-a9b0-49bc-bc96-0000007340d360bda694","serverTime":1770298866865,"type":"switch_ack_received"}
19:11:07.351 > [WebSocket] Processing message type: switch_ack_received
19:11:07.356 > [136.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:07.461 > [136.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:07.561 > [136.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:07.663 > [136.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:07.765 > [WebSocket] Received (250 bytes): {"payload":{"epoch":4,"proposalId":"654c5339-e76d-452f-a13d-0000009a2d0d1b1b7d06","proposedAt":"2026-02-05T13:41:07Z","targetRecipe":"CHAOS_ONLY"},"signature":"5c062ba91d3148fede43832c62c4324b0f10e5a4c2d92e9b3041e49d058c0c56","type":"switch_propose"}
19:11:07.787 > [WebSocket] Processing message type: switch_propose
19:11:07.792 > [WS_RX] switch_propose (new format) proposalId=654c5339-e76d-452f-a13d-0000009a2d0d1b1b7d06 targetRecipe=CHAOS_ONLY epoch=4
19:11:07.803 > [ZTM] Master key (first 16 bytes): 3D5D3BB6324126096E14D68E6AD0F442
19:11:07.809 > [ZTM] HMAC verify: canonical={"epoch":4,"proposalId":"654c5339-e76d-452f-a13d-0000009a2d0d1b1b7d06","proposedAt":"2026-02-05T13:41:07Z","targetRecipe":"CHAOS_ONLY"}
19:11:07.823 > [ZTM] HMAC verify: computed=5c062ba91d3148fede43832c62c4324b0f10e5a4c2d92e9b3041e49d058c0c56 expected=5c062ba91d3148fede43832c62c4324b0f10e5a4c2d92e9b3041e49d058c0c56
19:11:07.837 > [EPOCH_UPDATE] Updating from 3 to 4 (from switch_propose)\n[PROPOSE_REJECT] overlapping transaction
19:11:07.848 > [NACK_SENT] proposalId=654c5339-e76d-452f-a13d-0000009a2d0d1b1b7d06 reason=overlapping currentEpoch=4
19:11:07.856 > [137.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:07.960 > [WebSocket] Received (321 bytes): {"currentRecipe":"FULL_STACK","epoch":4,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298867664,"threatLevel":0,"type":"heuristics_update"}
19:11:07.990 > [WebSocket] Processing message type: heuristics_update
19:11:07.994 > [137.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:08.103 > [WebSocket] Received (500 bytes): {"activatedAt":1770298867852,"active":true,"epoch":1,"heuristics":{"cpuUsage":20.0,"decryptFailures":0,"entropy":7.5,"hmacFailures":0,"latency":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"lastCommitNonce":12884901889,"lastSeenNonce":1,"lastSwitchReason":"ZTM activated - baseline recipe","message":"Zero Trust Mode activated successfully","pendingProposals":2,"recipe":"CHAOS_ONLY","serverTime":1770298867852,"success":true,"threatLevel":0,"type":"ztm_activation_acknowledged"}
19:11:08.148 > [WebSocket] Processing message type: ztm_activation_acknowledged
19:11:08.153 > [WebSocket] ========================================
19:11:08.159 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged, fromFrontend: NO)
19:11:08.167 > [WebSocket] ========================================
19:11:08.170 > [ZTM] Settings saved successfully
19:11:08.176 > [WebSocket] ✓ ZTM activated successfully
19:11:08.179 > [WebSocket] ✓ Normal Mode encryption STOPPED
19:11:08.181 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
19:11:08.187 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
19:11:08.189 > [WebSocket] ========================================
19:11:08.195 > [WebSocket] Received server ack - not sending duplicate ack (prevents loop)
19:11:08.207 > [137.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:08.308 > [WebSocket] Received (118 bytes): {"proposalId":"654c5339-e76d-452f-a13d-0000009a2d0d1b1b7d06","serverTime":1770298867861,"type":"switch_nack_received"}
19:11:08.319 > [WebSocket] Processing message type: switch_nack_received
19:11:08.325 > [137.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:08.431 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":12,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":137386,"type":"ztm_activated"}
19:11:08.447 > [WebSocket] Processing message type: ztm_activated
19:11:08.449 > [137.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:08.551 > [137.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:08.652 > [137.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:08.754 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298868671,"threatLevel":0,"type":"heuristics_update"}
19:11:08.785 > [WebSocket] Processing message type: heuristics_update
19:11:08.788 > [138.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:08.898 > [138.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:08.998 > [138.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:09.099 > [138.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:09.201 > [138.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:09.302 > [138.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:09.403 > [138.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:09.504 > [138.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:09.605 > [138.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:09.706 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298869680,"threatLevel":0,"type":"heuristics_update"}
19:11:09.736 > [WebSocket] Processing message type: heuristics_update
19:11:09.740 > [138.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:09.849 > [139.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:09.950 > [139.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:10.051 > [139.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:10.151 > [139.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:10.253 > [139.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:10.354 > [139.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:10.455 > [139.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:10.556 > [139.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:10.657 > [139.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:10.760 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298870695,"threatLevel":0,"type":"heuristics_update"}
19:11:10.790 > [WebSocket] Processing message type: heuristics_update
19:11:10.793 > [140.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:10.901 > [140.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:11.002 > [140.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:11.104 > [140.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:11.204 > [140.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:11.306 > [140.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:11.406 > [140.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:11.508 > [140.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:11:11.514 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:11.519 > [BOUNDARY_CHECK] SwitchState=3 PendingActive=1 CommitNonce=12884901889\n[BOUNDARY_CHECK] nextTxNonce=17179869185 commitNonce=12884901889 (epoch=4 packet=1)\n[SWITCH] commit boundary reached — applying recipe proposalId=8d113f71-a9b0-49bc-bc96-0000007340d360bda694
19:11:11.544 > [SWITCH] applyRecipe: CHAOS_ONLY
19:11:11.547 > [ZTM] Settings saved successfully
19:11:11.549 > [SWITCH] Protocol complete — returning to NORMAL state. Applied recipe at nonce: 12884901889
19:11:11.558 > [DONE_SENT] proposalId=8d113f71-a9b0-49bc-bc96-0000007340d360bda694 commitNonce=12884901889 epoch=3
19:11:11.566 > [SWITCH_DONE] Recipe switch completed at nonce=12884901889
19:11:11.571 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:11:11.574 > Generated health data: HR-62 SPO2-95 STEPS-720
19:11:11.579 > [ESP32] ========================================
19:11:11.583 > [ESP32] ENCRYPTION PIPELINE START
19:11:11.588 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:11:11.591 > [ESP32] Active Algorithms for this packet:
19:11:11.596 > [ESP32]   + LFSR
19:11:11.596 > [ESP32]   + Tinkerbell
19:11:11.599 > [ESP32]   + Transposition
19:11:11.602 > [ESP32]   - ChaCha20
19:11:11.602 > [ESP32]   - Salsa20
19:11:11.605 > [ESP32] ========================================
19:11:11.610 > [ESP32] MsgKeys: lfsrSeed=0x3BB0E6F0 tnk[0..3]=7DBF8E86 trn[0..3]=5EB42891
19:11:11.616 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3732304D50
19:11:11.621 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3732304D5000000000000000 
19:11:11.630 > [ESP32][LFSR] Initializing - Seed: 0x3BB0E6F0 SeedBe: 0xF0E6B03B ChaosKey[0..3]: 7DBF8E86 InitialTap: 0x0029 State: 0x3BB0E6F0
19:11:11.641 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:11:11.649 > 3_After_LFSR (32): B8B49D0D7DAE9D9B6BD5504343CC1391 252F5EE1C0AA93D8AC70BD02C280FE47 
19:11:11.658 > [ESP32][LFSR] Keystream (first 16 bytes): F0E6B03B4F8ECECB24E77D7A76EC40C5
19:11:11.663 > [ESP32][4D] LFSR keystream (first 32 bytes): F0E6B03B4F8ECECB24E77D7A76EC40C5607F0DCCF798A395FC70BD02C280FE47
19:11:11.671 > [ESP32][TINKERBELL] Input (first 16 bytes): B8B49D0D7DAE9D9B6BD5504343CC1391 Nonce: 0x00000001 Buffer size: 32 bytes
19:11:11.682 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 7DBF8E86
19:11:11.693 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A9175C2AE370F4324A2160ED06317F85
19:11:11.702 > 4_After_Tinkerbell (32): 11A3C1279EDE69A921F430AE45FD6C14 B1174955001BC9D9DFB2E773AD54E801 
19:11:11.711 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A9175C2AE370F4324A2160ED06317F85
19:11:11.716 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A9175C2AE370F4324A2160ED06317F85943817B4C0B15A0173C25A716FD41646
19:11:11.727 > 5_After_Transposition (32): 17DE4900AE111BA99EE801DF21C1E769 FD4554D9C9B230A35514B16CF47327AD 
19:11:11.736 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:11:11.741 > [ESP32] === HMAC DEBUG INFO ===
19:11:11.744 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:11:11.752 > [ESP32] HMAC Input length: 45 bytes
19:11:11.755 > [ESP32] HMAC Input (first 32 bytes): 8202170017000408040000000117DE4900AE111BA99EE801DF21C1E769FD4554
19:11:11.763 > [ESP32] Nonce: 0x00000001
19:11:11.766 > [ESP32] Packet size before HMAC: 61
19:11:11.769 > [ESP32] Computed HMAC Tag: 02E536B840F846ACBB4555BFEE9DAA2D
19:11:11.775 > [ESP32] === END HMAC DEBUG ===
19:11:11.777 > 6_Final_Packet (61): 8202170017000408040000000117DE49 00AE111BA99EE801DF21C1E769FD4554 ...
19:11:11.785 > [RETRY] Attempt 1/3 (nonce: 1)
19:11:11.788 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:11.793 > Sending pipeline data to server (606 bytes)
19:11:12.025 > [HTTP] Response code: 200
19:11:12.025 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:11:12.036 > [RETRY] Health data sent successfully!
19:11:12.040 > ✓ Health data #13 sent successfully
19:11:12.141 > [WebSocket] Received (411 bytes): {"activatedAt":1770298867852,"active":true,"epoch":1,"heuristics":{"cpuUsage":20.0,"decryptFailures":0,"entropy":7.5,"hmacFailures":0,"latency":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"lastCommitNonce":12884901889,"lastSeenNonce":1,"lastSwitchReason":"Committed via switch_done","pendingProposals":0,"recipe":"CHAOS_ONLY","serverTime":1770298871561,"threatLevel":0,"type":"ztm_status"}
19:11:12.177 > [WebSocket] Processing message type: ztm_status
19:11:12.182 > [141.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:12.284 > [WebSocket] Received (135 bytes): {"proposalId":"8d113f71-a9b0-49bc-bc96-0000007340d360bda694","serverTime":1770298871561,"status":"committed","type":"switch_committed"}
19:11:12.298 > [WebSocket] Processing message type: switch_committed
19:11:12.303 > [141.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:12.406 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298871706,"threatLevel":0,"type":"heuristics_update"}
19:11:12.437 > [WebSocket] Processing message type: heuristics_update
19:11:12.439 > [141.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:12.550 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":3,"serverTime":1770298871880,"type":"security_update"}
19:11:12.566 > [WebSocket] Processing message type: security_update
19:11:12.571 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:11:12.577 > [141.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:12.682 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:8202170017000408040000000117DE4900AE111BA99EE801DF21C1E769FD4554D9C9B230A35514B16CF47327AD02E536B840F846ACBB4555BFEE9DAA2D","pipeline":{"afterLFSR":"B8B49D0D7DAE9D9B6BD5504343CC1391252F5EE1C0AA93D8AC70BD02C280FE47","afterSalt":"48522D36322053504F322D39352053544550532D3732304D50","afterTinkerbell":"11A3C1279EDE69A921F430AE45FD6C14B1174955001BC9D9DFB2E773AD54E801","afterTransposition":"17DE4900AE111BA99EE801DF21C1E769FD4554D9C9B230A35514B16CF47327AD"},"plaintext":"HR-62 SPO2-95 STEPS-720","serverTime":1770298871880,"timestamp":140970,"type":"encryption_update","ztmEnabled":true}
19:11:12.737 > [WebSocket] Processing message type: encryption_update
19:11:12.742 > [141.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:12.845 > [WebSocket] Received (87 bytes): {"heartRate":62,"spo2":95,"steps":720,"time":1770298871880,"type":"health_data_update"}
19:11:12.854 > [WebSocket] Processing message type: health_data_update
19:11:12.859 > [142.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:12.967 > [WebSocket] Received (223 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.301,"encryptionTime":0.0,"finalPlaintext":"HR-62 SPO2-95 STEPS-720","handshakeSuccess":true,"totalTime":0.301},"type":"session_summary_update"}
19:11:12.989 > [WebSocket] Processing message type: session_summary_update
19:11:12.992 > [142.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:13.099 > [WebSocket] Received (657 bytes): {"decryptionTime":0.301,"encryptedPacket":"8202170017000408040000000117DE4900AE111BA99EE801DF21C1E769FD4554D9C9B230A35514B16CF47327AD02E536B840F846ACBB4555BFEE9DAA2D","finalPlaintext":"HR-62 SPO2-95 STEPS-720","healthData":{"heartRate":62,"spo2":95,"steps":720},"pipeline":{"afterDepad":"48522D36322053504F322D39352053544550532D37323000000000000000","afterLFSR":"48522D36322053504F322D39352053544550532D3732304D5000000000000000","afterTinkerbell":"B8B49D0D7DAE9D9B6BD5504343CC1391252F5EE1C0AA93D8AC70BD02C280FE47","afterTransposition":"11A3C1279EDE69A921F430AE45FD6C14B1174955001BC9D9DFB2E773AD54E801"},"serverTime":1770298871881,"type":"decryption_update"}
19:11:13.158 > [WebSocket] Processing message type: decryption_update
19:11:13.163 > [WebSocket] Server decryption completed
19:11:13.165 > [WebSocket] Health data - HR: 62, SPO2: 95, Steps: 720
19:11:13.171 > [142.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:13.273 > [WebSocket] Received (646 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":12,"pipeline":{"afterLFSR":"B8B49D0D7DAE9D9B6BD5504343CC1391252F5EE1C0AA93D8AC70BD02C280FE47","afterSalt":"48522D36322053504F322D39352053544550532D3732304D50","afterTinkerbell":"11A3C1279EDE69A921F430AE45FD6C14B1174955001BC9D9DFB2E773AD54E801","afterTransposition":"17DE4900AE111BA99EE801DF21C1E769FD4554D9C9B230A35514B16CF47327AD","finalPacket":"8202170017000408040000000117DE4900AE111BA99EE801DF21C1E769FD4554D9C9B230A35514B16CF47327AD02E536B840F846ACBB4555BFEE9DAA2D"},"plaintext":"HR-62 SPO2-95 STEPS-720","timestamp":141210,"type":"encryption_pipeline","ztmEnabled":true}
19:11:13.332 > [WebSocket] Processing message type: encryption_pipeline
19:11:13.338 > [142.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:13.437 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":12,"message":"Health data #13 sent successfully","state":7,"success":true,"timestamp":141215,"type":"health_data_sent"}
19:11:13.454 > [WebSocket] Processing message type: health_data_sent
19:11:13.456 > [142.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:13.559 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298872715,"threatLevel":0,"type":"heuristics_update"}
19:11:13.590 > [WebSocket] Processing message type: heuristics_update
19:11:13.593 > [142.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:13.701 > [142.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:13.804 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298873725,"threatLevel":0,"type":"heuristics_update"}
19:11:13.834 > [WebSocket] Processing message type: heuristics_update
19:11:13.837 > [143.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:13.945 > [143.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:14.047 > [143.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:14.148 > [143.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:14.249 > [143.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:14.350 > [143.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:14.451 > [143.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:14.551 > [143.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:14.652 > [143.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:14.757 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298874736,"threatLevel":0,"type":"heuristics_update"}
19:11:14.787 > [WebSocket] Processing message type: heuristics_update
19:11:14.790 > [144.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:14.899 > [144.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:15.000 > [144.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:15.101 > [144.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:15.202 > [144.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:15.303 > [144.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:15.403 > [144.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:15.504 > [144.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:15.606 > [144.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:15.707 > [144.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:15.809 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298875746,"threatLevel":0,"type":"heuristics_update"}
19:11:15.839 > [WebSocket] Processing message type: heuristics_update
19:11:15.842 > [145.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:15.951 > [145.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:16.052 > [145.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:16.152 > [145.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:16.253 > [145.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:16.354 > [145.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:16.456 > [145.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:16.556 > [145.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:16.658 > [145.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:16.759 > [145.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:16.861 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298876756,"threatLevel":0,"type":"heuristics_update"}
19:11:16.890 > [WebSocket] Processing message type: heuristics_update
19:11:16.894 > [146.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:17.002 > [146.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:17.103 > [146.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:17.204 > [146.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:17.306 > [146.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:17.407 > [146.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:17.508 > [146.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:17.609 > [146.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:17.709 > [146.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:17.811 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298877764,"threatLevel":0,"type":"heuristics_update"}
19:11:17.842 > [WebSocket] Processing message type: heuristics_update
19:11:17.845 > [147.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:17.954 > [147.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:18.054 > [147.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:18.156 > [147.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:18.257 > [147.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:18.358 > [147.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:18.459 > [147.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:18.560 > [147.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:18.661 > [147.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:18.761 > [147.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:18.863 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298878775,"threatLevel":0,"type":"heuristics_update"}
19:11:18.894 > [WebSocket] Processing message type: heuristics_update
19:11:18.896 > [148.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:19.006 > [148.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:19.107 > [148.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:19.208 > [148.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:19.309 > [148.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:19.409 > [148.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:19.510 > [148.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:19.612 > [148.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:19.713 > [148.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:19.816 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298879778,"threatLevel":0,"type":"heuristics_update"}
19:11:19.847 > [WebSocket] Processing message type: heuristics_update
19:11:19.850 > [149.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:19.958 > [149.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:20.059 > [149.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:20.160 > [149.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:20.261 > [149.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:20.363 > [149.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:20.463 > [149.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:20.564 > [149.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:20.666 > [149.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:20.767 > [150.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:20.868 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298880792,"threatLevel":0,"type":"heuristics_update"}
19:11:20.899 > [WebSocket] Processing message type: heuristics_update
19:11:20.902 > [150.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:21.010 > [150.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:21.111 > [150.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:21.212 > [150.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:21.314 > [WebSocket] Received (500 bytes): {"activatedAt":1770298881281,"active":true,"epoch":1,"heuristics":{"cpuUsage":20.0,"decryptFailures":0,"entropy":7.5,"hmacFailures":0,"latency":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"lastCommitNonce":12884901889,"lastSeenNonce":1,"lastSwitchReason":"ZTM activated - baseline recipe","message":"Zero Trust Mode activated successfully","pendingProposals":0,"recipe":"CHAOS_ONLY","serverTime":1770298881281,"success":true,"threatLevel":0,"type":"ztm_activation_acknowledged"}
19:11:21.359 > [WebSocket] Processing message type: ztm_activation_acknowledged
19:11:21.364 > [WebSocket] ========================================
19:11:21.370 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged, fromFrontend: NO)
19:11:21.378 > [WebSocket] ========================================
19:11:21.381 > [ZTM] Settings saved successfully
19:11:21.387 > [WebSocket] ✓ ZTM activated successfully
19:11:21.389 > [WebSocket] ✓ Normal Mode encryption STOPPED
19:11:21.392 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
19:11:21.398 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
19:11:21.400 > [WebSocket] ========================================
19:11:21.406 > [WebSocket] Received server ack - not sending duplicate ack (prevents loop)
19:11:21.415 > [150.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:21.516 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":150594,"type":"ztm_activated"}
19:11:21.533 > [WebSocket] Processing message type: ztm_activated
19:11:21.536 > [150.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:21.639 > [150.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:21.740 > [150.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:21.842 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298881794,"threatLevel":0,"type":"heuristics_update"}
19:11:21.872 > [WebSocket] Processing message type: heuristics_update
19:11:21.874 > [151.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:21.983 > [151.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:22.084 > [151.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:22.091 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:22.096 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:11:22.112 > Generated health data: HR-62 SPO2-95 STEPS-779
19:11:22.118 > [ESP32] ========================================
19:11:22.120 > [ESP32] ENCRYPTION PIPELINE START
19:11:22.124 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:11:22.128 > [ESP32] Active Algorithms for this packet:
19:11:22.135 > [ESP32]   + LFSR
19:11:22.135 > [ESP32]   + Tinkerbell
19:11:22.137 > [ESP32]   + Transposition
19:11:22.140 > [ESP32]   - ChaCha20
19:11:22.140 > [ESP32]   - Salsa20
19:11:22.143 > [ESP32] ========================================
19:11:22.149 > [ESP32] MsgKeys: lfsrSeed=0xA8FF9E73 tnk[0..3]=CABF4CED trn[0..3]=B6559938
19:11:22.153 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3737394D50
19:11:22.159 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3737394D5000000000000000 
19:11:22.167 > [ESP32][LFSR] Initializing - Seed: 0xA8FF9E73 SeedBe: 0x739EFFA8 ChaosKey[0..3]: CABF4CED InitialTap: 0x0029 State: 0xA8FF9E73
19:11:22.179 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:11:22.187 > 3_After_LFSR (32): 3BCCD29EE8490DFB1EC4E6CD8C7451EE FCCED9536814378CC1922A958D7986C1 
19:11:22.195 > [ESP32][LFSR] Keystream (first 16 bytes): 739EFFA8DA695EAB51F6CBF4B95402BA
19:11:22.201 > [ESP32][4D] LFSR keystream (first 32 bytes): 739EFFA8DA695EAB51F6CBF4B95402BAB99E8A7E5F230EC191922A958D7986C1
19:11:22.209 > [ESP32][TINKERBELL] Input (first 16 bytes): 3BCCD29EE8490DFB1EC4E6CD8C7451EE Nonce: 0x00000002 Buffer size: 32 bytes
19:11:22.220 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: CABF4CED
19:11:22.231 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FF171D7B9D382A2DD8D1FB174E90AE39
19:11:22.240 > 4_After_Tinkerbell (32): C4DBCFE5757127D6C6151DDAC2E4FFD7 FC07BE4ED0DA3BD521E8309DF77B87B2 
19:11:22.248 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FF171D7B9D382A2DD8D1FB174E90AE39
19:11:22.253 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FF171D7B9D382A2DD8D1FB174E90AE3900C9671DB8CE0C59E07A1A087A020173
19:11:22.265 > 5_After_Transposition (32): D64E75C6DADA3BFCD7C27B30BE211D07 C4E571F7FFE4279D87CFD5DBB215E8D0 
19:11:22.274 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:11:22.279 > [ESP32] === HMAC DEBUG INFO ===
19:11:22.282 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:11:22.290 > [ESP32] HMAC Input length: 45 bytes
19:11:22.292 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000002D64E75C6DADA3BFCD7C27B30BE211D07C4E571
19:11:22.301 > [ESP32] Nonce: 0x00000002
19:11:22.304 > [ESP32] Packet size before HMAC: 61
19:11:22.306 > [ESP32] Computed HMAC Tag: A49AF62800EFD5B3B87DE817850AB1F7
19:11:22.312 > [ESP32] === END HMAC DEBUG ===
19:11:22.315 > 6_Final_Packet (61): 82021700170004080400000002D64E75 C6DADA3BFCD7C27B30BE211D07C4E571 ...
19:11:22.323 > [RETRY] Attempt 1/3 (nonce: 2)
19:11:22.326 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:22.331 > Sending pipeline data to server (606 bytes)
19:11:22.552 > [HTTP] Response code: 400
19:11:22.552 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:22.557 > [HTTP] Request failed with code: 400
19:11:22.560 > [RETRY] Send failed, waiting 100 ms before retry
19:11:22.660 > [RETRY] Attempt 2/3 (nonce: 2)
19:11:22.660 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:22.666 > Sending pipeline data to server (606 bytes)
19:11:22.806 > [HTTP] Response code: 400
19:11:22.807 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:22.812 > [HTTP] Request failed with code: 400
19:11:22.815 > [RETRY] Send failed, waiting 200 ms before retry
19:11:23.016 > [RETRY] Attempt 3/3 (nonce: 2)
19:11:23.017 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:23.022 > Sending pipeline data to server (606 bytes)
19:11:23.315 > [HTTP] Response code: 400
19:11:23.315 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:23.321 > [HTTP] Request failed with code: 400
19:11:23.324 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:11:23.329 > [RETRY] Consecutive failures: 1
19:11:23.331 > Health data send failed (retry count: 1/3)
19:11:23.438 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Failed to send health data","state":7,"success":false,"timestamp":151738,"type":"health_data_error"}
19:11:23.452 > [WebSocket] Processing message type: health_data_error
19:11:23.458 > [152.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:23.466 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:23.471 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:11:23.488 > Generated health data: HR-62 SPO2-95 STEPS-795
19:11:23.493 > [ESP32] ========================================
19:11:23.496 > [ESP32] ENCRYPTION PIPELINE START
19:11:23.499 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:11:23.504 > [ESP32] Active Algorithms for this packet:
19:11:23.508 > [ESP32]   + LFSR
19:11:23.511 > [ESP32]   + Tinkerbell
19:11:23.514 > [ESP32]   + Transposition
19:11:23.514 > [ESP32]   - ChaCha20
19:11:23.516 > [ESP32]   - Salsa20
19:11:23.519 > [ESP32] ========================================
19:11:23.521 > [ESP32] MsgKeys: lfsrSeed=0xA8FF9E73 tnk[0..3]=CABF4CED trn[0..3]=B6559938
19:11:23.530 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3739354D50
19:11:23.535 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3739354D5000000000000000 
19:11:23.543 > [ESP32][LFSR] Initializing - Seed: 0xA8FF9E73 SeedBe: 0x739EFFA8 ChaosKey[0..3]: CABF4CED InitialTap: 0x0029 State: 0xA8FF9E73
19:11:23.555 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:11:23.563 > 3_After_LFSR (32): 3BCCD29EE8490DFB1EC4E6CD8C7451EE FCCED953681A3B8CC1922A958D7986C1 
19:11:23.568 > [ESP32][LFSR] Keystream (first 16 bytes): 739EFFA8DA695EAB51F6CBF4B95402BA
19:11:23.577 > [ESP32][4D] LFSR keystream (first 32 bytes): 739EFFA8DA695EAB51F6CBF4B95402BAB99E8A7E5F230EC191922A958D7986C1
19:11:23.586 > [ESP32][TINKERBELL] Input (first 16 bytes): 3BCCD29EE8490DFB1EC4E6CD8C7451EE Nonce: 0x00000002 Buffer size: 32 bytes
19:11:23.597 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: CABF4CED
19:11:23.604 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FF171D7B9D382A2DD8D1FB174E90AE39
19:11:23.613 > 4_After_Tinkerbell (32): C4DBCFE5757127D6C6151DDAC2E4FFD7 FC07BE4ED0D437D521E8309DF77B87B2 
19:11:23.621 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FF171D7B9D382A2DD8D1FB174E90AE39
19:11:23.630 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FF171D7B9D382A2DD8D1FB174E90AE3900C9671DB8CE0C59E07A1A087A020173
19:11:23.641 > 5_After_Transposition (32): D64E75C6D4DA37FCD7C27B30BE211D07 C4E571F7FFE4279D87CFD5DBB215E8D0 
19:11:23.649 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:11:23.652 > [ESP32] === HMAC DEBUG INFO ===
19:11:23.654 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:11:23.663 > [ESP32] HMAC Input length: 45 bytes
19:11:23.666 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000002D64E75C6D4DA37FCD7C27B30BE211D07C4E571
19:11:23.677 > [ESP32] Nonce: 0x00000002
19:11:23.677 > [ESP32] Packet size before HMAC: 61
19:11:23.683 > [ESP32] Computed HMAC Tag: BD4B80ED24D9A3DF20E4BE3440C45B3D
19:11:23.686 > [ESP32] === END HMAC DEBUG ===
19:11:23.688 > 6_Final_Packet (61): 82021700170004080400000002D64E75 C6D4DA37FCD7C27B30BE211D07C4E571 ...
19:11:23.696 > [RETRY] Attempt 1/3 (nonce: 2)
19:11:23.699 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:23.704 > Sending pipeline data to server (606 bytes)
19:11:24.052 > [HTTP] Response code: 400
19:11:24.052 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:24.057 > [HTTP] Request failed with code: 400
19:11:24.060 > [RETRY] Send failed, waiting 100 ms before retry
19:11:24.162 > [RETRY] Attempt 2/3 (nonce: 2)
19:11:24.162 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:24.166 > Sending pipeline data to server (606 bytes)
19:11:24.315 > [HTTP] Response code: 400
19:11:24.316 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:24.320 > [HTTP] Request failed with code: 400
19:11:24.323 > [RETRY] Send failed, waiting 200 ms before retry
19:11:24.523 > [RETRY] Attempt 3/3 (nonce: 2)
19:11:24.523 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:24.529 > Sending pipeline data to server (606 bytes)
19:11:24.819 > [HTTP] Response code: 400
19:11:24.819 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:24.825 > [HTTP] Request failed with code: 400
19:11:24.828 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:11:24.833 > [RETRY] Consecutive failures: 2
19:11:24.836 > Health data send failed (retry count: 2/3)
19:11:24.938 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298882804,"threatLevel":0,"type":"heuristics_update"}
19:11:24.968 > [WebSocket] Processing message type: heuristics_update
19:11:24.971 > [154.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:24.979 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:24.985 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:11:25.002 > Generated health data: HR-62 SPO2-95 STEPS-808
19:11:25.007 > [ESP32] ========================================
19:11:25.010 > [ESP32] ENCRYPTION PIPELINE START
19:11:25.012 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:11:25.018 > [ESP32] Active Algorithms for this packet:
19:11:25.024 > [ESP32]   + LFSR
19:11:25.024 > [ESP32]   + Tinkerbell
19:11:25.026 > [ESP32]   + Transposition
19:11:25.030 > [ESP32]   - ChaCha20
19:11:25.030 > [ESP32]   - Salsa20
19:11:25.032 > [ESP32] ========================================
19:11:25.035 > [ESP32] MsgKeys: lfsrSeed=0xA8FF9E73 tnk[0..3]=CABF4CED trn[0..3]=B6559938
19:11:25.043 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3830384D50
19:11:25.049 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3830384D5000000000000000 
19:11:25.058 > [ESP32][LFSR] Initializing - Seed: 0xA8FF9E73 SeedBe: 0x739EFFA8 ChaosKey[0..3]: CABF4CED InitialTap: 0x0029 State: 0xA8FF9E73
19:11:25.068 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:11:25.076 > 3_After_LFSR (32): 3BCCD29EE8490DFB1EC4E6CD8C7451EE FCCED9536713368CC1922A958D7986C1 
19:11:25.082 > [ESP32][LFSR] Keystream (first 16 bytes): 739EFFA8DA695EAB51F6CBF4B95402BA
19:11:25.090 > [ESP32][4D] LFSR keystream (first 32 bytes): 739EFFA8DA695EAB51F6CBF4B95402BAB99E8A7E5F230EC191922A958D7986C1
19:11:25.099 > [ESP32][TINKERBELL] Input (first 16 bytes): 3BCCD29EE8490DFB1EC4E6CD8C7451EE Nonce: 0x00000002 Buffer size: 32 bytes
19:11:25.110 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: CABF4CED
19:11:25.121 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FF171D7B9D382A2DD8D1FB174E90AE39
19:11:25.126 > 4_After_Tinkerbell (32): C4DBCFE5757127D6C6151DDAC2E4FFD7 FC07BE4EDFDD3AD521E8309DF77B87B2 
19:11:25.135 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FF171D7B9D382A2DD8D1FB174E90AE39
19:11:25.143 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FF171D7B9D382A2DD8D1FB174E90AE3900C9671DB8CE0C59E07A1A087A020173
19:11:25.154 > 5_After_Transposition (32): D64E75C6DDDA3AFCD7C27B30BE211D07 C4E571F7FFE4279D87CFD5DBB215E8DF 
19:11:25.163 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:11:25.166 > [ESP32] === HMAC DEBUG INFO ===
19:11:25.168 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:11:25.176 > [ESP32] HMAC Input length: 45 bytes
19:11:25.182 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000002D64E75C6DDDA3AFCD7C27B30BE211D07C4E571
19:11:25.190 > [ESP32] Nonce: 0x00000002
19:11:25.193 > [ESP32] Packet size before HMAC: 61
19:11:25.196 > [ESP32] Computed HMAC Tag: BE50F37BF714E1E16D27A7A3BE0E69DA
19:11:25.202 > [ESP32] === END HMAC DEBUG ===
19:11:25.204 > 6_Final_Packet (61): 82021700170004080400000002D64E75 C6DDDA3AFCD7C27B30BE211D07C4E571 ...
19:11:25.210 > [RETRY] Attempt 1/3 (nonce: 2)
19:11:25.213 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:25.219 > Sending pipeline data to server (606 bytes)
19:11:25.351 > [HTTP] Response code: 400
19:11:25.352 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:25.357 > [HTTP] Request failed with code: 400
19:11:25.361 > [RETRY] Send failed, waiting 100 ms before retry
19:11:25.462 > [RETRY] Attempt 2/3 (nonce: 2)
19:11:25.462 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:25.467 > Sending pipeline data to server (606 bytes)
19:11:25.585 > [HTTP] Response code: 400
19:11:25.585 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:25.590 > [HTTP] Request failed with code: 400
19:11:25.593 > [RETRY] Send failed, waiting 200 ms before retry
19:11:25.793 > [RETRY] Attempt 3/3 (nonce: 2)
19:11:25.793 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:25.798 > Sending pipeline data to server (606 bytes)
19:11:26.085 > [HTTP] Response code: 400
19:11:26.085 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:26.090 > [HTTP] Request failed with code: 400
19:11:26.092 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:11:26.098 > [RETRY] Consecutive failures: 3
19:11:26.101 > Health data send failed (retry count: 3/3)
19:11:26.103 > Health data transmission failed after max retries
19:11:26.204 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Failed to send health data","state":7,"success":false,"timestamp":151993,"type":"health_data_error"}
19:11:26.219 > [WebSocket] Processing message type: health_data_error
19:11:26.224 > [155.4] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:26.233 > ERROR state - attempting recovery
19:11:26.235 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:26.241 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:11:26.258 > Generated health data: HR-62 SPO2-95 STEPS-814
19:11:26.260 > [ESP32] ========================================
19:11:26.266 > [ESP32] ENCRYPTION PIPELINE START
19:11:26.268 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:11:26.274 > [ESP32] Active Algorithms for this packet:
19:11:26.277 > [ESP32]   + LFSR
19:11:26.280 > [ESP32]   + Tinkerbell
19:11:26.280 > [ESP32]   + Transposition
19:11:26.282 > [ESP32]   - ChaCha20
19:11:26.285 > [ESP32]   - Salsa20
19:11:26.285 > [ESP32] ========================================
19:11:26.290 > [ESP32] MsgKeys: lfsrSeed=0xA8FF9E73 tnk[0..3]=CABF4CED trn[0..3]=B6559938
19:11:26.296 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3831344D50
19:11:26.304 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3831344D5000000000000000 
19:11:26.311 > [ESP32][LFSR] Initializing - Seed: 0xA8FF9E73 SeedBe: 0x739EFFA8 ChaosKey[0..3]: CABF4CED InitialTap: 0x0029 State: 0xA8FF9E73
19:11:26.321 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:11:26.329 > 3_After_LFSR (32): 3BCCD29EE8490DFB1EC4E6CD8C7451EE FCCED95367123A8CC1922A958D7986C1 
19:11:26.338 > [ESP32][LFSR] Keystream (first 16 bytes): 739EFFA8DA695EAB51F6CBF4B95402BA
19:11:26.343 > [ESP32][4D] LFSR keystream (first 32 bytes): 739EFFA8DA695EAB51F6CBF4B95402BAB99E8A7E5F230EC191922A958D7986C1
19:11:26.355 > [ESP32][TINKERBELL] Input (first 16 bytes): 3BCCD29EE8490DFB1EC4E6CD8C7451EE Nonce: 0x00000002 Buffer size: 32 bytes
19:11:26.366 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: CABF4CED
19:11:26.374 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FF171D7B9D382A2DD8D1FB174E90AE39
19:11:26.382 > 4_After_Tinkerbell (32): C4DBCFE5757127D6C6151DDAC2E4FFD7 FC07BE4EDFDC36D521E8309DF77B87B2 
19:11:26.391 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FF171D7B9D382A2DD8D1FB174E90AE39
19:11:26.399 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FF171D7B9D382A2DD8D1FB174E90AE3900C9671DB8CE0C59E07A1A087A020173
19:11:26.408 > 5_After_Transposition (32): D64E75C6DCDA36FCD7C27B30BE211D07 C4E571F7FFE4279D87CFD5DBB215E8DF 
19:11:26.416 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:11:26.422 > [ESP32] === HMAC DEBUG INFO ===
19:11:26.424 > [ESP32] HMAC Key being used: 5390FD2C355DECCD4646B53F7FB018893668969E9F065305BD138FA7F9E4B4FE
19:11:26.433 > [ESP32] HMAC Input length: 45 bytes
19:11:26.435 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000002D64E75C6DCDA36FCD7C27B30BE211D07C4E571
19:11:26.444 > [ESP32] Nonce: 0x00000002
19:11:26.447 > [ESP32] Packet size before HMAC: 61
19:11:26.449 > [ESP32] Computed HMAC Tag: A3EA2D425C36CF7BAD7741156497BDBC
19:11:26.455 > [ESP32] === END HMAC DEBUG ===
19:11:26.458 > 6_Final_Packet (61): 82021700170004080400000002D64E75 C6DCDA36FCD7C27B30BE211D07C4E571 ...
19:11:26.466 > [RETRY] Attempt 1/3 (nonce: 2)
19:11:26.469 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:26.475 > Sending pipeline data to server (606 bytes)
19:11:26.592 > [HTTP] Response code: 400
19:11:26.593 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:26.597 > [HTTP] Request failed with code: 400
19:11:26.600 > [RETRY] Send failed, waiting 100 ms before retry
19:11:26.701 > [RETRY] Attempt 2/3 (nonce: 2)
19:11:26.702 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:26.707 > Sending pipeline data to server (606 bytes)
19:11:26.841 > [HTTP] Response code: 400
19:11:26.841 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:26.847 > [HTTP] Request failed with code: 400
19:11:26.849 > [RETRY] Send failed, waiting 200 ms before retry
19:11:27.049 > [RETRY] Attempt 3/3 (nonce: 2)
19:11:27.050 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:27.056 > Sending pipeline data to server (606 bytes)
19:11:27.356 > [HTTP] Response code: 400
19:11:27.356 > [HTTP] Error response: {"error":"Decryption failed"}
19:11:27.362 > [HTTP] Request failed with code: 400
19:11:27.364 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:11:27.371 > [RETRY] Consecutive failures: 4
19:11:27.373 > ✗ Auto-recovery failed - restarting key exchange
19:11:29.476 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Failed to send health data","state":7,"success":false,"timestamp":152501,"type":"health_data_error"}
19:11:29.488 > [WebSocket] Processing message type: health_data_error
19:11:29.496 > [158.7] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:29.503 > ✓ Public key loaded from NVS
19:11:29.602 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298883808,"threatLevel":0,"type":"heuristics_update"}
19:11:29.634 > [WebSocket] Processing message type: heuristics_update
19:11:29.636 > [158.8] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:29.745 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Failed to send health data","state":7,"success":false,"timestamp":153238,"type":"health_data_error"}
19:11:29.759 > [WebSocket] Processing message type: health_data_error
19:11:29.765 > [158.9] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:29.773 > Generating fresh master key from entropy...
19:11:29.782 > Generated master key (32): 556C98B1B57FE61946699256EFCABC6A CFFB1C5FC61C62857D46A009FF37AB69 
19:11:29.788 > Using reduced master key (byte % 3) for NTRU encryption only
19:11:29.796 > NTRU encrypted master key (502): 0043000000320018006C00040005000A 00100053007F004F0058002200290028 ...
19:11:29.806 > POST http://10.249.92.115:8081/master-key
19:11:30.104 > ✓ Master key exchange completed
19:11:30.206 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Failed to send health data","state":7,"success":false,"timestamp":153502,"type":"health_data_error"}
19:11:30.219 > [WebSocket] Processing message type: health_data_error
19:11:30.225 > [159.4] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:30.234 > Loading master key from NVS and deriving symmetric keys...
19:11:30.239 > Loaded master key from NVS (32): 556C98B1B57FE61946699256EFCABC6A CFFB1C5FC61C62857D46A009FF37AB69 
19:11:30.247 > Derived HMAC key (32): 221377786C6254B4A5AF0FAC6F5E8C4E F9C231B68FD2AA658BDBA2B238616FF3 
19:11:30.256 > Derived Tinkerbell key (16): 24739D44374EBDC6679310308985835B 
19:11:30.261 > Derived Transposition key (16): 7404ACD7BE19023D92A1F16AF733E78A 
19:11:30.266 > ✓ Symmetric keys derived successfully
19:11:30.269 > Nonce tracker reset - new session started
19:11:30.765 > Waiting for server to process master key...
19:11:30.769 > ✓ Symmetric keys ready - starting health data transmission
19:11:30.870 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298884820,"threatLevel":0,"type":"heuristics_update"}
19:11:30.902 > [WebSocket] Processing message type: heuristics_update
19:11:30.903 > [160.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:31.014 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Failed to send health data","state":7,"success":false,"timestamp":154006,"type":"health_data_error"}
19:11:31.027 > [WebSocket] Processing message type: health_data_error
19:11:31.033 > [160.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:31.135 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Failed to send health data","state":7,"success":false,"timestamp":154538,"type":"health_data_error"}
19:11:31.149 > [WebSocket] Processing message type: health_data_error
19:11:31.154 > [160.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:31.258 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Failed to send health data","state":7,"success":false,"timestamp":154772,"type":"health_data_error"}
19:11:31.272 > [WebSocket] Processing message type: health_data_error
19:11:31.277 > [160.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:31.380 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298885824,"threatLevel":0,"type":"heuristics_update"}
19:11:31.411 > [WebSocket] Processing message type: heuristics_update
19:11:31.414 > [160.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:31.523 > [160.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:31.624 > [160.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:31.724 > [160.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:31.826 > [161.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:31.927 > [161.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:32.028 > [161.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:32.129 > [161.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:32.230 > [161.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:32.331 > [161.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:32.432 > [161.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:32.533 > [161.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:32.634 > [161.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:32.738 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Failed to send health data","state":7,"success":false,"timestamp":155271,"type":"health_data_error"}
19:11:32.752 > [WebSocket] Processing message type: health_data_error
19:11:32.758 > [161.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:32.860 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Failed to send health data","state":8,"success":false,"timestamp":155778,"type":"health_data_error"}
19:11:32.874 > [WebSocket] Processing message type: health_data_error
19:11:32.880 > [162.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:32.982 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298886838,"threatLevel":0,"type":"heuristics_update"}
19:11:33.013 > [WebSocket] Processing message type: heuristics_update
19:11:33.016 > [162.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:33.125 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Failed to send health data","state":8,"success":false,"timestamp":156028,"type":"health_data_error"}
19:11:33.139 > [WebSocket] Processing message type: health_data_error
19:11:33.145 > [162.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:33.248 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Failed to send health data","state":8,"success":false,"timestamp":156543,"type":"health_data_error"}
19:11:33.261 > [WebSocket] Processing message type: health_data_error
19:11:33.266 > [162.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:33.369 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298887843,"threatLevel":0,"type":"heuristics_update"}
19:11:33.399 > [WebSocket] Processing message type: heuristics_update
19:11:33.402 > [162.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:33.512 > [WebSocket] Received (252 bytes): {"payload":{"epoch":2,"proposalId":"7fdcd823-f276-4725-84b3-000000d4f81a495c44ac","proposedAt":"2026-02-05T13:41:27Z","targetRecipe":"CHACHA_HEAVY"},"signature":"53168e3cf0ff885678bca3b5ec80e4608606ff73fbb4aba5afa3748c319388a7","type":"switch_propose"}
19:11:33.535 > [WebSocket] Processing message type: switch_propose
19:11:33.541 > [WS_RX] switch_propose (new format) proposalId=7fdcd823-f276-4725-84b3-000000d4f81a495c44ac targetRecipe=CHACHA_HEAVY epoch=2
19:11:33.552 > [ZTM] Master key is zero - reloading from NVS
19:11:33.557 > [ZTM] Successfully reloaded master key from NVS
19:11:33.560 > [ZTM] Master key (first 16 bytes): 556C98B1B57FE61946699256EFCABC6A
19:11:33.566 > [ZTM] HMAC verify: canonical={"epoch":2,"proposalId":"7fdcd823-f276-4725-84b3-000000d4f81a495c44ac","proposedAt":"2026-02-05T13:41:27Z","targetRecipe":"CHACHA_HEAVY"}
19:11:33.579 > [ZTM] HMAC verify: computed=d4661f1ee352b3ce48fe5a2c52c41c5c7bd028e9faf283dfc64067ea68e22352 expected=53168e3cf0ff885678bca3b5ec80e4608606ff73fbb4aba5afa3748c319388a7
19:11:33.595 > [PROPOSE_REJECT] HMAC verification failed
19:11:33.598 > [NACK_SENT] proposalId=7fdcd823-f276-4725-84b3-000000d4f81a495c44ac reason=invalid_signature currentEpoch=3
19:11:33.607 > [162.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:33.709 > [WebSocket] Received (213 bytes): {"pending":true,"proposalId":"7fdcd823-f276-4725-84b3-000000d4f81a495c44ac","reason":"Manual switch request","recipe":"CHACHA_HEAVY","serverTime":1770298887986,"success":true,"type":"adaptive_switch_acknowledged"}
19:11:33.727 > [WebSocket] Processing message type: adaptive_switch_acknowledged
19:11:33.733 > [WebSocket] ========================================
19:11:33.739 > [WebSocket] Received message type: adaptive_switch_acknowledged
19:11:33.745 > [WebSocket] Mode from message: 'ztm'
19:11:33.747 > [WebSocket] Recipe from message: 'CHACHA_HEAVY'
19:11:33.753 > [WebSocket] Current gZTMEnabled: TRUE
19:11:33.756 > [WebSocket] Current gCurrentMode: ZTM
19:11:33.758 > [WebSocket] Current gCurrentRecipe: CHAOS_ONLY
19:11:33.763 > [WebSocket] ========================================
19:11:33.767 > [WebSocket] Parsed newMode: ZTM, newRecipe: CHACHA_HEAVY
19:11:33.772 > [WebSocket] Waiting for switch_propose from server for recipe CHACHA_HEAVY
19:11:33.778 > [163.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:33.887 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298888858,"threatLevel":0,"type":"heuristics_update"}
19:11:33.918 > [WebSocket] Processing message type: heuristics_update
19:11:33.920 > [163.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:34.031 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298889868,"threatLevel":0,"type":"heuristics_update"}
19:11:34.061 > [WebSocket] Processing message type: heuristics_update
19:11:34.064 > [163.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:34.174 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770298889891,"type":"master_key_received"}
19:11:34.188 > [WebSocket] Processing message type: master_key_received
19:11:34.190 > [163.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:34.296 > [WebSocket] Received (176 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":159283,"type":"master_key_exchanged"}
19:11:34.312 > [WebSocket] Processing message type: master_key_exchanged
19:11:34.318 > [163.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:34.418 > [WebSocket] Received (168 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":159951,"type":"symmetric_keys_derived"}
19:11:34.435 > [WebSocket] Processing message type: symmetric_keys_derived
19:11:34.440 > [163.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:34.541 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298890879,"threatLevel":0,"type":"heuristics_update"}
19:11:34.570 > [WebSocket] Processing message type: heuristics_update
19:11:34.574 > [163.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:34.683 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298891890,"threatLevel":0,"type":"heuristics_update"}
19:11:34.713 > [WebSocket] Processing message type: heuristics_update
19:11:34.717 > [163.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:34.826 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298892903,"threatLevel":0,"type":"heuristics_update"}
19:11:34.857 > [WebSocket] Processing message type: heuristics_update
19:11:34.859 > [164.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:34.969 > [WebSocket] Received (118 bytes): {"proposalId":"7fdcd823-f276-4725-84b3-000000d4f81a495c44ac","serverTime":1770298893609,"type":"switch_nack_received"}
19:11:34.981 > [WebSocket] Processing message type: switch_nack_received
19:11:34.986 > [164.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:35.091 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Mode: ztm, Recipe: CHACHA_HEAVY","state":7,"success":true,"timestamp":162957,"type":"mode_changed_pending"}
19:11:35.108 > [WebSocket] Processing message type: mode_changed_pending
19:11:35.111 > [164.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:35.213 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298893907,"threatLevel":0,"type":"heuristics_update"}
19:11:35.245 > [WebSocket] Processing message type: heuristics_update
19:11:35.247 > [164.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:35.356 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298894917,"threatLevel":0,"type":"heuristics_update"}
19:11:35.387 > [WebSocket] Processing message type: heuristics_update
19:11:35.390 > [164.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:35.499 > [164.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:35.600 > [164.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:35.701 > [164.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:35.802 > [165.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:35.902 > [165.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:36.004 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298895932,"threatLevel":0,"type":"heuristics_update"}
19:11:36.036 > [WebSocket] Processing message type: heuristics_update
19:11:36.038 > [165.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:36.147 > [165.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:36.247 > [165.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:36.349 > [165.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:36.450 > [165.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:36.551 > [165.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:36.652 > [165.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:36.753 > [165.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:36.853 > [166.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:36.956 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298896945,"threatLevel":0,"type":"heuristics_update"}
19:11:36.986 > [WebSocket] Processing message type: heuristics_update
19:11:36.988 > [166.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:37.098 > [166.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:37.198 > [166.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:37.300 > [166.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:37.401 > [166.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:37.502 > [166.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:37.603 > [166.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:37.703 > [166.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:37.804 > [167.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:37.906 > [167.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:38.009 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298897958,"threatLevel":0,"type":"heuristics_update"}
19:11:38.040 > [WebSocket] Processing message type: heuristics_update
19:11:38.042 > [167.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:38.152 > [167.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:38.253 > [167.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:38.354 > [167.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:38.455 > [167.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:38.556 > [167.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:38.657 > [167.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:38.758 > [167.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:38.859 > [168.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:38.959 > [168.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:39.062 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298898966,"threatLevel":0,"type":"heuristics_update"}
19:11:39.092 > [WebSocket] Processing message type: heuristics_update
19:11:39.095 > [168.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:39.204 > [168.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:39.305 > [168.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:39.406 > [168.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:39.507 > [168.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:39.608 > [168.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:39.709 > [168.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:39.809 > [169.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:39.910 > [169.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:40.012 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298899977,"threatLevel":0,"type":"heuristics_update"}
19:11:40.043 > [WebSocket] Processing message type: heuristics_update
19:11:40.046 > [169.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:40.155 > [169.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:40.256 > [169.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:40.357 > [169.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:40.458 > [169.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:40.558 > [169.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:40.660 > [169.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:40.761 > [169.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:40.861 > [170.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:11:40.867 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:40.872 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:11:40.889 > Generated health data: HR-64 SPO2-95 STEPS-874
19:11:40.895 > [ESP32] ========================================
19:11:40.898 > [ESP32] ENCRYPTION PIPELINE START
19:11:40.901 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:11:40.906 > [ESP32] Active Algorithms for this packet:
19:11:40.912 > [ESP32]   + LFSR
19:11:40.912 > [ESP32]   + Tinkerbell
19:11:40.914 > [ESP32]   + Transposition
19:11:40.918 > [ESP32]   - ChaCha20
19:11:40.918 > [ESP32]   - Salsa20
19:11:40.920 > [ESP32] ========================================
19:11:40.926 > [ESP32] MsgKeys: lfsrSeed=0x1916A810 tnk[0..3]=498601C6 trn[0..3]=94D94D97
19:11:40.931 > 1_After_Salt (25): 48522D36342053504F322D3935205354 4550532D3837344D50
19:11:40.937 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D3837344D5000000000000000 
19:11:40.945 > [ESP32][LFSR] Initializing - Seed: 0x1916A810 SeedBe: 0x10A81619 ChaosKey[0..3]: 498601C6 InitialTap: 0x0029 State: 0x1916A810
19:11:40.956 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
19:11:40.964 > 3_After_LFSR (32): 58FA3B2FAF12B1CBB5E357E2D0D64152 4C824BF4048F93DCDB8173AAB63067B5 
19:11:40.973 > [ESP32][LFSR] Keystream (first 16 bytes): 10A816199B32E29BFAD17ADBE5F61206
19:11:40.978 > [ESP32][4D] LFSR keystream (first 32 bytes): 10A816199B32E29BFAD17ADBE5F6120609D218D93CB8A7918B8173AAB63067B5
19:11:40.987 > [ESP32][TINKERBELL] Input (first 16 bytes): 58FA3B2FAF12B1CBB5E357E2D0D64152 Nonce: 0x00000001 Buffer size: 32 bytes
19:11:40.998 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 498601C6
19:11:41.009 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): C2A42268104078781B62C3CBE7A4157A
19:11:41.017 > 4_After_Tinkerbell (32): 9A5E1947BF52C9B3AE81942937725428 63A254B85783BFB47EB69F528E516CE5 
19:11:41.025 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): C2A42268104078781B62C3CBE7A4157A
19:11:41.031 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): C2A42268104078781B62C3CBE7A4157A2F201F4C530C2C68A537ECF838610B50
19:11:41.042 > 5_After_Transposition (32): AE47BFBF83C97E9A52A22928E58E5E37 51B41954579FB39452B6B86C54726381 
19:11:41.050 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:11:41.057 > [ESP32] === HMAC DEBUG INFO ===
19:11:41.059 > [ESP32] HMAC Key being used: 221377786C6254B4A5AF0FAC6F5E8C4EF9C231B68FD2AA658BDBA2B238616FF3
19:11:41.068 > [ESP32] HMAC Input length: 45 bytes
19:11:41.070 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000001AE47BFBF83C97E9A52A22928E58E5E3751B419
19:11:41.078 > [ESP32] Nonce: 0x00000001
19:11:41.081 > [ESP32] Packet size before HMAC: 61
19:11:41.084 > [ESP32] Computed HMAC Tag: 2A316C3027BFDD84A6B44A5DD4826DDF
19:11:41.089 > [ESP32] === END HMAC DEBUG ===
19:11:41.092 > 6_Final_Packet (61): 82021700170004080400000001AE47BF BF83C97E9A52A22928E58E5E3751B419 ...
19:11:41.101 > [RETRY] Attempt 1/3 (nonce: 1)
19:11:41.104 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:41.109 > Sending pipeline data to server (606 bytes)
19:11:41.378 > [HTTP] Response code: 200
19:11:41.378 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:11:41.389 > [RETRY] Health data sent successfully!
19:11:41.392 > ✓ Health data #14 sent successfully
19:11:41.494 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298900990,"threatLevel":0,"type":"heuristics_update"}
19:11:41.524 > [WebSocket] Processing message type: heuristics_update
19:11:41.528 > [170.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:41.637 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:82021700170004080400000001AE47BFBF83C97E9A52A22928E58E5E3751B41954579FB39452B6B86C547263812A316C3027BFDD84A6B44A5DD4826DDF","pipeline":{"afterLFSR":"58FA3B2FAF12B1CBB5E357E2D0D641524C824BF4048F93DCDB8173AAB63067B5","afterSalt":"48522D36342053504F322D39352053544550532D3837344D50","afterTinkerbell":"9A5E1947BF52C9B3AE8194293772542863A254B85783BFB47EB69F528E516CE5","afterTransposition":"AE47BFBF83C97E9A52A22928E58E5E3751B41954579FB39452B6B86C54726381"},"plaintext":"HR-64 SPO2-95 STEPS-874","serverTime":1770298901184,"timestamp":170285,"type":"encryption_update","ztmEnabled":true}
19:11:41.693 > [WebSocket] Processing message type: encryption_update
19:11:41.698 > [170.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:41.800 > [WebSocket] Received (87 bytes): {"heartRate":64,"spo2":95,"steps":874,"time":1770298901184,"type":"health_data_update"}
19:11:41.809 > [WebSocket] Processing message type: health_data_update
19:11:41.814 > [171.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:41.922 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3333,"encryptionTime":0.0,"finalPlaintext":"HR-64 SPO2-95 STEPS-874","handshakeSuccess":true,"totalTime":0.3333},"type":"session_summary_update"}
19:11:41.944 > [WebSocket] Processing message type: session_summary_update
19:11:41.949 > [171.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:42.055 > [WebSocket] Received (658 bytes): {"decryptionTime":0.3333,"encryptedPacket":"82021700170004080400000001AE47BFBF83C97E9A52A22928E58E5E3751B41954579FB39452B6B86C547263812A316C3027BFDD84A6B44A5DD4826DDF","finalPlaintext":"HR-64 SPO2-95 STEPS-874","healthData":{"heartRate":64,"spo2":95,"steps":874},"pipeline":{"afterDepad":"48522D36342053504F322D39352053544550532D38373400000000000000","afterLFSR":"48522D36342053504F322D39352053544550532D3837344D5000000000000000","afterTinkerbell":"58FA3B2FAF12B1CBB5E357E2D0D641524C824BF4048F93DCDB8173AAB63067B5","afterTransposition":"9A5E1947BF52C9B3AE8194293772542863A254B85783BFB47EB69F528E516CE5"},"serverTime":1770298901185,"type":"decryption_update"}
19:11:42.113 > [WebSocket] Processing message type: decryption_update
19:11:42.118 > [WebSocket] Server decryption completed
19:11:42.121 > [WebSocket] Health data - HR: 64, SPO2: 95, Steps: 874
19:11:42.127 > [171.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:42.229 > [WebSocket] Received (646 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":13,"pipeline":{"afterLFSR":"58FA3B2FAF12B1CBB5E357E2D0D641524C824BF4048F93DCDB8173AAB63067B5","afterSalt":"48522D36342053504F322D39352053544550532D3837344D50","afterTinkerbell":"9A5E1947BF52C9B3AE8194293772542863A254B85783BFB47EB69F528E516CE5","afterTransposition":"AE47BFBF83C97E9A52A22928E58E5E3751B41954579FB39452B6B86C54726381","finalPacket":"82021700170004080400000001AE47BFBF83C97E9A52A22928E58E5E3751B41954579FB39452B6B86C547263812A316C3027BFDD84A6B44A5DD4826DDF"},"plaintext":"HR-64 SPO2-95 STEPS-874","timestamp":170564,"type":"encryption_pipeline","ztmEnabled":true}
19:11:42.287 > [WebSocket] Processing message type: encryption_pipeline
19:11:42.292 > [171.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:42.391 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Health data #14 sent successfully","state":7,"success":true,"timestamp":170569,"type":"health_data_sent"}
19:11:42.408 > [WebSocket] Processing message type: health_data_sent
19:11:42.411 > [171.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:42.514 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298901999,"threatLevel":0,"type":"heuristics_update"}
19:11:42.544 > [WebSocket] Processing message type: heuristics_update
19:11:42.546 > [171.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:42.656 > [171.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:42.757 > [171.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:42.858 > [172.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:42.959 > [172.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:43.061 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298903014,"threatLevel":0,"type":"heuristics_update"}
19:11:43.091 > [WebSocket] Processing message type: heuristics_update
19:11:43.094 > [172.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:43.202 > [172.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:43.304 > [172.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:43.405 > [172.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:43.506 > [172.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:43.607 > [172.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:43.708 > [172.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:43.809 > [173.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:43.909 > [173.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:44.010 > [173.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:44.112 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298904024,"threatLevel":0,"type":"heuristics_update"}
19:11:44.143 > [WebSocket] Processing message type: heuristics_update
19:11:44.146 > [173.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:44.255 > [173.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:44.356 > [173.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:44.457 > [173.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:44.558 > [173.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:44.658 > [173.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:44.760 > [173.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:44.861 > [174.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:44.962 > [174.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:45.063 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298905033,"threatLevel":0,"type":"heuristics_update"}
19:11:45.094 > [WebSocket] Processing message type: heuristics_update
19:11:45.097 > [174.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:45.206 > [174.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:45.306 > [174.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:45.408 > [174.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:45.509 > [174.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:45.609 > [174.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:45.710 > [174.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:45.811 > [175.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:45.913 > [175.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:46.013 > [175.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:46.118 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298906046,"threatLevel":0,"type":"heuristics_update"}
19:11:46.148 > [WebSocket] Processing message type: heuristics_update
19:11:46.151 > [175.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:46.260 > [175.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:46.360 > [175.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:46.461 > [175.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:46.562 > [175.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:46.664 > [175.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:46.764 > [175.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:46.866 > [176.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:46.967 > [176.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:47.068 > [176.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:47.169 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298907058,"threatLevel":0,"type":"heuristics_update"}
19:11:47.200 > [WebSocket] Processing message type: heuristics_update
19:11:47.202 > [176.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:47.312 > [176.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:47.412 > [176.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:47.514 > [176.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:47.615 > [176.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:47.715 > [176.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:47.816 > [177.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:47.917 > [177.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:48.019 > [177.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:48.120 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298908070,"threatLevel":0,"type":"heuristics_update"}
19:11:48.151 > [WebSocket] Processing message type: heuristics_update
19:11:48.154 > [177.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:48.263 > [177.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:48.364 > [177.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:48.464 > [177.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:48.566 > [177.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:48.667 > [177.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:48.767 > [178.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:48.869 > [178.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:48.969 > [178.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:49.069 > [178.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:49.172 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298909076,"threatLevel":0,"type":"heuristics_update"}
19:11:49.202 > [WebSocket] Processing message type: heuristics_update
19:11:49.206 > [178.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:49.314 > [178.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:49.415 > [178.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:49.516 > [178.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:49.618 > [178.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:49.719 > [178.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:49.819 > [179.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:49.920 > [179.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:50.021 > [179.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:50.123 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298910086,"threatLevel":0,"type":"heuristics_update"}
19:11:50.154 > [WebSocket] Processing message type: heuristics_update
19:11:50.156 > [179.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:50.265 > [179.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:50.366 > [179.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:50.468 > [179.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:50.568 > [179.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:50.669 > [179.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:50.771 > [180.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:50.872 > [180.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:50.973 > [180.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:51.073 > [180.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:51.178 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298911095,"threatLevel":0,"type":"heuristics_update"}
19:11:51.208 > [WebSocket] Processing message type: heuristics_update
19:11:51.211 > [180.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:51.320 > [180.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:51.421 > [180.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:11:51.427 > [RETRY] Attempting to send health data (Max retries: 3)
19:11:51.432 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:11:51.449 > Generated health data: HR-63 SPO2-95 STEPS-938
19:11:51.454 > [ESP32] ========================================
19:11:51.458 > [ESP32] ENCRYPTION PIPELINE START
19:11:51.460 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:11:51.466 > [ESP32] Active Algorithms for this packet:
19:11:51.471 > [ESP32]   + LFSR
19:11:51.471 > [ESP32]   + Tinkerbell
19:11:51.474 > [ESP32]   + Transposition
19:11:51.477 > [ESP32]   - ChaCha20
19:11:51.477 > [ESP32]   - Salsa20
19:11:51.480 > [ESP32] ========================================
19:11:51.485 > [ESP32] MsgKeys: lfsrSeed=0x2A8BB237 tnk[0..3]=D8504085 trn[0..3]=5435899F
19:11:51.491 > 1_After_Salt (25): 48522D36332053504F322D3935205354 4550532D3933384D50
19:11:51.497 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D3933384D5000000000000000 
19:11:51.505 > [ESP32][LFSR] Initializing - Seed: 0x2A8BB237 SeedBe: 0x37B28B2A ChaosKey[0..3]: D8504085 InitialTap: 0x0029 State: 0x2A8BB237
19:11:51.516 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:11:51.524 > 3_After_LFSR (32): 7FE0A61CA598CB81E5AC712D54C3A789 33E626709B8345C97F4D424732320B39 
19:11:51.533 > [ESP32][LFSR] Keystream (first 16 bytes): 37B28B2A96B898D1AA9E5C1461E3F4DD
19:11:51.538 > [ESP32][4D] LFSR keystream (first 32 bytes): 37B28B2A96B898D1AA9E5C1461E3F4DD76B6755DA2B07D842F4D424732320B39
19:11:51.546 > [ESP32][TINKERBELL] Input (first 16 bytes): 7FE0A61CA598CB81E5AC712D54C3A789 Nonce: 0x00000002 Buffer size: 32 bytes
19:11:51.557 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: D8504085
19:11:51.569 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 8B5D1B260E0561267A9FA7B76F3FBCE3
19:11:51.577 > 4_After_Tinkerbell (32): F4BDBD3AAB9DAAA79F33D69A3BFC1B6A 540A7C593E18F396A478EC3EC5C58C74 
19:11:51.585 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 8B5D1B260E0561267A9FA7B76F3FBCE3
19:11:51.591 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 8B5D1B260E0561267A9FA7B76F3FBCE367EC5A29A59BB65FDB35AE79F7F7874D
19:11:51.601 > 5_After_Transposition (32): 0AF33A96F4ECA7AA74A4BDD6C5BD3E3E 7C5918C56A9F1B9A788CFCAB9D33543B 
19:11:51.610 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:11:51.616 > [ESP32] === HMAC DEBUG INFO ===
19:11:51.619 > [ESP32] HMAC Key being used: 221377786C6254B4A5AF0FAC6F5E8C4EF9C231B68FD2AA658BDBA2B238616FF3
19:11:51.627 > [ESP32] HMAC Input length: 45 bytes
19:11:51.629 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000020AF33A96F4ECA7AA74A4BDD6C5BD3E3E7C5918
19:11:51.638 > [ESP32] Nonce: 0x00000002
19:11:51.641 > [ESP32] Packet size before HMAC: 61
19:11:51.644 > [ESP32] Computed HMAC Tag: 523308F2B31D390B6D7D4BBBB1B840A5
19:11:51.649 > [ESP32] === END HMAC DEBUG ===
19:11:51.652 > 6_Final_Packet (61): 820217001700040804000000020AF33A 96F4ECA7AA74A4BDD6C5BD3E3E7C5918 ...
19:11:51.660 > [RETRY] Attempt 1/3 (nonce: 2)
19:11:51.662 > POST http://10.249.92.115:8081/health-data with pipeline data
19:11:51.668 > Sending pipeline data to server (606 bytes)
19:11:51.927 > [HTTP] Response code: 200
19:11:51.927 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:11:51.940 > [RETRY] Health data sent successfully!
19:11:51.943 > ✓ Health data #15 sent successfully
19:11:52.041 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":2,"serverTime":1770298911759,"type":"security_update"}
19:11:52.058 > [WebSocket] Processing message type: security_update
19:11:52.063 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:11:52.069 > [181.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:52.175 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820217001700040804000000020AF33A96F4ECA7AA74A4BDD6C5BD3E3E7C5918C56A9F1B9A788CFCAB9D33543B523308F2B31D390B6D7D4BBBB1B840A5","pipeline":{"afterLFSR":"7FE0A61CA598CB81E5AC712D54C3A78933E626709B8345C97F4D424732320B39","afterSalt":"48522D36332053504F322D39352053544550532D3933384D50","afterTinkerbell":"F4BDBD3AAB9DAAA79F33D69A3BFC1B6A540A7C593E18F396A478EC3EC5C58C74","afterTransposition":"0AF33A96F4ECA7AA74A4BDD6C5BD3E3E7C5918C56A9F1B9A788CFCAB9D33543B"},"plaintext":"HR-63 SPO2-95 STEPS-938","serverTime":1770298911760,"timestamp":180845,"type":"encryption_update","ztmEnabled":true}
19:11:52.230 > [WebSocket] Processing message type: encryption_update
19:11:52.236 > [181.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:52.338 > [WebSocket] Received (87 bytes): {"heartRate":63,"spo2":95,"steps":938,"time":1770298911760,"type":"health_data_update"}
19:11:52.346 > [WebSocket] Processing message type: health_data_update
19:11:52.351 > [181.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:52.460 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2783,"encryptionTime":0.0,"finalPlaintext":"HR-63 SPO2-95 STEPS-938","handshakeSuccess":true,"totalTime":0.2783},"type":"session_summary_update"}
19:11:52.482 > [WebSocket] Processing message type: session_summary_update
19:11:52.487 > [181.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:52.592 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2783,"encryptedPacket":"820217001700040804000000020AF33A96F4ECA7AA74A4BDD6C5BD3E3E7C5918C56A9F1B9A788CFCAB9D33543B523308F2B31D390B6D7D4BBBB1B840A5","finalPlaintext":"HR-63 SPO2-95 STEPS-938","healthData":{"heartRate":63,"spo2":95,"steps":938},"pipeline":{"afterDepad":"48522D36332053504F322D39352053544550532D39333800000000000000","afterLFSR":"48522D36332053504F322D39352053544550532D3933384D5000000000000000","afterTinkerbell":"7FE0A61CA598CB81E5AC712D54C3A78933E626709B8345C97F4D424732320B39","afterTransposition":"F4BDBD3AAB9DAAA79F33D69A3BFC1B6A540A7C593E18F396A478EC3EC5C58C74"},"serverTime":1770298911761,"type":"decryption_update"}
19:11:52.651 > [WebSocket] Processing message type: decryption_update
19:11:52.657 > [WebSocket] Server decryption completed
19:11:52.659 > [WebSocket] Health data - HR: 63, SPO2: 95, Steps: 938
19:11:52.664 > [181.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:52.766 > [WebSocket] Received (646 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":14,"pipeline":{"afterLFSR":"7FE0A61CA598CB81E5AC712D54C3A78933E626709B8345C97F4D424732320B39","afterSalt":"48522D36332053504F322D39352053544550532D3933384D50","afterTinkerbell":"F4BDBD3AAB9DAAA79F33D69A3BFC1B6A540A7C593E18F396A478EC3EC5C58C74","afterTransposition":"0AF33A96F4ECA7AA74A4BDD6C5BD3E3E7C5918C56A9F1B9A788CFCAB9D33543B","finalPacket":"820217001700040804000000020AF33A96F4ECA7AA74A4BDD6C5BD3E3E7C5918C56A9F1B9A788CFCAB9D33543B523308F2B31D390B6D7D4BBBB1B840A5"},"plaintext":"HR-63 SPO2-95 STEPS-938","timestamp":181114,"type":"encryption_pipeline","ztmEnabled":true}
19:11:52.824 > [WebSocket] Processing message type: encryption_pipeline
19:11:52.830 > [182.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:52.928 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":14,"message":"Health data #15 sent successfully","state":7,"success":true,"timestamp":181119,"type":"health_data_sent"}
19:11:52.945 > [WebSocket] Processing message type: health_data_sent
19:11:52.947 > [182.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:53.053 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298912098,"threatLevel":0,"type":"heuristics_update"}
19:11:53.085 > [WebSocket] Processing message type: heuristics_update
19:11:53.087 > [182.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:53.196 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298913110,"threatLevel":0,"type":"heuristics_update"}
19:11:53.228 > [WebSocket] Processing message type: heuristics_update
19:11:53.231 > [182.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:53.339 > [182.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:53.440 > [182.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:53.541 > [182.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:53.642 > [182.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:53.743 > [182.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:53.845 > [183.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:53.945 > [183.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:54.046 > [183.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:54.148 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298914122,"threatLevel":0,"type":"heuristics_update"}
19:11:54.178 > [WebSocket] Processing message type: heuristics_update
19:11:54.182 > [183.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:54.290 > [183.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:54.391 > [183.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:54.492 > [183.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:54.593 > [183.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:54.693 > [183.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:54.795 > [184.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:54.896 > [184.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:54.997 > [184.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:55.098 > [184.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:55.200 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298915128,"threatLevel":0,"type":"heuristics_update"}
19:11:55.230 > [WebSocket] Processing message type: heuristics_update
19:11:55.233 > [184.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:55.342 > [184.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:55.443 > [184.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:55.544 > [184.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:55.645 > [184.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:55.746 > [184.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:55.847 > [185.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:55.948 > [185.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:56.049 > [185.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:56.150 > [185.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:56.251 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298916144,"threatLevel":0,"type":"heuristics_update"}
19:11:56.283 > [WebSocket] Processing message type: heuristics_update
19:11:56.286 > [185.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:56.395 > [185.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:56.495 > [185.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:56.596 > [185.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:56.697 > [185.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:56.798 > [186.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:56.899 > [186.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:57.000 > [186.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:57.101 > [186.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:57.207 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298917154,"threatLevel":0,"type":"heuristics_update"}
19:11:57.237 > [WebSocket] Processing message type: heuristics_update
19:11:57.240 > [186.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:57.349 > [186.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:57.451 > [186.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:57.551 > [186.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:57.652 > [186.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:57.754 > [186.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:57.854 > [187.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:57.956 > [187.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:58.056 > [187.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:58.156 > [187.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:58.259 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298918162,"threatLevel":0,"type":"heuristics_update"}
19:11:58.289 > [WebSocket] Processing message type: heuristics_update
19:11:58.292 > [187.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:58.402 > [187.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:58.502 > [187.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:58.603 > [187.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:58.704 > [187.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:58.805 > [188.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:58.906 > [188.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:59.007 > [188.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:59.108 > [188.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:59.210 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298919174,"threatLevel":0,"type":"heuristics_update"}
19:11:59.241 > [WebSocket] Processing message type: heuristics_update
19:11:59.243 > [188.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:59.352 > [188.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:59.453 > [188.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:59.554 > [188.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:59.656 > [188.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:59.756 > [188.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:59.857 > [189.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:11:59.958 > [189.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:00.059 > [189.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:00.160 > [189.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:00.262 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298920185,"threatLevel":0,"type":"heuristics_update"}
19:12:00.292 > [WebSocket] Processing message type: heuristics_update
19:12:00.295 > [189.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:00.404 > [189.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:00.504 > [189.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:00.606 > [189.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:00.706 > [189.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:00.808 > [190.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:00.909 > [190.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:01.010 > [190.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:01.111 > [190.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:01.212 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298921187,"threatLevel":0,"type":"heuristics_update"}
19:12:01.243 > [WebSocket] Processing message type: heuristics_update
19:12:01.246 > [190.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:01.355 > [190.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:01.456 > [190.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:01.557 > [190.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:01.658 > [190.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:01.759 > [190.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:01.860 > [191.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:01.961 > [191.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:12:01.967 > [RETRY] Attempting to send health data (Max retries: 3)
19:12:01.972 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:12:01.989 > Generated health data: HR-63 SPO2-95 STEPS-973
19:12:01.994 > [ESP32] ========================================
19:12:01.997 > [ESP32] ENCRYPTION PIPELINE START
19:12:02.000 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:12:02.006 > [ESP32] Active Algorithms for this packet:
19:12:02.011 > [ESP32]   + LFSR
19:12:02.011 > [ESP32]   + Tinkerbell
19:12:02.013 > [ESP32]   + Transposition
19:12:02.017 > [ESP32]   - ChaCha20
19:12:02.017 > [ESP32]   - Salsa20
19:12:02.019 > [ESP32] ========================================
19:12:02.024 > [ESP32] MsgKeys: lfsrSeed=0xE4DD1783 tnk[0..3]=EBB70F05 trn[0..3]=DDF1687E
19:12:02.031 > 1_After_Salt (25): 48522D36332053504F322D3935205354 4550532D3937334D50
19:12:02.036 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D3937334D5000000000000000 
19:12:02.044 > [ESP32][LFSR] Initializing - Seed: 0xE4DD1783 SeedBe: 0x8317DDE4 ChaosKey[0..3]: EBB70F05 InitialTap: 0x0029 State: 0xE4DD1783
19:12:02.056 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:12:02.065 > 3_After_LFSR (32): CB45F0D256FBD1A69A76533C6A6CCC74 B10AD68BD2F280066EF2999BD7CEF51B 
19:12:02.072 > [ESP32][LFSR] Keystream (first 16 bytes): 8317DDE465DB82F6D5447E055F4C9F20
19:12:02.078 > [ESP32][4D] LFSR keystream (first 32 bytes): 8317DDE465DB82F6D5447E055F4C9F20F45A85A6EBC5B34B3EF2999BD7CEF51B
19:12:02.086 > [ESP32][TINKERBELL] Input (first 16 bytes): CB45F0D256FBD1A69A76533C6A6CCC74 Nonce: 0x00000003 Buffer size: 32 bytes
19:12:02.097 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: EBB70F05
19:12:02.107 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9442DD353983DF9A40A7E9F1D42FAD72
19:12:02.117 > 4_After_Tinkerbell (32): 5F072DE76F780E3CDAD1BACDBE436106 78F1B9313CCCD57E90E07F3D4C9CB318 
19:12:02.125 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9442DD353983DF9A40A7E9F1D42FAD72
19:12:02.131 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 9442DD353983DF9A40A7E9F1D42FAD72C9FB6FBAEE3E5578FE12E6A69B524603
19:12:02.141 > 5_After_Transposition (32): 61D5B378433CDA6F7F4C063DF13C2D0E 5F90CDBEE07E07B9D178E731CCBA9C18 
19:12:02.150 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000003
19:12:02.156 > [ESP32] === HMAC DEBUG INFO ===
19:12:02.159 > [ESP32] HMAC Key being used: 221377786C6254B4A5AF0FAC6F5E8C4EF9C231B68FD2AA658BDBA2B238616FF3
19:12:02.167 > [ESP32] HMAC Input length: 45 bytes
19:12:02.169 > [ESP32] HMAC Input (first 32 bytes): 8202170017000408040000000361D5B378433CDA6F7F4C063DF13C2D0E5F90CD
19:12:02.178 > [ESP32] Nonce: 0x00000003
19:12:02.180 > [ESP32] Packet size before HMAC: 61
19:12:02.183 > [ESP32] Computed HMAC Tag: F0220D512639805AC0256F7A16D8084D
19:12:02.189 > [ESP32] === END HMAC DEBUG ===
19:12:02.192 > 6_Final_Packet (61): 8202170017000408040000000361D5B3 78433CDA6F7F4C063DF13C2D0E5F90CD ...
19:12:02.200 > [RETRY] Attempt 1/3 (nonce: 3)
19:12:02.203 > POST http://10.249.92.115:8081/health-data with pipeline data
19:12:02.208 > Sending pipeline data to server (606 bytes)
19:12:02.439 > [HTTP] Response code: 200
19:12:02.439 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:12:02.453 > [RETRY] Health data sent successfully!
19:12:02.456 > ✓ Health data #16 sent successfully
19:12:02.558 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298922197,"threatLevel":0,"type":"heuristics_update"}
19:12:02.588 > [WebSocket] Processing message type: heuristics_update
19:12:02.590 > [191.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:02.700 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:8202170017000408040000000361D5B378433CDA6F7F4C063DF13C2D0E5F90CDBEE07E07B9D178E731CCBA9C18F0220D512639805AC0256F7A16D8084D","pipeline":{"afterLFSR":"CB45F0D256FBD1A69A76533C6A6CCC74B10AD68BD2F280066EF2999BD7CEF51B","afterSalt":"48522D36332053504F322D39352053544550532D3937334D50","afterTinkerbell":"5F072DE76F780E3CDAD1BACDBE43610678F1B9313CCCD57E90E07F3D4C9CB318","afterTransposition":"61D5B378433CDA6F7F4C063DF13C2D0E5F90CDBEE07E07B9D178E731CCBA9C18"},"plaintext":"HR-63 SPO2-95 STEPS-973","serverTime":1770298922316,"timestamp":191385,"type":"encryption_update","ztmEnabled":true}
19:12:02.756 > [WebSocket] Processing message type: encryption_update
19:12:02.762 > [191.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:02.863 > [WebSocket] Received (87 bytes): {"heartRate":63,"spo2":95,"steps":973,"time":1770298922316,"type":"health_data_update"}
19:12:02.871 > [WebSocket] Processing message type: health_data_update
19:12:02.877 > [192.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:02.985 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3719,"encryptionTime":0.0,"finalPlaintext":"HR-63 SPO2-95 STEPS-973","handshakeSuccess":true,"totalTime":0.3719},"type":"session_summary_update"}
19:12:03.008 > [WebSocket] Processing message type: session_summary_update
19:12:03.013 > [192.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:03.118 > [WebSocket] Received (658 bytes): {"decryptionTime":0.3719,"encryptedPacket":"8202170017000408040000000361D5B378433CDA6F7F4C063DF13C2D0E5F90CDBEE07E07B9D178E731CCBA9C18F0220D512639805AC0256F7A16D8084D","finalPlaintext":"HR-63 SPO2-95 STEPS-973","healthData":{"heartRate":63,"spo2":95,"steps":973},"pipeline":{"afterDepad":"48522D36332053504F322D39352053544550532D39373300000000000000","afterLFSR":"48522D36332053504F322D39352053544550532D3937334D5000000000000000","afterTinkerbell":"CB45F0D256FBD1A69A76533C6A6CCC74B10AD68BD2F280066EF2999BD7CEF51B","afterTransposition":"5F072DE76F780E3CDAD1BACDBE43610678F1B9313CCCD57E90E07F3D4C9CB318"},"serverTime":1770298922317,"type":"decryption_update"}
19:12:03.176 > [WebSocket] Processing message type: decryption_update
19:12:03.181 > [WebSocket] Server decryption completed
19:12:03.185 > [WebSocket] Health data - HR: 63, SPO2: 95, Steps: 973
19:12:03.190 > [192.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:03.291 > [WebSocket] Received (646 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":15,"pipeline":{"afterLFSR":"CB45F0D256FBD1A69A76533C6A6CCC74B10AD68BD2F280066EF2999BD7CEF51B","afterSalt":"48522D36332053504F322D39352053544550532D3937334D50","afterTinkerbell":"5F072DE76F780E3CDAD1BACDBE43610678F1B9313CCCD57E90E07F3D4C9CB318","afterTransposition":"61D5B378433CDA6F7F4C063DF13C2D0E5F90CDBEE07E07B9D178E731CCBA9C18","finalPacket":"8202170017000408040000000361D5B378433CDA6F7F4C063DF13C2D0E5F90CDBEE07E07B9D178E731CCBA9C18F0220D512639805AC0256F7A16D8084D"},"plaintext":"HR-63 SPO2-95 STEPS-973","timestamp":191627,"type":"encryption_pipeline","ztmEnabled":true}
19:12:03.350 > [WebSocket] Processing message type: encryption_pipeline
19:12:03.355 > [192.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:03.455 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":15,"message":"Health data #16 sent successfully","state":7,"success":true,"timestamp":191632,"type":"health_data_sent"}
19:12:03.471 > [WebSocket] Processing message type: health_data_sent
19:12:03.473 > [192.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:03.579 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298923199,"threatLevel":0,"type":"heuristics_update"}
19:12:03.610 > [WebSocket] Processing message type: heuristics_update
19:12:03.612 > [192.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:03.721 > [192.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:03.822 > [193.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:03.923 > [193.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:04.024 > [193.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:04.125 > [193.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:04.226 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298924210,"threatLevel":0,"type":"heuristics_update"}
19:12:04.258 > [WebSocket] Processing message type: heuristics_update
19:12:04.260 > [193.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:04.369 > [193.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:04.470 > [193.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:04.571 > [193.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:04.672 > [193.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:04.773 > [194.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:04.874 > [194.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:04.975 > [194.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:05.075 > [194.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:05.177 > [194.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:05.278 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298925221,"threatLevel":0,"type":"heuristics_update"}
19:12:05.309 > [WebSocket] Processing message type: heuristics_update
19:12:05.312 > [194.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:05.421 > [194.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:05.522 > [194.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:05.623 > [194.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:05.724 > [194.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:05.825 > [195.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:05.926 > [195.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:06.027 > [195.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:06.128 > [195.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:06.229 > [195.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:06.330 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298926230,"threatLevel":0,"type":"heuristics_update"}
19:12:06.361 > [WebSocket] Processing message type: heuristics_update
19:12:06.364 > [195.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:06.473 > [195.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:06.574 > [195.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:06.675 > [195.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:06.776 > [196.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:06.877 > [196.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:06.977 > [196.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:07.079 > [196.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:07.180 > [196.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:07.282 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298927240,"threatLevel":0,"type":"heuristics_update"}
19:12:07.312 > [WebSocket] Processing message type: heuristics_update
19:12:07.314 > [196.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:07.424 > [196.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:07.525 > [196.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:07.626 > [196.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:07.727 > [196.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:07.828 > [197.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:07.929 > [197.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:08.030 > [197.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:08.131 > [197.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:08.232 > [197.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:08.336 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298928251,"threatLevel":0,"type":"heuristics_update"}
19:12:08.367 > [WebSocket] Processing message type: heuristics_update
19:12:08.369 > [197.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:08.478 > [197.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:08.579 > [197.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:08.680 > [197.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:08.781 > [198.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:08.882 > [198.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:08.983 > [WebSocket] Received (252 bytes): {"payload":{"epoch":3,"proposalId":"243dd880-2fde-47d8-abae-000000614a706f1c9c90","proposedAt":"2026-02-05T13:42:08Z","targetRecipe":"CHACHA_HEAVY"},"signature":"20deb204c46365a9c83fbe38ce3d2b6f05084c75736ca39e36ba344a2a444918","type":"switch_propose"}
19:12:09.006 > [WebSocket] Processing message type: switch_propose
19:12:09.012 > [WS_RX] switch_propose (new format) proposalId=243dd880-2fde-47d8-abae-000000614a706f1c9c90 targetRecipe=CHACHA_HEAVY epoch=3
19:12:09.022 > [ZTM] Master key (first 16 bytes): 556C98B1B57FE61946699256EFCABC6A
19:12:09.028 > [ZTM] HMAC verify: canonical={"epoch":3,"proposalId":"243dd880-2fde-47d8-abae-000000614a706f1c9c90","proposedAt":"2026-02-05T13:42:08Z","targetRecipe":"CHACHA_HEAVY"}
19:12:09.047 > [ZTM] HMAC verify: computed=20deb204c46365a9c83fbe38ce3d2b6f05084c75736ca39e36ba344a2a444918 expected=20deb204c46365a9c83fbe38ce3d2b6f05084c75736ca39e36ba344a2a444918
19:12:09.059 > [ACK_SENT] proposalId=243dd880-2fde-47d8-abae-000000614a706f1c9c90 epoch=3 lastSeenNonce=3
19:12:09.064 > [ACK_SENT] payload={"deviceId":"f9641d44","epoch":3,"lastSeenNonce":3,"proposalId":"243dd880-2fde-47d8-abae-000000614a706f1c9c90","ready":true} signature=e0d676f9dc78bc860034884040a17d23a988a6a5b593b831ab7216a91271932b
19:12:09.084 > [PROPOSE_ACCEPT] proposalId=243dd880-2fde-47d8-abae-000000614a706f1c9c90 epoch=3 targetRecipe=CHACHA_HEAVY\n[198.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:09.199 > [WebSocket] Received (213 bytes): {"pending":true,"proposalId":"243dd880-2fde-47d8-abae-000000614a706f1c9c90","reason":"Manual switch request","recipe":"CHACHA_HEAVY","serverTime":1770298928968,"success":true,"type":"adaptive_switch_acknowledged"}
19:12:09.218 > [WebSocket] Processing message type: adaptive_switch_acknowledged
19:12:09.224 > [WebSocket] ========================================
19:12:09.230 > [WebSocket] Received message type: adaptive_switch_acknowledged
19:12:09.235 > [WebSocket] Mode from message: 'ztm'
19:12:09.238 > [WebSocket] Recipe from message: 'CHACHA_HEAVY'
19:12:09.243 > [WebSocket] Current gZTMEnabled: TRUE
19:12:09.246 > [WebSocket] Current gCurrentMode: ZTM
19:12:09.249 > [WebSocket] Current gCurrentRecipe: CHAOS_ONLY
19:12:09.254 > [WebSocket] ========================================
19:12:09.257 > [WebSocket] Parsed newMode: ZTM, newRecipe: CHACHA_HEAVY
19:12:09.263 > [WebSocket] Waiting for switch_propose from server for recipe CHACHA_HEAVY
19:12:09.269 > [198.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:09.378 > [WebSocket] Received (248 bytes): {"payload":{"commitNonce":12884901892,"committedAt":"2026-02-05T13:42:09Z","epoch":3,"proposalId":"243dd880-2fde-47d8-abae-000000614a706f1c9c90"},"signature":"2bbb660fc0fb285ac902c59bb537538ffa71c8b6898b6698f16a750e7d3ae11b","type":"switch_commit"}
19:12:09.400 > [WebSocket] Processing message type: switch_commit
19:12:09.406 > [WS_RX] switch_commit (new format) proposalId=243dd880-2fde-47d8-abae-000000614a706f1c9c90 commitNonce=12884901892
19:12:09.417 > [ZTM] Master key (first 16 bytes): 556C98B1B57FE61946699256EFCABC6A
19:12:09.423 > [ZTM] HMAC verify: canonical={"commitNonce":12884901892,"committedAt":"2026-02-05T13:42:09Z","epoch":3,"proposalId":"243dd880-2fde-47d8-abae-000000614a706f1c9c90"}
19:12:09.437 > [ZTM] HMAC verify: computed=2bbb660fc0fb285ac902c59bb537538ffa71c8b6898b6698f16a750e7d3ae11b expected=2bbb660fc0fb285ac902c59bb537538ffa71c8b6898b6698f16a750e7d3ae11b
19:12:09.451 > [COMMIT_RECEIVED] proposalId=243dd880-2fde-47d8-abae-000000614a706f1c9c90 commitNonce=12884901892 epoch=3
19:12:09.459 > [198.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:09.564 > [WebSocket] Received (117 bytes): {"proposalId":"243dd880-2fde-47d8-abae-000000614a706f1c9c90","serverTime":1770298929054,"type":"switch_ack_received"}
19:12:09.576 > [WebSocket] Processing message type: switch_ack_received
19:12:09.582 > [198.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:09.688 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":3,"lastCommitNonce":12884901892,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298929260,"threatLevel":0,"type":"heuristics_update"}
19:12:09.719 > [WebSocket] Processing message type: heuristics_update
19:12:09.721 > [198.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:09.830 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":16,"message":"Mode: ztm, Recipe: CHACHA_HEAVY","state":7,"success":true,"timestamp":198449,"type":"mode_changed_pending"}
19:12:09.847 > [WebSocket] Processing message type: mode_changed_pending
19:12:09.849 > [199.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:09.952 > [199.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:10.052 > [199.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:10.154 > [199.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:10.255 > [199.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:10.359 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":3,"lastCommitNonce":12884901892,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298930272,"threatLevel":0,"type":"heuristics_update"}
19:12:10.389 > [WebSocket] Processing message type: heuristics_update
19:12:10.392 > [199.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:10.501 > [199.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:10.602 > [199.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:10.702 > [199.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:10.804 > [200.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:10.905 > [200.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:11.006 > [200.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:11.107 > [200.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:11.208 > [200.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:11.309 > [200.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:11.411 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":3,"lastCommitNonce":12884901892,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298931281,"threatLevel":0,"type":"heuristics_update"}
19:12:11.441 > [WebSocket] Processing message type: heuristics_update
19:12:11.444 > [200.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:11.554 > [200.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:11.654 > [200.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:11.755 > [200.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:11.856 > [201.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:11.957 > [201.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:12.058 > [201.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:12.158 > [201.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:12.260 > [201.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:12.361 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":3,"lastCommitNonce":12884901892,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298932289,"threatLevel":0,"type":"heuristics_update"}
19:12:12.392 > [WebSocket] Processing message type: heuristics_update
19:12:12.395 > [201.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:12.503 > [201.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:12:12.510 > [RETRY] Attempting to send health data (Max retries: 3)
19:12:12.514 > [BOUNDARY_CHECK] SwitchState=3 PendingActive=1 CommitNonce=12884901892\n[BOUNDARY_CHECK] nextTxNonce=12884901892 commitNonce=12884901892 (epoch=3 packet=4)\n[SWITCH] commit boundary reached — applying recipe proposalId=243dd880-2fde-47d8-abae-000000614a706f1c9c90
19:12:12.540 > [SWITCH] applyRecipe: CHACHA_HEAVY
19:12:12.543 > [ZTM] Settings saved successfully
19:12:12.545 > [SWITCH] Protocol complete — returning to NORMAL state. Applied recipe at nonce: 12884901892
19:12:12.558 > [DONE_SENT] proposalId=243dd880-2fde-47d8-abae-000000614a706f1c9c90 commitNonce=12884901892 epoch=3
19:12:12.566 > [SWITCH_DONE] Recipe switch completed at nonce=12884901892
19:12:12.569 > [RETRY] Using nonce 4 for all retry attempts (saved: 3)
19:12:12.574 > Generated health data: HR-63 SPO2-95 STEPS-1026
19:12:12.579 > [ESP32] ========================================
19:12:12.583 > [ESP32] ENCRYPTION PIPELINE START
19:12:12.585 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHACHA_HEAVY
19:12:12.591 > [ESP32] Active Algorithms for this packet:
19:12:12.597 > [ESP32]   + LFSR
19:12:12.597 > [ESP32]   + Tinkerbell
19:12:12.599 > [ESP32]   - Transposition
19:12:12.602 > [ESP32]   + ChaCha20
19:12:12.602 > [ESP32]   - Salsa20
19:12:12.605 > [ESP32] ========================================
19:12:12.610 > [ESP32] MsgKeys: lfsrSeed=0x842A8811 tnk[0..3]=0B73C19D trn[0..3]=3547B31C
19:12:12.616 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313032364D50
19:12:12.622 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313032364D50000000000000 
19:12:12.630 > [ESP32][LFSR] Initializing - Seed: 0x842A8811 SeedBe: 0x11882A84 ChaosKey[0..3]: 0B73C19D InitialTap: 0x0029 State: 0x842A8811
19:12:12.641 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:12:12.650 > 3_After_LFSR (32): 59DA07B201B482C994959CC365037303 D4953FEFCAB5362709E06FAF09917BC1 
19:12:12.658 > [ESP32][LFSR] Keystream (first 16 bytes): 11882A843294D199DBA7B1FA50232057
19:12:12.663 > [ESP32][4D] LFSR keystream (first 32 bytes): 11882A843294D199DBA7B1FA5023205791C56CC2FB85041144B06FAF09917BC1
19:12:12.671 > [ESP32][TINKERBELL] Input (first 16 bytes): 59DA07B201B482C994959CC365037303 Nonce: 0x00000004 Buffer size: 32 bytes
19:12:12.682 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000004 Counter: 0 (must start at 0) Key[0..3]: 0B73C19D
19:12:12.694 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B7612A919EB3C6E3514C0047ECB6F1FA
19:12:12.702 > 4_After_Tinkerbell (32): EEBB2D239F07442AC5D99C8489B582F9 426830E5AECAB4492C6939E45F40E72C 
19:12:12.710 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B7612A919EB3C6E3514C0047ECB6F1FA
19:12:12.716 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): B7612A919EB3C6E3514C0047ECB6F1FA96FD0F0A647F826E2589564B56D19CED
19:12:12.727 > [ESP32][TRANSPOSITION] SKIPPED (recipe: CHACHA_HEAVY)
19:12:12.732 > [ESP32][CHACHA20] Initializing - Nonce: 0x00000004
19:12:12.735 > [ESP32][CHACHA20] Key (first 8 bytes): 221377786C6254B4
19:12:12.741 > [ESP32][CHACHA20] Full Nonce (12 bytes): 040000000000000000000000
19:12:12.747 > [ESP32][CHACHA20] Input (first 16 bytes): EEBB2D239F07442AC5D99C8489B582F9
19:12:12.755 > 6_After_ChaCha20 (32): 188C78A746339C725A1189275689AFF9 8BE5BD90E2C1708C91DF3BCC04059766 
19:12:12.760 > [ESP32][CHACHA20] Encryption complete - Output size: 32 bytes
19:12:12.766 > [ESP32][4B] recipeId=2 (CHACHA_HEAVY) nonce=0x00000004
19:12:12.772 > [ESP32] === HMAC DEBUG INFO ===
19:12:12.775 > [ESP32] HMAC Key being used: 221377786C6254B4A5AF0FAC6F5E8C4EF9C231B68FD2AA658BDBA2B238616FF3
19:12:12.782 > [ESP32] HMAC Input length: 45 bytes
19:12:12.786 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080200000004188C78A746339C725A1189275689AFF98BE5BD
19:12:12.793 > [ESP32] Nonce: 0x00000004
19:12:12.797 > [ESP32] Packet size before HMAC: 61
19:12:12.800 > [ESP32] Computed HMAC Tag: DB1F87404E000144432185F7957D77F3
19:12:12.805 > [ESP32] === END HMAC DEBUG ===
19:12:12.808 > 6_Final_Packet (61): 82021800180004080200000004188C78 A746339C725A1189275689AFF98BE5BD ...
19:12:12.816 > [RETRY] Attempt 1/3 (nonce: 4)
19:12:12.819 > POST http://10.249.92.115:8081/health-data with pipeline data
19:12:12.825 > Sending pipeline data to server (606 bytes)
19:12:12.964 > [HTTP] Response code: 200
19:12:12.964 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:12:12.980 > [RETRY] Health data sent successfully!
19:12:12.983 > ✓ Health data #17 sent successfully
19:12:13.085 > [WebSocket] Received (413 bytes): {"activatedAt":1770298881281,"active":true,"epoch":3,"heuristics":{"cpuUsage":20.0,"decryptFailures":0,"entropy":7.5,"hmacFailures":0,"latency":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"lastCommitNonce":12884901892,"lastSeenNonce":3,"lastSwitchReason":"Committed via switch_done","pendingProposals":0,"recipe":"CHACHA_HEAVY","serverTime":1770298932560,"threatLevel":0,"type":"ztm_status"}
19:12:13.123 > [WebSocket] Processing message type: ztm_status
19:12:13.126 > [202.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:13.227 > [WebSocket] Received (135 bytes): {"proposalId":"243dd880-2fde-47d8-abae-000000614a706f1c9c90","serverTime":1770298932561,"status":"committed","type":"switch_committed"}
19:12:13.241 > [WebSocket] Processing message type: switch_committed
19:12:13.246 > [202.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:13.349 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHACHA_HEAVY","encData":"ENC_DATA:82021800180004080200000004188C78A746339C725A1189275689AFF98BE5BD90E2C1708C91DF3BCC04059766DB1F87404E000144432185F7957D77F3","pipeline":{"afterChaCha20":"188C78A746339C725A1189275689AFF98BE5BD90E2C1708C91DF3BCC04059766","afterLFSR":"59DA07B201B482C994959CC365037303D4953FEFCAB5362709E06FAF09917BC1","afterSalt":"48522D36332053504F322D39352053544550532D313032364D50","afterTinkerbell":"EEBB2D239F07442AC5D99C8489B582F9426830E5AECAB4492C6939E45F40E72C"},"plaintext":"HR-63 SPO2-95 STEPS-1026","serverTime":1770298932902,"timestamp":202003,"type":"encryption_update","ztmEnabled":true}
19:12:13.405 > [WebSocket] Processing message type: encryption_update
19:12:13.410 > [202.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:13.512 > [WebSocket] Received (88 bytes): {"heartRate":63,"spo2":95,"steps":1026,"time":1770298932903,"type":"health_data_update"}
19:12:13.520 > [WebSocket] Processing message type: health_data_update
19:12:13.526 > [202.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:13.635 > [WebSocket] Received (224 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.365,"encryptionTime":0.0,"finalPlaintext":"HR-63 SPO2-95 STEPS-1026","handshakeSuccess":true,"totalTime":0.365},"type":"session_summary_update"}
19:12:13.657 > [WebSocket] Processing message type: session_summary_update
19:12:13.660 > [202.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:13.768 > [WebSocket] Received (659 bytes): {"decryptionTime":0.365,"encryptedPacket":"82021800180004080200000004188C78A746339C725A1189275689AFF98BE5BD90E2C1708C91DF3BCC04059766DB1F87404E000144432185F7957D77F3","finalPlaintext":"HR-63 SPO2-95 STEPS-1026","healthData":{"heartRate":63,"spo2":95,"steps":1026},"pipeline":{"afterDepad":"48522D36332053504F322D39352053544550532D31303236000000000000","afterLFSR":"48522D36332053504F322D39352053544550532D313032364D50000000000000","afterTinkerbell":"59DA07B201B482C994959CC365037303D4953FEFCAB5362709E06FAF09917BC1","afterTransposition":"EEBB2D239F07442AC5D99C8489B582F9426830E5AECAB4492C6939E45F40E72C"},"serverTime":1770298932903,"type":"decryption_update"}
19:12:13.825 > [WebSocket] Processing message type: decryption_update
19:12:13.831 > [WebSocket] Server decryption completed
19:12:13.834 > [WebSocket] Health data - HR: 63, SPO2: 95, Steps: 1026
19:12:13.839 > [203.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:13.942 > [WebSocket] Received (646 bytes): {"currentRecipe":"CHACHA_HEAVY","deviceId":"f9641d44","healthSendCount":16,"pipeline":{"afterChaCha20":"188C78A746339C725A1189275689AFF98BE5BD90E2C1708C91DF3BCC04059766","afterLFSR":"59DA07B201B482C994959CC365037303D4953FEFCAB5362709E06FAF09917BC1","afterSalt":"48522D36332053504F322D39352053544550532D313032364D50","afterTinkerbell":"EEBB2D239F07442AC5D99C8489B582F9426830E5AECAB4492C6939E45F40E72C","finalPacket":"82021800180004080200000004188C78A746339C725A1189275689AFF98BE5BD90E2C1708C91DF3BCC04059766DB1F87404E000144432185F7957D77F3"},"plaintext":"HR-63 SPO2-95 STEPS-1026","timestamp":202151,"type":"encryption_pipeline","ztmEnabled":true}
19:12:14.000 > [WebSocket] Processing message type: encryption_pipeline
19:12:14.005 > [203.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:14.107 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":16,"message":"Health data #17 sent successfully","state":7,"success":true,"timestamp":202157,"type":"health_data_sent"}
19:12:14.123 > [WebSocket] Processing message type: health_data_sent
19:12:14.126 > [203.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:14.230 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":3,"lastCommitNonce":12884901892,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298933299,"threatLevel":0,"type":"heuristics_update"}
19:12:14.260 > [WebSocket] Processing message type: heuristics_update
19:12:14.262 > [203.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:14.373 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":3,"lastCommitNonce":12884901892,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298934311,"threatLevel":0,"type":"heuristics_update"}
19:12:14.402 > [WebSocket] Processing message type: heuristics_update
19:12:14.406 > [203.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:14.514 > [203.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:14.616 > [203.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:14.717 > [203.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:14.818 > [204.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:14.920 > [204.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:15.020 > [204.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:15.120 > [204.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:15.222 > [204.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:15.323 > [204.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:15.425 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":3,"lastCommitNonce":12884901892,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298935323,"threatLevel":0,"type":"heuristics_update"}
19:12:15.454 > [WebSocket] Processing message type: heuristics_update
19:12:15.458 > [204.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:15.567 > [204.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:15.668 > [204.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:15.769 > [205.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:15.870 > [205.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:15.971 > [205.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:16.072 > [205.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:16.173 > [205.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:16.274 > [205.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:16.376 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":3,"lastCommitNonce":12884901892,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298936335,"threatLevel":0,"type":"heuristics_update"}
19:12:16.406 > [WebSocket] Processing message type: heuristics_update
19:12:16.409 > [205.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:16.518 > [205.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:16.618 > [205.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:16.720 > [205.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:16.821 > [206.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:16.922 > [206.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:17.023 > [206.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:17.124 > [206.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:17.224 > [206.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:17.326 > [206.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:17.428 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":3,"lastCommitNonce":12884901892,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298937346,"threatLevel":0,"type":"heuristics_update"}
19:12:17.458 > [WebSocket] Processing message type: heuristics_update
19:12:17.461 > [206.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:17.570 > [206.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:17.671 > [206.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:17.772 > [207.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:17.873 > [207.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:17.974 > [207.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:18.075 > [207.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:18.176 > [207.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:18.277 > [207.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:18.380 > [WebSocket] Received (250 bytes): {"payload":{"epoch":4,"proposalId":"c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5","proposedAt":"2026-02-05T13:42:18Z","targetRecipe":"CHAOS_ONLY"},"signature":"e37b657698a048e67c02e91380da0286dcdba8abaf7273c7b6e8ec4cc97e1412","type":"switch_propose"}
19:12:18.402 > [WebSocket] Processing message type: switch_propose
19:12:18.409 > [WS_RX] switch_propose (new format) proposalId=c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5 targetRecipe=CHAOS_ONLY epoch=4
19:12:18.420 > [ZTM] Master key (first 16 bytes): 556C98B1B57FE61946699256EFCABC6A
19:12:18.425 > [ZTM] HMAC verify: canonical={"epoch":4,"proposalId":"c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5","proposedAt":"2026-02-05T13:42:18Z","targetRecipe":"CHAOS_ONLY"}
19:12:18.439 > [ZTM] HMAC verify: computed=e37b657698a048e67c02e91380da0286dcdba8abaf7273c7b6e8ec4cc97e1412 expected=e37b657698a048e67c02e91380da0286dcdba8abaf7273c7b6e8ec4cc97e1412
19:12:18.453 > [EPOCH_UPDATE] Updating from 3 to 4 (from switch_propose)\n[ACK_SENT] proposalId=c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5 epoch=4 lastSeenNonce=0
19:12:18.468 > [ACK_SENT] payload={"deviceId":"f9641d44","epoch":4,"lastSeenNonce":0,"proposalId":"c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5","ready":true} signature=1d29fc20ecc87735685a6ac541f91c51dc50ef910b694e8c823112fcc3a03581
19:12:18.488 > [PROPOSE_ACCEPT] proposalId=c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5 epoch=4 targetRecipe=CHAOS_ONLY\n[207.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:18.607 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":4,"lastCommitNonce":12884901892,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298938354,"threatLevel":0,"type":"heuristics_update"}
19:12:18.637 > [WebSocket] Processing message type: heuristics_update
19:12:18.639 > [207.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:18.751 > [WebSocket] Received (248 bytes): {"payload":{"commitNonce":17179869185,"committedAt":"2026-02-05T13:42:18Z","epoch":4,"proposalId":"c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5"},"signature":"8150f8b650102b03b5d553b01f2a299b77979cb7eeccbd01318cd95e36527534","type":"switch_commit"}
19:12:18.773 > [WebSocket] Processing message type: switch_commit
19:12:18.777 > [WS_RX] switch_commit (new format) proposalId=c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5 commitNonce=17179869185
19:12:18.789 > [ZTM] Master key (first 16 bytes): 556C98B1B57FE61946699256EFCABC6A
19:12:18.795 > [ZTM] HMAC verify: canonical={"commitNonce":17179869185,"committedAt":"2026-02-05T13:42:18Z","epoch":4,"proposalId":"c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5"}
19:12:18.809 > [ZTM] HMAC verify: computed=8150f8b650102b03b5d553b01f2a299b77979cb7eeccbd01318cd95e36527534 expected=8150f8b650102b03b5d553b01f2a299b77979cb7eeccbd01318cd95e36527534
19:12:18.823 > [COMMIT_RECEIVED] proposalId=c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5 commitNonce=17179869185 epoch=4
19:12:18.830 > [208.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:18.937 > [WebSocket] Received (117 bytes): {"proposalId":"c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5","serverTime":1770298938462,"type":"switch_ack_received"}
19:12:18.948 > [WebSocket] Processing message type: switch_ack_received
19:12:18.954 > [208.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:19.059 > [208.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:19.160 > [208.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:19.261 > [208.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:19.362 > [208.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:19.463 > [WebSocket] Received (250 bytes): {"payload":{"epoch":5,"proposalId":"707d0ee5-0525-49e2-b7fa-000000c96bd0d99d4c2a","proposedAt":"2026-02-05T13:42:19Z","targetRecipe":"CHAOS_ONLY"},"signature":"def1215658ebf3f83da5b031be5226d5f661e80a5258dc31178b4ffda67dc8fe","type":"switch_propose"}
19:12:19.486 > [WebSocket] Processing message type: switch_propose
19:12:19.491 > [WS_RX] switch_propose (new format) proposalId=707d0ee5-0525-49e2-b7fa-000000c96bd0d99d4c2a targetRecipe=CHAOS_ONLY epoch=5
19:12:19.502 > [ZTM] Master key (first 16 bytes): 556C98B1B57FE61946699256EFCABC6A
19:12:19.508 > [ZTM] HMAC verify: canonical={"epoch":5,"proposalId":"707d0ee5-0525-49e2-b7fa-000000c96bd0d99d4c2a","proposedAt":"2026-02-05T13:42:19Z","targetRecipe":"CHAOS_ONLY"}
19:12:19.522 > [ZTM] HMAC verify: computed=def1215658ebf3f83da5b031be5226d5f661e80a5258dc31178b4ffda67dc8fe expected=def1215658ebf3f83da5b031be5226d5f661e80a5258dc31178b4ffda67dc8fe
19:12:19.536 > [EPOCH_UPDATE] Updating from 4 to 5 (from switch_propose)\n[PROPOSE_REJECT] overlapping transaction
19:12:19.546 > [NACK_SENT] proposalId=707d0ee5-0525-49e2-b7fa-000000c96bd0d99d4c2a reason=overlapping currentEpoch=5
19:12:19.554 > [208.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:19.658 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":5,"lastCommitNonce":17179869185,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298939366,"threatLevel":0,"type":"heuristics_update"}
19:12:19.688 > [WebSocket] Processing message type: heuristics_update
19:12:19.691 > [208.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:19.801 > [WebSocket] Received (118 bytes): {"proposalId":"707d0ee5-0525-49e2-b7fa-000000c96bd0d99d4c2a","serverTime":1770298939562,"type":"switch_nack_received"}
19:12:19.812 > [WebSocket] Processing message type: switch_nack_received
19:12:19.817 > [209.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:19.923 > [209.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:20.024 > [209.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:20.125 > [209.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:20.225 > [209.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:20.327 > [209.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:20.431 > [WebSocket] Received (250 bytes): {"payload":{"epoch":6,"proposalId":"655e5599-e2be-4fa5-a832-00000097d33f1b54aa1b","proposedAt":"2026-02-05T13:42:20Z","targetRecipe":"CHAOS_ONLY"},"signature":"87212a3de28c4d5e612f7f4f560ee19f99604700447c1efd909c8bfde35230a0","type":"switch_propose"}
19:12:20.453 > [WebSocket] Processing message type: switch_propose
19:12:20.458 > [WS_RX] switch_propose (new format) proposalId=655e5599-e2be-4fa5-a832-00000097d33f1b54aa1b targetRecipe=CHAOS_ONLY epoch=6
19:12:20.469 > [ZTM] Master key (first 16 bytes): 556C98B1B57FE61946699256EFCABC6A
19:12:20.475 > [ZTM] HMAC verify: canonical={"epoch":6,"proposalId":"655e5599-e2be-4fa5-a832-00000097d33f1b54aa1b","proposedAt":"2026-02-05T13:42:20Z","targetRecipe":"CHAOS_ONLY"}
19:12:20.489 > [ZTM] HMAC verify: computed=87212a3de28c4d5e612f7f4f560ee19f99604700447c1efd909c8bfde35230a0 expected=87212a3de28c4d5e612f7f4f560ee19f99604700447c1efd909c8bfde35230a0
19:12:20.502 > [EPOCH_UPDATE] Updating from 5 to 6 (from switch_propose)\n[PROPOSE_REJECT] overlapping transaction
19:12:20.514 > [NACK_SENT] proposalId=655e5599-e2be-4fa5-a832-00000097d33f1b54aa1b reason=overlapping currentEpoch=6
19:12:20.522 > [209.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:20.624 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":6,"lastCommitNonce":17179869185,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298940380,"threatLevel":0,"type":"heuristics_update"}
19:12:20.655 > [WebSocket] Processing message type: heuristics_update
19:12:20.658 > [209.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:20.767 > [WebSocket] Received (118 bytes): {"proposalId":"655e5599-e2be-4fa5-a832-00000097d33f1b54aa1b","serverTime":1770298940510,"type":"switch_nack_received"}
19:12:20.779 > [WebSocket] Processing message type: switch_nack_received
19:12:20.785 > [210.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:20.889 > [210.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:20.991 > [210.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:21.091 > [210.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:21.192 > [210.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:21.293 > [210.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:21.395 > [210.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:21.497 > [WebSocket] Received (250 bytes): {"payload":{"epoch":7,"proposalId":"5db2f25d-cbf8-4f82-8d03-000000b251005a094d1e","proposedAt":"2026-02-05T13:42:21Z","targetRecipe":"CHAOS_ONLY"},"signature":"9d8f172618191607ecd26e51283cfea64317c273534872688b798286587954c9","type":"switch_propose"}
19:12:21.519 > [WebSocket] Processing message type: switch_propose
19:12:21.524 > [WS_RX] switch_propose (new format) proposalId=5db2f25d-cbf8-4f82-8d03-000000b251005a094d1e targetRecipe=CHAOS_ONLY epoch=7
19:12:21.535 > [ZTM] Master key (first 16 bytes): 556C98B1B57FE61946699256EFCABC6A
19:12:21.541 > [ZTM] HMAC verify: canonical={"epoch":7,"proposalId":"5db2f25d-cbf8-4f82-8d03-000000b251005a094d1e","proposedAt":"2026-02-05T13:42:21Z","targetRecipe":"CHAOS_ONLY"}
19:12:21.554 > [ZTM] HMAC verify: computed=9d8f172618191607ecd26e51283cfea64317c273534872688b798286587954c9 expected=9d8f172618191607ecd26e51283cfea64317c273534872688b798286587954c9
19:12:21.568 > [EPOCH_UPDATE] Updating from 6 to 7 (from switch_propose)\n[PROPOSE_REJECT] overlapping transaction
19:12:21.579 > [NACK_SENT] proposalId=5db2f25d-cbf8-4f82-8d03-000000b251005a094d1e reason=overlapping currentEpoch=7
19:12:21.588 > [210.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:21.692 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":7,"lastCommitNonce":17179869185,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298941390,"threatLevel":0,"type":"heuristics_update"}
19:12:21.721 > [WebSocket] Processing message type: heuristics_update
19:12:21.725 > [210.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:21.835 > [WebSocket] Received (118 bytes): {"proposalId":"5db2f25d-cbf8-4f82-8d03-000000b251005a094d1e","serverTime":1770298941599,"type":"switch_nack_received"}
19:12:21.846 > [WebSocket] Processing message type: switch_nack_received
19:12:21.851 > [211.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:21.957 > [211.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:22.058 > [211.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:22.159 > [211.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:22.259 > [211.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:22.361 > [211.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:22.463 > [WebSocket] Received (250 bytes): {"payload":{"epoch":8,"proposalId":"0e21ed21-0552-4790-9c49-0000002230d249aec2f3","proposedAt":"2026-02-05T13:42:22Z","targetRecipe":"CHAOS_ONLY"},"signature":"08de4a71b19ff97bb856c90ee219a50372717da7d5503bfd9abc4d9fa5902b1a","type":"switch_propose"}
19:12:22.484 > [WebSocket] Processing message type: switch_propose
19:12:22.489 > [WS_RX] switch_propose (new format) proposalId=0e21ed21-0552-4790-9c49-0000002230d249aec2f3 targetRecipe=CHAOS_ONLY epoch=8
19:12:22.501 > [ZTM] Master key (first 16 bytes): 556C98B1B57FE61946699256EFCABC6A
19:12:22.506 > [ZTM] HMAC verify: canonical={"epoch":8,"proposalId":"0e21ed21-0552-4790-9c49-0000002230d249aec2f3","proposedAt":"2026-02-05T13:42:22Z","targetRecipe":"CHAOS_ONLY"}
19:12:22.521 > [ZTM] HMAC verify: computed=08de4a71b19ff97bb856c90ee219a50372717da7d5503bfd9abc4d9fa5902b1a expected=08de4a71b19ff97bb856c90ee219a50372717da7d5503bfd9abc4d9fa5902b1a
19:12:22.534 > [EPOCH_UPDATE] Updating from 7 to 8 (from switch_propose)\n[PROPOSE_REJECT] overlapping transaction
19:12:22.545 > [NACK_SENT] proposalId=0e21ed21-0552-4790-9c49-0000002230d249aec2f3 reason=overlapping currentEpoch=8
19:12:22.554 > [211.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:22.658 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":8,"lastCommitNonce":17179869185,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298942394,"threatLevel":0,"type":"heuristics_update"}
19:12:22.689 > [WebSocket] Processing message type: heuristics_update
19:12:22.692 > [211.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:22.801 > [WebSocket] Received (118 bytes): {"proposalId":"0e21ed21-0552-4790-9c49-0000002230d249aec2f3","serverTime":1770298942543,"type":"switch_nack_received"}
19:12:22.813 > [WebSocket] Processing message type: switch_nack_received
19:12:22.819 > [212.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:22.923 > [212.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:23.025 > [212.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:12:23.030 > [RETRY] Attempting to send health data (Max retries: 3)
19:12:23.036 > [BOUNDARY_CHECK] SwitchState=3 PendingActive=1 CommitNonce=17179869185\n[BOUNDARY_CHECK] nextTxNonce=34359738369 commitNonce=17179869185 (epoch=8 packet=1)\n[SWITCH] commit boundary reached — applying recipe proposalId=c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5
19:12:23.061 > [SWITCH] applyRecipe: CHAOS_ONLY
19:12:23.063 > [ZTM] Settings saved successfully
19:12:23.066 > [SWITCH] Protocol complete — returning to NORMAL state. Applied recipe at nonce: 17179869185
19:12:23.078 > [DONE_SENT] proposalId=c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5 commitNonce=17179869185 epoch=4
19:12:23.086 > [SWITCH_DONE] Recipe switch completed at nonce=17179869185
19:12:23.089 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:12:23.095 > Generated health data: HR-63 SPO2-95 STEPS-1108
19:12:23.100 > [ESP32] ========================================
19:12:23.103 > [ESP32] ENCRYPTION PIPELINE START
19:12:23.106 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:12:23.111 > [ESP32] Active Algorithms for this packet:
19:12:23.117 > [ESP32]   + LFSR
19:12:23.117 > [ESP32]   + Tinkerbell
19:12:23.120 > [ESP32]   + Transposition
19:12:23.122 > [ESP32]   - ChaCha20
19:12:23.122 > [ESP32]   - Salsa20
19:12:23.125 > [ESP32] ========================================
19:12:23.128 > [ESP32] MsgKeys: lfsrSeed=0x1916A810 tnk[0..3]=498601C6 trn[0..3]=94D94D97
19:12:23.136 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313130384D50
19:12:23.142 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313130384D50000000000000 
19:12:23.150 > [ESP32][LFSR] Initializing - Seed: 0x1916A810 SeedBe: 0x10A81619 ChaosKey[0..3]: 498601C6 InitialTap: 0x0029 State: 0x1916A810
19:12:23.162 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:12:23.169 > 3_After_LFSR (32): 58FA3B2FA812B1CBB5E357E2D0D64152 4C824BF40D8997A9C6D173AAB63067B5 
19:12:23.178 > [ESP32][LFSR] Keystream (first 16 bytes): 10A816199B32E29BFAD17ADBE5F61206
19:12:23.184 > [ESP32][4D] LFSR keystream (first 32 bytes): 10A816199B32E29BFAD17ADBE5F6120609D218D93CB8A7918B8173AAB63067B5
19:12:23.192 > [ESP32][TINKERBELL] Input (first 16 bytes): 58FA3B2FA812B1CBB5E357E2D0D64152 Nonce: 0x00000001 Buffer size: 32 bytes
19:12:23.203 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 498601C6
19:12:23.214 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): C2A42268104078781B62C3CBE7A4157A
19:12:23.222 > 4_After_Tinkerbell (32): 9A5E1947B852C9B3AE81942937725428 63A254B85E85BBC163E69F528E516CE5 
19:12:23.228 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): C2A42268104078781B62C3CBE7A4157A
19:12:23.236 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): C2A42268104078781B62C3CBE7A4157A2F201F4C530C2C68A537ECF838610B50
19:12:23.248 > 5_After_Transposition (32): AE47BBB885C9639A52A22928E58E5E37 51C119545E9FB39452E6B86C54726381 
19:12:23.256 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:12:23.262 > [ESP32] === HMAC DEBUG INFO ===
19:12:23.264 > [ESP32] HMAC Key being used: 221377786C6254B4A5AF0FAC6F5E8C4EF9C231B68FD2AA658BDBA2B238616FF3
19:12:23.272 > [ESP32] HMAC Input length: 45 bytes
19:12:23.275 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001AE47BBB885C9639A52A22928E58E5E3751C119
19:12:23.284 > [ESP32] Nonce: 0x00000001
19:12:23.287 > [ESP32] Packet size before HMAC: 61
19:12:23.290 > [ESP32] Computed HMAC Tag: 9A0F1B65DA6FE197B370665BCBDC806D
19:12:23.295 > [ESP32] === END HMAC DEBUG ===
19:12:23.298 > 6_Final_Packet (61): 82021800180004080400000001AE47BB B885C9639A52A22928E58E5E3751C119 ...
19:12:23.306 > [RETRY] Attempt 1/3 (nonce: 1)
19:12:23.309 > POST http://10.249.92.115:8081/health-data with pipeline data
19:12:23.311 > Sending pipeline data to server (609 bytes)
19:12:23.504 > [HTTP] Response code: 200
19:12:23.504 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:12:23.517 > [RETRY] Health data sent successfully!
19:12:23.520 > ✓ Health data #18 sent successfully
19:12:23.619 > [WebSocket] Received (411 bytes): {"activatedAt":1770298881281,"active":true,"epoch":8,"heuristics":{"cpuUsage":20.0,"decryptFailures":0,"entropy":7.5,"hmacFailures":0,"latency":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"lastCommitNonce":17179869185,"lastSeenNonce":4,"lastSwitchReason":"Committed via switch_done","pendingProposals":0,"recipe":"CHAOS_ONLY","serverTime":1770298943079,"threatLevel":0,"type":"ztm_status"}
19:12:23.656 > [WebSocket] Processing message type: ztm_status
19:12:23.661 > [212.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:23.763 > [WebSocket] Received (135 bytes): {"proposalId":"c533e2ea-35c3-4968-9a6b-00000082b92380c6d2c5","serverTime":1770298943079,"status":"committed","type":"switch_committed"}
19:12:23.776 > [WebSocket] Processing message type: switch_committed
19:12:23.781 > [213.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:23.885 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":5,"serverTime":1770298943396,"type":"security_update"}
19:12:23.901 > [WebSocket] Processing message type: security_update
19:12:23.907 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:12:23.912 > [213.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:24.016 > [WebSocket] Received (636 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:82021800180004080400000001AE47BBB885C9639A52A22928E58E5E3751C119545E9FB39452E6B86C547263819A0F1B65DA6FE197B370665BCBDC806D","pipeline":{"afterLFSR":"58FA3B2FA812B1CBB5E357E2D0D641524C824BF40D8997A9C6D173AAB63067B5","afterSalt":"48522D36332053504F322D39352053544550532D313130384D50","afterTinkerbell":"9A5E1947B852C9B3AE8194293772542863A254B85E85BBC163E69F528E516CE5","afterTransposition":"AE47BBB885C9639A52A22928E58E5E3751C119545E9FB39452E6B86C54726381"},"plaintext":"HR-63 SPO2-95 STEPS-1108","serverTime":1770298943396,"timestamp":212493,"type":"encryption_update","ztmEnabled":true}
19:12:24.087 > [WebSocket] Processing message type: encryption_update
19:12:24.087 > [213.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:24.179 > [WebSocket] Received (88 bytes): {"heartRate":63,"spo2":95,"steps":1108,"time":1770298943396,"type":"health_data_update"}
19:12:24.189 > [WebSocket] Processing message type: health_data_update
19:12:24.194 > [213.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:24.302 > [WebSocket] Received (226 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2499,"encryptionTime":0.0,"finalPlaintext":"HR-63 SPO2-95 STEPS-1108","handshakeSuccess":true,"totalTime":0.2499},"type":"session_summary_update"}
19:12:24.325 > [WebSocket] Processing message type: session_summary_update
19:12:24.331 > [213.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:24.435 > [WebSocket] Received (660 bytes): {"decryptionTime":0.2499,"encryptedPacket":"82021800180004080400000001AE47BBB885C9639A52A22928E58E5E3751C119545E9FB39452E6B86C547263819A0F1B65DA6FE197B370665BCBDC806D","finalPlaintext":"HR-63 SPO2-95 STEPS-1108","healthData":{"heartRate":63,"spo2":95,"steps":1108},"pipeline":{"afterDepad":"48522D36332053504F322D39352053544550532D31313038000000000000","afterLFSR":"48522D36332053504F322D39352053544550532D313130384D50000000000000","afterTinkerbell":"58FA3B2FA812B1CBB5E357E2D0D641524C824BF40D8997A9C6D173AAB63067B5","afterTransposition":"9A5E1947B852C9B3AE8194293772542863A254B85E85BBC163E69F528E516CE5"},"serverTime":1770298943397,"type":"decryption_update"}
19:12:24.493 > [WebSocket] Processing message type: decryption_update
19:12:24.499 > [WebSocket] Server decryption completed
19:12:24.502 > [WebSocket] Health data - HR: 63, SPO2: 95, Steps: 1108
19:12:24.507 > [213.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:24.608 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":17179869185,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298943405,"threatLevel":0,"type":"heuristics_update"}
19:12:24.638 > [WebSocket] Processing message type: heuristics_update
19:12:24.641 > [213.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:24.752 > [WebSocket] Received (649 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":17,"pipeline":{"afterLFSR":"58FA3B2FA812B1CBB5E357E2D0D641524C824BF40D8997A9C6D173AAB63067B5","afterSalt":"48522D36332053504F322D39352053544550532D313130384D50","afterTinkerbell":"9A5E1947B852C9B3AE8194293772542863A254B85E85BBC163E69F528E516CE5","afterTransposition":"AE47BBB885C9639A52A22928E58E5E3751C119545E9FB39452E6B86C54726381","finalPacket":"82021800180004080400000001AE47BBB885C9639A52A22928E58E5E3751C119545E9FB39452E6B86C547263819A0F1B65DA6FE197B370665BCBDC806D"},"plaintext":"HR-63 SPO2-95 STEPS-1108","timestamp":212692,"type":"encryption_pipeline","ztmEnabled":true}
19:12:24.810 > [WebSocket] Processing message type: encryption_pipeline
19:12:24.815 > [214.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:24.914 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":17,"message":"Health data #18 sent successfully","state":7,"success":true,"timestamp":212697,"type":"health_data_sent"}
19:12:24.932 > [WebSocket] Processing message type: health_data_sent
19:12:24.936 > [214.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:25.037 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":17179869185,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298944418,"threatLevel":0,"type":"heuristics_update"}
19:12:25.067 > [WebSocket] Processing message type: heuristics_update
19:12:25.070 > [214.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:25.180 > [214.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:25.280 > [214.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:25.381 > [214.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:25.483 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":17179869185,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770298945433,"threatLevel":0,"type":"heuristics_update"}
19:12:25.514 > [WebSocket] Processing message type: heuristics_update
19:12:25.517 > [214.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:25.625 > [214.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:25.726 > [214.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:25.828 > [215.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:25.929 > [215.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:12:26.030 > [215.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
