19:40:48.202 > ets Jul 29 2019 12:21:46
19:40:48.202 > 
19:40:48.202 > rst:0x1 (POWERON_RESET),boot:0x13 (SPI_FAST_FLASH_BOOT)
19:40:48.208 > configsip: 0, SPIWP:0xee
19:40:48.210 > clk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00
19:40:48.216 > mode:DIO, clock div:2
19:40:48.218 > load:0x3fff0030,len:1184
19:40:48.221 > load:0x40078000,len:13232
19:40:48.224 > load:0x40080400,len:3028
19:40:48.224 > entry 0x400805e4
19:40:49.644 > === XenoCipher ESP32 Booting ===
19:40:49.647 > Free heap: 293772 bytes
19:40:49.647 > Nonce counter reset for new session
19:40:49.650 > [ZTM] Forced NORMAL mode on startup - waiting for server ZTM activation
19:40:49.658 > [ZTM] (Previous ZTM settings in NVS are ignored to prevent mode desync)
19:40:49.664 > [RECIPE] Recipe map version: 1
19:40:49.667 > [RECIPE] Mapping: 1=FULL_STACK 2=CHACHA_HEAVY 3=SALSA_LIGHT 4=CHAOS_ONLY 5=STREAM_FOCUS
19:40:49.675 > [1.0] STATE: INIT_NVS | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:49.684 > ✓ NVS initialized
19:40:49.777 > [1.1] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:49.783 > Connecting to motorola edge 40_6753
19:40:49.987 > [WiFi] STA Start
19:40:50.115 > [1.5] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:50.215 > [1.6] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:50.316 > [1.7] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:50.415 > [1.8] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:50.514 > [1.9] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:50.614 > [2.0] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:50.715 > [2.1] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:50.814 > [2.2] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:50.915 > [2.3] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:51.015 > [2.4] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:51.115 > [2.5] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:51.215 > [2.6] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:51.315 > [2.7] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:51.351 > [WiFi] Connected to AP
19:40:51.385 > [WiFi] Got IP: 10.249.92.171
19:40:51.385 > [WebSocket] Initialized - Server: 10.249.92.115:8081/api/ws
19:40:51.415 > [2.8] STATE: CONNECT_WIFI | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:51.421 > ✓ WiFi connected! IP: 10.249.92.171
19:40:51.516 > [2.9] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:51.524 > No public key in NVS, fetching from server
19:40:51.627 > [3.0] STATE: GET_PUBLIC_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:51.633 > GET http://10.249.92.115:8081/public-key
19:40:51.905 > Response length: 1027 chars
19:40:52.016 > [3.4] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:52.116 > [3.5] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:52.125 > Generating fresh master key from entropy...
19:40:52.132 > Generated master key (32): 6C6F2F5696B28FFE99EB86F2C23C4B6D 4BFC050914F2D806FBDF48A7159795F0 
19:40:52.137 > Using reduced master key (byte % 3) for NTRU encryption only
19:40:52.143 > NTRU encrypted master key (502): 007A007A002000110053006000760049 006B003A0014001D0052003300500016 ...
19:40:52.154 > POST http://10.249.92.115:8081/master-key
19:40:52.409 > ✓ Master key exchange completed
19:40:52.510 > [3.9] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
19:40:52.519 > Loading master key from NVS and deriving symmetric keys...
19:40:52.521 > Loaded master key from NVS (32): 6C6F2F5696B28FFE99EB86F2C23C4B6D 4BFC050914F2D806FBDF48A7159795F0 
19:40:52.532 > Derived HMAC key (32): A1943F11EAB4DE11E26253318D689A32 EEE583B0FA7907E5A57D289F2910CA79 
19:40:52.538 > Derived Tinkerbell key (16): DB204B8824DF9B1CE59AE74846050D18 
19:40:52.543 > Derived Transposition key (16): 09B8C69A3B20B40ABC8F85A9C395498B 
19:40:52.552 > ✓ Symmetric keys derived successfully
19:40:52.555 > Nonce tracker reset - new session started
19:40:53.059 > Waiting for server to process master key...
19:40:53.061 > ✓ Symmetric keys ready - starting health data transmission
19:40:53.158 > [4.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:40:53.259 > [4.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:40:53.359 > [4.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:40:53.459 > [4.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:40:53.559 > [4.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:40:53.679 > [5.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:40:53.782 > [5.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:40:53.883 > [5.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:40:53.984 > [5.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:40:54.085 > [5.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
19:40:54.186 > [WebSocket] ========================================[WebSocket] CONNECTED to: /api/ws
19:40:54.192 > [WebSocket] WebSocket connection established[WebSocket] Ready to receive ZTM activation requests[WebSocket] ========================================[WebSocket] Sent hello message (hello_from_esp32)
19:40:54.208 > [5.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:54.313 > [WebSocket] Received (151 bytes): {"message":"Connected to XenoCipher Server","serverTime":1770300653678,"sessionId":"1770300653678-41","totalClients":2,"type":"connection_established"}
19:40:54.327 > [WebSocket] Processing message type: connection_established
19:40:54.333 > [WebSocket] Connection established - Session: 1770300653678-41
19:40:54.339 > [5.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:54.446 > [WebSocket] Received (112 bytes): {"message":"ESP32 connection acknowledged","serverTime":1770300654204,"status":"ready","type":"esp32_connected"}
19:40:54.458 > [WebSocket] Processing message type: esp32_connected
19:40:54.463 > [5.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:54.568 > [5.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:54.669 > [6.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:54.770 > [6.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:54.871 > [6.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:54.973 > [6.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:55.074 > [6.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:55.175 > [6.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:55.276 > [6.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:55.377 > [6.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:55.478 > [6.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:55.579 > [7.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:55.679 > [7.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:55.780 > [7.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:55.881 > [7.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:55.983 > [7.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:56.083 > [7.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:56.184 > [7.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:56.285 > [7.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:56.386 > [7.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:56.487 > [7.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:56.589 > [8.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:56.689 > [8.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:56.790 > [8.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:56.891 > [8.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:56.992 > [8.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:57.094 > [8.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:57.195 > [8.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:57.295 > [8.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:57.397 > [8.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:57.497 > [8.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:57.598 > [9.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:57.698 > [9.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:57.800 > [9.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:57.901 > [9.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:58.002 > [9.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:58.104 > [9.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:58.205 > [9.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:58.306 > [9.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:58.406 > [9.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:58.508 > [9.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:58.608 > [10.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:58.709 > [10.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:58.810 > [10.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:58.912 > [10.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:59.012 > [10.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:59.113 > [10.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:59.214 > [10.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:59.315 > [10.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:59.416 > [10.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:59.517 > [10.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:59.618 > [11.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:59.719 > [11.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:59.820 > [11.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:40:59.921 > [11.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:00.022 > [11.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:00.123 > [11.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:00.224 > [11.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:00.326 > [11.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:00.426 > [11.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:00.527 > [11.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:00.628 > [12.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:00.729 > [12.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:00.830 > [12.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:00.931 > [12.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:01.032 > [12.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:01.133 > [12.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:01.235 > [12.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:01.335 > [12.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:01.437 > [12.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:01.537 > [12.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:01.638 > [13.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:01.739 > [13.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:01.840 > [13.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:01.942 > [13.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:02.042 > [13.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:02.144 > [13.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:02.245 > [13.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:02.345 > [13.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:02.446 > [13.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:02.547 > [13.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:02.648 > [14.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:02.749 > [14.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:02.851 > [14.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:02.952 > [14.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:03.052 > [14.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:03.153 > [14.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
19:41:03.159 > [RETRY] Attempting to send health data (Max retries: 3)
19:41:03.164 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:41:03.180 > Generated health data: HR-60 SPO2-95 STEPS-77
19:41:03.184 > [ESP32] ========================================
19:41:03.189 > [ESP32] ENCRYPTION PIPELINE START
19:41:03.192 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:41:03.200 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:41:03.205 > [ESP32] ========================================
19:41:03.211 > [ESP32] MsgKeys: lfsrSeed=0x8E7A0AB6 tnk[0..3]=984C5571 trn[0..3]=F8C2400B
19:41:03.217 > 1_After_Salt (24): 48522D36302053504F322D3935205354 4550532D37374D50
19:41:03.223 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D37374D500000000000000000 
19:41:03.231 > [ESP32][LFSR] Initializing - Seed: 0x8E7A0AB6 SeedBe: 0xB60A7A8E ChaosKey[0..3]: 984C5571 InitialTap: 0x0029 State: 0x8E7A0AB6
19:41:03.242 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:41:03.250 > 3_After_LFSR (32): FE5857B8ACAE49B10A2E3633DE45276A 110D23E5FB8F8508BFF0A6003D6615AE 
19:41:03.256 > [ESP32][LFSR] Keystream (first 16 bytes): B60A7A8E9C8E1AE1451C1B0AEB65743E
19:41:03.264 > [ESP32][4D] LFSR keystream (first 32 bytes): B60A7A8E9C8E1AE1451C1B0AEB65743E545D70C8CCB8C858BFF0A6003D6615AE
19:41:03.273 > [ESP32][TINKERBELL] Input (first 16 bytes): FE5857B8ACAE49B10A2E3633DE45276A Nonce: 0x00000001 Buffer size: 32 bytes
19:41:03.283 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 984C5571
19:41:03.295 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 1965C2886F12405D254DE58D59960BED
19:41:03.301 > 4_After_Tinkerbell (32): E73D9530C3BC09EC2F63D3BE87D32C87 622EE3D12509E82C206D6656319769EB 
19:41:03.308 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 1965C2886F12405D254DE58D59960BED
19:41:03.317 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 1965C2886F12405D254DE58D59960BED7323C034DE866D249F9DC0560CF17C45
19:41:03.328 > 5_After_Transposition (32): 2569EBD3E7EC09E8312C9530C32C2F20 97BC3D56BE8709D1E36687D32E6D6362 
19:41:03.336 > [ESP32] === HMAC DEBUG INFO ===
19:41:03.339 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:41:03.348 > [ESP32] HMAC Input length: 44 bytes
19:41:03.350 > [ESP32] HMAC Input (first 32 bytes): 8102160016000408000000012569EBD3E7EC09E8312C9530C32C2F2097BC3D56
19:41:03.359 > [ESP32] Nonce: 0x00000001
19:41:03.361 > [ESP32] Packet size before HMAC: 60
19:41:03.364 > [ESP32] Computed HMAC Tag: 5CCDBE0A3B1686035E34E493A16F4B1C
19:41:03.370 > [ESP32] === END HMAC DEBUG ===
19:41:03.373 > 6_Final_Packet (60): 8102160016000408000000012569EBD3 E7EC09E8312C9530C32C2F2097BC3D56 ...
19:41:03.381 > [RETRY] Attempt 1/3 (nonce: 1)
19:41:03.384 > POST http://10.249.92.115:8081/health-data with pipeline data
19:41:03.390 > Sending pipeline data to server (601 bytes)
19:41:03.672 > [HTTP] Response code: 200
19:41:03.672 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:41:03.683 > [RETRY] Health data sent successfully!
19:41:03.686 > ✓ Health data #1 sent successfully
19:41:03.788 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":1,"serverTime":1770300663461,"type":"security_update"}
19:41:03.804 > [WebSocket] Processing message type: security_update
19:41:03.810 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:41:03.815 > [15.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:03.921 > [WebSocket] Received (628 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:8102160016000408000000012569EBD3E7EC09E8312C9530C32C2F2097BC3D56BE8709D1E36687D32E6D63625CCDBE0A3B1686035E34E493A16F4B1C","pipeline":{"afterLFSR":"FE5857B8ACAE49B10A2E3633DE45276A110D23E5FB8F8508BFF0A6003D6615AE","afterSalt":"48522D36302053504F322D39352053544550532D37374D50","afterTinkerbell":"E73D9530C3BC09EC2F63D3BE87D32C87622EE3D12509E82C206D6656319769EB","afterTransposition":"2569EBD3E7EC09E8312C9530C32C2F2097BC3D56BE8709D1E36687D32E6D6362"},"plaintext":"HR-60 SPO2-95 STEPS-77","serverTime":1770300663461,"timestamp":14762,"type":"encryption_update","ztmEnabled":false}
19:41:03.976 > [WebSocket] Processing message type: encryption_update
19:41:03.982 > [15.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:04.083 > [WebSocket] Received (86 bytes): {"heartRate":60,"spo2":95,"steps":77,"time":1770300663461,"type":"health_data_update"}
19:41:04.092 > [WebSocket] Processing message type: health_data_update
19:41:04.097 > [15.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:04.206 > [WebSocket] Received (224 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2833,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-77","handshakeSuccess":true,"totalTime":0.2833},"type":"session_summary_update"}
19:41:04.227 > [WebSocket] Processing message type: session_summary_update
19:41:04.231 > [15.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:04.338 > [WebSocket] Received (654 bytes): {"decryptionTime":0.2833,"encryptedPacket":"8102160016000408000000012569EBD3E7EC09E8312C9530C32C2F2097BC3D56BE8709D1E36687D32E6D63625CCDBE0A3B1686035E34E493A16F4B1C","finalPlaintext":"HR-60 SPO2-95 STEPS-77","healthData":{"heartRate":60,"spo2":95,"steps":77},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D37370000000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D37374D500000000000000000","afterTinkerbell":"FE5857B8ACAE49B10A2E3633DE45276A110D23E5FB8F8508BFF0A6003D6615AE","afterTransposition":"E73D9530C3BC09EC2F63D3BE87D32C87622EE3D12509E82C206D6656319769EB"},"serverTime":1770300663463,"type":"decryption_update"}
19:41:04.396 > [WebSocket] Processing message type: decryption_update
19:41:04.402 > [WebSocket] Server decryption completed
19:41:04.405 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 77
19:41:04.410 > [15.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:04.512 > [WebSocket] Received (640 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":0,"pipeline":{"afterLFSR":"FE5857B8ACAE49B10A2E3633DE45276A110D23E5FB8F8508BFF0A6003D6615AE","afterSalt":"48522D36302053504F322D39352053544550532D37374D50","afterTinkerbell":"E73D9530C3BC09EC2F63D3BE87D32C87622EE3D12509E82C206D6656319769EB","afterTransposition":"2569EBD3E7EC09E8312C9530C32C2F2097BC3D56BE8709D1E36687D32E6D6362","finalPacket":"8102160016000408000000012569EBD3E7EC09E8312C9530C32C2F2097BC3D56BE8709D1E36687D32E6D63625CCDBE0A3B1686035E34E493A16F4B1C"},"plaintext":"HR-60 SPO2-95 STEPS-77","timestamp":15045,"type":"encryption_pipeline","ztmEnabled":false}
19:41:04.570 > [WebSocket] Processing message type: encryption_pipeline
19:41:04.573 > [15.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:04.675 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":0,"message":"Health data #1 sent successfully","state":7,"success":true,"timestamp":15050,"type":"health_data_sent"}
19:41:04.691 > [WebSocket] Processing message type: health_data_sent
19:41:04.694 > [16.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:04.796 > [16.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:04.898 > [16.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:04.998 > [16.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:05.100 > [16.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:05.200 > [16.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:05.301 > [16.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:05.402 > [16.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:05.503 > [16.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:05.604 > [17.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:05.705 > [17.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:05.806 > [17.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:05.908 > [17.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:06.008 > [17.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:06.109 > [17.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:06.210 > [17.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:06.311 > [17.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:06.412 > [17.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:06.513 > [17.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:06.614 > [18.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:06.714 > [18.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:06.816 > [18.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:06.917 > [18.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:07.017 > [18.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:07.118 > [18.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:07.220 > [18.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:07.321 > [18.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:07.422 > [18.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:07.523 > [18.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:07.625 > [19.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:07.725 > [19.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:07.826 > [19.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:07.927 > [19.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:08.028 > [19.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:08.128 > [19.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:08.230 > [19.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:08.331 > [19.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:08.432 > [19.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:08.533 > [19.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:08.634 > [20.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:08.735 > [20.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:08.835 > [20.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:08.937 > [20.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:09.038 > [20.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:09.139 > [20.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:09.240 > [20.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:09.341 > [20.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:09.442 > [20.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:09.543 > [20.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:09.644 > [21.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:09.745 > [21.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:09.845 > [21.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:09.946 > [21.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:10.048 > [21.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:10.149 > [21.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:10.250 > [21.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:10.351 > [21.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:10.452 > [21.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:10.552 > [21.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:10.654 > [22.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:10.755 > [22.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:10.856 > [22.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:10.957 > [22.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:11.058 > [22.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:11.159 > [22.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:11.260 > [22.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:11.360 > [22.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:11.462 > [22.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:11.563 > [22.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:11.664 > [23.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:11.765 > [23.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:11.865 > [23.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:11.967 > [23.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:12.067 > [23.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:12.169 > [23.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:12.270 > [23.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:12.371 > [23.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:12.472 > [23.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:12.572 > [23.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:12.673 > [24.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:12.774 > [24.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:12.876 > [24.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:12.977 > [24.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:13.078 > [24.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:13.178 > [24.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:13.279 > [24.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:13.381 > [24.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:13.482 > [24.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:13.583 > [25.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:13.684 > [25.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
19:41:13.690 > [RETRY] Attempting to send health data (Max retries: 3)
19:41:13.695 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:41:13.711 > Generated health data: HR-60 SPO2-95 STEPS-126
19:41:13.714 > [ESP32] ========================================
19:41:13.720 > [ESP32] ENCRYPTION PIPELINE START
19:41:13.722 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
19:41:13.731 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
19:41:13.737 > [ESP32] ========================================
19:41:13.742 > [ESP32] MsgKeys: lfsrSeed=0xF0C1FAA8 tnk[0..3]=5F4F03CF trn[0..3]=29C941D3
19:41:13.748 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3132364D50
19:41:13.753 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3132364D5000000000000000 
19:41:13.762 > [ESP32][LFSR] Initializing - Seed: 0xF0C1FAA8 SeedBe: 0xA8FAC1F0 ChaosKey[0..3]: 5F4F03CF InitialTap: 0x0029 State: 0xF0C1FAA8
19:41:13.773 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:41:13.781 > 3_After_LFSR (32): E0A8ECC6078EB19C73353BA210F83F04 DDD3BDFB4CE2F27AABEECE56246638A3 
19:41:13.789 > [ESP32][LFSR] Keystream (first 16 bytes): A8FAC1F037AEE2CC3C07169B25D86C50
19:41:13.795 > [ESP32][4D] LFSR keystream (first 32 bytes): A8FAC1F037AEE2CC3C07169B25D86C509883EED67DD0C437FBEECE56246638A3
19:41:13.804 > [ESP32][TINKERBELL] Input (first 16 bytes): E0A8ECC6078EB19C73353BA210F83F04 Nonce: 0x00000002 Buffer size: 32 bytes
19:41:13.814 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 5F4F03CF
19:41:13.825 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBD
19:41:13.834 > 4_After_Tinkerbell (32): AA9583073F433D8018D8834D2EFAE1B9 64EDAB89604A400F11F07D34FD6CFFF5 
19:41:13.839 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBD
19:41:13.848 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBDB93E16722CA8B275BA1EB362D90AC756
19:41:13.859 > 5_After_Transposition (32): F5B90F0760114AFDE18383641880AB3D EDF0FA8940FFAA7D433F342E4DD86C95 
19:41:13.867 > [ESP32] === HMAC DEBUG INFO ===
19:41:13.870 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:41:13.878 > [ESP32] HMAC Input length: 44 bytes
19:41:13.881 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000002F5B90F0760114AFDE18383641880AB3DEDF0FA89
19:41:13.889 > [ESP32] Nonce: 0x00000002
19:41:13.892 > [ESP32] Packet size before HMAC: 60
19:41:13.895 > [ESP32] Computed HMAC Tag: 470A2EFD7AE00468EC9B73578F4027E3
19:41:13.900 > [ESP32] === END HMAC DEBUG ===
19:41:13.904 > 6_Final_Packet (60): 810217001700040800000002F5B90F07 60114AFDE18383641880AB3DEDF0FA89 ...
19:41:13.912 > [RETRY] Attempt 1/3 (nonce: 2)
19:41:13.915 > POST http://10.249.92.115:8081/health-data with pipeline data
19:41:13.921 > Sending pipeline data to server (604 bytes)
19:41:14.175 > [HTTP] Response code: 200
19:41:14.175 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:41:14.189 > [RETRY] Health data sent successfully!
19:41:14.192 > ✓ Health data #2 sent successfully
19:41:14.294 > [WebSocket] Received (631 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:810217001700040800000002F5B90F0760114AFDE18383641880AB3DEDF0FA8940FFAA7D433F342E4DD86C95470A2EFD7AE00468EC9B73578F4027E3","pipeline":{"afterLFSR":"E0A8ECC6078EB19C73353BA210F83F04DDD3BDFB4CE2F27AABEECE56246638A3","afterSalt":"48522D36302053504F322D39352053544550532D3132364D50","afterTinkerbell":"AA9583073F433D8018D8834D2EFAE1B964EDAB89604A400F11F07D34FD6CFFF5","afterTransposition":"F5B90F0760114AFDE18383641880AB3DEDF0FA8940FFAA7D433F342E4DD86C95"},"plaintext":"HR-60 SPO2-95 STEPS-126","serverTime":1770300674017,"timestamp":25294,"type":"encryption_update","ztmEnabled":false}
19:41:14.349 > [WebSocket] Processing message type: encryption_update
19:41:14.354 > [25.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:14.456 > [WebSocket] Received (87 bytes): {"heartRate":60,"spo2":95,"steps":126,"time":1770300674018,"type":"health_data_update"}
19:41:14.464 > [WebSocket] Processing message type: health_data_update
19:41:14.471 > [25.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:14.579 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2708,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-126","handshakeSuccess":true,"totalTime":0.2708},"type":"session_summary_update"}
19:41:14.610 > [WebSocket] Processing message type: session_summary_update
19:41:14.610 > [26.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:14.711 > [WebSocket] Received (656 bytes): {"decryptionTime":0.2708,"encryptedPacket":"810217001700040800000002F5B90F0760114AFDE18383641880AB3DEDF0FA8940FFAA7D433F342E4DD86C95470A2EFD7AE00468EC9B73578F4027E3","finalPlaintext":"HR-60 SPO2-95 STEPS-126","healthData":{"heartRate":60,"spo2":95,"steps":126},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D31323600000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D3132364D5000000000000000","afterTinkerbell":"E0A8ECC6078EB19C73353BA210F83F04DDD3BDFB4CE2F27AABEECE56246638A3","afterTransposition":"AA9583073F433D8018D8834D2EFAE1B964EDAB89604A400F11F07D34FD6CFFF5"},"serverTime":1770300674019,"type":"decryption_update"}
19:41:14.769 > [WebSocket] Processing message type: decryption_update
19:41:14.775 > [WebSocket] Server decryption completed
19:41:14.778 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 126
19:41:14.784 > [26.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:14.885 > [WebSocket] Received (643 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":1,"pipeline":{"afterLFSR":"E0A8ECC6078EB19C73353BA210F83F04DDD3BDFB4CE2F27AABEECE56246638A3","afterSalt":"48522D36302053504F322D39352053544550532D3132364D50","afterTinkerbell":"AA9583073F433D8018D8834D2EFAE1B964EDAB89604A400F11F07D34FD6CFFF5","afterTransposition":"F5B90F0760114AFDE18383641880AB3DEDF0FA8940FFAA7D433F342E4DD86C95","finalPacket":"810217001700040800000002F5B90F0760114AFDE18383641880AB3DEDF0FA8940FFAA7D433F342E4DD86C95470A2EFD7AE00468EC9B73578F4027E3"},"plaintext":"HR-60 SPO2-95 STEPS-126","timestamp":25548,"type":"encryption_pipeline","ztmEnabled":false}
19:41:14.944 > [WebSocket] Processing message type: encryption_pipeline
19:41:14.946 > [26.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:15.048 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Health data #2 sent successfully","state":7,"success":true,"timestamp":25555,"type":"health_data_sent"}
19:41:15.064 > [WebSocket] Processing message type: health_data_sent
19:41:15.068 > [26.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:15.169 > [26.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:15.270 > [26.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:15.372 > [26.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:15.473 > [26.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:15.574 > [26.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:15.675 > [27.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:15.776 > [27.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:15.877 > [27.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:15.978 > [27.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:16.079 > [27.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:16.180 > [27.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:16.280 > [27.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:16.382 > [27.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:16.482 > [27.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:16.584 > [28.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:16.685 > [28.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:16.785 > [28.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:16.886 > [28.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:16.988 > [28.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:17.089 > [28.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:17.189 > [28.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:17.291 > [28.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:17.392 > [28.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:17.493 > [28.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:17.594 > [29.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:17.694 > [29.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:17.795 > [29.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:17.896 > [29.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:17.998 > [29.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:18.099 > [29.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:18.200 > [29.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:18.301 > [29.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:18.402 > [29.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:18.502 > [29.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:18.604 > [30.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:18.705 > [30.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:18.806 > [30.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:18.906 > [30.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:19.008 > [30.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:19.109 > [30.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:19.209 > [30.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:19.311 > [30.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:19.411 > [30.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:19.512 > [30.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:19.613 > [31.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:19.714 > [31.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:19.816 > [31.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:19.916 > [31.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:20.018 > [31.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:20.118 > [31.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:20.220 > [31.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:20.320 > [31.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:20.422 > [31.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:20.523 > [31.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:20.624 > [32.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:20.725 > [32.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:20.826 > [32.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:20.927 > [32.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:21.027 > [32.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:21.129 > [32.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:21.230 > [32.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:21.330 > [32.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:21.431 > [32.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:21.532 > [32.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:21.633 > [33.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:21.735 > [33.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:21.836 > [33.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:21.937 > [33.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:22.038 > [33.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:22.139 > [33.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:22.240 > [33.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:22.340 > [33.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:22.442 > [33.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:22.542 > [33.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:22.644 > [34.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:22.744 > [34.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:22.845 > [34.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:22.947 > [34.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:23.047 > [34.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:23.152 > [WebSocket] Received (492 bytes): {"activatedAt":1770300683115,"active":true,"epoch":1,"heuristics":{"cpuUsage":20.0,"decryptFailures":0,"entropy":7.5,"hmacFailures":0,"latency":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"lastCommitNonce":0,"lastSeenNonce":757,"lastSwitchReason":"ZTM activated - baseline recipe","message":"Zero Trust Mode activated successfully","pendingProposals":0,"recipe":"CHAOS_ONLY","serverTime":1770300683115,"success":true,"threatLevel":0,"type":"ztm_activation_acknowledged"}
19:41:23.196 > [WebSocket] Processing message type: ztm_activation_acknowledged
19:41:23.202 > [WebSocket] ========================================
19:41:23.207 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged, fromFrontend: NO)
19:41:23.214 > [WebSocket] ========================================
19:41:23.218 > [ZTM] Settings saved successfully
19:41:23.221 > [WebSocket] ✓ ZTM activated successfully
19:41:23.226 > [WebSocket] ✓ Normal Mode encryption STOPPED
19:41:23.230 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
19:41:23.235 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
19:41:23.237 > [WebSocket] ========================================
19:41:23.243 > [WebSocket] Received server ack - not sending duplicate ack (prevents loop)
19:41:23.252 > [34.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:23.355 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":34620,"type":"ztm_activated"}
19:41:23.371 > [WebSocket] Processing message type: ztm_activated
19:41:23.375 > [34.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:23.477 > [34.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:23.578 > [35.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:23.679 > [35.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:23.779 > [35.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:23.881 > [35.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:23.981 > [35.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:24.083 > [35.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:24.184 > [WebSocket] Received (313 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":757,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300684127,"threatLevel":0,"type":"heuristics_update"}
19:41:24.212 > [WebSocket] Processing message type: heuristics_update
19:41:24.218 > [35.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
19:41:24.226 > [RETRY] Attempting to send health data (Max retries: 3)
19:41:24.231 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:41:24.248 > Generated health data: HR-60 SPO2-95 STEPS-208
19:41:24.251 > [ESP32] ========================================
19:41:24.257 > [ESP32] ENCRYPTION PIPELINE START
19:41:24.259 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:41:24.264 > [ESP32] Active Algorithms for this packet:
19:41:24.268 > [ESP32]   + LFSR
19:41:24.268 > [ESP32]   + Tinkerbell
19:41:24.270 > [ESP32]   + Transposition
19:41:24.273 > [ESP32]   - ChaCha20
19:41:24.276 > [ESP32]   - Salsa20
19:41:24.276 > [ESP32] ========================================
19:41:24.282 > [ESP32] MsgKeys: lfsrSeed=0x78FC9D83 tnk[0..3]=ABC4042E trn[0..3]=05ABC052
19:41:24.287 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3230384D50
19:41:24.292 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3230384D5000000000000000 
19:41:24.301 > [ESP32][LFSR] Initializing - Seed: 0x78FC9D83 SeedBe: 0x839DFC78 ChaosKey[0..3]: ABC4042E InitialTap: 0x0029 State: 0x78FC9D83
19:41:24.312 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:41:24.321 > 3_After_LFSR (32): CBCFD14E4B6D132F88C269370F34B449 9E95F36CC2A29664740535F7FF0B65BC 
19:41:24.329 > [ESP32][LFSR] Keystream (first 16 bytes): 839DFC787B4D407FC7F0440E3A14E71D
19:41:24.334 > [ESP32][4D] LFSR keystream (first 32 bytes): 839DFC787B4D407FC7F0440E3A14E71DDBC5A041F092AE29240535F7FF0B65BC
19:41:24.345 > [ESP32][TINKERBELL] Input (first 16 bytes): CBCFD14E4B6D132F88C269370F34B449 Nonce: 0x00000003 Buffer size: 32 bytes
19:41:24.354 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: ABC4042E
19:41:24.364 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 36E03AA95015626079296378EFB5DD69
19:41:24.373 > 4_After_Tinkerbell (32): FD2FEBE71B78714FF1EB0A4FE0816920 7C6B7BBBA00A36D597D3F8A4DF3BB012 
19:41:24.381 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 36E03AA95015626079296378EFB5DD69
19:41:24.389 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 36E03AA95015626079296378EFB5DD69E2FE88D762A8A0B1E3D6CD532030D5AE
19:41:24.398 > 5_After_Transposition (32): 3BA0E0EBA4EBBBDFB0F8D56B699736E7 81D3787B4F124F1B2F0AFD0A7C71F120 
19:41:24.406 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000003
19:41:24.412 > [ESP32] === HMAC DEBUG INFO ===
19:41:24.415 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:41:24.423 > [ESP32] HMAC Input length: 45 bytes
19:41:24.426 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000033BA0E0EBA4EBBBDFB0F8D56B699736E781D378
19:41:24.434 > [ESP32] Nonce: 0x00000003
19:41:24.437 > [ESP32] Packet size before HMAC: 61
19:41:24.440 > [ESP32] Computed HMAC Tag: A0E5095E0D9CE226CD4B39F4931D86BC
19:41:24.445 > [ESP32] === END HMAC DEBUG ===
19:41:24.448 > 6_Final_Packet (61): 820217001700040804000000033BA0E0 EBA4EBBBDFB0F8D56B699736E781D378 ...
19:41:24.457 > [RETRY] Attempt 1/3 (nonce: 3)
19:41:24.459 > POST http://10.249.92.115:8081/health-data with pipeline data
19:41:24.464 > Sending pipeline data to server (605 bytes)
19:41:24.734 > [HTTP] Response code: 200
19:41:24.735 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:41:24.746 > [RETRY] Health data sent successfully!
19:41:24.748 > ✓ Health data #3 sent successfully
19:41:24.851 > [WebSocket] Received (632 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820217001700040804000000033BA0E0EBA4EBBBDFB0F8D56B699736E781D3787B4F124F1B2F0AFD0A7C71F120A0E5095E0D9CE226CD4B39F4931D86BC","pipeline":{"afterLFSR":"CBCFD14E4B6D132F88C269370F34B4499E95F36CC2A29664740535F7FF0B65BC","afterSalt":"48522D36302053504F322D39352053544550532D3230384D50","afterTinkerbell":"FD2FEBE71B78714FF1EB0A4FE08169207C6B7BBBA00A36D597D3F8A4DF3BB012","afterTransposition":"3BA0E0EBA4EBBBDFB0F8D56B699736E781D3787B4F124F1B2F0AFD0A7C71F120"},"plaintext":"HR-60 SPO2-95 STEPS-208","serverTime":1770300684553,"timestamp":35837,"type":"encryption_update","ztmEnabled":true}
19:41:24.914 > [WebSocket] Processing message type: encryption_update
19:41:24.914 > [36.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:25.015 > [WebSocket] Received (87 bytes): {"heartRate":60,"spo2":95,"steps":208,"time":1770300684553,"type":"health_data_update"}
19:41:25.023 > [WebSocket] Processing message type: health_data_update
19:41:25.029 > [36.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:25.137 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3177,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-208","handshakeSuccess":true,"totalTime":0.3177},"type":"session_summary_update"}
19:41:25.159 > [WebSocket] Processing message type: session_summary_update
19:41:25.164 > [36.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:25.270 > [WebSocket] Received (658 bytes): {"decryptionTime":0.3177,"encryptedPacket":"820217001700040804000000033BA0E0EBA4EBBBDFB0F8D56B699736E781D3787B4F124F1B2F0AFD0A7C71F120A0E5095E0D9CE226CD4B39F4931D86BC","finalPlaintext":"HR-60 SPO2-95 STEPS-208","healthData":{"heartRate":60,"spo2":95,"steps":208},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D32303800000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D3230384D5000000000000000","afterTinkerbell":"CBCFD14E4B6D132F88C269370F34B4499E95F36CC2A29664740535F7FF0B65BC","afterTransposition":"FD2FEBE71B78714FF1EB0A4FE08169207C6B7BBBA00A36D597D3F8A4DF3BB012"},"serverTime":1770300684554,"type":"decryption_update"}
19:41:25.329 > [WebSocket] Processing message type: decryption_update
19:41:25.342 > [WebSocket] Server decryption completed
19:41:25.342 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 208
19:41:25.346 > [36.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:25.443 > [WebSocket] Received (644 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":2,"pipeline":{"afterLFSR":"CBCFD14E4B6D132F88C269370F34B4499E95F36CC2A29664740535F7FF0B65BC","afterSalt":"48522D36302053504F322D39352053544550532D3230384D50","afterTinkerbell":"FD2FEBE71B78714FF1EB0A4FE08169207C6B7BBBA00A36D597D3F8A4DF3BB012","afterTransposition":"3BA0E0EBA4EBBBDFB0F8D56B699736E781D3787B4F124F1B2F0AFD0A7C71F120","finalPacket":"820217001700040804000000033BA0E0EBA4EBBBDFB0F8D56B699736E781D3787B4F124F1B2F0AFD0A7C71F120A0E5095E0D9CE226CD4B39F4931D86BC"},"plaintext":"HR-60 SPO2-95 STEPS-208","timestamp":36109,"type":"encryption_pipeline","ztmEnabled":true}
19:41:25.501 > [WebSocket] Processing message type: encryption_pipeline
19:41:25.506 > [36.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:25.606 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Health data #3 sent successfully","state":7,"success":true,"timestamp":36114,"type":"health_data_sent"}
19:41:25.622 > [WebSocket] Processing message type: health_data_sent
19:41:25.625 > [37.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:25.728 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300685137,"threatLevel":0,"type":"heuristics_update"}
19:41:25.756 > [WebSocket] Processing message type: heuristics_update
19:41:25.762 > [37.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:25.871 > [37.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:25.971 > [37.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:26.072 > [37.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:26.176 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300686147,"threatLevel":0,"type":"heuristics_update"}
19:41:26.205 > [WebSocket] Processing message type: heuristics_update
19:41:26.210 > [37.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:26.318 > [37.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:26.420 > [37.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:26.520 > [37.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:26.621 > [38.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:26.723 > [38.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:26.824 > [38.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:26.925 > [38.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:27.026 > [38.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:27.126 > [38.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:27.228 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300687159,"threatLevel":0,"type":"heuristics_update"}
19:41:27.256 > [WebSocket] Processing message type: heuristics_update
19:41:27.261 > [38.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:27.371 > [38.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:27.472 > [38.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:27.573 > [38.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:27.674 > [39.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:27.774 > [39.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:27.876 > [39.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:27.976 > [39.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:28.078 > [39.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:28.180 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300688161,"threatLevel":0,"type":"heuristics_update"}
19:41:28.207 > [WebSocket] Processing message type: heuristics_update
19:41:28.212 > [39.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:28.312 > [39.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:28.412 > [39.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:28.514 > [39.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:28.615 > [40.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:28.715 > [40.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:28.816 > [40.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:28.917 > [40.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:29.019 > [40.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:29.119 > [40.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:29.221 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300689174,"threatLevel":0,"type":"heuristics_update"}
19:41:29.249 > [WebSocket] Processing message type: heuristics_update
19:41:29.254 > [40.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:29.364 > [40.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:29.465 > [40.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:29.564 > [40.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:29.667 > [41.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:29.767 > [41.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:29.868 > [41.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:29.970 > [41.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:30.071 > [41.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:30.171 > [41.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:30.273 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300690184,"threatLevel":0,"type":"heuristics_update"}
19:41:30.301 > [WebSocket] Processing message type: heuristics_update
19:41:30.306 > [41.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:30.416 > [41.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:30.516 > [41.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:30.618 > [42.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:30.719 > [42.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:30.820 > [42.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:30.921 > [42.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:31.022 > [42.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:31.123 > [42.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:31.226 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300691190,"threatLevel":0,"type":"heuristics_update"}
19:41:31.254 > [WebSocket] Processing message type: heuristics_update
19:41:31.259 > [42.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:31.368 > [42.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:31.470 > [42.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:31.571 > [42.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:31.671 > [43.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:31.772 > [43.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:31.874 > [43.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:31.974 > [43.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:32.075 > [43.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:32.176 > [43.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:32.278 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300692201,"threatLevel":0,"type":"heuristics_update"}
19:41:32.306 > [WebSocket] Processing message type: heuristics_update
19:41:32.311 > [43.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:32.420 > [43.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:32.522 > [43.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:32.622 > [44.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:32.722 > [44.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:32.824 > [44.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:32.926 > [44.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:33.026 > [44.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:33.127 > [44.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:33.228 > [44.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:33.330 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300693211,"threatLevel":0,"type":"heuristics_update"}
19:41:33.358 > [WebSocket] Processing message type: heuristics_update
19:41:33.363 > [44.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:33.473 > [44.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:33.573 > [44.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:33.674 > [45.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:33.776 > [45.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:33.876 > [45.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:33.978 > [45.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:34.078 > [45.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:34.179 > [45.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:34.281 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300694212,"threatLevel":0,"type":"heuristics_update"}
19:41:34.309 > [WebSocket] Processing message type: heuristics_update
19:41:34.314 > [45.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:34.413 > [45.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:34.514 > [45.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:34.615 > [46.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:34.716 > [46.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:34.817 > [46.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
19:41:34.823 > [RETRY] Attempting to send health data (Max retries: 3)
19:41:34.828 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 4 for all retry attempts (saved: 3)
19:41:34.844 > Generated health data: HR-60 SPO2-95 STEPS-257
19:41:34.847 > [ESP32] ========================================
19:41:34.853 > [ESP32] ENCRYPTION PIPELINE START
19:41:34.856 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:41:34.861 > [ESP32] Active Algorithms for this packet:
19:41:34.864 > [ESP32]   + LFSR
19:41:34.867 > [ESP32]   + Tinkerbell
19:41:34.870 > [ESP32]   + Transposition
19:41:34.870 > [ESP32]   - ChaCha20
19:41:34.896 > [ESP32]   - Salsa20
19:41:34.896 > [ESP32] ========================================
19:41:34.896 > [ESP32] MsgKeys: lfsrSeed=0x4A6A70E1 tnk[0..3]=7B88BB4F trn[0..3]=1075AAA3
19:41:34.896 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3235374D50
19:41:34.896 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3235374D5000000000000000 
19:41:34.906 > [ESP32][LFSR] Initializing - Seed: 0x4A6A70E1 SeedBe: 0xE1706A4A ChaosKey[0..3]: 7B88BB4F InitialTap: 0x0029 State: 0x4A6A70E1
19:41:34.914 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:41:34.920 > 3_After_LFSR (32): A922477CAB55CB1BC1EBF719324B1965 66564E2A4988DC88A69452F2353A88CD 
19:41:34.925 > [ESP32][LFSR] Keystream (first 16 bytes): E1706A4A9B75984B8ED9DA20076B4A31
19:41:34.934 > [ESP32][4D] LFSR keystream (first 32 bytes): E1706A4A9B75984B8ED9DA20076B4A3123061D077BBDEBC5F69452F2353A88CD
19:41:34.943 > [ESP32][TINKERBELL] Input (first 16 bytes): A922477CAB55CB1BC1EBF719324B1965 Nonce: 0x00000004 Buffer size: 32 bytes
19:41:34.954 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000004 Counter: 0 (must start at 0) Key[0..3]: 7B88BB4F
19:41:34.962 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 040AE574B8F5F5CFF84551BEBE5EC07B
19:41:34.970 > 4_After_Tinkerbell (32): AD28A20813A03ED439AEA6A78C15D91E C7FD4D4F5287A9D3EC2F72482C1C2A13 
19:41:34.978 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 040AE574B8F5F5CFF84551BEBE5EC07B
19:41:34.986 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 040AE574B8F5F5CFF84551BEBE5EC07BA1AB03651B0F755B4ABB20BA1926A2DE
19:41:34.998 > 5_After_Transposition (32): D4A27213A9EC1E39A6D387153E4D2C48 08C71C8CAE13A72FA0FDD9AD524F2A28 
19:41:35.006 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000004
19:41:35.009 > [ESP32] === HMAC DEBUG INFO ===
19:41:35.012 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:41:35.020 > [ESP32] HMAC Input length: 45 bytes
19:41:35.023 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000004D4A27213A9EC1E39A6D387153E4D2C4808C71C
19:41:35.034 > [ESP32] Nonce: 0x00000004
19:41:35.034 > [ESP32] Packet size before HMAC: 61
19:41:35.039 > [ESP32] Computed HMAC Tag: 24F6E5B84F9A7F1B175BEEB0BC326D0C
19:41:35.042 > [ESP32] === END HMAC DEBUG ===
19:41:35.045 > 6_Final_Packet (61): 82021700170004080400000004D4A272 13A9EC1E39A6D387153E4D2C4808C71C ...
19:41:35.053 > [RETRY] Attempt 1/3 (nonce: 4)
19:41:35.056 > POST http://10.249.92.115:8081/health-data with pipeline data
19:41:35.062 > Sending pipeline data to server (605 bytes)
19:41:35.211 > [HTTP] Response code: 200
19:41:35.211 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:41:35.222 > [RETRY] Health data sent successfully!
19:41:35.225 > ✓ Health data #4 sent successfully
19:41:35.326 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":4,"serverTime":1770300695180,"type":"security_update"}
19:41:35.343 > [WebSocket] Processing message type: security_update
19:41:35.349 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:41:35.354 > [46.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:35.459 > [WebSocket] Received (632 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:82021700170004080400000004D4A27213A9EC1E39A6D387153E4D2C4808C71C8CAE13A72FA0FDD9AD524F2A2824F6E5B84F9A7F1B175BEEB0BC326D0C","pipeline":{"afterLFSR":"A922477CAB55CB1BC1EBF719324B196566564E2A4988DC88A69452F2353A88CD","afterSalt":"48522D36302053504F322D39352053544550532D3235374D50","afterTinkerbell":"AD28A20813A03ED439AEA6A78C15D91EC7FD4D4F5287A9D3EC2F72482C1C2A13","afterTransposition":"D4A27213A9EC1E39A6D387153E4D2C4808C71C8CAE13A72FA0FDD9AD524F2A28"},"plaintext":"HR-60 SPO2-95 STEPS-257","serverTime":1770300695180,"timestamp":46428,"type":"encryption_update","ztmEnabled":true}
19:41:35.515 > [WebSocket] Processing message type: encryption_update
19:41:35.521 > [46.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:35.623 > [WebSocket] Received (87 bytes): {"heartRate":60,"spo2":95,"steps":257,"time":1770300695180,"type":"health_data_update"}
19:41:35.630 > [WebSocket] Processing message type: health_data_update
19:41:35.636 > [47.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:35.744 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2543,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-257","handshakeSuccess":true,"totalTime":0.2543},"type":"session_summary_update"}
19:41:35.766 > [WebSocket] Processing message type: session_summary_update
19:41:35.772 > [47.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:35.877 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2543,"encryptedPacket":"82021700170004080400000004D4A27213A9EC1E39A6D387153E4D2C4808C71C8CAE13A72FA0FDD9AD524F2A2824F6E5B84F9A7F1B175BEEB0BC326D0C","finalPlaintext":"HR-60 SPO2-95 STEPS-257","healthData":{"heartRate":60,"spo2":95,"steps":257},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D32353700000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D3235374D5000000000000000","afterTinkerbell":"A922477CAB55CB1BC1EBF719324B196566564E2A4988DC88A69452F2353A88CD","afterTransposition":"AD28A20813A03ED439AEA6A78C15D91EC7FD4D4F5287A9D3EC2F72482C1C2A13"},"serverTime":1770300695181,"type":"decryption_update"}
19:41:35.935 > [WebSocket] Processing message type: decryption_update
19:41:35.941 > [WebSocket] Server decryption completed
19:41:35.944 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 257
19:41:35.949 > [47.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:36.050 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300695227,"threatLevel":0,"type":"heuristics_update"}
19:41:36.078 > [WebSocket] Processing message type: heuristics_update
19:41:36.084 > [47.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:36.193 > [WebSocket] Received (644 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":3,"pipeline":{"afterLFSR":"A922477CAB55CB1BC1EBF719324B196566564E2A4988DC88A69452F2353A88CD","afterSalt":"48522D36302053504F322D39352053544550532D3235374D50","afterTinkerbell":"AD28A20813A03ED439AEA6A78C15D91EC7FD4D4F5287A9D3EC2F72482C1C2A13","afterTransposition":"D4A27213A9EC1E39A6D387153E4D2C4808C71C8CAE13A72FA0FDD9AD524F2A28","finalPacket":"82021700170004080400000004D4A27213A9EC1E39A6D387153E4D2C4808C71C8CAE13A72FA0FDD9AD524F2A2824F6E5B84F9A7F1B175BEEB0BC326D0C"},"plaintext":"HR-60 SPO2-95 STEPS-257","timestamp":46586,"type":"encryption_pipeline","ztmEnabled":true}
19:41:36.251 > [WebSocket] Processing message type: encryption_pipeline
19:41:36.258 > [47.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:36.359 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Health data #4 sent successfully","state":7,"success":true,"timestamp":46590,"type":"health_data_sent"}
19:41:36.376 > [WebSocket] Processing message type: health_data_sent
19:41:36.379 > [47.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:36.482 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300696240,"threatLevel":0,"type":"heuristics_update"}
19:41:36.509 > [WebSocket] Processing message type: heuristics_update
19:41:36.514 > [47.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:36.624 > [48.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:36.725 > [48.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:36.826 > [48.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:36.927 > [48.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:37.028 > [48.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:37.129 > [48.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:37.230 > [48.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:37.332 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300697250,"threatLevel":0,"type":"heuristics_update"}
19:41:37.359 > [WebSocket] Processing message type: heuristics_update
19:41:37.365 > [48.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:37.475 > [48.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:37.575 > [48.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:37.676 > [49.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:37.777 > [49.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:37.878 > [49.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:37.979 > [49.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:38.080 > [49.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:38.182 > [49.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:38.282 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300698265,"threatLevel":0,"type":"heuristics_update"}
19:41:38.311 > [WebSocket] Processing message type: heuristics_update
19:41:38.316 > [49.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:38.415 > [49.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:38.516 > [49.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:38.617 > [50.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:38.718 > [50.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:38.819 > [50.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:38.920 > [50.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:39.021 > [50.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:39.122 > [50.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:39.224 > [50.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:39.325 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300699277,"threatLevel":0,"type":"heuristics_update"}
19:41:39.352 > [WebSocket] Processing message type: heuristics_update
19:41:39.358 > [50.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:39.467 > [50.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:39.568 > [50.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:39.669 > [51.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:39.770 > [51.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:39.872 > [51.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:39.972 > [51.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:40.073 > [51.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:40.173 > [51.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:40.275 > [51.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:40.376 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300700286,"threatLevel":0,"type":"heuristics_update"}
19:41:40.405 > [WebSocket] Processing message type: heuristics_update
19:41:40.410 > [51.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:40.519 > [51.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:40.621 > [52.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:40.721 > [52.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:40.822 > [52.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:40.923 > [52.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:41.024 > [52.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:41.125 > [52.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:41.226 > [52.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:41.330 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300701295,"threatLevel":0,"type":"heuristics_update"}
19:41:41.358 > [WebSocket] Processing message type: heuristics_update
19:41:41.363 > [52.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:41.472 > [52.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:41.573 > [52.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:41.674 > [53.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:41.775 > [53.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:41.876 > [53.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:41.977 > [53.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:42.078 > [53.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:42.179 > [53.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:42.280 > [53.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:42.381 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300702304,"threatLevel":0,"type":"heuristics_update"}
19:41:42.409 > [WebSocket] Processing message type: heuristics_update
19:41:42.415 > [53.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:42.515 > [53.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:42.615 > [54.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:42.716 > [54.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:42.817 > [54.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:42.918 > [54.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:43.019 > [54.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:43.120 > [54.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:43.221 > [54.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:43.322 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300703308,"threatLevel":0,"type":"heuristics_update"}
19:41:43.351 > [WebSocket] Processing message type: heuristics_update
19:41:43.356 > [54.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:43.464 > [54.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:43.566 > [54.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:43.667 > [55.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:43.768 > [55.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:43.869 > [55.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:43.969 > [55.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:44.071 > [55.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:44.171 > [55.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:44.273 > [55.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:44.374 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300704321,"threatLevel":0,"type":"heuristics_update"}
19:41:44.402 > [WebSocket] Processing message type: heuristics_update
19:41:44.408 > [55.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:44.517 > [55.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:44.618 > [56.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:44.719 > [56.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:44.820 > [56.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:44.921 > [56.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:45.022 > [56.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:45.122 > [56.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:45.224 > [56.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
19:41:45.229 > [RETRY] Attempting to send health data (Max retries: 3)
19:41:45.235 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 5 for all retry attempts (saved: 4)
19:41:45.251 > Generated health data: HR-60 SPO2-95 STEPS-313
19:41:45.254 > [ESP32] ========================================
19:41:45.259 > [ESP32] ENCRYPTION PIPELINE START
19:41:45.263 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:41:45.268 > [ESP32] Active Algorithms for this packet:
19:41:45.271 > [ESP32]   + LFSR
19:41:45.274 > [ESP32]   + Tinkerbell
19:41:45.277 > [ESP32]   + Transposition
19:41:45.277 > [ESP32]   - ChaCha20
19:41:45.279 > [ESP32]   - Salsa20
19:41:45.282 > [ESP32] ========================================
19:41:45.285 > [ESP32] MsgKeys: lfsrSeed=0xDE660499 tnk[0..3]=13E5153A trn[0..3]=FC77A90D
19:41:45.294 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3331334D50
19:41:45.299 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3331334D5000000000000000 
19:41:45.308 > [ESP32][LFSR] Initializing - Seed: 0xDE660499 SeedBe: 0x990466DE ChaosKey[0..3]: 13E5153A InitialTap: 0x0029 State: 0xDE660499
19:41:45.318 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
19:41:45.326 > 3_After_LFSR (32): D1564BE88970DB8C9EF6569C87D0D243 8E99944A53BFC44A372E39DA18523228 
19:41:45.332 > [ESP32][LFSR] Keystream (first 16 bytes): 990466DEB95088DCD1C47BA5B2F08117
19:41:45.340 > [ESP32][4D] LFSR keystream (first 32 bytes): 990466DEB95088DCD1C47BA5B2F08117CBC9C767608EF707672E39DA18523228
19:41:45.349 > [ESP32][TINKERBELL] Input (first 16 bytes): D1564BE88970DB8C9EF6569C87D0D243 Nonce: 0x00000005 Buffer size: 32 bytes
19:41:45.360 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000005 Counter: 0 (must start at 0) Key[0..3]: 13E5153A
19:41:45.368 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): F04DD208C2E8F00638F4CDC9FAF97FE3
19:41:45.377 > 4_After_Tinkerbell (32): 211B99E04B982B8AA6029B557D29ADA0 973CEC1945F4B258283002364EFF05DF 
19:41:45.385 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): F04DD208C2E8F00638F4CDC9FAF97FE3
19:41:45.393 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): F04DD208C2E8F00638F4CDC9FAF97FE319A57853164B76121F1E3BEC56AD37F7
19:41:45.404 > 5_After_Transposition (32): 308A9736ECA6E0A05829DF9B454B7D28 AD1B2199FFB29855F4193C052B024E02 
19:41:45.413 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000005
19:41:45.416 > [ESP32] === HMAC DEBUG INFO ===
19:41:45.419 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:41:45.427 > [ESP32] HMAC Input length: 45 bytes
19:41:45.429 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000005308A9736ECA6E0A05829DF9B454B7D28AD1B21
19:41:45.441 > [ESP32] Nonce: 0x00000005
19:41:45.441 > [ESP32] Packet size before HMAC: 61
19:41:45.446 > [ESP32] Computed HMAC Tag: 48F4F33B2523FAACDFD5D89A70DDB8D1
19:41:45.449 > [ESP32] === END HMAC DEBUG ===
19:41:45.452 > 6_Final_Packet (61): 82021700170004080400000005308A97 36ECA6E0A05829DF9B454B7D28AD1B21 ...
19:41:45.460 > [RETRY] Attempt 1/3 (nonce: 5)
19:41:45.463 > POST http://10.249.92.115:8081/health-data with pipeline data
19:41:45.468 > Sending pipeline data to server (605 bytes)
19:41:45.753 > [HTTP] Response code: 200
19:41:45.754 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:41:45.766 > [RETRY] Health data sent successfully!
19:41:45.768 > ✓ Health data #5 sent successfully
19:41:45.870 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300705327,"threatLevel":0,"type":"heuristics_update"}
19:41:45.928 > [WebSocket] Processing message type: heuristics_update
19:41:45.928 > [57.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:46.003 > [WebSocket] Received (632 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:82021700170004080400000005308A9736ECA6E0A05829DF9B454B7D28AD1B2199FFB29855F4193C052B024E0248F4F33B2523FAACDFD5D89A70DDB8D1","pipeline":{"afterLFSR":"D1564BE88970DB8C9EF6569C87D0D2438E99944A53BFC44A372E39DA18523228","afterSalt":"48522D36302053504F322D39352053544550532D3331334D50","afterTinkerbell":"211B99E04B982B8AA6029B557D29ADA0973CEC1945F4B258283002364EFF05DF","afterTransposition":"308A9736ECA6E0A05829DF9B454B7D28AD1B2199FFB29855F4193C052B024E02"},"plaintext":"HR-60 SPO2-95 STEPS-313","serverTime":1770300705571,"timestamp":56835,"type":"encryption_update","ztmEnabled":true}
19:41:46.059 > [WebSocket] Processing message type: encryption_update
19:41:46.064 > [57.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:46.166 > [WebSocket] Received (87 bytes): {"heartRate":60,"spo2":95,"steps":313,"time":1770300705571,"type":"health_data_update"}
19:41:46.174 > [WebSocket] Processing message type: health_data_update
19:41:46.180 > [57.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:46.288 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2825,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-313","handshakeSuccess":true,"totalTime":0.2825},"type":"session_summary_update"}
19:41:46.310 > [WebSocket] Processing message type: session_summary_update
19:41:46.316 > [57.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:46.420 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2825,"encryptedPacket":"82021700170004080400000005308A9736ECA6E0A05829DF9B454B7D28AD1B2199FFB29855F4193C052B024E0248F4F33B2523FAACDFD5D89A70DDB8D1","finalPlaintext":"HR-60 SPO2-95 STEPS-313","healthData":{"heartRate":60,"spo2":95,"steps":313},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D33313300000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D3331334D5000000000000000","afterTinkerbell":"D1564BE88970DB8C9EF6569C87D0D2438E99944A53BFC44A372E39DA18523228","afterTransposition":"211B99E04B982B8AA6029B557D29ADA0973CEC1945F4B258283002364EFF05DF"},"serverTime":1770300705572,"type":"decryption_update"}
19:41:46.479 > [WebSocket] Processing message type: decryption_update
19:41:46.484 > [WebSocket] Server decryption completed
19:41:46.487 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 313
19:41:46.493 > [57.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:46.594 > [WebSocket] Received (644 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":4,"pipeline":{"afterLFSR":"D1564BE88970DB8C9EF6569C87D0D2438E99944A53BFC44A372E39DA18523228","afterSalt":"48522D36302053504F322D39352053544550532D3331334D50","afterTinkerbell":"211B99E04B982B8AA6029B557D29ADA0973CEC1945F4B258283002364EFF05DF","afterTransposition":"308A9736ECA6E0A05829DF9B454B7D28AD1B2199FFB29855F4193C052B024E02","finalPacket":"82021700170004080400000005308A9736ECA6E0A05829DF9B454B7D28AD1B2199FFB29855F4193C052B024E0248F4F33B2523FAACDFD5D89A70DDB8D1"},"plaintext":"HR-60 SPO2-95 STEPS-313","timestamp":57129,"type":"encryption_pipeline","ztmEnabled":true}
19:41:46.652 > [WebSocket] Processing message type: encryption_pipeline
19:41:46.658 > [58.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:46.756 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Health data #5 sent successfully","state":7,"success":true,"timestamp":57133,"type":"health_data_sent"}
19:41:46.774 > [WebSocket] Processing message type: health_data_sent
19:41:46.776 > [58.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:46.880 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300706338,"threatLevel":0,"type":"heuristics_update"}
19:41:46.907 > [WebSocket] Processing message type: heuristics_update
19:41:46.912 > [58.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:47.022 > [58.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:47.122 > [58.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:47.224 > [58.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:47.325 > [58.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:47.426 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300707344,"threatLevel":0,"type":"heuristics_update"}
19:41:47.454 > [WebSocket] Processing message type: heuristics_update
19:41:47.460 > [58.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:47.569 > [58.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:47.670 > [59.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:47.771 > [59.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:47.872 > [59.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:47.972 > [59.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:48.073 > [59.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:48.175 > [59.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:48.276 > [59.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:48.378 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300708351,"threatLevel":0,"type":"heuristics_update"}
19:41:48.406 > [WebSocket] Processing message type: heuristics_update
19:41:48.410 > [59.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:48.520 > [59.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:48.620 > [60.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:48.722 > [60.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:48.823 > [60.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:48.924 > [60.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:49.025 > [60.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:49.125 > [60.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:49.227 > [60.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:49.328 > [60.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:49.430 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300709360,"threatLevel":0,"type":"heuristics_update"}
19:41:49.456 > [WebSocket] Processing message type: heuristics_update
19:41:49.463 > [60.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:49.572 > [60.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:49.672 > [61.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:49.775 > [61.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:49.875 > [61.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:49.975 > [61.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:50.077 > [61.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:50.178 > [61.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:50.279 > [61.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:50.382 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300710367,"threatLevel":0,"type":"heuristics_update"}
19:41:50.410 > [WebSocket] Processing message type: heuristics_update
19:41:50.416 > [61.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:50.514 > [61.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:50.616 > [62.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:50.717 > [62.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:50.818 > [62.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:50.919 > [62.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:51.019 > [62.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:51.120 > [62.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:51.222 > [62.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:51.323 > [62.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:51.424 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300711375,"threatLevel":0,"type":"heuristics_update"}
19:41:51.452 > [WebSocket] Processing message type: heuristics_update
19:41:51.458 > [62.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:51.566 > [62.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:51.667 > [63.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:51.769 > [63.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:51.870 > [63.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:51.970 > [63.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:52.072 > [63.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:52.173 > [63.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:52.274 > [63.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:52.375 > [63.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:52.476 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300712387,"threatLevel":0,"type":"heuristics_update"}
19:41:52.504 > [WebSocket] Processing message type: heuristics_update
19:41:52.510 > [63.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:52.619 > [64.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:52.720 > [64.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:52.821 > [64.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:52.922 > [64.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:53.023 > [64.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:53.123 > [64.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:53.225 > [64.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:53.325 > [64.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:53.428 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300713401,"threatLevel":0,"type":"heuristics_update"}
19:41:53.455 > [WebSocket] Processing message type: heuristics_update
19:41:53.461 > [64.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:53.570 > [64.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:53.670 > [65.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:53.772 > [65.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:53.873 > [65.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:53.973 > [65.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:54.074 > [65.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:54.175 > [65.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:54.276 > [65.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:54.378 > [65.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:54.479 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300714414,"threatLevel":0,"type":"heuristics_update"}
19:41:54.507 > [WebSocket] Processing message type: heuristics_update
19:41:54.513 > [65.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:54.612 > [66.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:54.712 > [66.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:54.813 > [66.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:54.915 > [66.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:55.016 > [66.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:55.117 > [66.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:55.218 > [66.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:55.319 > [66.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:55.420 > [66.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:55.523 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300715427,"threatLevel":0,"type":"heuristics_update"}
19:41:55.550 > [WebSocket] Processing message type: heuristics_update
19:41:55.556 > [66.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:55.666 > [67.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:55.766 > [67.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
19:41:55.772 > [RETRY] Attempting to send health data (Max retries: 3)
19:41:55.778 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 6 for all retry attempts (saved: 5)
19:41:55.794 > Generated health data: HR-61 SPO2-95 STEPS-335
19:41:55.797 > [ESP32] ========================================
19:41:55.803 > [ESP32] ENCRYPTION PIPELINE START
19:41:55.806 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:41:55.810 > [ESP32] Active Algorithms for this packet:
19:41:55.814 > [ESP32]   + LFSR
19:41:55.816 > [ESP32]   + Tinkerbell
19:41:55.819 > [ESP32]   + Transposition
19:41:55.819 > [ESP32]   - ChaCha20
19:41:55.822 > [ESP32]   - Salsa20
19:41:55.825 > [ESP32] ========================================
19:41:55.827 > [ESP32] MsgKeys: lfsrSeed=0x882EB047 tnk[0..3]=62326D1A trn[0..3]=5CCD94DE
19:41:55.836 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3333354D50
19:41:55.841 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3333354D5000000000000000 
19:41:55.849 > [ESP32][LFSR] Initializing - Seed: 0x882EB047 SeedBe: 0x47B02E88 ChaosKey[0..3]: 62326D1A InitialTap: 0x0029 State: 0x882EB047
19:41:55.861 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:41:55.869 > 3_After_LFSR (32): 0FE203BEB95DA0244E0515CABA3A06C4 1F0F56C3B9267EBDD94FD60853C8083D 
19:41:55.875 > [ESP32][LFSR] Keystream (first 16 bytes): 47B02E88887DF374013738F38F1A5590
19:41:55.883 > [ESP32][4D] LFSR keystream (first 32 bytes): 47B02E88887DF374013738F38F1A55905A5F05EE8A154BF0894FD60853C8083D
19:41:55.892 > [ESP32][TINKERBELL] Input (first 16 bytes): 0FE203BEB95DA0244E0515CABA3A06C4 Nonce: 0x00000006 Buffer size: 32 bytes
19:41:55.902 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000006 Counter: 0 (must start at 0) Key[0..3]: 62326D1A
19:41:55.911 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 437D1FC21ACCBFB10B9A7E73430BCA38
19:41:55.920 > 4_After_Tinkerbell (32): 4C9F1C7CA3911F95459F6BB9F931CCFC 15ACA431239279B557852375A4895AF8 
19:41:55.927 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 437D1FC21ACCBFB10B9A7E73430BCA38
19:41:55.936 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 437D1FC21ACCBFB10B9A7E73430BCA380AA3F2F29AB407088ECAF57DF74152C5
19:41:55.947 > 5_After_Transposition (32): 89B9AC3123A4759FF94C796B571C4585 F89295CC159F91A3B5A45A23FC1F7C31 
19:41:55.956 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000006
19:41:55.958 > [ESP32] === HMAC DEBUG INFO ===
19:41:55.961 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:41:55.969 > [ESP32] HMAC Input length: 45 bytes
19:41:55.972 > [ESP32] HMAC Input (first 32 bytes): 8202170017000408040000000689B9AC3123A4759FF94C796B571C4585F89295
19:41:55.983 > [ESP32] Nonce: 0x00000006
19:41:55.983 > [ESP32] Packet size before HMAC: 61
19:41:55.989 > [ESP32] Computed HMAC Tag: 53E842E0A4EB5106C00D16C56E18E2CE
19:41:55.992 > [ESP32] === END HMAC DEBUG ===
19:41:55.995 > 6_Final_Packet (61): 8202170017000408040000000689B9AC 3123A4759FF94C796B571C4585F89295 ...
19:41:56.002 > [RETRY] Attempt 1/3 (nonce: 6)
19:41:56.004 > POST http://10.249.92.115:8081/health-data with pipeline data
19:41:56.011 > Sending pipeline data to server (605 bytes)
19:41:56.271 > [HTTP] Response code: 200
19:41:56.271 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:41:56.285 > [RETRY] Health data sent successfully!
19:41:56.288 > ✓ Health data #6 sent successfully
19:41:56.387 > [WebSocket] Received (632 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:8202170017000408040000000689B9AC3123A4759FF94C796B571C4585F89295CC159F91A3B5A45A23FC1F7C3153E842E0A4EB5106C00D16C56E18E2CE","pipeline":{"afterLFSR":"0FE203BEB95DA0244E0515CABA3A06C41F0F56C3B9267EBDD94FD60853C8083D","afterSalt":"48522D36312053504F322D39352053544550532D3333354D50","afterTinkerbell":"4C9F1C7CA3911F95459F6BB9F931CCFC15ACA431239279B557852375A4895AF8","afterTransposition":"89B9AC3123A4759FF94C796B571C4585F89295CC159F91A3B5A45A23FC1F7C31"},"plaintext":"HR-61 SPO2-95 STEPS-335","serverTime":1770300716091,"timestamp":67378,"type":"encryption_update","ztmEnabled":true}
19:41:56.443 > [WebSocket] Processing message type: encryption_update
19:41:56.449 > [67.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:56.552 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":335,"time":1770300716091,"type":"health_data_update"}
19:41:56.560 > [WebSocket] Processing message type: health_data_update
19:41:56.566 > [67.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:56.673 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3154,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-335","handshakeSuccess":true,"totalTime":0.3154},"type":"session_summary_update"}
19:41:56.695 > [WebSocket] Processing message type: session_summary_update
19:41:56.702 > [68.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:56.806 > [WebSocket] Received (658 bytes): {"decryptionTime":0.3154,"encryptedPacket":"8202170017000408040000000689B9AC3123A4759FF94C796B571C4585F89295CC159F91A3B5A45A23FC1F7C3153E842E0A4EB5106C00D16C56E18E2CE","finalPlaintext":"HR-61 SPO2-95 STEPS-335","healthData":{"heartRate":61,"spo2":95,"steps":335},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D33333500000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3333354D5000000000000000","afterTinkerbell":"0FE203BEB95DA0244E0515CABA3A06C41F0F56C3B9267EBDD94FD60853C8083D","afterTransposition":"4C9F1C7CA3911F95459F6BB9F931CCFC15ACA431239279B557852375A4895AF8"},"serverTime":1770300716092,"type":"decryption_update"}
19:41:56.865 > [WebSocket] Processing message type: decryption_update
19:41:56.870 > [WebSocket] Server decryption completed
19:41:56.872 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 335
19:41:56.879 > [68.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:56.981 > [WebSocket] Received (644 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":5,"pipeline":{"afterLFSR":"0FE203BEB95DA0244E0515CABA3A06C41F0F56C3B9267EBDD94FD60853C8083D","afterSalt":"48522D36312053504F322D39352053544550532D3333354D50","afterTinkerbell":"4C9F1C7CA3911F95459F6BB9F931CCFC15ACA431239279B557852375A4895AF8","afterTransposition":"89B9AC3123A4759FF94C796B571C4585F89295CC159F91A3B5A45A23FC1F7C31","finalPacket":"8202170017000408040000000689B9AC3123A4759FF94C796B571C4585F89295CC159F91A3B5A45A23FC1F7C3153E842E0A4EB5106C00D16C56E18E2CE"},"plaintext":"HR-61 SPO2-95 STEPS-335","timestamp":67646,"type":"encryption_pipeline","ztmEnabled":true}
19:41:57.038 > [WebSocket] Processing message type: encryption_pipeline
19:41:57.044 > [68.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:57.143 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Health data #6 sent successfully","state":7,"success":true,"timestamp":67652,"type":"health_data_sent"}
19:41:57.159 > [WebSocket] Processing message type: health_data_sent
19:41:57.162 > [68.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:57.264 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300716435,"threatLevel":0,"type":"heuristics_update"}
19:41:57.293 > [WebSocket] Processing message type: heuristics_update
19:41:57.299 > [68.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:57.408 > [68.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:57.513 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300717450,"threatLevel":0,"type":"heuristics_update"}
19:41:57.540 > [WebSocket] Processing message type: heuristics_update
19:41:57.545 > [68.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:57.655 > [69.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:57.756 > [69.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:57.856 > [69.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:57.958 > [69.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:58.058 > [69.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:58.160 > [69.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:58.261 > [69.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:58.361 > [69.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:58.463 > [69.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:58.564 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300718465,"threatLevel":0,"type":"heuristics_update"}
19:41:58.592 > [WebSocket] Processing message type: heuristics_update
19:41:58.597 > [70.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:58.707 > [70.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:58.808 > [70.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:58.908 > [70.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:59.009 > [70.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:59.111 > [70.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:59.211 > [70.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:59.313 > [70.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:59.414 > [70.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:59.515 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300719477,"threatLevel":0,"type":"heuristics_update"}
19:41:59.543 > [WebSocket] Processing message type: heuristics_update
19:41:59.548 > [70.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:59.658 > [71.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:59.758 > [71.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:59.860 > [71.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:41:59.961 > [71.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:00.061 > [71.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:00.162 > [71.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:00.264 > [71.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:00.364 > [71.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:00.466 > [71.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:00.568 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300720488,"threatLevel":0,"type":"heuristics_update"}
19:42:00.596 > [WebSocket] Processing message type: heuristics_update
19:42:00.602 > [72.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:00.710 > [72.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:00.811 > [72.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:00.912 > [72.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:01.014 > [72.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:01.114 > [72.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:01.215 > [72.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:01.316 > [72.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:01.417 > [72.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:01.520 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300721497,"threatLevel":0,"type":"heuristics_update"}
19:42:01.546 > [WebSocket] Processing message type: heuristics_update
19:42:01.552 > [72.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:01.661 > [73.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:01.762 > [73.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:01.864 > [73.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:01.965 > [73.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:02.065 > [73.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:02.166 > [73.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:02.267 > [73.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:02.368 > [73.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:02.469 > [73.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:02.573 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300722509,"threatLevel":0,"type":"heuristics_update"}
19:42:02.600 > [WebSocket] Processing message type: heuristics_update
19:42:02.606 > [74.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:02.716 > [74.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:02.817 > [74.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:02.917 > [74.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:03.019 > [74.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:03.120 > [74.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:03.220 > [74.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:03.322 > [74.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:03.423 > [74.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:03.523 > [74.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:03.624 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300723518,"threatLevel":0,"type":"heuristics_update"}
19:42:03.653 > [WebSocket] Processing message type: heuristics_update
19:42:03.658 > [75.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:03.768 > [75.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:03.868 > [75.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:03.969 > [75.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:04.071 > [75.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:04.172 > [75.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:04.273 > [75.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:04.373 > [75.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:04.475 > [75.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:04.576 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300724529,"threatLevel":0,"type":"heuristics_update"}
19:42:04.604 > [WebSocket] Processing message type: heuristics_update
19:42:04.609 > [76.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:04.719 > [76.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:04.819 > [76.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:04.920 > [76.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:05.021 > [76.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:05.123 > [76.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:05.223 > [76.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:05.324 > [76.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:05.425 > [76.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:05.526 > [76.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:05.628 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300725530,"threatLevel":0,"type":"heuristics_update"}
19:42:05.656 > [WebSocket] Processing message type: heuristics_update
19:42:05.661 > [77.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:05.770 > [77.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:05.872 > [77.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:05.973 > [77.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:06.073 > [77.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:06.174 > [77.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:06.275 > [77.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:06.377 > [77.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
19:42:06.382 > [RETRY] Attempting to send health data (Max retries: 3)
19:42:06.388 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 7 for all retry attempts (saved: 6)
19:42:06.404 > Generated health data: HR-61 SPO2-95 STEPS-401
19:42:06.408 > [ESP32] ========================================
19:42:06.412 > [ESP32] ENCRYPTION PIPELINE START
19:42:06.415 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:42:06.421 > [ESP32] Active Algorithms for this packet:
19:42:06.424 > [ESP32]   + LFSR
19:42:06.426 > [ESP32]   + Tinkerbell
19:42:06.430 > [ESP32]   + Transposition
19:42:06.430 > [ESP32]   - ChaCha20
19:42:06.432 > [ESP32]   - Salsa20
19:42:06.435 > [ESP32] ========================================
19:42:06.438 > [ESP32] MsgKeys: lfsrSeed=0xF25B756F tnk[0..3]=5C747791 trn[0..3]=2727E219
19:42:06.446 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3430314D50
19:42:06.452 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3430314D5000000000000000 
19:42:06.460 > [ESP32][LFSR] Initializing - Seed: 0xF25B756F SeedBe: 0x6F755BF2 ChaosKey[0..3]: 5C747791 InitialTap: 0x0029 State: 0xF25B756F
19:42:06.471 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:42:06.479 > 3_After_LFSR (32): 272776C4817464B74BF8672A06782B6E 8A644AD4844E2428E553431A97B77184 
19:42:06.485 > [ESP32][LFSR] Keystream (first 16 bytes): 6F755BF2B05437E704CA4A133358783A
19:42:06.493 > [ESP32][4D] LFSR keystream (first 32 bytes): 6F755BF2B05437E704CA4A133358783ACF3419F9B07E1565B553431A97B77184
19:42:06.502 > [ESP32][TINKERBELL] Input (first 16 bytes): 272776C4817464B74BF8672A06782B6E Nonce: 0x00000007 Buffer size: 32 bytes
19:42:06.513 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000007 Counter: 0 (must start at 0) Key[0..3]: 5C747791
19:42:06.521 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 83FAFB5793E4F5000D553E0BCF690B8B
19:42:06.529 > 4_After_Tinkerbell (32): A4DD8D93129091B746AD5921C91120E5 81DF6AF43B365DF498B7D342A6FE3A15 
19:42:06.538 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 83FAFB5793E4F5000D553E0BCF690B8B
19:42:06.546 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 83FAFB5793E4F5000D553E0BCF690B8B0BBB2020BF7879DC7DE4905831494B91
19:42:06.557 > 5_After_Transposition (32): 818D363AF4A491DFF442205D93B7A6DD E546FEB7906AD33B21C9AD1211155998 
19:42:06.565 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000007
19:42:06.568 > [ESP32] === HMAC DEBUG INFO ===
19:42:06.571 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:42:06.580 > [ESP32] HMAC Input length: 45 bytes
19:42:06.582 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000007818D363AF4A491DFF442205D93B7A6DDE546FE
19:42:06.593 > [ESP32] Nonce: 0x00000007
19:42:06.593 > [ESP32] Packet size before HMAC: 61
19:42:06.598 > [ESP32] Computed HMAC Tag: 8C75A139F1C3D0E591083AD69FE79562
19:42:06.601 > [ESP32] === END HMAC DEBUG ===
19:42:06.604 > 6_Final_Packet (61): 82021700170004080400000007818D36 3AF4A491DFF442205D93B7A6DDE546FE ...
19:42:06.613 > [RETRY] Attempt 1/3 (nonce: 7)
19:42:06.616 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:06.621 > Sending pipeline data to server (605 bytes)
19:42:06.797 > [HTTP] Response code: 200
19:42:06.797 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:42:06.809 > [RETRY] Health data sent successfully!
19:42:06.812 > ✓ Health data #7 sent successfully
19:42:06.913 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300726539,"threatLevel":0,"type":"heuristics_update"}
19:42:06.941 > [WebSocket] Processing message type: heuristics_update
19:42:06.947 > [78.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:07.047 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":2,"serverTime":1770300726721,"type":"security_update"}
19:42:07.063 > [WebSocket] Processing message type: security_update
19:42:07.069 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:42:07.074 > [78.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:07.179 > [WebSocket] Received (632 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:82021700170004080400000007818D363AF4A491DFF442205D93B7A6DDE546FEB7906AD33B21C9AD12111559988C75A139F1C3D0E591083AD69FE79562","pipeline":{"afterLFSR":"272776C4817464B74BF8672A06782B6E8A644AD4844E2428E553431A97B77184","afterSalt":"48522D36312053504F322D39352053544550532D3430314D50","afterTinkerbell":"A4DD8D93129091B746AD5921C91120E581DF6AF43B365DF498B7D342A6FE3A15","afterTransposition":"818D363AF4A491DFF442205D93B7A6DDE546FEB7906AD33B21C9AD1211155998"},"plaintext":"HR-61 SPO2-95 STEPS-401","serverTime":1770300726721,"timestamp":77988,"type":"encryption_update","ztmEnabled":true}
19:42:07.234 > [WebSocket] Processing message type: encryption_update
19:42:07.239 > [78.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:07.342 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":401,"time":1770300726721,"type":"health_data_update"}
19:42:07.350 > [WebSocket] Processing message type: health_data_update
19:42:07.354 > [78.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:07.464 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3099,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-401","handshakeSuccess":true,"totalTime":0.3099},"type":"session_summary_update"}
19:42:07.486 > [WebSocket] Processing message type: session_summary_update
19:42:07.491 > [78.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:07.597 > [WebSocket] Received (658 bytes): {"decryptionTime":0.3099,"encryptedPacket":"82021700170004080400000007818D363AF4A491DFF442205D93B7A6DDE546FEB7906AD33B21C9AD12111559988C75A139F1C3D0E591083AD69FE79562","finalPlaintext":"HR-61 SPO2-95 STEPS-401","healthData":{"heartRate":61,"spo2":95,"steps":401},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D34303100000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3430314D5000000000000000","afterTinkerbell":"272776C4817464B74BF8672A06782B6E8A644AD4844E2428E553431A97B77184","afterTransposition":"A4DD8D93129091B746AD5921C91120E581DF6AF43B365DF498B7D342A6FE3A15"},"serverTime":1770300726722,"type":"decryption_update"}
19:42:07.654 > [WebSocket] Processing message type: decryption_update
19:42:07.660 > [WebSocket] Server decryption completed
19:42:07.664 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 401
19:42:07.668 > [79.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:07.771 > [WebSocket] Received (644 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":6,"pipeline":{"afterLFSR":"272776C4817464B74BF8672A06782B6E8A644AD4844E2428E553431A97B77184","afterSalt":"48522D36312053504F322D39352053544550532D3430314D50","afterTinkerbell":"A4DD8D93129091B746AD5921C91120E581DF6AF43B365DF498B7D342A6FE3A15","afterTransposition":"818D363AF4A491DFF442205D93B7A6DDE546FEB7906AD33B21C9AD1211155998","finalPacket":"82021700170004080400000007818D363AF4A491DFF442205D93B7A6DDE546FEB7906AD33B21C9AD12111559988C75A139F1C3D0E591083AD69FE79562"},"plaintext":"HR-61 SPO2-95 STEPS-401","timestamp":78172,"type":"encryption_pipeline","ztmEnabled":true}
19:42:07.828 > [WebSocket] Processing message type: encryption_pipeline
19:42:07.835 > [79.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:07.934 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Health data #7 sent successfully","state":7,"success":true,"timestamp":78177,"type":"health_data_sent"}
19:42:07.951 > [WebSocket] Processing message type: health_data_sent
19:42:07.954 > [79.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:08.057 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300727551,"threatLevel":0,"type":"heuristics_update"}
19:42:08.084 > [WebSocket] Processing message type: heuristics_update
19:42:08.090 > [79.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:08.200 > [79.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:08.300 > [79.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:08.402 > [79.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:08.502 > [79.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:08.603 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300728564,"threatLevel":0,"type":"heuristics_update"}
19:42:08.631 > [WebSocket] Processing message type: heuristics_update
19:42:08.637 > [80.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:08.747 > [80.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:08.848 > [80.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:08.948 > [80.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:09.050 > [80.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:09.151 > [80.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:09.251 > [80.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:09.352 > [80.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:09.454 > [80.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:09.554 > [80.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:09.656 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300729575,"threatLevel":0,"type":"heuristics_update"}
19:42:09.684 > [WebSocket] Processing message type: heuristics_update
19:42:09.689 > [81.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:09.799 > [81.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:09.900 > [81.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:10.000 > [81.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:10.101 > [81.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:10.202 > [81.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:10.303 > [81.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:10.404 > [81.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:10.504 > [81.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:10.607 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300730583,"threatLevel":0,"type":"heuristics_update"}
19:42:10.635 > [WebSocket] Processing message type: heuristics_update
19:42:10.640 > [82.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:10.750 > [82.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:10.850 > [82.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:10.952 > [82.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:11.052 > [82.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:11.153 > [82.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:11.254 > [82.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:11.354 > [82.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:11.456 > [82.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:11.557 > [82.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:11.662 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300731593,"threatLevel":0,"type":"heuristics_update"}
19:42:11.689 > [WebSocket] Processing message type: heuristics_update
19:42:11.694 > [83.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:11.803 > [83.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:11.904 > [83.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:12.005 > [83.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:12.106 > [83.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:12.207 > [83.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:12.308 > [83.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:12.409 > [83.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:12.510 > [83.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:12.611 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300732604,"threatLevel":0,"type":"heuristics_update"}
19:42:12.639 > [WebSocket] Processing message type: heuristics_update
19:42:12.645 > [84.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:12.753 > [84.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:12.854 > [84.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:12.956 > [84.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:13.056 > [84.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:13.158 > [84.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:13.259 > [84.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:13.360 > [84.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:13.461 > [84.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:13.563 > [84.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:13.664 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300733619,"threatLevel":0,"type":"heuristics_update"}
19:42:13.692 > [WebSocket] Processing message type: heuristics_update
19:42:13.697 > [85.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:13.807 > [85.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:13.907 > [85.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:14.008 > [85.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:14.109 > [85.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:14.209 > [85.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:14.311 > [85.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:14.412 > [85.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:14.514 > [85.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:14.614 > [86.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:14.716 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300734629,"threatLevel":0,"type":"heuristics_update"}
19:42:14.743 > [WebSocket] Processing message type: heuristics_update
19:42:14.749 > [86.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:14.858 > [86.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:14.959 > [86.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:15.060 > [86.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:15.161 > [86.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:15.262 > [86.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:15.364 > [86.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:15.464 > [86.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:15.565 > [86.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:15.667 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300735638,"threatLevel":0,"type":"heuristics_update"}
19:42:15.695 > [WebSocket] Processing message type: heuristics_update
19:42:15.700 > [87.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:15.810 > [87.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:15.910 > [87.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:16.011 > [87.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:16.112 > [87.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:16.213 > [87.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:16.314 > [87.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:16.415 > [87.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:16.516 > [87.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:16.617 > [88.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:16.721 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300736650,"threatLevel":0,"type":"heuristics_update"}
19:42:16.749 > [WebSocket] Processing message type: heuristics_update
19:42:16.754 > [88.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:16.863 > [88.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
19:42:16.869 > [RETRY] Attempting to send health data (Max retries: 3)
19:42:16.875 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=0\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 8 for all retry attempts (saved: 7)
19:42:16.890 > Generated health data: HR-61 SPO2-95 STEPS-462
19:42:16.893 > [ESP32] ========================================
19:42:16.899 > [ESP32] ENCRYPTION PIPELINE START
19:42:16.902 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:42:16.908 > [ESP32] Active Algorithms for this packet:
19:42:16.910 > [ESP32]   + LFSR
19:42:16.913 > [ESP32]   + Tinkerbell
19:42:16.916 > [ESP32]   + Transposition
19:42:16.916 > [ESP32]   - ChaCha20
19:42:16.919 > [ESP32]   - Salsa20
19:42:16.921 > [ESP32] ========================================
19:42:16.924 > [ESP32] MsgKeys: lfsrSeed=0x9A8861D0 tnk[0..3]=B6C5958E trn[0..3]=D5EE07B9
19:42:16.932 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3436324D50
19:42:16.938 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3436324D5000000000000000 
19:42:16.947 > [ESP32][LFSR] Initializing - Seed: 0x9A8861D0 SeedBe: 0xD061889A ChaosKey[0..3]: B6C5958E InitialTap: 0x0029 State: 0x9A8861D0
19:42:16.958 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:42:16.965 > 3_After_LFSR (32): 9833A5ACBCEEB0B77289A8937997DAF7 FE8B39F24749686A289601FFF918FB55 
19:42:16.971 > [ESP32][LFSR] Keystream (first 16 bytes): D061889A8DCEE3E73DBB85AA4CB789A3
19:42:16.980 > [ESP32][4D] LFSR keystream (first 32 bytes): D061889A8DCEE3E73DBB85AA4CB789A3BBDB6ADF737F5A27789601FFF918FB55
19:42:16.988 > [ESP32][TINKERBELL] Input (first 16 bytes): 9833A5ACBCEEB0B77289A8937997DAF7 Nonce: 0x00000008 Buffer size: 32 bytes
19:42:16.999 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000008 Counter: 0 (must start at 0) Key[0..3]: B6C5958E
19:42:17.008 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): F86E8205D5BBF75346F05583DCCF66D4
19:42:17.016 > 4_After_Tinkerbell (32): 605D27A9695547E43479FD10A558BC23 3C2DDE4B145C1E9160EEE1E71A45681F 
19:42:17.024 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): F86E8205D5BBF75346F05583DCCF66D4
19:42:17.033 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): F86E8205D5BBF75346F05583DCCF66D4C2A6E7B9531576FB4878E018E35D934A
19:42:17.044 > 5_After_Transposition (32): 1F68E45D605C2DE71E4B6023FDEE2758 A9A5DE14E179551A4534BC4710693C91 
19:42:17.052 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000008
19:42:17.055 > [ESP32] === HMAC DEBUG INFO ===
19:42:17.057 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:42:17.066 > [ESP32] HMAC Input length: 45 bytes
19:42:17.069 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000081F68E45D605C2DE71E4B6023FDEE2758A9A5DE
19:42:17.080 > [ESP32] Nonce: 0x00000008
19:42:17.080 > [ESP32] Packet size before HMAC: 61
19:42:17.085 > [ESP32] Computed HMAC Tag: EA395E170B1304BED813D80335C349EE
19:42:17.088 > [ESP32] === END HMAC DEBUG ===
19:42:17.091 > 6_Final_Packet (61): 820217001700040804000000081F68E4 5D605C2DE71E4B6023FDEE2758A9A5DE ...
19:42:17.099 > [RETRY] Attempt 1/3 (nonce: 8)
19:42:17.101 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:17.108 > Sending pipeline data to server (605 bytes)
19:42:17.321 > [HTTP] Response code: 200
19:42:17.321 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:42:17.333 > [RETRY] Health data sent successfully!
19:42:17.335 > ✓ Health data #8 sent successfully
19:42:17.435 > [WebSocket] Received (632 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820217001700040804000000081F68E45D605C2DE71E4B6023FDEE2758A9A5DE14E179551A4534BC4710693C91EA395E170B1304BED813D80335C349EE","pipeline":{"afterLFSR":"9833A5ACBCEEB0B77289A8937997DAF7FE8B39F24749686A289601FFF918FB55","afterSalt":"48522D36312053504F322D39352053544550532D3436324D50","afterTinkerbell":"605D27A9695547E43479FD10A558BC233C2DDE4B145C1E9160EEE1E71A45681F","afterTransposition":"1F68E45D605C2DE71E4B6023FDEE2758A9A5DE14E179551A4534BC4710693C91"},"plaintext":"HR-61 SPO2-95 STEPS-462","serverTime":1770300737185,"timestamp":88475,"type":"encryption_update","ztmEnabled":true}
19:42:17.490 > [WebSocket] Processing message type: encryption_update
19:42:17.496 > [88.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:17.598 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":462,"time":1770300737185,"type":"health_data_update"}
19:42:17.606 > [WebSocket] Processing message type: health_data_update
19:42:17.612 > [89.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:17.720 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3464,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-462","handshakeSuccess":true,"totalTime":0.3464},"type":"session_summary_update"}
19:42:17.742 > [WebSocket] Processing message type: session_summary_update
19:42:17.747 > [89.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:17.852 > [WebSocket] Received (658 bytes): {"decryptionTime":0.3464,"encryptedPacket":"820217001700040804000000081F68E45D605C2DE71E4B6023FDEE2758A9A5DE14E179551A4534BC4710693C91EA395E170B1304BED813D80335C349EE","finalPlaintext":"HR-61 SPO2-95 STEPS-462","healthData":{"heartRate":61,"spo2":95,"steps":462},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D34363200000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3436324D5000000000000000","afterTinkerbell":"9833A5ACBCEEB0B77289A8937997DAF7FE8B39F24749686A289601FFF918FB55","afterTransposition":"605D27A9695547E43479FD10A558BC233C2DDE4B145C1E9160EEE1E71A45681F"},"serverTime":1770300737186,"type":"decryption_update"}
19:42:17.911 > [WebSocket] Processing message type: decryption_update
19:42:17.916 > [WebSocket] Server decryption completed
19:42:17.919 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 462
19:42:17.925 > [89.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:18.026 > [WebSocket] Received (644 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":7,"pipeline":{"afterLFSR":"9833A5ACBCEEB0B77289A8937997DAF7FE8B39F24749686A289601FFF918FB55","afterSalt":"48522D36312053504F322D39352053544550532D3436324D50","afterTinkerbell":"605D27A9695547E43479FD10A558BC233C2DDE4B145C1E9160EEE1E71A45681F","afterTransposition":"1F68E45D605C2DE71E4B6023FDEE2758A9A5DE14E179551A4534BC4710693C91","finalPacket":"820217001700040804000000081F68E45D605C2DE71E4B6023FDEE2758A9A5DE14E179551A4534BC4710693C91EA395E170B1304BED813D80335C349EE"},"plaintext":"HR-61 SPO2-95 STEPS-462","timestamp":88697,"type":"encryption_pipeline","ztmEnabled":true}
19:42:18.085 > [WebSocket] Processing message type: encryption_pipeline
19:42:18.090 > [89.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:18.189 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Health data #8 sent successfully","state":7,"success":true,"timestamp":88702,"type":"health_data_sent"}
19:42:18.206 > [WebSocket] Processing message type: health_data_sent
19:42:18.209 > [89.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:18.312 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300737657,"threatLevel":0,"type":"heuristics_update"}
19:42:18.339 > [WebSocket] Processing message type: heuristics_update
19:42:18.345 > [89.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:18.454 > [89.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:18.554 > [89.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:18.656 > [90.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:18.760 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300738664,"threatLevel":0,"type":"heuristics_update"}
19:42:18.788 > [WebSocket] Processing message type: heuristics_update
19:42:18.793 > [90.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:18.902 > [90.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:19.002 > [90.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:19.104 > [90.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:19.205 > [90.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:19.306 > [90.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:19.407 > [90.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:19.508 > [90.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:19.609 > [91.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:19.711 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300739672,"threatLevel":0,"type":"heuristics_update"}
19:42:19.738 > [WebSocket] Processing message type: heuristics_update
19:42:19.743 > [91.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:19.853 > [91.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:19.954 > [91.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:20.055 > [91.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:20.156 > [91.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:20.257 > [91.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:20.358 > [91.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:20.459 > [91.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:20.560 > [91.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:20.660 > [92.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:20.762 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300740683,"threatLevel":0,"type":"heuristics_update"}
19:42:20.790 > [WebSocket] Processing message type: heuristics_update
19:42:20.796 > [92.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:20.905 > [92.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:21.006 > [92.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:21.107 > [92.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:21.208 > [92.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:21.309 > [92.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:21.410 > [92.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:21.510 > [92.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:21.612 > [93.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:21.713 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300741702,"threatLevel":0,"type":"heuristics_update"}
19:42:21.741 > [WebSocket] Processing message type: heuristics_update
19:42:21.747 > [93.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:21.856 > [93.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:21.957 > [93.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:22.058 > [93.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:22.159 > [93.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:22.260 > [93.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:22.360 > [93.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:22.462 > [93.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:22.562 > [93.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:22.664 > [94.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:22.766 > [WebSocket] Received (311 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":1,"lastCommitNonce":0,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300742706,"threatLevel":0,"type":"heuristics_update"}
19:42:22.793 > [WebSocket] Processing message type: heuristics_update
19:42:22.798 > [94.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:22.908 > [94.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:23.008 > [94.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:23.110 > [94.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:23.214 > [WebSocket] Received (252 bytes): {"payload":{"epoch":2,"proposalId":"7be3935d-d59f-4845-9eb0-00000093532950703529","proposedAt":"2026-02-05T14:12:23Z","targetRecipe":"CHACHA_HEAVY"},"signature":"64e30eb3822750f787d70325426f74f27aae3d5fb49c02c34ba6c6a698f0834e","type":"switch_propose"}
19:42:23.237 > [WebSocket] Processing message type: switch_propose
19:42:23.242 > [WS_RX] switch_propose (new format) proposalId=7be3935d-d59f-4845-9eb0-00000093532950703529 targetRecipe=CHACHA_HEAVY epoch=2
19:42:23.254 > [ZTM] Master key is zero - reloading from NVS
19:42:23.259 > [ZTM] Successfully reloaded master key from NVS
19:42:23.261 > [ZTM] Master key (first 16 bytes): 6C6F2F5696B28FFE99EB86F2C23C4B6D
19:42:23.267 > [ZTM] HMAC verify: canonical={"epoch":2,"proposalId":"7be3935d-d59f-4845-9eb0-00000093532950703529","proposedAt":"2026-02-05T14:12:23Z","targetRecipe":"CHACHA_HEAVY"}
19:42:23.281 > [ZTM] HMAC verify: computed=64e30eb3822750f787d70325426f74f27aae3d5fb49c02c34ba6c6a698f0834e expected=64e30eb3822750f787d70325426f74f27aae3d5fb49c02c34ba6c6a698f0834e
19:42:23.298 > [EPOCH_UPDATE] Updating from 1 to 2 (from switch_propose)\n[ACK_SENT] proposalId=7be3935d-d59f-4845-9eb0-00000093532950703529 epoch=2 lastSeenNonce=0
19:42:23.314 > [ACK_SENT] payload={"deviceId":"f9641d44","epoch":2,"lastSeenNonce":0,"proposalId":"7be3935d-d59f-4845-9eb0-00000093532950703529","ready":true} signature=01357465331b0e512006d24f3d9a165444e83c94af5fa175c8a949ef7fdb0943
19:42:23.333 > [PROPOSE_ACCEPT] proposalId=7be3935d-d59f-4845-9eb0-00000093532950703529 epoch=2 targetRecipe=CHACHA_HEAVY\n[94.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:23.452 > [WebSocket] Received (213 bytes): {"pending":true,"proposalId":"7be3935d-d59f-4845-9eb0-00000093532950703529","reason":"Manual switch request","recipe":"CHACHA_HEAVY","serverTime":1770300743161,"success":true,"type":"adaptive_switch_acknowledged"}
19:42:23.471 > [WebSocket] Processing message type: adaptive_switch_acknowledged
19:42:23.477 > [WebSocket] ========================================
19:42:23.481 > [WebSocket] Received message type: adaptive_switch_acknowledged
19:42:23.488 > [WebSocket] Mode from message: 'ztm'
19:42:23.490 > [WebSocket] Recipe from message: 'CHACHA_HEAVY'
19:42:23.497 > [WebSocket] Current gZTMEnabled: TRUE
19:42:23.499 > [WebSocket] Current gCurrentMode: ZTM
19:42:23.502 > [WebSocket] Current gCurrentRecipe: CHAOS_ONLY
19:42:23.507 > [WebSocket] ========================================
19:42:23.510 > [WebSocket] Parsed newMode: ZTM, newRecipe: CHACHA_HEAVY
19:42:23.516 > [WebSocket] Waiting for switch_propose from server for recipe CHACHA_HEAVY
19:42:23.521 > [94.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:23.621 > [WebSocket] Received (247 bytes): {"payload":{"commitNonce":8589934593,"committedAt":"2026-02-05T14:12:23Z","epoch":2,"proposalId":"7be3935d-d59f-4845-9eb0-00000093532950703529"},"signature":"e77bab8d03bbaf80435a681a708e7bf806f88cd709ea864fd024689b74310ca3","type":"switch_commit"}
19:42:23.643 > [WebSocket] Processing message type: switch_commit
19:42:23.649 > [WS_RX] switch_commit (new format) proposalId=7be3935d-d59f-4845-9eb0-00000093532950703529 commitNonce=8589934593
19:42:23.658 > [ZTM] Master key (first 16 bytes): 6C6F2F5696B28FFE99EB86F2C23C4B6D
19:42:23.666 > [ZTM] HMAC verify: canonical={"commitNonce":8589934593,"committedAt":"2026-02-05T14:12:23Z","epoch":2,"proposalId":"7be3935d-d59f-4845-9eb0-00000093532950703529"}
19:42:23.679 > [ZTM] HMAC verify: computed=e77bab8d03bbaf80435a681a708e7bf806f88cd709ea864fd024689b74310ca3 expected=e77bab8d03bbaf80435a681a708e7bf806f88cd709ea864fd024689b74310ca3
19:42:23.693 > [COMMIT_RECEIVED] proposalId=7be3935d-d59f-4845-9eb0-00000093532950703529 commitNonce=8589934593 epoch=2
19:42:23.701 > [95.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:23.808 > [WebSocket] Received (117 bytes): {"proposalId":"7be3935d-d59f-4845-9eb0-00000093532950703529","serverTime":1770300743309,"type":"switch_ack_received"}
19:42:23.819 > [WebSocket] Processing message type: switch_ack_received
19:42:23.824 > [95.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:23.931 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Mode: ztm, Recipe: CHACHA_HEAVY","state":7,"success":true,"timestamp":94890,"type":"mode_changed_pending"}
19:42:23.948 > [WebSocket] Processing message type: mode_changed_pending
19:42:23.950 > [95.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:24.054 > [WebSocket] Received (320 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300743715,"threatLevel":0,"type":"heuristics_update"}
19:42:24.084 > [WebSocket] Processing message type: heuristics_update
19:42:24.087 > [95.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:24.195 > [95.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:24.297 > [95.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:24.398 > [95.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:24.499 > [95.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:24.600 > [96.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:24.701 > [96.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:24.803 > [WebSocket] Received (320 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300744730,"threatLevel":0,"type":"heuristics_update"}
19:42:24.833 > [WebSocket] Processing message type: heuristics_update
19:42:24.835 > [96.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:24.945 > [96.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:25.046 > [96.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:25.147 > [96.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:25.248 > [96.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:25.349 > [96.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:25.449 > [96.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:25.550 > [96.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:25.652 > [97.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:25.755 > [WebSocket] Received (320 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300745738,"threatLevel":0,"type":"heuristics_update"}
19:42:25.786 > [WebSocket] Processing message type: heuristics_update
19:42:25.789 > [97.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:25.898 > [97.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:25.999 > [97.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:26.100 > [97.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:26.201 > [97.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:26.302 > [97.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:26.403 > [97.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:26.504 > [97.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:26.605 > [98.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:26.706 > [98.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:26.807 > [WebSocket] Received (320 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300746752,"threatLevel":0,"type":"heuristics_update"}
19:42:26.838 > [WebSocket] Processing message type: heuristics_update
19:42:26.841 > [98.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:26.950 > [98.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:27.051 > [98.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:27.152 > [98.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:27.252 > [98.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:27.354 > [98.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
19:42:27.359 > [RETRY] Attempting to send health data (Max retries: 3)
19:42:27.365 > [BOUNDARY_CHECK] SwitchState=3 PendingActive=1 CommitNonce=8589934593\n[BOUNDARY_CHECK] nextTxNonce=8589934593 commitNonce=8589934593 (epoch=2 packet=1)\n[SWITCH] commit boundary reached — applying recipe proposalId=7be3935d-d59f-4845-9eb0-00000093532950703529
19:42:27.387 > [SWITCH] applyRecipe: CHACHA_HEAVY
19:42:27.392 > [ZTM] Settings saved successfully
19:42:27.395 > [SWITCH] Protocol complete — returning to NORMAL state. Applied recipe at nonce: 8589934593
19:42:27.408 > [DONE_SENT] proposalId=7be3935d-d59f-4845-9eb0-00000093532950703529 commitNonce=8589934593 epoch=2
19:42:27.416 > [SWITCH_DONE] Recipe switch completed at nonce=8589934593
19:42:27.419 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:42:27.425 > Generated health data: HR-61 SPO2-95 STEPS-537
19:42:27.430 > [ESP32] ========================================
19:42:27.432 > [ESP32] ENCRYPTION PIPELINE START
19:42:27.436 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHACHA_HEAVY
19:42:27.440 > [ESP32] Active Algorithms for this packet:
19:42:27.447 > [ESP32]   + LFSR
19:42:27.447 > [ESP32]   + Tinkerbell
19:42:27.449 > [ESP32]   - Transposition
19:42:27.460 > [ESP32]   + ChaCha20
19:42:27.460 > [ESP32]   - Salsa20
19:42:27.460 > [ESP32] ========================================
19:42:27.460 > [ESP32] MsgKeys: lfsrSeed=0x8E7A0AB6 tnk[0..3]=984C5571 trn[0..3]=F8C2400B
19:42:27.466 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3533374D50
19:42:27.472 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3533374D5000000000000000 
19:42:27.479 > [ESP32][LFSR] Initializing - Seed: 0x8E7A0AB6 SeedBe: 0xB60A7A8E ChaosKey[0..3]: 984C5571 InitialTap: 0x0029 State: 0x8E7A0AB6
19:42:27.491 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:42:27.499 > 3_After_LFSR (32): FE5857B8ADAE49B10A2E3633DE45276A 110D23E5F98BFF15EFF0A6003D6615AE 
19:42:27.504 > [ESP32][LFSR] Keystream (first 16 bytes): B60A7A8E9C8E1AE1451C1B0AEB65743E
19:42:27.513 > [ESP32][4D] LFSR keystream (first 32 bytes): B60A7A8E9C8E1AE1451C1B0AEB65743E545D70C8CCB8C858BFF0A6003D6615AE
19:42:27.522 > [ESP32][TINKERBELL] Input (first 16 bytes): FE5857B8ADAE49B10A2E3633DE45276A Nonce: 0x00000001 Buffer size: 32 bytes
19:42:27.533 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 984C5571
19:42:27.543 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 1965C2886F12405D254DE58D59960BED
19:42:27.550 > 4_After_Tinkerbell (32): E73D9530C2BC09EC2F63D3BE87D32C87 622EE3D1270D9231706D6656319769EB 
19:42:27.558 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 1965C2886F12405D254DE58D59960BED
19:42:27.566 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 1965C2886F12405D254DE58D59960BED7323C034DE866D249F9DC0560CF17C45
19:42:27.577 > [ESP32][TRANSPOSITION] SKIPPED (recipe: CHACHA_HEAVY)
19:42:27.582 > [ESP32][CHACHA20] Initializing - Nonce: 0x00000001
19:42:27.585 > [ESP32][CHACHA20] Key (first 8 bytes): A1943F11EAB4DE11
19:42:27.591 > [ESP32][CHACHA20] Full Nonce (12 bytes): 010000000000000000000000
19:42:27.596 > [ESP32][CHACHA20] Input (first 16 bytes): E73D9530C2BC09EC2F63D3BE87D32C87
19:42:27.601 > 6_After_ChaCha20 (32): EF585798546732D1A9C8DAEBC707DC5C 3D1E4DD898EB48A6C2E6C84C02E37407 
19:42:27.610 > [ESP32][CHACHA20] Encryption complete - Output size: 32 bytes
19:42:27.616 > [ESP32][4B] recipeId=2 (CHACHA_HEAVY) nonce=0x00000001
19:42:27.621 > [ESP32] === HMAC DEBUG INFO ===
19:42:27.624 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:42:27.633 > [ESP32] HMAC Input length: 45 bytes
19:42:27.635 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080200000001EF585798546732D1A9C8DAEBC707DC5C3D1E4D
19:42:27.644 > [ESP32] Nonce: 0x00000001
19:42:27.646 > [ESP32] Packet size before HMAC: 61
19:42:27.649 > [ESP32] Computed HMAC Tag: 5D4C525F35CBD4C67A7629723AEB0F59
19:42:27.655 > [ESP32] === END HMAC DEBUG ===
19:42:27.658 > 6_Final_Packet (61): 82021700170004080200000001EF5857 98546732D1A9C8DAEBC707DC5C3D1E4D ...
19:42:27.666 > [RETRY] Attempt 1/3 (nonce: 1)
19:42:27.669 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:27.674 > Sending pipeline data to server (602 bytes)
19:42:27.855 > [HTTP] Response code: 200
19:42:27.856 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:42:27.868 > [RETRY] Health data sent successfully!
19:42:27.871 > ✓ Health data #9 sent successfully
19:42:27.972 > [WebSocket] Received (423 bytes): {"activatedAt":1770300683115,"active":true,"epoch":2,"heuristics":{"cpuUsage":20.0,"decryptFailures":0,"entropy":7.5,"hmacFailures":0,"latency":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"lastCommitNonce":8589934593,"lastSeenNonce":8,"lastSwitchReason":"Committed via switch_done","pendingProposals":0,"recipe":"CHACHA_HEAVY","serverTime":1770300747408,"threatLevel":0,"type":"active_recipe_updated"}
19:42:28.010 > [WebSocket] Processing message type: active_recipe_updated
19:42:28.016 > [99.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:28.115 > [WebSocket] Received (135 bytes): {"proposalId":"7be3935d-d59f-4845-9eb0-00000093532950703529","serverTime":1770300747408,"status":"committed","type":"switch_committed"}
19:42:28.129 > [WebSocket] Processing message type: switch_committed
19:42:28.134 > [99.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:28.237 > [WebSocket] Received (629 bytes): {"currentRecipe":"CHACHA_HEAVY","encData":"ENC_DATA:82021700170004080200000001EF585798546732D1A9C8DAEBC707DC5C3D1E4DD898EB48A6C2E6C84C02E374075D4C525F35CBD4C67A7629723AEB0F59","pipeline":{"afterChaCha20":"EF585798546732D1A9C8DAEBC707DC5C3D1E4DD898EB48A6C2E6C84C02E37407","afterLFSR":"FE5857B8ADAE49B10A2E3633DE45276A110D23E5F98BFF15EFF0A6003D6615AE","afterSalt":"48522D36312053504F322D39352053544550532D3533374D50","afterTinkerbell":"E73D9530C2BC09EC2F63D3BE87D32C87622EE3D1270D9231706D6656319769EB"},"plaintext":"HR-61 SPO2-95 STEPS-537","serverTime":1770300747760,"timestamp":99041,"type":"encryption_update","ztmEnabled":true}
19:42:28.293 > [WebSocket] Processing message type: encryption_update
19:42:28.298 > [99.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:28.400 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":537,"time":1770300747760,"type":"health_data_update"}
19:42:28.408 > [WebSocket] Processing message type: health_data_update
19:42:28.413 > [99.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:28.523 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.5266,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-537","handshakeSuccess":true,"totalTime":0.5266},"type":"session_summary_update"}
19:42:28.545 > [WebSocket] Processing message type: session_summary_update
19:42:28.550 > [99.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:28.655 > [WebSocket] Received (658 bytes): {"decryptionTime":0.5266,"encryptedPacket":"82021700170004080200000001EF585798546732D1A9C8DAEBC707DC5C3D1E4DD898EB48A6C2E6C84C02E374075D4C525F35CBD4C67A7629723AEB0F59","finalPlaintext":"HR-61 SPO2-95 STEPS-537","healthData":{"heartRate":61,"spo2":95,"steps":537},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D35333700000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3533374D5000000000000000","afterTinkerbell":"FE5857B8ADAE49B10A2E3633DE45276A110D23E5F98BFF15EFF0A6003D6615AE","afterTransposition":"E73D9530C2BC09EC2F63D3BE87D32C87622EE3D1270D9231706D6656319769EB"},"serverTime":1770300747761,"type":"decryption_update"}
19:42:28.713 > [WebSocket] Processing message type: decryption_update
19:42:28.718 > [WebSocket] Server decryption completed
19:42:28.722 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 537
19:42:28.727 > [100.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:28.830 > [WebSocket] Received (322 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300747762,"threatLevel":0,"type":"heuristics_update"}
19:42:28.859 > [WebSocket] Processing message type: heuristics_update
19:42:28.862 > [100.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:28.972 > [WebSocket] Received (641 bytes): {"currentRecipe":"CHACHA_HEAVY","deviceId":"f9641d44","healthSendCount":8,"pipeline":{"afterChaCha20":"EF585798546732D1A9C8DAEBC707DC5C3D1E4DD898EB48A6C2E6C84C02E37407","afterLFSR":"FE5857B8ADAE49B10A2E3633DE45276A110D23E5F98BFF15EFF0A6003D6615AE","afterSalt":"48522D36312053504F322D39352053544550532D3533374D50","afterTinkerbell":"E73D9530C2BC09EC2F63D3BE87D32C87622EE3D1270D9231706D6656319769EB","finalPacket":"82021700170004080200000001EF585798546732D1A9C8DAEBC707DC5C3D1E4DD898EB48A6C2E6C84C02E374075D4C525F35CBD4C67A7629723AEB0F59"},"plaintext":"HR-61 SPO2-95 STEPS-537","timestamp":99231,"type":"encryption_pipeline","ztmEnabled":true}
19:42:29.030 > [WebSocket] Processing message type: encryption_pipeline
19:42:29.033 > [100.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:29.136 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Health data #9 sent successfully","state":7,"success":true,"timestamp":99236,"type":"health_data_sent"}
19:42:29.153 > [WebSocket] Processing message type: health_data_sent
19:42:29.156 > [100.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:29.258 > [WebSocket] Received (322 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300748773,"threatLevel":0,"type":"heuristics_update"}
19:42:29.289 > [WebSocket] Processing message type: heuristics_update
19:42:29.291 > [100.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:29.400 > [100.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:29.502 > [100.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:29.603 > [101.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:29.704 > [101.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:29.804 > [101.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:29.906 > [WebSocket] Received (322 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300749786,"threatLevel":0,"type":"heuristics_update"}
19:42:29.937 > [WebSocket] Processing message type: heuristics_update
19:42:29.939 > [101.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:30.049 > [101.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:30.150 > [101.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:30.250 > [101.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:30.352 > [101.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:30.452 > [101.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:30.554 > [101.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:30.654 > [102.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:30.754 > [102.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:30.856 > [WebSocket] Received (322 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300750796,"threatLevel":0,"type":"heuristics_update"}
19:42:30.888 > [WebSocket] Processing message type: heuristics_update
19:42:30.890 > [102.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:30.999 > [102.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:31.101 > [102.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:31.202 > [102.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:31.303 > [102.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:31.404 > [102.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:31.505 > [102.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:31.606 > [103.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:31.706 > [103.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:31.808 > [103.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:31.912 > [WebSocket] Received (322 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":2,"lastCommitNonce":8589934593,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300751804,"threatLevel":0,"type":"heuristics_update"}
19:42:31.942 > [WebSocket] Processing message type: heuristics_update
19:42:31.945 > [103.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:32.055 > [103.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:32.156 > [103.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:32.256 > [103.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:32.357 > [103.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:32.459 > [103.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:32.559 > [103.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:32.661 > [104.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:32.762 > [104.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:32.864 > [WebSocket] Received (250 bytes): {"payload":{"epoch":3,"proposalId":"93be634a-2067-4931-afa5-00000094dbafa927bfa3","proposedAt":"2026-02-05T14:12:32Z","targetRecipe":"CHAOS_ONLY"},"signature":"1e058756416d010745c20528da7421d849859beda9020eaaf43556fccf4874d0","type":"switch_propose"}
19:42:32.886 > [WebSocket] Processing message type: switch_propose
19:42:32.891 > [WS_RX] switch_propose (new format) proposalId=93be634a-2067-4931-afa5-00000094dbafa927bfa3 targetRecipe=CHAOS_ONLY epoch=3
19:42:32.902 > [ZTM] Master key (first 16 bytes): 6C6F2F5696B28FFE99EB86F2C23C4B6D
19:42:32.908 > [ZTM] HMAC verify: canonical={"epoch":3,"proposalId":"93be634a-2067-4931-afa5-00000094dbafa927bfa3","proposedAt":"2026-02-05T14:12:32Z","targetRecipe":"CHAOS_ONLY"}
19:42:32.922 > [ZTM] HMAC verify: computed=1e058756416d010745c20528da7421d849859beda9020eaaf43556fccf4874d0 expected=1e058756416d010745c20528da7421d849859beda9020eaaf43556fccf4874d0
19:42:32.935 > [EPOCH_UPDATE] Updating from 2 to 3 (from switch_propose)\n[ACK_SENT] proposalId=93be634a-2067-4931-afa5-00000094dbafa927bfa3 epoch=3 lastSeenNonce=0
19:42:32.950 > [ACK_SENT] payload={"deviceId":"f9641d44","epoch":3,"lastSeenNonce":0,"proposalId":"93be634a-2067-4931-afa5-00000094dbafa927bfa3","ready":true} signature=6484a35bec501ab098a602dfc846a5d95beb07311077a78da7286f42fc68e443
19:42:32.971 > [PROPOSE_ACCEPT] proposalId=93be634a-2067-4931-afa5-00000094dbafa927bfa3 epoch=3 targetRecipe=CHAOS_ONLY\n[104.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:33.090 > [WebSocket] Received (322 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":3,"lastCommitNonce":8589934593,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300752818,"threatLevel":0,"type":"heuristics_update"}
19:42:33.120 > [WebSocket] Processing message type: heuristics_update
19:42:33.123 > [104.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:33.233 > [WebSocket] Received (248 bytes): {"payload":{"commitNonce":12884901889,"committedAt":"2026-02-05T14:12:32Z","epoch":3,"proposalId":"93be634a-2067-4931-afa5-00000094dbafa927bfa3"},"signature":"95d0846241ba3d2e4794b1532ee17833ca17d10f7a6d5197a70b69c25320b672","type":"switch_commit"}
19:42:33.256 > [WebSocket] Processing message type: switch_commit
19:42:33.261 > [WS_RX] switch_commit (new format) proposalId=93be634a-2067-4931-afa5-00000094dbafa927bfa3 commitNonce=12884901889
19:42:33.272 > [ZTM] Master key (first 16 bytes): 6C6F2F5696B28FFE99EB86F2C23C4B6D
19:42:33.277 > [ZTM] HMAC verify: canonical={"commitNonce":12884901889,"committedAt":"2026-02-05T14:12:32Z","epoch":3,"proposalId":"93be634a-2067-4931-afa5-00000094dbafa927bfa3"}
19:42:33.291 > [ZTM] HMAC verify: computed=95d0846241ba3d2e4794b1532ee17833ca17d10f7a6d5197a70b69c25320b672 expected=95d0846241ba3d2e4794b1532ee17833ca17d10f7a6d5197a70b69c25320b672
19:42:33.305 > [COMMIT_RECEIVED] proposalId=93be634a-2067-4931-afa5-00000094dbafa927bfa3 commitNonce=12884901889 epoch=3
19:42:33.314 > [104.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:33.420 > [WebSocket] Received (117 bytes): {"proposalId":"93be634a-2067-4931-afa5-00000094dbafa927bfa3","serverTime":1770300752947,"type":"switch_ack_received"}
19:42:33.432 > [WebSocket] Processing message type: switch_ack_received
19:42:33.437 > [104.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:33.542 > [104.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:33.644 > [105.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:33.745 > [105.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:33.847 > [WebSocket] Received (250 bytes): {"payload":{"epoch":4,"proposalId":"cd113349-94da-4243-8af1-00000014773b3a3fa5cf","proposedAt":"2026-02-05T14:12:33Z","targetRecipe":"CHAOS_ONLY"},"signature":"0a5551ff932bfea24a01c2a0111624d129afc904c19258e8573b556262223c05","type":"switch_propose"}
19:42:33.869 > [WebSocket] Processing message type: switch_propose
19:42:33.875 > [WS_RX] switch_propose (new format) proposalId=cd113349-94da-4243-8af1-00000014773b3a3fa5cf targetRecipe=CHAOS_ONLY epoch=4
19:42:33.886 > [ZTM] Master key (first 16 bytes): 6C6F2F5696B28FFE99EB86F2C23C4B6D
19:42:33.891 > [ZTM] HMAC verify: canonical={"epoch":4,"proposalId":"cd113349-94da-4243-8af1-00000014773b3a3fa5cf","proposedAt":"2026-02-05T14:12:33Z","targetRecipe":"CHAOS_ONLY"}
19:42:33.905 > [ZTM] HMAC verify: computed=0a5551ff932bfea24a01c2a0111624d129afc904c19258e8573b556262223c05 expected=0a5551ff932bfea24a01c2a0111624d129afc904c19258e8573b556262223c05
19:42:33.919 > [EPOCH_UPDATE] Updating from 3 to 4 (from switch_propose)\n[PROPOSE_REJECT] overlapping transaction
19:42:33.930 > [NACK_SENT] proposalId=cd113349-94da-4243-8af1-00000014773b3a3fa5cf reason=overlapping currentEpoch=4
19:42:33.939 > [105.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:34.043 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":4,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300753829,"threatLevel":0,"type":"heuristics_update"}
19:42:34.074 > [WebSocket] Processing message type: heuristics_update
19:42:34.077 > [105.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:34.187 > [WebSocket] Received (118 bytes): {"proposalId":"cd113349-94da-4243-8af1-00000014773b3a3fa5cf","serverTime":1770300753938,"type":"switch_nack_received"}
19:42:34.198 > [WebSocket] Processing message type: switch_nack_received
19:42:34.204 > [105.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:34.309 > [105.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:34.410 > [105.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:34.510 > [105.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:34.611 > [106.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:34.712 > [106.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:34.814 > [106.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:34.915 > [WebSocket] Received (250 bytes): {"payload":{"epoch":5,"proposalId":"678a2816-93a0-41fa-bb58-00000001c10cd6e0b955","proposedAt":"2026-02-05T14:12:34Z","targetRecipe":"CHAOS_ONLY"},"signature":"07617d4f41d855e44f697493f8f1b26b95a9de7ec045d454cd9bc0bc6ba18960","type":"switch_propose"}
19:42:34.938 > [WebSocket] Processing message type: switch_propose
19:42:34.943 > [WS_RX] switch_propose (new format) proposalId=678a2816-93a0-41fa-bb58-00000001c10cd6e0b955 targetRecipe=CHAOS_ONLY epoch=5
19:42:34.953 > [ZTM] Master key (first 16 bytes): 6C6F2F5696B28FFE99EB86F2C23C4B6D
19:42:34.959 > [ZTM] HMAC verify: canonical={"epoch":5,"proposalId":"678a2816-93a0-41fa-bb58-00000001c10cd6e0b955","proposedAt":"2026-02-05T14:12:34Z","targetRecipe":"CHAOS_ONLY"}
19:42:34.974 > [ZTM] HMAC verify: computed=07617d4f41d855e44f697493f8f1b26b95a9de7ec045d454cd9bc0bc6ba18960 expected=07617d4f41d855e44f697493f8f1b26b95a9de7ec045d454cd9bc0bc6ba18960
19:42:34.987 > [EPOCH_UPDATE] Updating from 4 to 5 (from switch_propose)\n[PROPOSE_REJECT] overlapping transaction
19:42:34.998 > [NACK_SENT] proposalId=678a2816-93a0-41fa-bb58-00000001c10cd6e0b955 reason=overlapping currentEpoch=5
19:42:35.007 > [106.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:35.109 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":5,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300754837,"threatLevel":0,"type":"heuristics_update"}
19:42:35.139 > [WebSocket] Processing message type: heuristics_update
19:42:35.141 > [106.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:35.252 > [WebSocket] Received (118 bytes): {"proposalId":"678a2816-93a0-41fa-bb58-00000001c10cd6e0b955","serverTime":1770300755015,"type":"switch_nack_received"}
19:42:35.263 > [WebSocket] Processing message type: switch_nack_received
19:42:35.269 > [106.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:35.374 > [106.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:35.476 > [106.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:35.576 > [107.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:35.678 > [107.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:35.778 > [107.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:35.879 > [WebSocket] Received (250 bytes): {"payload":{"epoch":6,"proposalId":"8a8c36c0-e7f0-4bb1-b7c6-00000028412ebc2c58c2","proposedAt":"2026-02-05T14:12:35Z","targetRecipe":"CHAOS_ONLY"},"signature":"e56ad0f7f2e6cba6ab2a28430efd579bf5d5d66ed5e3baa653442491ba22ff9a","type":"switch_propose"}
19:42:35.902 > [WebSocket] Processing message type: switch_propose
19:42:35.908 > [WS_RX] switch_propose (new format) proposalId=8a8c36c0-e7f0-4bb1-b7c6-00000028412ebc2c58c2 targetRecipe=CHAOS_ONLY epoch=6
19:42:35.919 > [ZTM] Master key (first 16 bytes): 6C6F2F5696B28FFE99EB86F2C23C4B6D
19:42:35.925 > [ZTM] HMAC verify: canonical={"epoch":6,"proposalId":"8a8c36c0-e7f0-4bb1-b7c6-00000028412ebc2c58c2","proposedAt":"2026-02-05T14:12:35Z","targetRecipe":"CHAOS_ONLY"}
19:42:35.938 > [ZTM] HMAC verify: computed=e56ad0f7f2e6cba6ab2a28430efd579bf5d5d66ed5e3baa653442491ba22ff9a expected=e56ad0f7f2e6cba6ab2a28430efd579bf5d5d66ed5e3baa653442491ba22ff9a
19:42:35.952 > [EPOCH_UPDATE] Updating from 5 to 6 (from switch_propose)\n[PROPOSE_REJECT] overlapping transaction
19:42:35.964 > [NACK_SENT] proposalId=8a8c36c0-e7f0-4bb1-b7c6-00000028412ebc2c58c2 reason=overlapping currentEpoch=6
19:42:35.971 > [107.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:36.075 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":6,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300755850,"threatLevel":0,"type":"heuristics_update"}
19:42:36.104 > [WebSocket] Processing message type: heuristics_update
19:42:36.108 > [107.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:36.218 > [WebSocket] Received (118 bytes): {"proposalId":"8a8c36c0-e7f0-4bb1-b7c6-00000028412ebc2c58c2","serverTime":1770300755961,"type":"switch_nack_received"}
19:42:36.229 > [WebSocket] Processing message type: switch_nack_received
19:42:36.235 > [107.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:36.340 > [107.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:36.441 > [107.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:36.542 > [107.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:36.643 > [108.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:36.744 > [108.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:36.845 > [108.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:36.949 > [WebSocket] Received (250 bytes): {"payload":{"epoch":7,"proposalId":"b72e2b7a-28db-4da9-a4b2-000000c4df87208d32e4","proposedAt":"2026-02-05T14:12:36Z","targetRecipe":"CHAOS_ONLY"},"signature":"439ed2b340ba730b6cd8dbde3970fde07f9bcc842e584e54b299f67a4df868ee","type":"switch_propose"}
19:42:36.972 > [WebSocket] Processing message type: switch_propose
19:42:36.977 > [WS_RX] switch_propose (new format) proposalId=b72e2b7a-28db-4da9-a4b2-000000c4df87208d32e4 targetRecipe=CHAOS_ONLY epoch=7
19:42:36.988 > [ZTM] Master key (first 16 bytes): 6C6F2F5696B28FFE99EB86F2C23C4B6D
19:42:36.993 > [ZTM] HMAC verify: canonical={"epoch":7,"proposalId":"b72e2b7a-28db-4da9-a4b2-000000c4df87208d32e4","proposedAt":"2026-02-05T14:12:36Z","targetRecipe":"CHAOS_ONLY"}
19:42:37.008 > [ZTM] HMAC verify: computed=439ed2b340ba730b6cd8dbde3970fde07f9bcc842e584e54b299f67a4df868ee expected=439ed2b340ba730b6cd8dbde3970fde07f9bcc842e584e54b299f67a4df868ee
19:42:37.021 > [EPOCH_UPDATE] Updating from 6 to 7 (from switch_propose)\n[PROPOSE_REJECT] overlapping transaction
19:42:37.032 > [NACK_SENT] proposalId=b72e2b7a-28db-4da9-a4b2-000000c4df87208d32e4 reason=overlapping currentEpoch=7
19:42:37.041 > [108.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:37.144 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":7,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300756858,"threatLevel":0,"type":"heuristics_update"}
19:42:37.174 > [WebSocket] Processing message type: heuristics_update
19:42:37.177 > [108.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:37.287 > [WebSocket] Received (118 bytes): {"proposalId":"b72e2b7a-28db-4da9-a4b2-000000c4df87208d32e4","serverTime":1770300757030,"type":"switch_nack_received"}
19:42:37.298 > [WebSocket] Processing message type: switch_nack_received
19:42:37.304 > [108.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:37.409 > [108.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:37.510 > [108.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:37.611 > [109.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:37.712 > [109.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:37.813 > [109.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:37.914 > [WebSocket] Received (250 bytes): {"payload":{"epoch":8,"proposalId":"6184c4db-4c4a-4ada-8aed-0000007165d6100f52ab","proposedAt":"2026-02-05T14:12:37Z","targetRecipe":"CHAOS_ONLY"},"signature":"d09bc2fe0d695087119fa7bc51ac1f7b75ce27e1d155899fc3f4b9b653ae40ad","type":"switch_propose"}
19:42:37.937 > [WebSocket] Processing message type: switch_propose
19:42:37.943 > [WS_RX] switch_propose (new format) proposalId=6184c4db-4c4a-4ada-8aed-0000007165d6100f52ab targetRecipe=CHAOS_ONLY epoch=8
19:42:37.954 > [ZTM] Master key (first 16 bytes): 6C6F2F5696B28FFE99EB86F2C23C4B6D
19:42:37.959 > [ZTM] HMAC verify: canonical={"epoch":8,"proposalId":"6184c4db-4c4a-4ada-8aed-0000007165d6100f52ab","proposedAt":"2026-02-05T14:12:37Z","targetRecipe":"CHAOS_ONLY"}
19:42:37.974 > [ZTM] HMAC verify: computed=d09bc2fe0d695087119fa7bc51ac1f7b75ce27e1d155899fc3f4b9b653ae40ad expected=d09bc2fe0d695087119fa7bc51ac1f7b75ce27e1d155899fc3f4b9b653ae40ad
19:42:37.987 > [EPOCH_UPDATE] Updating from 7 to 8 (from switch_propose)\n[PROPOSE_REJECT] overlapping transaction
19:42:37.998 > [NACK_SENT] proposalId=6184c4db-4c4a-4ada-8aed-0000007165d6100f52ab reason=overlapping currentEpoch=8
19:42:38.006 > [109.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
19:42:38.015 > [RETRY] Attempting to send health data (Max retries: 3)
19:42:38.017 > [BOUNDARY_CHECK] SwitchState=3 PendingActive=1 CommitNonce=12884901889\n[BOUNDARY_CHECK] nextTxNonce=34359738369 commitNonce=12884901889 (epoch=8 packet=1)\n[SWITCH] commit boundary reached — applying recipe proposalId=93be634a-2067-4931-afa5-00000094dbafa927bfa3
19:42:38.061 > [SWITCH] applyRecipe: CHAOS_ONLY
19:42:38.061 > [ZTM] Settings saved successfully
19:42:38.061 > [SWITCH] Protocol complete — returning to NORMAL state. Applied recipe at nonce: 12884901889
19:42:38.068 > [DONE_SENT] proposalId=93be634a-2067-4931-afa5-00000094dbafa927bfa3 commitNonce=12884901889 epoch=3
19:42:38.071 > [SWITCH_DONE] Recipe switch completed at nonce=12884901889
19:42:38.073 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:42:38.084 > Generated health data: HR-61 SPO2-95 STEPS-568
19:42:38.085 > [ESP32] ========================================
19:42:38.087 > [ESP32] ENCRYPTION PIPELINE START
19:42:38.090 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:42:38.096 > [ESP32] Active Algorithms for this packet:
19:42:38.101 > [ESP32]   + LFSR
19:42:38.101 > [ESP32]   + Tinkerbell
19:42:38.103 > [ESP32]   + Transposition
19:42:38.107 > [ESP32]   - ChaCha20
19:42:38.107 > [ESP32]   - Salsa20
19:42:38.109 > [ESP32] ========================================
19:42:38.112 > [ESP32] MsgKeys: lfsrSeed=0x8E7A0AB6 tnk[0..3]=984C5571 trn[0..3]=F8C2400B
19:42:38.120 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3536384D50
19:42:38.126 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3536384D5000000000000000 
19:42:38.135 > [ESP32][LFSR] Initializing - Seed: 0x8E7A0AB6 SeedBe: 0xB60A7A8E ChaosKey[0..3]: 984C5571 InitialTap: 0x0029 State: 0x8E7A0AB6
19:42:38.145 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
19:42:38.153 > 3_After_LFSR (32): FE5857B8ADAE49B10A2E3633DE45276A 110D23E5F98EF015EFF0A6003D6615AE 
19:42:38.159 > [ESP32][LFSR] Keystream (first 16 bytes): B60A7A8E9C8E1AE1451C1B0AEB65743E
19:42:38.168 > [ESP32][4D] LFSR keystream (first 32 bytes): B60A7A8E9C8E1AE1451C1B0AEB65743E545D70C8CCB8C858BFF0A6003D6615AE
19:42:38.176 > [ESP32][TINKERBELL] Input (first 16 bytes): FE5857B8ADAE49B10A2E3633DE45276A Nonce: 0x00000001 Buffer size: 32 bytes
19:42:38.187 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 984C5571
19:42:38.198 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 1965C2886F12405D254DE58D59960BED
19:42:38.204 > 4_After_Tinkerbell (32): E73D9530C2BC09EC2F63D3BE87D32C87 622EE3D127089D31706D6656319769EB 
19:42:38.212 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 1965C2886F12405D254DE58D59960BED
19:42:38.220 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 1965C2886F12405D254DE58D59960BED7323C034DE866D249F9DC0560CF17C45
19:42:38.231 > 5_After_Transposition (32): 2769EBD3E7EC089D312C9530C2312F70 97BC3D56BE8709D1E36687D32E6D6362 
19:42:38.240 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:42:38.243 > [ESP32] === HMAC DEBUG INFO ===
19:42:38.245 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:42:38.254 > [ESP32] HMAC Input length: 45 bytes
19:42:38.260 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000012769EBD3E7EC089D312C9530C2312F7097BC3D
19:42:38.268 > [ESP32] Nonce: 0x00000001
19:42:38.270 > [ESP32] Packet size before HMAC: 61
19:42:38.273 > [ESP32] Computed HMAC Tag: B104FEBB01841AADE46470EA014F43B3
19:42:38.278 > [ESP32] === END HMAC DEBUG ===
19:42:38.281 > 6_Final_Packet (61): 820217001700040804000000012769EB D3E7EC089D312C9530C2312F7097BC3D ...
19:42:38.287 > [RETRY] Attempt 1/3 (nonce: 1)
19:42:38.290 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:38.295 > Sending pipeline data to server (606 bytes)
19:42:38.613 > [HTTP] Response code: 200
19:42:38.614 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:42:38.624 > [RETRY] Health data sent successfully!
19:42:38.628 > ✓ Health data #10 sent successfully
19:42:38.726 > [WebSocket] Received (323 bytes): {"currentRecipe":"CHACHA_HEAVY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300757870,"threatLevel":0,"type":"heuristics_update"}
19:42:38.756 > [WebSocket] Processing message type: heuristics_update
19:42:38.759 > [110.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:38.872 > [WebSocket] Received (118 bytes): {"proposalId":"6184c4db-4c4a-4ada-8aed-0000007165d6100f52ab","serverTime":1770300757996,"type":"switch_nack_received"}
19:42:38.884 > [WebSocket] Processing message type: switch_nack_received
19:42:38.889 > [110.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:38.994 > [WebSocket] Received (422 bytes): {"activatedAt":1770300683115,"active":true,"epoch":8,"heuristics":{"cpuUsage":20.0,"decryptFailures":0,"entropy":7.5,"hmacFailures":0,"latency":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"lastCommitNonce":12884901889,"lastSeenNonce":1,"lastSwitchReason":"Committed via switch_done","pendingProposals":0,"recipe":"CHAOS_ONLY","serverTime":1770300758087,"threatLevel":0,"type":"active_recipe_updated"}
19:42:39.034 > [WebSocket] Processing message type: active_recipe_updated
19:42:39.039 > [110.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:39.137 > [WebSocket] Received (135 bytes): {"proposalId":"93be634a-2067-4931-afa5-00000094dbafa927bfa3","serverTime":1770300758087,"status":"committed","type":"switch_committed"}
19:42:39.166 > [WebSocket] Processing message type: switch_committed
19:42:39.166 > [110.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:39.259 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":5,"serverTime":1770300758381,"type":"security_update"}
19:42:39.276 > [WebSocket] Processing message type: security_update
19:42:39.281 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:42:39.287 > [110.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:39.392 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820217001700040804000000012769EBD3E7EC089D312C9530C2312F7097BC3D56BE8709D1E36687D32E6D6362B104FEBB01841AADE46470EA014F43B3","pipeline":{"afterLFSR":"FE5857B8ADAE49B10A2E3633DE45276A110D23E5F98EF015EFF0A6003D6615AE","afterSalt":"48522D36312053504F322D39352053544550532D3536384D50","afterTinkerbell":"E73D9530C2BC09EC2F63D3BE87D32C87622EE3D127089D31706D6656319769EB","afterTransposition":"2769EBD3E7EC089D312C9530C2312F7097BC3D56BE8709D1E36687D32E6D6362"},"plaintext":"HR-61 SPO2-95 STEPS-568","serverTime":1770300758381,"timestamp":109665,"type":"encryption_update","ztmEnabled":true}
19:42:39.447 > [WebSocket] Processing message type: encryption_update
19:42:39.454 > [110.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:39.556 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":568,"time":1770300758381,"type":"health_data_update"}
19:42:39.564 > [WebSocket] Processing message type: health_data_update
19:42:39.569 > [110.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:39.678 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.4283,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-568","handshakeSuccess":true,"totalTime":0.4283},"type":"session_summary_update"}
19:42:39.700 > [WebSocket] Processing message type: session_summary_update
19:42:39.705 > [111.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:39.809 > [WebSocket] Received (658 bytes): {"decryptionTime":0.4283,"encryptedPacket":"820217001700040804000000012769EBD3E7EC089D312C9530C2312F7097BC3D56BE8709D1E36687D32E6D6362B104FEBB01841AADE46470EA014F43B3","finalPlaintext":"HR-61 SPO2-95 STEPS-568","healthData":{"heartRate":61,"spo2":95,"steps":568},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D35363800000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3536384D5000000000000000","afterTinkerbell":"FE5857B8ADAE49B10A2E3633DE45276A110D23E5F98EF015EFF0A6003D6615AE","afterTransposition":"E73D9530C2BC09EC2F63D3BE87D32C87622EE3D127089D31706D6656319769EB"},"serverTime":1770300758382,"type":"decryption_update"}
19:42:39.868 > [WebSocket] Processing message type: decryption_update
19:42:39.873 > [WebSocket] Server decryption completed
19:42:39.876 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 568
19:42:39.882 > [111.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:39.987 > [WebSocket] Received (645 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":9,"pipeline":{"afterLFSR":"FE5857B8ADAE49B10A2E3633DE45276A110D23E5F98EF015EFF0A6003D6615AE","afterSalt":"48522D36312053504F322D39352053544550532D3536384D50","afterTinkerbell":"E73D9530C2BC09EC2F63D3BE87D32C87622EE3D127089D31706D6656319769EB","afterTransposition":"2769EBD3E7EC089D312C9530C2312F7097BC3D56BE8709D1E36687D32E6D6362","finalPacket":"820217001700040804000000012769EBD3E7EC089D312C9530C2312F7097BC3D56BE8709D1E36687D32E6D6362B104FEBB01841AADE46470EA014F43B3"},"plaintext":"HR-61 SPO2-95 STEPS-568","timestamp":109990,"type":"encryption_pipeline","ztmEnabled":true}
19:42:40.045 > [WebSocket] Processing message type: encryption_pipeline
19:42:40.051 > [111.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:40.150 > [WebSocket] Received (159 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Health data #10 sent successfully","state":7,"success":true,"timestamp":109994,"type":"health_data_sent"}
19:42:40.167 > [WebSocket] Processing message type: health_data_sent
19:42:40.170 > [111.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:40.272 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300758883,"threatLevel":0,"type":"heuristics_update"}
19:42:40.304 > [WebSocket] Processing message type: heuristics_update
19:42:40.306 > [111.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:40.415 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300759897,"threatLevel":0,"type":"heuristics_update"}
19:42:40.446 > [WebSocket] Processing message type: heuristics_update
19:42:40.449 > [111.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:40.558 > [111.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:40.659 > [112.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:40.760 > [112.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:40.861 > [112.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:40.962 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300760911,"threatLevel":0,"type":"heuristics_update"}
19:42:40.993 > [WebSocket] Processing message type: heuristics_update
19:42:40.996 > [112.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:41.104 > [112.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:41.206 > [112.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:41.307 > [112.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:41.408 > [112.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:41.509 > [112.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:41.610 > [113.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:41.712 > [113.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:41.812 > [113.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:41.913 > [113.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:42.015 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300761922,"threatLevel":0,"type":"heuristics_update"}
19:42:42.045 > [WebSocket] Processing message type: heuristics_update
19:42:42.048 > [113.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:42.158 > [113.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:42.258 > [113.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:42.359 > [113.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:42.461 > [113.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:42.562 > [113.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:42.662 > [114.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:42.764 > [114.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:42.864 > [114.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:42.966 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300762924,"threatLevel":0,"type":"heuristics_update"}
19:42:42.996 > [WebSocket] Processing message type: heuristics_update
19:42:42.999 > [114.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:43.108 > [114.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:43.210 > [114.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:43.310 > [114.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:43.411 > [114.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:43.512 > [114.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:43.613 > [115.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:43.715 > [115.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:43.815 > [115.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:43.916 > [115.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:44.018 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300763927,"threatLevel":0,"type":"heuristics_update"}
19:42:44.048 > [WebSocket] Processing message type: heuristics_update
19:42:44.051 > [115.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:44.161 > [115.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:44.261 > [115.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:44.362 > [115.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:44.463 > [115.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:44.564 > [115.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:44.665 > [116.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:44.766 > [116.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:44.867 > [116.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:44.971 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300764936,"threatLevel":0,"type":"heuristics_update"}
19:42:45.001 > [WebSocket] Processing message type: heuristics_update
19:42:45.004 > [116.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:45.113 > [116.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:45.214 > [116.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:45.314 > [116.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:45.416 > [116.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:45.517 > [116.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:45.618 > [117.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:45.719 > [117.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:45.820 > [117.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:45.921 > [117.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:46.022 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300765943,"threatLevel":0,"type":"heuristics_update"}
19:42:46.053 > [WebSocket] Processing message type: heuristics_update
19:42:46.056 > [117.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:46.165 > [117.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:46.266 > [117.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:46.368 > [117.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:46.468 > [117.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:46.569 > [117.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:46.670 > [118.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:46.771 > [118.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:46.872 > [118.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:46.973 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300766955,"threatLevel":0,"type":"heuristics_update"}
19:42:47.004 > [WebSocket] Processing message type: heuristics_update
19:42:47.006 > [118.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:47.116 > [118.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:47.217 > [118.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:47.318 > [118.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:47.419 > [118.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:47.520 > [118.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:47.621 > [119.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:47.722 > [119.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:47.823 > [119.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:47.924 > [119.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:48.026 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300767968,"threatLevel":0,"type":"heuristics_update"}
19:42:48.057 > [WebSocket] Processing message type: heuristics_update
19:42:48.059 > [119.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:48.168 > [119.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:48.269 > [119.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:48.370 > [119.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:48.471 > [119.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:48.572 > [119.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:48.673 > [120.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:48.679 > [RETRY] Attempting to send health data (Max retries: 3)
19:42:48.684 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:42:48.701 > Generated health data: HR-62 SPO2-95 STEPS-640
19:42:48.706 > [ESP32] ========================================
19:42:48.709 > [ESP32] ENCRYPTION PIPELINE START
19:42:48.712 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:42:48.717 > [ESP32] Active Algorithms for this packet:
19:42:48.723 > [ESP32]   + LFSR
19:42:48.723 > [ESP32]   + Tinkerbell
19:42:48.726 > [ESP32]   + Transposition
19:42:48.728 > [ESP32]   - ChaCha20
19:42:48.728 > [ESP32]   - Salsa20
19:42:48.731 > [ESP32] ========================================
19:42:48.737 > [ESP32] MsgKeys: lfsrSeed=0xF0C1FAA8 tnk[0..3]=5F4F03CF trn[0..3]=29C941D3
19:42:48.742 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3634304D50
19:42:48.748 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3634304D5000000000000000 
19:42:48.756 > [ESP32][LFSR] Initializing - Seed: 0xF0C1FAA8 SeedBe: 0xA8FAC1F0 ChaosKey[0..3]: 5F4F03CF InitialTap: 0x0029 State: 0xF0C1FAA8
19:42:48.767 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:42:48.776 > 3_After_LFSR (32): E0A8ECC6058EB19C73353BA210F83F04 DDD3BDFB4BE4F47AABEECE56246638A3 
19:42:48.784 > [ESP32][LFSR] Keystream (first 16 bytes): A8FAC1F037AEE2CC3C07169B25D86C50
19:42:48.790 > [ESP32][4D] LFSR keystream (first 32 bytes): A8FAC1F037AEE2CC3C07169B25D86C509883EED67DD0C437FBEECE56246638A3
19:42:48.798 > [ESP32][TINKERBELL] Input (first 16 bytes): E0A8ECC6058EB19C73353BA210F83F04 Nonce: 0x00000002 Buffer size: 32 bytes
19:42:48.809 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 5F4F03CF
19:42:48.820 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBD
19:42:48.828 > 4_After_Tinkerbell (32): AA9583073D433D8018D8834D2EFAE1B9 64EDAB89674C460F11F07D34FD6CFFF5 
19:42:48.837 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBD
19:42:48.842 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBDB93E16722CA8B275BA1EB362D90AC756
19:42:48.853 > 5_After_Transposition (32): F5B90F0767114CFDE18383641880AB3D EDF0FA8946FFAA7D433D342E4DD86C95 
19:42:48.862 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:42:48.867 > [ESP32] === HMAC DEBUG INFO ===
19:42:48.870 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:42:48.878 > [ESP32] HMAC Input length: 45 bytes
19:42:48.881 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000002F5B90F0767114CFDE18383641880AB3DEDF0FA
19:42:48.890 > [ESP32] Nonce: 0x00000002
19:42:48.893 > [ESP32] Packet size before HMAC: 61
19:42:48.895 > [ESP32] Computed HMAC Tag: ED5AB8476AD56253A8311050892B320B
19:42:48.900 > [ESP32] === END HMAC DEBUG ===
19:42:48.904 > 6_Final_Packet (61): 82021700170004080400000002F5B90F 0767114CFDE18383641880AB3DEDF0FA ...
19:42:48.912 > [RETRY] Attempt 1/3 (nonce: 2)
19:42:48.914 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:48.921 > Sending pipeline data to server (606 bytes)
19:42:49.186 > [HTTP] Response code: 400
19:42:49.186 > [HTTP] Error response: {"error":"Decryption failed"}
19:42:49.192 > [HTTP] Request failed with code: 400
19:42:49.194 > [RETRY] Send failed, waiting 100 ms before retry
19:42:49.294 > [RETRY] Attempt 2/3 (nonce: 2)
19:42:49.294 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:49.299 > Sending pipeline data to server (606 bytes)
19:42:49.421 > [HTTP] Response code: 400
19:42:49.421 > [HTTP] Error response: {"error":"Decryption failed"}
19:42:49.427 > [HTTP] Request failed with code: 400
19:42:49.429 > [RETRY] Send failed, waiting 200 ms before retry
19:42:49.630 > [RETRY] Attempt 3/3 (nonce: 2)
19:42:49.630 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:49.635 > Sending pipeline data to server (606 bytes)
19:42:49.929 > [HTTP] Response code: 400
19:42:49.929 > [HTTP] Error response: {"error":"Decryption failed"}
19:42:49.934 > [HTTP] Request failed with code: 400
19:42:49.937 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:42:49.942 > [RETRY] Consecutive failures: 1
19:42:49.945 > Health data send failed (retry count: 1/3)
19:42:50.051 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300768980,"threatLevel":0,"type":"heuristics_update"}
19:42:50.082 > [WebSocket] Processing message type: heuristics_update
19:42:50.084 > [121.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:50.093 > [RETRY] Attempting to send health data (Max retries: 3)
19:42:50.099 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:42:50.115 > Generated health data: HR-62 SPO2-95 STEPS-637
19:42:50.121 > [ESP32] ========================================
19:42:50.123 > [ESP32] ENCRYPTION PIPELINE START
19:42:50.127 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:42:50.132 > [ESP32] Active Algorithms for this packet:
19:42:50.138 > [ESP32]   + LFSR
19:42:50.138 > [ESP32]   + Tinkerbell
19:42:50.140 > [ESP32]   + Transposition
19:42:50.143 > [ESP32]   - ChaCha20
19:42:50.143 > [ESP32]   - Salsa20
19:42:50.146 > [ESP32] ========================================
19:42:50.148 > [ESP32] MsgKeys: lfsrSeed=0xF0C1FAA8 tnk[0..3]=5F4F03CF trn[0..3]=29C941D3
19:42:50.156 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3633374D50
19:42:50.162 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3633374D5000000000000000 
19:42:50.171 > [ESP32][LFSR] Initializing - Seed: 0xF0C1FAA8 SeedBe: 0xA8FAC1F0 ChaosKey[0..3]: 5F4F03CF InitialTap: 0x0029 State: 0xF0C1FAA8
19:42:50.182 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:42:50.190 > 3_After_LFSR (32): E0A8ECC6058EB19C73353BA210F83F04 DDD3BDFB4BE3F37AABEECE56246638A3 
19:42:50.195 > [ESP32][LFSR] Keystream (first 16 bytes): A8FAC1F037AEE2CC3C07169B25D86C50
19:42:50.204 > [ESP32][4D] LFSR keystream (first 32 bytes): A8FAC1F037AEE2CC3C07169B25D86C509883EED67DD0C437FBEECE56246638A3
19:42:50.213 > [ESP32][TINKERBELL] Input (first 16 bytes): E0A8ECC6058EB19C73353BA210F83F04 Nonce: 0x00000002 Buffer size: 32 bytes
19:42:50.223 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 5F4F03CF
19:42:50.234 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBD
19:42:50.240 > 4_After_Tinkerbell (32): AA9583073D433D8018D8834D2EFAE1B9 64EDAB89674B410F11F07D34FD6CFFF5 
19:42:50.249 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBD
19:42:50.256 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBDB93E16722CA8B275BA1EB362D90AC756
19:42:50.268 > 5_After_Transposition (32): F5B90F0767114BFDE18383641880AB3D EDF0FA8941FFAA7D433D342E4DD86C95 
19:42:50.276 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:42:50.279 > [ESP32] === HMAC DEBUG INFO ===
19:42:50.282 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:42:50.290 > [ESP32] HMAC Input length: 45 bytes
19:42:50.295 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000002F5B90F0767114BFDE18383641880AB3DEDF0FA
19:42:50.304 > [ESP32] Nonce: 0x00000002
19:42:50.307 > [ESP32] Packet size before HMAC: 61
19:42:50.310 > [ESP32] Computed HMAC Tag: 3560328F30608FF62633F818E7AAE45E
19:42:50.315 > [ESP32] === END HMAC DEBUG ===
19:42:50.318 > 6_Final_Packet (61): 82021700170004080400000002F5B90F 0767114BFDE18383641880AB3DEDF0FA ...
19:42:50.324 > [RETRY] Attempt 1/3 (nonce: 2)
19:42:50.326 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:50.332 > Sending pipeline data to server (606 bytes)
19:42:50.675 > [HTTP] Response code: 400
19:42:50.676 > [HTTP] Error response: {"error":"Decryption failed"}
19:42:50.681 > [HTTP] Request failed with code: 400
19:42:50.684 > [RETRY] Send failed, waiting 100 ms before retry
19:42:50.784 > [RETRY] Attempt 2/3 (nonce: 2)
19:42:50.784 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:50.789 > Sending pipeline data to server (606 bytes)
19:42:50.958 > [HTTP] Response code: 400
19:42:50.958 > [HTTP] Error response: {"error":"Decryption failed"}
19:42:50.964 > [HTTP] Request failed with code: 400
19:42:50.966 > [RETRY] Send failed, waiting 200 ms before retry
19:42:51.166 > [RETRY] Attempt 3/3 (nonce: 2)
19:42:51.166 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:51.172 > Sending pipeline data to server (606 bytes)
19:42:51.438 > [HTTP] Response code: 400
19:42:51.438 > [HTTP] Error response: {"error":"Decryption failed"}
19:42:51.444 > [HTTP] Request failed with code: 400
19:42:51.446 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:42:51.452 > [RETRY] Consecutive failures: 2
19:42:51.454 > Health data send failed (retry count: 2/3)
19:42:51.558 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":120563,"type":"health_data_error"}
19:42:51.571 > [WebSocket] Processing message type: health_data_error
19:42:51.577 > [122.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:51.585 > [RETRY] Attempting to send health data (Max retries: 3)
19:42:51.591 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:42:51.608 > Generated health data: HR-62 SPO2-95 STEPS-638
19:42:51.613 > [ESP32] ========================================
19:42:51.615 > [ESP32] ENCRYPTION PIPELINE START
19:42:51.619 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:42:51.624 > [ESP32] Active Algorithms for this packet:
19:42:51.627 > [ESP32]   + LFSR
19:42:51.630 > [ESP32]   + Tinkerbell
19:42:51.633 > [ESP32]   + Transposition
19:42:51.633 > [ESP32]   - ChaCha20
19:42:51.635 > [ESP32]   - Salsa20
19:42:51.637 > [ESP32] ========================================
19:42:51.640 > [ESP32] MsgKeys: lfsrSeed=0xF0C1FAA8 tnk[0..3]=5F4F03CF trn[0..3]=29C941D3
19:42:51.649 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3633384D50
19:42:51.655 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3633384D5000000000000000 
19:42:51.663 > [ESP32][LFSR] Initializing - Seed: 0xF0C1FAA8 SeedBe: 0xA8FAC1F0 ChaosKey[0..3]: 5F4F03CF InitialTap: 0x0029 State: 0xF0C1FAA8
19:42:51.674 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:42:51.682 > 3_After_LFSR (32): E0A8ECC6058EB19C73353BA210F83F04 DDD3BDFB4BE3FC7AABEECE56246638A3 
19:42:51.688 > [ESP32][LFSR] Keystream (first 16 bytes): A8FAC1F037AEE2CC3C07169B25D86C50
19:42:51.696 > [ESP32][4D] LFSR keystream (first 32 bytes): A8FAC1F037AEE2CC3C07169B25D86C509883EED67DD0C437FBEECE56246638A3
19:42:51.704 > [ESP32][TINKERBELL] Input (first 16 bytes): E0A8ECC6058EB19C73353BA210F83F04 Nonce: 0x00000002 Buffer size: 32 bytes
19:42:51.716 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 5F4F03CF
19:42:51.724 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBD
19:42:51.732 > 4_After_Tinkerbell (32): AA9583073D433D8018D8834D2EFAE1B9 64EDAB89674B4E0F11F07D34FD6CFFF5 
19:42:51.740 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBD
19:42:51.748 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBDB93E16722CA8B275BA1EB362D90AC756
19:42:51.760 > 5_After_Transposition (32): F5B90F0767114BFDE18383641880AB3D EDF0FA894EFFAA7D433D342E4DD86C95 
19:42:51.768 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:42:51.771 > [ESP32] === HMAC DEBUG INFO ===
19:42:51.774 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:42:51.782 > [ESP32] HMAC Input length: 45 bytes
19:42:51.785 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000002F5B90F0767114BFDE18383641880AB3DEDF0FA
19:42:51.796 > [ESP32] Nonce: 0x00000002
19:42:51.796 > [ESP32] Packet size before HMAC: 61
19:42:51.801 > [ESP32] Computed HMAC Tag: E3E7C392467C6096DA6F6F24204C9CD4
19:42:51.805 > [ESP32] === END HMAC DEBUG ===
19:42:51.807 > 6_Final_Packet (61): 82021700170004080400000002F5B90F 0767114BFDE18383641880AB3DEDF0FA ...
19:42:51.816 > [RETRY] Attempt 1/3 (nonce: 2)
19:42:51.818 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:51.824 > Sending pipeline data to server (606 bytes)
19:42:51.944 > [HTTP] Response code: 400
19:42:51.945 > [HTTP] Error response: {"error":"Decryption failed"}
19:42:51.950 > [HTTP] Request failed with code: 400
19:42:51.953 > [RETRY] Send failed, waiting 100 ms before retry
19:42:52.054 > [RETRY] Attempt 2/3 (nonce: 2)
19:42:52.054 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:52.059 > Sending pipeline data to server (606 bytes)
19:42:52.197 > [HTTP] Response code: 400
19:42:52.197 > [HTTP] Error response: {"error":"Decryption failed"}
19:42:52.202 > [HTTP] Request failed with code: 400
19:42:52.205 > [RETRY] Send failed, waiting 200 ms before retry
19:42:52.405 > [RETRY] Attempt 3/3 (nonce: 2)
19:42:52.442 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:52.442 > Sending pipeline data to server (606 bytes)
19:42:52.702 > [HTTP] Response code: 400
19:42:52.702 > [HTTP] Error response: {"error":"Decryption failed"}
19:42:52.708 > [HTTP] Request failed with code: 400
19:42:52.711 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:42:52.716 > [RETRY] Consecutive failures: 3
19:42:52.719 > Health data send failed (retry count: 3/3)
19:42:52.722 > Health data transmission failed after max retries
19:42:52.823 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":120798,"type":"health_data_error"}
19:42:52.836 > [WebSocket] Processing message type: health_data_error
19:42:52.842 > [124.2] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:52.850 > ERROR state - attempting recovery
19:42:52.852 > [RETRY] Attempting to send health data (Max retries: 3)
19:42:52.859 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:42:52.875 > Generated health data: HR-62 SPO2-95 STEPS-657
19:42:52.877 > [ESP32] ========================================
19:42:52.883 > [ESP32] ENCRYPTION PIPELINE START
19:42:52.886 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:42:52.892 > [ESP32] Active Algorithms for this packet:
19:42:52.894 > [ESP32]   + LFSR
19:42:52.897 > [ESP32]   + Tinkerbell
19:42:52.897 > [ESP32]   + Transposition
19:42:52.900 > [ESP32]   - ChaCha20
19:42:52.903 > [ESP32]   - Salsa20
19:42:52.903 > [ESP32] ========================================
19:42:52.908 > [ESP32] MsgKeys: lfsrSeed=0xF0C1FAA8 tnk[0..3]=5F4F03CF trn[0..3]=29C941D3
19:42:52.914 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3635374D50
19:42:52.922 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3635374D5000000000000000 
19:42:52.927 > [ESP32][LFSR] Initializing - Seed: 0xF0C1FAA8 SeedBe: 0xA8FAC1F0 ChaosKey[0..3]: 5F4F03CF InitialTap: 0x0029 State: 0xF0C1FAA8
19:42:52.939 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:42:52.947 > 3_After_LFSR (32): E0A8ECC6058EB19C73353BA210F83F04 DDD3BDFB4BE5F37AABEECE56246638A3 
19:42:52.956 > [ESP32][LFSR] Keystream (first 16 bytes): A8FAC1F037AEE2CC3C07169B25D86C50
19:42:52.961 > [ESP32][4D] LFSR keystream (first 32 bytes): A8FAC1F037AEE2CC3C07169B25D86C509883EED67DD0C437FBEECE56246638A3
19:42:52.972 > [ESP32][TINKERBELL] Input (first 16 bytes): E0A8ECC6058EB19C73353BA210F83F04 Nonce: 0x00000002 Buffer size: 32 bytes
19:42:52.983 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 5F4F03CF
19:42:52.991 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBD
19:42:53.000 > 4_After_Tinkerbell (32): AA9583073D433D8018D8834D2EFAE1B9 64EDAB89674D410F11F07D34FD6CFFF5 
19:42:53.009 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBD
19:42:53.017 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 4A3D6FC138CD8C1C6BEDB8EF3E02DEBDB93E16722CA8B275BA1EB362D90AC756
19:42:53.026 > 5_After_Transposition (32): F5B90F0767114DFDE18383641880AB3D EDF0FA8941FFAA7D433D342E4DD86C95 
19:42:53.037 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:42:53.065 > [ESP32] === HMAC DEBUG INFO ===
19:42:53.065 > [ESP32] HMAC Key being used: A1943F11EAB4DE11E26253318D689A32EEE583B0FA7907E5A57D289F2910CA79
19:42:53.065 > [ESP32] HMAC Input length: 45 bytes
19:42:53.065 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000002F5B90F0767114DFDE18383641880AB3DEDF0FA
19:42:53.065 > [ESP32] Nonce: 0x00000002
19:42:53.065 > [ESP32] Packet size before HMAC: 61
19:42:53.074 > [ESP32] Computed HMAC Tag: 346072AD3F714D31970FF178AB07F632
19:42:53.074 > [ESP32] === END HMAC DEBUG ===
19:42:53.077 > 6_Final_Packet (61): 82021700170004080400000002F5B90F 0767114DFDE18383641880AB3DEDF0FA ...
19:42:53.089 > [RETRY] Attempt 1/3 (nonce: 2)
19:42:53.089 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:53.113 > Sending pipeline data to server (606 bytes)
19:42:53.203 > [HTTP] Response code: 400
19:42:53.211 > [HTTP] Error response: {"error":"Decryption failed"}
19:42:53.211 > [HTTP] Request failed with code: 400
19:42:53.218 > [RETRY] Send failed, waiting 100 ms before retry
19:42:53.312 > [RETRY] Attempt 2/3 (nonce: 2)
19:42:53.312 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:53.316 > Sending pipeline data to server (606 bytes)
19:42:53.457 > [HTTP] Response code: 400
19:42:53.458 > [HTTP] Error response: {"error":"Decryption failed"}
19:42:53.463 > [HTTP] Request failed with code: 400
19:42:53.466 > [RETRY] Send failed, waiting 200 ms before retry
19:42:53.666 > [RETRY] Attempt 3/3 (nonce: 2)
19:42:53.666 > POST http://10.249.92.115:8081/health-data with pipeline data
19:42:53.671 > Sending pipeline data to server (606 bytes)
19:42:53.976 > [HTTP] Response code: 400
19:42:53.976 > [HTTP] Error response: {"error":"Decryption failed"}
19:42:53.981 > [HTTP] Request failed with code: 400
19:42:53.985 > [RETRY] All retry attempts failed - rolled back nonce to 1
19:42:53.990 > [RETRY] Consecutive failures: 4
19:42:53.993 > ✗ Auto-recovery failed - restarting key exchange
19:42:56.095 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":121305,"type":"health_data_error"}
19:42:56.109 > [WebSocket] Processing message type: health_data_error
19:42:56.114 > [127.5] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:56.123 > ✓ Public key loaded from NVS
19:42:56.222 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300769994,"threatLevel":0,"type":"heuristics_update"}
19:42:56.253 > [WebSocket] Processing message type: heuristics_update
19:42:56.256 > [127.6] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:56.365 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":122052,"type":"health_data_error"}
19:42:56.379 > [WebSocket] Processing message type: health_data_error
19:42:56.385 > [127.8] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:56.393 > Generating fresh master key from entropy...
19:42:56.402 > Generated master key (32): 78B89D41F23326065285EB93B8522621 34585A3CB9C4798AC9715D8660C4BBAD 
19:42:56.407 > Using reduced master key (byte % 3) for NTRU encryption only
19:42:56.416 > NTRU encrypted master key (502): 007A007B001F00110055005F00760047 006C003A0013001B0051003400520015 ...
19:42:56.424 > POST http://10.249.92.115:8081/master-key
19:42:56.720 > ✓ Master key exchange completed
19:42:56.821 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":122335,"type":"health_data_error"}
19:42:56.836 > [WebSocket] Processing message type: health_data_error
19:42:56.841 > [128.2] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:56.849 > Loading master key from NVS and deriving symmetric keys...
19:42:56.856 > Loaded master key from NVS (32): 78B89D41F23326065285EB93B8522621 34585A3CB9C4798AC9715D8660C4BBAD 
19:42:56.863 > Derived HMAC key (32): B18DCE08F2B9643BF08F1E40B05F2B0C 1597731850A09134B401AE76AE5A1B94 
19:42:56.871 > Derived Tinkerbell key (16): DBE1FAD9257B0FE6C4793B1E860D6835 
19:42:56.877 > Derived Transposition key (16): ACE9E8DD2AE1305A8FD582212D6E0CCF 
19:42:56.882 > ✓ Symmetric keys derived successfully
19:42:56.885 > Nonce tracker reset - new session started
19:42:57.379 > Waiting for server to process master key...
19:42:57.384 > ✓ Symmetric keys ready - starting health data transmission
19:42:57.486 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300771004,"threatLevel":0,"type":"heuristics_update"}
19:42:57.517 > [WebSocket] Processing message type: heuristics_update
19:42:57.519 > [128.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:57.629 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":122815,"type":"health_data_error"}
19:42:57.643 > [WebSocket] Processing message type: health_data_error
19:42:57.649 > [129.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:57.751 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":123322,"type":"health_data_error"}
19:42:57.765 > [WebSocket] Processing message type: health_data_error
19:42:57.770 > [129.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:57.874 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300772019,"threatLevel":0,"type":"heuristics_update"}
19:42:57.904 > [WebSocket] Processing message type: heuristics_update
19:42:57.907 > [129.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:58.016 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":123574,"type":"health_data_error"}
19:42:58.029 > [WebSocket] Processing message type: health_data_error
19:42:58.036 > [129.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:58.138 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":124080,"type":"health_data_error"}
19:42:58.151 > [WebSocket] Processing message type: health_data_error
19:42:58.158 > [129.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:58.260 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300773031,"threatLevel":0,"type":"heuristics_update"}
19:42:58.290 > [WebSocket] Processing message type: heuristics_update
19:42:58.294 > [129.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:58.402 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":124580,"type":"health_data_error"}
19:42:58.417 > [WebSocket] Processing message type: health_data_error
19:42:58.422 > [129.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:58.524 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":124834,"type":"health_data_error"}
19:42:58.538 > [WebSocket] Processing message type: health_data_error
19:42:58.544 > [129.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:58.646 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":125353,"type":"health_data_error"}
19:42:58.702 > [WebSocket] Processing message type: health_data_error
19:42:58.702 > [130.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:58.769 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300774042,"threatLevel":0,"type":"heuristics_update"}
19:42:58.800 > [WebSocket] Processing message type: heuristics_update
19:42:58.802 > [130.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:58.912 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300775056,"threatLevel":0,"type":"heuristics_update"}
19:42:58.942 > [WebSocket] Processing message type: heuristics_update
19:42:58.945 > [130.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:59.055 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300776064,"threatLevel":0,"type":"heuristics_update"}
19:42:59.086 > [WebSocket] Processing message type: heuristics_update
19:42:59.088 > [130.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:59.198 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770300776548,"type":"master_key_received"}
19:42:59.212 > [WebSocket] Processing message type: master_key_received
19:42:59.214 > [130.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:59.319 > [WebSocket] Received (176 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":128089,"type":"master_key_exchanged"}
19:42:59.337 > [WebSocket] Processing message type: master_key_exchanged
19:42:59.342 > [130.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:59.442 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300777073,"threatLevel":0,"type":"heuristics_update"}
19:42:59.473 > [WebSocket] Processing message type: heuristics_update
19:42:59.476 > [130.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:59.585 > [WebSocket] Received (168 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":128757,"type":"symmetric_keys_derived"}
19:42:59.602 > [WebSocket] Processing message type: symmetric_keys_derived
19:42:59.608 > [131.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:59.707 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300778086,"threatLevel":0,"type":"heuristics_update"}
19:42:59.737 > [WebSocket] Processing message type: heuristics_update
19:42:59.741 > [131.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:59.850 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300779094,"threatLevel":0,"type":"heuristics_update"}
19:42:59.881 > [WebSocket] Processing message type: heuristics_update
19:42:59.883 > [131.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:42:59.992 > [131.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:00.093 > [131.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:00.195 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300780106,"threatLevel":0,"type":"heuristics_update"}
19:43:00.226 > [WebSocket] Processing message type: heuristics_update
19:43:00.229 > [131.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:00.338 > [131.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:00.439 > [131.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:00.539 > [131.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:00.640 > [132.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:00.741 > [132.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:00.842 > [132.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:00.944 > [132.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:01.045 > [132.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:01.149 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300781116,"threatLevel":0,"type":"heuristics_update"}
19:43:01.180 > [WebSocket] Processing message type: heuristics_update
19:43:01.181 > [132.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:01.291 > [132.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:01.392 > [132.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:01.493 > [132.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:01.595 > [133.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:01.695 > [133.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:01.796 > [133.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:01.898 > [133.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:01.998 > [133.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:02.100 > [133.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:02.202 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300782116,"threatLevel":0,"type":"heuristics_update"}
19:43:02.231 > [WebSocket] Processing message type: heuristics_update
19:43:02.234 > [133.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:02.344 > [133.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:02.445 > [133.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:02.545 > [133.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:02.647 > [134.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:02.748 > [134.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:02.848 > [134.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:02.949 > [134.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:03.051 > [134.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:03.152 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300783128,"threatLevel":0,"type":"heuristics_update"}
19:43:03.183 > [WebSocket] Processing message type: heuristics_update
19:43:03.185 > [134.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:03.295 > [134.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:03.396 > [134.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:03.496 > [134.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:03.598 > [135.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:03.698 > [135.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:03.799 > [135.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:03.901 > [135.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:04.002 > [135.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:04.102 > [135.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:04.204 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300784137,"threatLevel":0,"type":"heuristics_update"}
19:43:04.235 > [WebSocket] Processing message type: heuristics_update
19:43:04.237 > [135.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:04.347 > [135.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:04.447 > [135.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:04.548 > [135.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:04.649 > [136.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:04.751 > [136.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:04.852 > [136.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:04.952 > [136.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:05.053 > [136.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:05.155 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300785145,"threatLevel":0,"type":"heuristics_update"}
19:43:05.186 > [WebSocket] Processing message type: heuristics_update
19:43:05.188 > [136.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:05.297 > [136.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:05.399 > [136.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:05.499 > [136.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:05.601 > [137.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:05.702 > [137.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:05.803 > [137.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:05.904 > [137.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:06.005 > [137.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:06.104 > [137.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:06.210 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300786158,"threatLevel":0,"type":"heuristics_update"}
19:43:06.240 > [WebSocket] Processing message type: heuristics_update
19:43:06.243 > [137.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:06.352 > [137.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:06.454 > [137.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:06.554 > [137.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:06.654 > [138.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:06.756 > [138.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:06.858 > [138.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:06.959 > [138.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:07.059 > [138.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:07.160 > [138.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:07.263 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300787171,"threatLevel":0,"type":"heuristics_update"}
19:43:07.292 > [WebSocket] Processing message type: heuristics_update
19:43:07.295 > [138.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:07.404 > [138.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
19:43:07.410 > [RETRY] Attempting to send health data (Max retries: 3)
19:43:07.415 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 1 for all retry attempts (saved: 0)
19:43:07.432 > Generated health data: HR-62 SPO2-95 STEPS-723
19:43:07.438 > [ESP32] ========================================
19:43:07.441 > [ESP32] ENCRYPTION PIPELINE START
19:43:07.443 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:43:07.449 > [ESP32] Active Algorithms for this packet:
19:43:07.455 > [ESP32]   + LFSR
19:43:07.455 > [ESP32]   + Tinkerbell
19:43:07.458 > [ESP32]   + Transposition
19:43:07.460 > [ESP32]   - ChaCha20
19:43:07.460 > [ESP32]   - Salsa20
19:43:07.463 > [ESP32] ========================================
19:43:07.468 > [ESP32] MsgKeys: lfsrSeed=0x54E9C8B2 tnk[0..3]=D5ABB78B trn[0..3]=651751CA
19:43:07.474 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3732334D50
19:43:07.479 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3732334D5000000000000000 
19:43:07.487 > [ESP32][LFSR] Initializing - Seed: 0x54E9C8B2 SeedBe: 0xB2C8E954 ChaosKey[0..3]: D5ABB78B InitialTap: 0x0029 State: 0x54E9C8B2
19:43:07.499 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:43:07.507 > 3_After_LFSR (32): FA9AC462DB047CE6470F3667561E363D 301C09231A4D7E8E40D4BF875B6E4AD3 
19:43:07.516 > [ESP32][LFSR] Keystream (first 16 bytes): B2C8E954E9242FB6083D1B5E633E6569
19:43:07.521 > [ESP32][4D] LFSR keystream (first 32 bytes): B2C8E954E9242FB6083D1B5E633E6569754C5A0E2D7F4DC310D4BF875B6E4AD3
19:43:07.530 > [ESP32][TINKERBELL] Input (first 16 bytes): FA9AC462DB047CE6470F3667561E363D Nonce: 0x00000001 Buffer size: 32 bytes
19:43:07.540 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: D5ABB78B
19:43:07.552 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E057885FD6410DE45A0F5E9F2B0F9BE1
19:43:07.560 > 4_After_Tinkerbell (32): 1ACD4C3D0D4571021D0068F87D11ADDC AA25019E986B482BBD1C9866B46DE8A6 
19:43:07.568 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E057885FD6410DE45A0F5E9F2B0F9BE1
19:43:07.574 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E057885FD6410DE45A0F5E9F2B0F9BE19A3908BD822636A5FDC827E1EF03A275
19:43:07.585 > 5_After_Transposition (32): BDA62B1145029E714C68E81A6BDC3D98 0DAA1CCD01486DAD661DB49825F8007D 
19:43:07.593 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
19:43:07.599 > [ESP32] === HMAC DEBUG INFO ===
19:43:07.602 > [ESP32] HMAC Key being used: B18DCE08F2B9643BF08F1E40B05F2B0C1597731850A09134B401AE76AE5A1B94
19:43:07.610 > [ESP32] HMAC Input length: 45 bytes
19:43:07.613 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000001BDA62B1145029E714C68E81A6BDC3D980DAA1C
19:43:07.621 > [ESP32] Nonce: 0x00000001
19:43:07.624 > [ESP32] Packet size before HMAC: 61
19:43:07.626 > [ESP32] Computed HMAC Tag: 3206828F9345352138D1309F195A0AAE
19:43:07.631 > [ESP32] === END HMAC DEBUG ===
19:43:07.635 > 6_Final_Packet (61): 82021700170004080400000001BDA62B 1145029E714C68E81A6BDC3D980DAA1C ...
19:43:07.643 > [RETRY] Attempt 1/3 (nonce: 1)
19:43:07.646 > POST http://10.249.92.115:8081/health-data with pipeline data
19:43:07.652 > Sending pipeline data to server (606 bytes)
19:43:07.975 > [HTTP] Response code: 200
19:43:07.975 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:43:07.986 > [RETRY] Health data sent successfully!
19:43:07.989 > ✓ Health data #11 sent successfully
19:43:08.090 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:82021700170004080400000001BDA62B1145029E714C68E81A6BDC3D980DAA1CCD01486DAD661DB49825F8007D3206828F9345352138D1309F195A0AAE","pipeline":{"afterLFSR":"FA9AC462DB047CE6470F3667561E363D301C09231A4D7E8E40D4BF875B6E4AD3","afterSalt":"48522D36322053504F322D39352053544550532D3732334D50","afterTinkerbell":"1ACD4C3D0D4571021D0068F87D11ADDCAA25019E986B482BBD1C9866B46DE8A6","afterTransposition":"BDA62B1145029E714C68E81A6BDC3D980DAA1CCD01486DAD661DB49825F8007D"},"plaintext":"HR-62 SPO2-95 STEPS-723","serverTime":1770300787740,"timestamp":139018,"type":"encryption_update","ztmEnabled":true}
19:43:08.147 > [WebSocket] Processing message type: encryption_update
19:43:08.151 > [139.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:08.255 > [WebSocket] Received (87 bytes): {"heartRate":62,"spo2":95,"steps":723,"time":1770300787741,"type":"health_data_update"}
19:43:08.263 > [WebSocket] Processing message type: health_data_update
19:43:08.268 > [139.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:08.376 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2638,"encryptionTime":0.0,"finalPlaintext":"HR-62 SPO2-95 STEPS-723","handshakeSuccess":true,"totalTime":0.2638},"type":"session_summary_update"}
19:43:08.398 > [WebSocket] Processing message type: session_summary_update
19:43:08.404 > [139.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:08.509 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2638,"encryptedPacket":"82021700170004080400000001BDA62B1145029E714C68E81A6BDC3D980DAA1CCD01486DAD661DB49825F8007D3206828F9345352138D1309F195A0AAE","finalPlaintext":"HR-62 SPO2-95 STEPS-723","healthData":{"heartRate":62,"spo2":95,"steps":723},"pipeline":{"afterDepad":"48522D36322053504F322D39352053544550532D37323300000000000000","afterLFSR":"48522D36322053504F322D39352053544550532D3732334D5000000000000000","afterTinkerbell":"FA9AC462DB047CE6470F3667561E363D301C09231A4D7E8E40D4BF875B6E4AD3","afterTransposition":"1ACD4C3D0D4571021D0068F87D11ADDCAA25019E986B482BBD1C9866B46DE8A6"},"serverTime":1770300787742,"type":"decryption_update"}
19:43:08.567 > [WebSocket] Processing message type: decryption_update
19:43:08.573 > [WebSocket] Server decryption completed
19:43:08.576 > [WebSocket] Health data - HR: 62, SPO2: 95, Steps: 723
19:43:08.582 > [139.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:08.682 > [WebSocket] Received (646 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":10,"pipeline":{"afterLFSR":"FA9AC462DB047CE6470F3667561E363D301C09231A4D7E8E40D4BF875B6E4AD3","afterSalt":"48522D36322053504F322D39352053544550532D3732334D50","afterTinkerbell":"1ACD4C3D0D4571021D0068F87D11ADDCAA25019E986B482BBD1C9866B46DE8A6","afterTransposition":"BDA62B1145029E714C68E81A6BDC3D980DAA1CCD01486DAD661DB49825F8007D","finalPacket":"82021700170004080400000001BDA62B1145029E714C68E81A6BDC3D980DAA1CCD01486DAD661DB49825F8007D3206828F9345352138D1309F195A0AAE"},"plaintext":"HR-62 SPO2-95 STEPS-723","timestamp":139352,"type":"encryption_pipeline","ztmEnabled":true}
19:43:08.741 > [WebSocket] Processing message type: encryption_pipeline
19:43:08.746 > [140.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:08.845 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Health data #11 sent successfully","state":7,"success":true,"timestamp":139357,"type":"health_data_sent"}
19:43:08.862 > [WebSocket] Processing message type: health_data_sent
19:43:08.865 > [140.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:08.967 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300788178,"threatLevel":0,"type":"heuristics_update"}
19:43:08.999 > [WebSocket] Processing message type: heuristics_update
19:43:09.001 > [140.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:09.111 > [140.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:09.215 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300789186,"threatLevel":0,"type":"heuristics_update"}
19:43:09.245 > [WebSocket] Processing message type: heuristics_update
19:43:09.248 > [140.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:09.356 > [140.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:09.456 > [140.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:09.559 > [140.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:09.659 > [141.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:09.760 > [141.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:09.862 > [141.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:09.963 > [141.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:10.064 > [141.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:10.165 > [141.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:10.266 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300790193,"threatLevel":0,"type":"heuristics_update"}
19:43:10.297 > [WebSocket] Processing message type: heuristics_update
19:43:10.300 > [141.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:10.408 > [141.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:10.509 > [141.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:10.610 > [142.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:10.711 > [142.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:10.813 > [142.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:10.913 > [142.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:11.015 > [142.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:11.116 > [142.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:11.217 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300791200,"threatLevel":0,"type":"heuristics_update"}
19:43:11.248 > [WebSocket] Processing message type: heuristics_update
19:43:11.251 > [142.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:11.360 > [142.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:11.462 > [142.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:11.562 > [142.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:11.663 > [143.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:11.765 > [143.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:11.866 > [143.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:11.966 > [143.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:12.067 > [143.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:12.168 > [143.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:12.270 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300792214,"threatLevel":0,"type":"heuristics_update"}
19:43:12.300 > [WebSocket] Processing message type: heuristics_update
19:43:12.303 > [143.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:12.412 > [143.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:12.513 > [143.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:12.614 > [144.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:12.715 > [144.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:12.816 > [144.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:12.917 > [144.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:13.018 > [144.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:13.118 > [144.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:13.220 > [144.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:13.322 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300793228,"threatLevel":0,"type":"heuristics_update"}
19:43:13.352 > [WebSocket] Processing message type: heuristics_update
19:43:13.356 > [144.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:13.464 > [144.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:13.564 > [144.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:13.666 > [145.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:13.768 > [145.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:13.868 > [145.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:13.970 > [145.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:14.070 > [145.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:14.171 > [145.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:14.274 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300794236,"threatLevel":0,"type":"heuristics_update"}
19:43:14.304 > [WebSocket] Processing message type: heuristics_update
19:43:14.308 > [145.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:14.418 > [145.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:14.518 > [145.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:14.619 > [146.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:14.720 > [146.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:14.821 > [146.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:14.922 > [146.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:15.023 > [146.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:15.124 > [146.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:15.226 > [146.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:15.327 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300795245,"threatLevel":0,"type":"heuristics_update"}
19:43:15.356 > [WebSocket] Processing message type: heuristics_update
19:43:15.360 > [146.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:15.470 > [146.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:15.569 > [146.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:15.670 > [147.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:15.772 > [147.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:15.873 > [147.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:15.975 > [147.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:16.076 > [147.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:16.176 > [147.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:16.277 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300796254,"threatLevel":0,"type":"heuristics_update"}
19:43:16.309 > [WebSocket] Processing message type: heuristics_update
19:43:16.311 > [147.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:16.420 > [147.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:16.521 > [147.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:16.622 > [148.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:16.722 > [148.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:16.824 > [148.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:16.926 > [148.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:17.026 > [148.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:17.127 > [148.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:17.228 > [148.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:17.329 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300797266,"threatLevel":0,"type":"heuristics_update"}
19:43:17.361 > [WebSocket] Processing message type: heuristics_update
19:43:17.364 > [148.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:17.472 > [148.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:17.573 > [148.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:17.674 > [149.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:17.775 > [149.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:17.876 > [149.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:17.976 > [149.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:18.078 > [149.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
19:43:18.083 > [RETRY] Attempting to send health data (Max retries: 3)
19:43:18.089 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 2 for all retry attempts (saved: 1)
19:43:18.106 > Generated health data: HR-62 SPO2-95 STEPS-776
19:43:18.111 > [ESP32] ========================================
19:43:18.114 > [ESP32] ENCRYPTION PIPELINE START
19:43:18.117 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:43:18.122 > [ESP32] Active Algorithms for this packet:
19:43:18.128 > [ESP32]   + LFSR
19:43:18.128 > [ESP32]   + Tinkerbell
19:43:18.131 > [ESP32]   + Transposition
19:43:18.133 > [ESP32]   - ChaCha20
19:43:18.133 > [ESP32]   - Salsa20
19:43:18.136 > [ESP32] ========================================
19:43:18.142 > [ESP32] MsgKeys: lfsrSeed=0xDE782136 tnk[0..3]=C67B96FE trn[0..3]=152689B9
19:43:18.148 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3737364D50
19:43:18.152 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3737364D5000000000000000 
19:43:18.161 > [ESP32][LFSR] Initializing - Seed: 0xDE782136 SeedBe: 0x362178DE ChaosKey[0..3]: C67B96FE InitialTap: 0x0029 State: 0xDE782136
19:43:18.173 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:43:18.180 > 3_After_LFSR (32): 7E7355E8297458C8680FC936DACBB9BF 7620062483794A4C81767F9675355882 
19:43:18.189 > [ESP32][LFSR] Keystream (first 16 bytes): 362178DE1B540B98273DE40FEFEBEAEB
19:43:18.195 > [ESP32][4D] LFSR keystream (first 32 bytes): 362178DE1B540B98273DE40FEFEBEAEB33705509B44E7C01D1767F9675355882
19:43:18.203 > [ESP32][TINKERBELL] Input (first 16 bytes): 7E7355E8297458C8680FC936DACBB9BF Nonce: 0x00000002 Buffer size: 32 bytes
19:43:18.214 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: C67B96FE
19:43:18.225 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 80B70BA2BD2FFAB90E8F8BEC98762790
19:43:18.233 > 4_After_Tinkerbell (32): FEC45E4A945BA271668042DA42BD9E2F 61315468937E8800F1272927DF1F9439 
19:43:18.242 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 80B70BA2BD2FFAB90E8F8BEC98762790
19:43:18.247 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 80B70BA2BD2FFAB90E8F8BEC987627901711524C1007C24C705156B1AA2ACCBB
19:43:18.258 > 5_After_Transposition (32): 9466274294297E3161DF5B8071548842 9E271FA2685EC44ADA9339BD2FFEF100 
19:43:18.267 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
19:43:18.272 > [ESP32] === HMAC DEBUG INFO ===
19:43:18.275 > [ESP32] HMAC Key being used: B18DCE08F2B9643BF08F1E40B05F2B0C1597731850A09134B401AE76AE5A1B94
19:43:18.284 > [ESP32] HMAC Input length: 45 bytes
19:43:18.286 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000029466274294297E3161DF5B80715488429E271F
19:43:18.295 > [ESP32] Nonce: 0x00000002
19:43:18.297 > [ESP32] Packet size before HMAC: 61
19:43:18.300 > [ESP32] Computed HMAC Tag: 471D97B0D4C469E7EF30CA479A9D9861
19:43:18.306 > [ESP32] === END HMAC DEBUG ===
19:43:18.309 > 6_Final_Packet (61): 82021700170004080400000002946627 4294297E3161DF5B80715488429E271F ...
19:43:18.317 > [RETRY] Attempt 1/3 (nonce: 2)
19:43:18.319 > POST http://10.249.92.115:8081/health-data with pipeline data
19:43:18.326 > Sending pipeline data to server (606 bytes)
19:43:18.526 > [HTTP] Response code: 200
19:43:18.526 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:43:18.538 > [RETRY] Health data sent successfully!
19:43:18.541 > ✓ Health data #12 sent successfully
19:43:18.643 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":1,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300798280,"threatLevel":0,"type":"heuristics_update"}
19:43:18.674 > [WebSocket] Processing message type: heuristics_update
19:43:18.676 > [150.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:18.786 > [WebSocket] Received (184 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":12,"requests_per_minute":14,"serverTime":1770300798437,"type":"security_update"}
19:43:18.806 > [WebSocket] Processing message type: security_update
19:43:18.809 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:43:18.814 > [150.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:18.918 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820217001700040804000000029466274294297E3161DF5B80715488429E271FA2685EC44ADA9339BD2FFEF100471D97B0D4C469E7EF30CA479A9D9861","pipeline":{"afterLFSR":"7E7355E8297458C8680FC936DACBB9BF7620062483794A4C81767F9675355882","afterSalt":"48522D36322053504F322D39352053544550532D3737364D50","afterTinkerbell":"FEC45E4A945BA271668042DA42BD9E2F61315468937E8800F1272927DF1F9439","afterTransposition":"9466274294297E3161DF5B80715488429E271FA2685EC44ADA9339BD2FFEF100"},"plaintext":"HR-62 SPO2-95 STEPS-776","serverTime":1770300798437,"timestamp":149692,"type":"encryption_update","ztmEnabled":true}
19:43:18.974 > [WebSocket] Processing message type: encryption_update
19:43:18.979 > [150.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:19.082 > [WebSocket] Received (87 bytes): {"heartRate":62,"spo2":95,"steps":776,"time":1770300798437,"type":"health_data_update"}
19:43:19.089 > [WebSocket] Processing message type: health_data_update
19:43:19.095 > [150.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:19.204 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.5381,"encryptionTime":0.0,"finalPlaintext":"HR-62 SPO2-95 STEPS-776","handshakeSuccess":true,"totalTime":0.5381},"type":"session_summary_update"}
19:43:19.226 > [WebSocket] Processing message type: session_summary_update
19:43:19.231 > [150.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:19.336 > [WebSocket] Received (658 bytes): {"decryptionTime":0.5381,"encryptedPacket":"820217001700040804000000029466274294297E3161DF5B80715488429E271FA2685EC44ADA9339BD2FFEF100471D97B0D4C469E7EF30CA479A9D9861","finalPlaintext":"HR-62 SPO2-95 STEPS-776","healthData":{"heartRate":62,"spo2":95,"steps":776},"pipeline":{"afterDepad":"48522D36322053504F322D39352053544550532D37373600000000000000","afterLFSR":"48522D36322053504F322D39352053544550532D3737364D5000000000000000","afterTinkerbell":"7E7355E8297458C8680FC936DACBB9BF7620062483794A4C81767F9675355882","afterTransposition":"FEC45E4A945BA271668042DA42BD9E2F61315468937E8800F1272927DF1F9439"},"serverTime":1770300798438,"type":"decryption_update"}
19:43:19.394 > [WebSocket] Processing message type: decryption_update
19:43:19.400 > [WebSocket] Server decryption completed
19:43:19.402 > [WebSocket] Health data - HR: 62, SPO2: 95, Steps: 776
19:43:19.409 > [150.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:19.510 > [WebSocket] Received (646 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":11,"pipeline":{"afterLFSR":"7E7355E8297458C8680FC936DACBB9BF7620062483794A4C81767F9675355882","afterSalt":"48522D36322053504F322D39352053544550532D3737364D50","afterTinkerbell":"FEC45E4A945BA271668042DA42BD9E2F61315468937E8800F1272927DF1F9439","afterTransposition":"9466274294297E3161DF5B80715488429E271FA2685EC44ADA9339BD2FFEF100","finalPacket":"820217001700040804000000029466274294297E3161DF5B80715488429E271FA2685EC44ADA9339BD2FFEF100471D97B0D4C469E7EF30CA479A9D9861"},"plaintext":"HR-62 SPO2-95 STEPS-776","timestamp":149904,"type":"encryption_pipeline","ztmEnabled":true}
19:43:19.569 > [WebSocket] Processing message type: encryption_pipeline
19:43:19.574 > [150.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:19.673 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Health data #12 sent successfully","state":7,"success":true,"timestamp":149909,"type":"health_data_sent"}
19:43:19.691 > [WebSocket] Processing message type: health_data_sent
19:43:19.693 > [151.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:19.797 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300799293,"threatLevel":0,"type":"heuristics_update"}
19:43:19.827 > [WebSocket] Processing message type: heuristics_update
19:43:19.830 > [151.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:19.939 > [151.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:20.040 > [151.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:20.141 > [151.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:20.241 > [151.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:20.343 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300800307,"threatLevel":0,"type":"heuristics_update"}
19:43:20.374 > [WebSocket] Processing message type: heuristics_update
19:43:20.377 > [151.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:20.486 > [151.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:20.587 > [152.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:20.688 > [152.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:20.789 > [152.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:20.890 > [152.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:20.991 > [152.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:21.092 > [152.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:21.193 > [152.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:21.294 > [152.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:21.395 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300801316,"threatLevel":0,"type":"heuristics_update"}
19:43:21.426 > [WebSocket] Processing message type: heuristics_update
19:43:21.429 > [152.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:21.537 > [152.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:21.638 > [153.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:21.740 > [153.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:21.841 > [153.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:21.942 > [153.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:22.043 > [153.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:22.144 > [153.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:22.245 > [153.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:22.346 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300802330,"threatLevel":0,"type":"heuristics_update"}
19:43:22.378 > [WebSocket] Processing message type: heuristics_update
19:43:22.379 > [153.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:22.489 > [153.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:22.590 > [154.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:22.691 > [154.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:22.792 > [154.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:22.893 > [154.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:22.994 > [154.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:23.095 > [154.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:23.197 > [154.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:23.296 > [154.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:23.400 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300803342,"threatLevel":0,"type":"heuristics_update"}
19:43:23.431 > [WebSocket] Processing message type: heuristics_update
19:43:23.434 > [154.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:23.543 > [154.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:23.644 > [155.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:23.745 > [155.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:23.845 > [155.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:23.947 > [155.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:24.048 > [155.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:24.148 > [155.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:24.250 > [155.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:24.351 > [155.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:24.452 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300804354,"threatLevel":0,"type":"heuristics_update"}
19:43:24.483 > [WebSocket] Processing message type: heuristics_update
19:43:24.486 > [155.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:24.595 > [156.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:24.695 > [156.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:24.797 > [156.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:24.897 > [156.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:24.999 > [156.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:25.100 > [156.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:25.201 > [156.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:25.302 > [156.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:25.403 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300805366,"threatLevel":0,"type":"heuristics_update"}
19:43:25.434 > [WebSocket] Processing message type: heuristics_update
19:43:25.437 > [156.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:25.546 > [156.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:25.647 > [157.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:25.748 > [157.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:25.849 > [157.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:25.950 > [157.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:26.051 > [157.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:26.152 > [157.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:26.252 > [157.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:26.354 > [157.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:26.456 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300806376,"threatLevel":0,"type":"heuristics_update"}
19:43:26.486 > [WebSocket] Processing message type: heuristics_update
19:43:26.488 > [157.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:26.598 > [158.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:26.698 > [158.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:26.800 > [158.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:26.900 > [158.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:27.002 > [158.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:27.103 > [158.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:27.204 > [158.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:27.304 > [158.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:27.406 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300807380,"threatLevel":0,"type":"heuristics_update"}
19:43:27.437 > [WebSocket] Processing message type: heuristics_update
19:43:27.440 > [158.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:27.549 > [158.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:27.650 > [159.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:27.751 > [159.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:27.852 > [159.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:27.953 > [159.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:28.054 > [159.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:28.155 > [159.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:28.256 > [159.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:28.357 > [159.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:28.461 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":2,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300808390,"threatLevel":0,"type":"heuristics_update"}
19:43:28.491 > [WebSocket] Processing message type: heuristics_update
19:43:28.494 > [159.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:28.603 > [160.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 12 | WS: CONNECTED
19:43:28.609 > [RETRY] Attempting to send health data (Max retries: 3)
19:43:28.614 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 3 for all retry attempts (saved: 2)
19:43:28.630 > Generated health data: HR-62 SPO2-95 STEPS-846
19:43:28.636 > [ESP32] ========================================
19:43:28.639 > [ESP32] ENCRYPTION PIPELINE START
19:43:28.642 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:43:28.647 > [ESP32] Active Algorithms for this packet:
19:43:28.652 > [ESP32]   + LFSR
19:43:28.652 > [ESP32]   + Tinkerbell
19:43:28.656 > [ESP32]   + Transposition
19:43:28.659 > [ESP32]   - ChaCha20
19:43:28.659 > [ESP32]   - Salsa20
19:43:28.662 > [ESP32] ========================================
19:43:28.667 > [ESP32] MsgKeys: lfsrSeed=0x6EDA7273 tnk[0..3]=AA2F3441 trn[0..3]=663AA02E
19:43:28.672 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3834364D50
19:43:28.678 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3834364D5000000000000000 
19:43:28.686 > [ESP32][LFSR] Initializing - Seed: 0x6EDA7273 SeedBe: 0x7372DA6E ChaosKey[0..3]: AA2F3441 InitialTap: 0x0029 State: 0x6EDA7273
19:43:28.697 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:43:28.705 > 3_After_LFSR (32): 3B20F758EB8065127523E5B804FA1F46 4AF1BE5895D6D1BAE85B9ADF0F3519B1 
19:43:28.714 > [ESP32][LFSR] Keystream (first 16 bytes): 7372DA6ED9A036423A11C88131DA4C12
19:43:28.720 > [ESP32][4D] LFSR keystream (first 32 bytes): 7372DA6ED9A036423A11C88131DA4C120FA1ED75ADE2E7F7B85B9ADF0F3519B1
19:43:28.728 > [ESP32][TINKERBELL] Input (first 16 bytes): 3B20F758EB8065127523E5B804FA1F46 Nonce: 0x00000003 Buffer size: 32 bytes
19:43:28.739 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: AA2F3441
19:43:28.750 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 41107E8C7C492E75D26E7EE4D84A6026
19:43:28.758 > 4_After_Tinkerbell (32): 7A3089D497C94B67A74D9B5CDCB07F60 4C6DA70B94C8A954151FAD38331A6257 
19:43:28.767 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 41107E8C7C492E75D26E7EE4D84A6026
19:43:28.772 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 41107E8C7C492E75D26E7EE4D84A6026069C1953011E78EEFD4437E73C2F7BE6
19:43:28.784 > 5_After_Transposition (32): 894D4C4BA99462D415547F33971F7A9B B0675C60ADA70BDC6DC83857A71AC930 
19:43:28.792 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000003
19:43:28.798 > [ESP32] === HMAC DEBUG INFO ===
19:43:28.800 > [ESP32] HMAC Key being used: B18DCE08F2B9643BF08F1E40B05F2B0C1597731850A09134B401AE76AE5A1B94
19:43:28.808 > [ESP32] HMAC Input length: 45 bytes
19:43:28.811 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000003894D4C4BA99462D415547F33971F7A9BB0675C
19:43:28.819 > [ESP32] Nonce: 0x00000003
19:43:28.823 > [ESP32] Packet size before HMAC: 61
19:43:28.825 > [ESP32] Computed HMAC Tag: D66DED4E9C664FF574D0AC82B79B6901
19:43:28.831 > [ESP32] === END HMAC DEBUG ===
19:43:28.833 > 6_Final_Packet (61): 82021700170004080400000003894D4C 4BA99462D415547F33971F7A9BB0675C ...
19:43:28.842 > [RETRY] Attempt 1/3 (nonce: 3)
19:43:28.845 > POST http://10.249.92.115:8081/health-data with pipeline data
19:43:28.850 > Sending pipeline data to server (606 bytes)
19:43:29.049 > [HTTP] Response code: 200
19:43:29.049 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:43:29.061 > [RETRY] Health data sent successfully!
19:43:29.064 > ✓ Health data #13 sent successfully
19:43:29.163 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:82021700170004080400000003894D4C4BA99462D415547F33971F7A9BB0675C60ADA70BDC6DC83857A71AC930D66DED4E9C664FF574D0AC82B79B6901","pipeline":{"afterLFSR":"3B20F758EB8065127523E5B804FA1F464AF1BE5895D6D1BAE85B9ADF0F3519B1","afterSalt":"48522D36322053504F322D39352053544550532D3834364D50","afterTinkerbell":"7A3089D497C94B67A74D9B5CDCB07F604C6DA70B94C8A954151FAD38331A6257","afterTransposition":"894D4C4BA99462D415547F33971F7A9BB0675C60ADA70BDC6DC83857A71AC930"},"plaintext":"HR-62 SPO2-95 STEPS-846","serverTime":1770300808948,"timestamp":160217,"type":"encryption_update","ztmEnabled":true}
19:43:29.218 > [WebSocket] Processing message type: encryption_update
19:43:29.223 > [160.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:29.327 > [WebSocket] Received (87 bytes): {"heartRate":62,"spo2":95,"steps":846,"time":1770300808948,"type":"health_data_update"}
19:43:29.335 > [WebSocket] Processing message type: health_data_update
19:43:29.341 > [160.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:29.450 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2487,"encryptionTime":0.0,"finalPlaintext":"HR-62 SPO2-95 STEPS-846","handshakeSuccess":true,"totalTime":0.2487},"type":"session_summary_update"}
19:43:29.472 > [WebSocket] Processing message type: session_summary_update
19:43:29.477 > [160.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:29.582 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2487,"encryptedPacket":"82021700170004080400000003894D4C4BA99462D415547F33971F7A9BB0675C60ADA70BDC6DC83857A71AC930D66DED4E9C664FF574D0AC82B79B6901","finalPlaintext":"HR-62 SPO2-95 STEPS-846","healthData":{"heartRate":62,"spo2":95,"steps":846},"pipeline":{"afterDepad":"48522D36322053504F322D39352053544550532D38343600000000000000","afterLFSR":"48522D36322053504F322D39352053544550532D3834364D5000000000000000","afterTinkerbell":"3B20F758EB8065127523E5B804FA1F464AF1BE5895D6D1BAE85B9ADF0F3519B1","afterTransposition":"7A3089D497C94B67A74D9B5CDCB07F604C6DA70B94C8A954151FAD38331A6257"},"serverTime":1770300808949,"type":"decryption_update"}
19:43:29.640 > [WebSocket] Processing message type: decryption_update
19:43:29.645 > [WebSocket] Server decryption completed
19:43:29.648 > [WebSocket] Health data - HR: 62, SPO2: 95, Steps: 846
19:43:29.654 > [161.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:29.755 > [WebSocket] Received (646 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":12,"pipeline":{"afterLFSR":"3B20F758EB8065127523E5B804FA1F464AF1BE5895D6D1BAE85B9ADF0F3519B1","afterSalt":"48522D36322053504F322D39352053544550532D3834364D50","afterTinkerbell":"7A3089D497C94B67A74D9B5CDCB07F604C6DA70B94C8A954151FAD38331A6257","afterTransposition":"894D4C4BA99462D415547F33971F7A9BB0675C60ADA70BDC6DC83857A71AC930","finalPacket":"82021700170004080400000003894D4C4BA99462D415547F33971F7A9BB0675C60ADA70BDC6DC83857A71AC930D66DED4E9C664FF574D0AC82B79B6901"},"plaintext":"HR-62 SPO2-95 STEPS-846","timestamp":160427,"type":"encryption_pipeline","ztmEnabled":true}
19:43:29.813 > [WebSocket] Processing message type: encryption_pipeline
19:43:29.819 > [161.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:29.919 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":12,"message":"Health data #13 sent successfully","state":7,"success":true,"timestamp":160432,"type":"health_data_sent"}
19:43:29.935 > [WebSocket] Processing message type: health_data_sent
19:43:29.938 > [161.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:30.040 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300809398,"threatLevel":0,"type":"heuristics_update"}
19:43:30.071 > [WebSocket] Processing message type: heuristics_update
19:43:30.073 > [161.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:30.183 > [161.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:30.284 > [161.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:30.385 > [161.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:30.489 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300810413,"threatLevel":0,"type":"heuristics_update"}
19:43:30.519 > [WebSocket] Processing message type: heuristics_update
19:43:30.522 > [161.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:30.631 > [162.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:30.732 > [162.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:30.833 > [162.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:30.933 > [162.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:31.035 > [162.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:31.135 > [162.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:31.237 > [162.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:31.337 > [162.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:31.439 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300811422,"threatLevel":0,"type":"heuristics_update"}
19:43:31.470 > [WebSocket] Processing message type: heuristics_update
19:43:31.472 > [162.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:31.582 > [163.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:31.683 > [163.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:31.784 > [163.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:31.885 > [163.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:31.985 > [163.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:32.086 > [163.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:32.188 > [163.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:32.288 > [163.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:32.389 > [163.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:32.492 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300812434,"threatLevel":0,"type":"heuristics_update"}
19:43:32.522 > [WebSocket] Processing message type: heuristics_update
19:43:32.525 > [163.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:32.634 > [164.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:32.735 > [164.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:32.836 > [164.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:32.937 > [164.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:33.038 > [164.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:33.138 > [164.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:33.239 > [164.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:33.340 > [164.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:33.442 > [164.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:33.544 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300813447,"threatLevel":0,"type":"heuristics_update"}
19:43:33.574 > [WebSocket] Processing message type: heuristics_update
19:43:33.576 > [165.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:33.686 > [165.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:33.787 > [165.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:33.888 > [165.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:33.988 > [165.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:34.090 > [165.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:34.191 > [165.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:34.292 > [165.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:34.392 > [165.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:34.495 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300814459,"threatLevel":0,"type":"heuristics_update"}
19:43:34.525 > [WebSocket] Processing message type: heuristics_update
19:43:34.528 > [165.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:34.636 > [166.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:34.737 > [166.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:34.838 > [166.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:34.939 > [166.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:35.040 > [166.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:35.142 > [166.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:35.242 > [166.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:35.344 > [166.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:35.445 > [166.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:35.549 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300815460,"threatLevel":0,"type":"heuristics_update"}
19:43:35.578 > [WebSocket] Processing message type: heuristics_update
19:43:35.582 > [167.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:35.691 > [167.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:35.791 > [167.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:35.892 > [167.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:35.994 > [167.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:36.095 > [167.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:36.195 > [167.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:36.296 > [167.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:36.398 > [167.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:36.499 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300816473,"threatLevel":0,"type":"heuristics_update"}
19:43:36.530 > [WebSocket] Processing message type: heuristics_update
19:43:36.533 > [167.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:36.642 > [168.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:36.743 > [168.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:36.843 > [168.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:36.944 > [168.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:37.046 > [168.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:37.146 > [168.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:37.248 > [168.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:37.349 > [168.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:37.449 > [168.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:37.551 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300817474,"threatLevel":0,"type":"heuristics_update"}
19:43:37.581 > [WebSocket] Processing message type: heuristics_update
19:43:37.584 > [169.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:37.693 > [169.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:37.794 > [169.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:37.895 > [169.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:37.997 > [169.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:38.097 > [169.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:38.198 > [169.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:38.300 > [169.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:38.401 > [169.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:38.502 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300818487,"threatLevel":0,"type":"heuristics_update"}
19:43:38.532 > [WebSocket] Processing message type: heuristics_update
19:43:38.535 > [169.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:38.644 > [170.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:38.746 > [170.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:38.847 > [170.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:38.948 > [170.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:39.049 > [170.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:39.149 > [170.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 13 | WS: CONNECTED
19:43:39.155 > [RETRY] Attempting to send health data (Max retries: 3)
19:43:39.161 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 4 for all retry attempts (saved: 3)
19:43:39.177 > Generated health data: HR-62 SPO2-95 STEPS-851
19:43:39.183 > [ESP32] ========================================
19:43:39.185 > [ESP32] ENCRYPTION PIPELINE START
19:43:39.188 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:43:39.194 > [ESP32] Active Algorithms for this packet:
19:43:39.200 > [ESP32]   + LFSR
19:43:39.200 > [ESP32]   + Tinkerbell
19:43:39.202 > [ESP32]   + Transposition
19:43:39.205 > [ESP32]   - ChaCha20
19:43:39.205 > [ESP32]   - Salsa20
19:43:39.208 > [ESP32] ========================================
19:43:39.213 > [ESP32] MsgKeys: lfsrSeed=0xE7472F58 tnk[0..3]=7B2B9DFD trn[0..3]=D4417FA6
19:43:39.219 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3835314D50
19:43:39.225 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3835314D5000000000000000 
19:43:39.233 > [ESP32][LFSR] Initializing - Seed: 0xE7472F58 SeedBe: 0x582F47E7 ChaosKey[0..3]: 7B2B9DFD InitialTap: 0x0029 State: 0xE7472F58
19:43:39.244 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
19:43:39.252 > 3_After_LFSR (32): 107D6AD17C2EB9300C12C7A3222C6A31 F1326A5296866543FEC31CC267CA685C 
19:43:39.261 > [ESP32][LFSR] Keystream (first 16 bytes): 582F47E74E0EEA604320EA9A170C3965
19:43:39.266 > [ESP32][4D] LFSR keystream (first 32 bytes): 582F47E74E0EEA604320EA9A170C3965B462397FAEB3540EAEC31CC267CA685C
19:43:39.274 > [ESP32][TINKERBELL] Input (first 16 bytes): 107D6AD17C2EB9300C12C7A3222C6A31 Nonce: 0x00000004 Buffer size: 32 bytes
19:43:39.285 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000004 Counter: 0 (must start at 0) Key[0..3]: 7B2B9DFD
19:43:39.297 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 9D368B733C2D8ADC669376A866E22C0D
19:43:39.304 > 4_After_Tinkerbell (32): 8D4BE1A2400333EC6A81B10B44CE463C 0383F1037BB2745BA01A66BA8E187DE8 
19:43:39.313 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 9D368B733C2D8ADC669376A866E22C0D
19:43:39.319 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 9D368B733C2D8ADC669376A866E22C0DF2B19B51ED3411185ED97A78E9D215B4
19:43:39.329 > 5_After_Transposition (32): 8144745B4B6640B28D1ACE836A03EC33 7D46BAF1038E3CB1A2E8E1A003187B0B 
19:43:39.338 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000004
19:43:39.344 > [ESP32] === HMAC DEBUG INFO ===
19:43:39.346 > [ESP32] HMAC Key being used: B18DCE08F2B9643BF08F1E40B05F2B0C1597731850A09134B401AE76AE5A1B94
19:43:39.355 > [ESP32] HMAC Input length: 45 bytes
19:43:39.358 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000048144745B4B6640B28D1ACE836A03EC337D46BA
19:43:39.366 > [ESP32] Nonce: 0x00000004
19:43:39.368 > [ESP32] Packet size before HMAC: 61
19:43:39.371 > [ESP32] Computed HMAC Tag: A52A1BAF3439BD8987474618B5F8C85D
19:43:39.377 > [ESP32] === END HMAC DEBUG ===
19:43:39.380 > 6_Final_Packet (61): 82021700170004080400000004814474 5B4B6640B28D1ACE836A03EC337D46BA ...
19:43:39.387 > [RETRY] Attempt 1/3 (nonce: 4)
19:43:39.391 > POST http://10.249.92.115:8081/health-data with pipeline data
19:43:39.396 > Sending pipeline data to server (606 bytes)
19:43:39.821 > [HTTP] Response code: 200
19:43:39.822 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:43:39.834 > [RETRY] Health data sent successfully!
19:43:39.837 > ✓ Health data #14 sent successfully
19:43:39.939 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":3,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300819502,"threatLevel":0,"type":"heuristics_update"}
19:43:39.969 > [WebSocket] Processing message type: heuristics_update
19:43:39.972 > [171.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:40.082 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820217001700040804000000048144745B4B6640B28D1ACE836A03EC337D46BAF1038E3CB1A2E8E1A003187B0BA52A1BAF3439BD8987474618B5F8C85D","pipeline":{"afterLFSR":"107D6AD17C2EB9300C12C7A3222C6A31F1326A5296866543FEC31CC267CA685C","afterSalt":"48522D36322053504F322D39352053544550532D3835314D50","afterTinkerbell":"8D4BE1A2400333EC6A81B10B44CE463C0383F1037BB2745BA01A66BA8E187DE8","afterTransposition":"8144745B4B6640B28D1ACE836A03EC337D46BAF1038E3CB1A2E8E1A003187B0B"},"plaintext":"HR-62 SPO2-95 STEPS-851","serverTime":1770300819588,"timestamp":170764,"type":"encryption_update","ztmEnabled":true}
19:43:40.137 > [WebSocket] Processing message type: encryption_update
19:43:40.143 > [171.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:40.245 > [WebSocket] Received (87 bytes): {"heartRate":62,"spo2":95,"steps":851,"time":1770300819588,"type":"health_data_update"}
19:43:40.254 > [WebSocket] Processing message type: health_data_update
19:43:40.259 > [171.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:40.366 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3027,"encryptionTime":0.0,"finalPlaintext":"HR-62 SPO2-95 STEPS-851","handshakeSuccess":true,"totalTime":0.3027},"type":"session_summary_update"}
19:43:40.389 > [WebSocket] Processing message type: session_summary_update
19:43:40.394 > [171.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:40.499 > [WebSocket] Received (658 bytes): {"decryptionTime":0.3027,"encryptedPacket":"820217001700040804000000048144745B4B6640B28D1ACE836A03EC337D46BAF1038E3CB1A2E8E1A003187B0BA52A1BAF3439BD8987474618B5F8C85D","finalPlaintext":"HR-62 SPO2-95 STEPS-851","healthData":{"heartRate":62,"spo2":95,"steps":851},"pipeline":{"afterDepad":"48522D36322053504F322D39352053544550532D38353100000000000000","afterLFSR":"48522D36322053504F322D39352053544550532D3835314D5000000000000000","afterTinkerbell":"107D6AD17C2EB9300C12C7A3222C6A31F1326A5296866543FEC31CC267CA685C","afterTransposition":"8D4BE1A2400333EC6A81B10B44CE463C0383F1037BB2745BA01A66BA8E187DE8"},"serverTime":1770300819590,"type":"decryption_update"}
19:43:40.558 > [WebSocket] Processing message type: decryption_update
19:43:40.562 > [WebSocket] Server decryption completed
19:43:40.566 > [WebSocket] Health data - HR: 62, SPO2: 95, Steps: 851
19:43:40.571 > [171.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:40.673 > [WebSocket] Received (646 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":13,"pipeline":{"afterLFSR":"107D6AD17C2EB9300C12C7A3222C6A31F1326A5296866543FEC31CC267CA685C","afterSalt":"48522D36322053504F322D39352053544550532D3835314D50","afterTinkerbell":"8D4BE1A2400333EC6A81B10B44CE463C0383F1037BB2745BA01A66BA8E187DE8","afterTransposition":"8144745B4B6640B28D1ACE836A03EC337D46BAF1038E3CB1A2E8E1A003187B0B","finalPacket":"820217001700040804000000048144745B4B6640B28D1ACE836A03EC337D46BAF1038E3CB1A2E8E1A003187B0BA52A1BAF3439BD8987474618B5F8C85D"},"plaintext":"HR-62 SPO2-95 STEPS-851","timestamp":171200,"type":"encryption_pipeline","ztmEnabled":true}
19:43:40.731 > [WebSocket] Processing message type: encryption_pipeline
19:43:40.737 > [172.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:40.836 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":13,"message":"Health data #14 sent successfully","state":7,"success":true,"timestamp":171207,"type":"health_data_sent"}
19:43:40.852 > [WebSocket] Processing message type: health_data_sent
19:43:40.856 > [172.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:40.960 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300820512,"threatLevel":0,"type":"heuristics_update"}
19:43:40.991 > [WebSocket] Processing message type: heuristics_update
19:43:40.994 > [172.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:41.102 > [172.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:41.203 > [172.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:41.304 > [172.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:41.406 > [172.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:41.506 > [172.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:41.609 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300821525,"threatLevel":0,"type":"heuristics_update"}
19:43:41.639 > [WebSocket] Processing message type: heuristics_update
19:43:41.642 > [173.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:41.751 > [173.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:41.851 > [173.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:41.952 > [173.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:42.054 > [173.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:42.154 > [173.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:42.254 > [173.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:42.356 > [173.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:42.456 > [173.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:42.559 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300822534,"threatLevel":0,"type":"heuristics_update"}
19:43:42.589 > [WebSocket] Processing message type: heuristics_update
19:43:42.592 > [174.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:42.702 > [174.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:42.802 > [174.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:42.904 > [174.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:43.004 > [174.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:43.106 > [174.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:43.207 > [174.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:43.308 > [174.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:43.409 > [174.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:43.509 > [174.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:43.611 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300823535,"threatLevel":0,"type":"heuristics_update"}
19:43:43.641 > [WebSocket] Processing message type: heuristics_update
19:43:43.644 > [175.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:43.753 > [175.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:43.854 > [175.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:43.954 > [175.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:44.056 > [175.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:44.158 > [175.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:44.258 > [175.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:44.359 > [175.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:44.460 > [175.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:44.562 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300824546,"threatLevel":0,"type":"heuristics_update"}
19:43:44.593 > [WebSocket] Processing message type: heuristics_update
19:43:44.595 > [176.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:44.705 > [176.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:44.805 > [176.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:44.907 > [176.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:45.007 > [176.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:45.108 > [176.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:45.209 > [176.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:45.310 > [176.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:45.411 > [176.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:45.513 > [176.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:45.616 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300825554,"threatLevel":0,"type":"heuristics_update"}
19:43:45.646 > [WebSocket] Processing message type: heuristics_update
19:43:45.649 > [177.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:45.758 > [177.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:45.859 > [177.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:45.959 > [177.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:46.060 > [177.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:46.161 > [177.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:46.262 > [177.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:46.363 > [177.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:46.464 > [177.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:46.564 > [177.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:46.667 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300826569,"threatLevel":0,"type":"heuristics_update"}
19:43:46.698 > [WebSocket] Processing message type: heuristics_update
19:43:46.701 > [178.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:46.809 > [178.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:46.910 > [178.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:47.011 > [178.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:47.112 > [178.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:47.213 > [178.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:47.314 > [178.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:47.415 > [178.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:47.516 > [178.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:47.618 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300827582,"threatLevel":0,"type":"heuristics_update"}
19:43:47.648 > [WebSocket] Processing message type: heuristics_update
19:43:47.651 > [179.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:47.760 > [179.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:47.861 > [179.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:47.962 > [179.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:48.063 > [179.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:48.164 > [179.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:48.265 > [179.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:48.366 > [179.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:48.467 > [179.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:48.568 > [179.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:48.669 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300828596,"threatLevel":0,"type":"heuristics_update"}
19:43:48.700 > [WebSocket] Processing message type: heuristics_update
19:43:48.703 > [180.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:48.812 > [180.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:48.913 > [180.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:49.013 > [180.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:49.115 > [180.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:49.216 > [180.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:49.317 > [180.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:49.418 > [180.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:49.519 > [180.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:49.621 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":4,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300829606,"threatLevel":0,"type":"heuristics_update"}
19:43:49.651 > [WebSocket] Processing message type: heuristics_update
19:43:49.654 > [181.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:49.763 > [181.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:49.864 > [181.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 14 | WS: CONNECTED
19:43:49.870 > [RETRY] Attempting to send health data (Max retries: 3)
19:43:49.875 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 5 for all retry attempts (saved: 4)
19:43:49.892 > Generated health data: HR-63 SPO2-95 STEPS-909
19:43:49.897 > [ESP32] ========================================
19:43:49.900 > [ESP32] ENCRYPTION PIPELINE START
19:43:49.902 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:43:49.909 > [ESP32] Active Algorithms for this packet:
19:43:49.914 > [ESP32]   + LFSR
19:43:49.914 > [ESP32]   + Tinkerbell
19:43:49.917 > [ESP32]   + Transposition
19:43:49.920 > [ESP32]   - ChaCha20
19:43:49.920 > [ESP32]   - Salsa20
19:43:49.922 > [ESP32] ========================================
19:43:49.928 > [ESP32] MsgKeys: lfsrSeed=0x55612057 tnk[0..3]=7A208603 trn[0..3]=F3403354
19:43:49.933 > 1_After_Salt (25): 48522D36332053504F322D3935205354 4550532D3930394D50
19:43:49.939 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D3930394D5000000000000000 
19:43:49.948 > [ESP32][LFSR] Initializing - Seed: 0x55612057 SeedBe: 0x57206155 ChaosKey[0..3]: 7A208603 InitialTap: 0x0029 State: 0x55612057
19:43:49.958 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:43:49.966 > 3_After_LFSR (32): 1F724C63F4D0AAB3957BB4F6D474928C CC1B5E7FA14F4A861A04A65BA59F0DD1 
19:43:49.975 > [ESP32][LFSR] Keystream (first 16 bytes): 57206155C7F0F9E3DA4999CFE154C1D8
19:43:49.981 > [ESP32][4D] LFSR keystream (first 32 bytes): 57206155C7F0F9E3DA4999CFE154C1D8894B0D52987F73CB4A04A65BA59F0DD1
19:43:49.989 > [ESP32][TINKERBELL] Input (first 16 bytes): 1F724C63F4D0AAB3957BB4F6D474928C Nonce: 0x00000005 Buffer size: 32 bytes
19:43:50.000 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000005 Counter: 0 (must start at 0) Key[0..3]: 7A208603
19:43:50.011 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): CCFA26D5CE5B6EF97506A4388A97BF28
19:43:50.019 > 4_After_Tinkerbell (32): D3886AB63A8BC44AE07D10CE5EE32DA4 6858B077FADBE1BF9C30000DFF616D60 
19:43:50.028 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): CCFA26D5CE5B6EF97506A4388A97BF28
19:43:50.034 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): CCFA26D5CE5B6EF97506A4388A97BF28A443EE085B94AB398634A6565AFE60B1
19:43:50.045 > 5_After_Transposition (32): 772DB00DE33A8858E0DB6830B6BFCE10 61005EFF7DFAA4C460E14A8B9C6DD36A 
19:43:50.053 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000005
19:43:50.059 > [ESP32] === HMAC DEBUG INFO ===
19:43:50.061 > [ESP32] HMAC Key being used: B18DCE08F2B9643BF08F1E40B05F2B0C1597731850A09134B401AE76AE5A1B94
19:43:50.070 > [ESP32] HMAC Input length: 45 bytes
19:43:50.073 > [ESP32] HMAC Input (first 32 bytes): 82021700170004080400000005772DB00DE33A8858E0DB6830B6BFCE1061005E
19:43:50.080 > [ESP32] Nonce: 0x00000005
19:43:50.083 > [ESP32] Packet size before HMAC: 61
19:43:50.087 > [ESP32] Computed HMAC Tag: 220412F94BDE4B8D776827E1BA12B554
19:43:50.091 > [ESP32] === END HMAC DEBUG ===
19:43:50.094 > 6_Final_Packet (61): 82021700170004080400000005772DB0 0DE33A8858E0DB6830B6BFCE1061005E ...
19:43:50.103 > [RETRY] Attempt 1/3 (nonce: 5)
19:43:50.106 > POST http://10.249.92.115:8081/health-data with pipeline data
19:43:50.111 > Sending pipeline data to server (606 bytes)
19:43:50.374 > [HTTP] Response code: 200
19:43:50.374 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:43:50.386 > [RETRY] Health data sent successfully!
19:43:50.389 > ✓ Health data #15 sent successfully
19:43:50.491 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":1,"serverTime":1770300830211,"type":"security_update"}
19:43:50.506 > [WebSocket] Processing message type: security_update
19:43:50.512 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:43:50.518 > [181.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:50.624 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:82021700170004080400000005772DB00DE33A8858E0DB6830B6BFCE1061005EFF7DFAA4C460E14A8B9C6DD36A220412F94BDE4B8D776827E1BA12B554","pipeline":{"afterLFSR":"1F724C63F4D0AAB3957BB4F6D474928CCC1B5E7FA14F4A861A04A65BA59F0DD1","afterSalt":"48522D36332053504F322D39352053544550532D3930394D50","afterTinkerbell":"D3886AB63A8BC44AE07D10CE5EE32DA46858B077FADBE1BF9C30000DFF616D60","afterTransposition":"772DB00DE33A8858E0DB6830B6BFCE1061005EFF7DFAA4C460E14A8B9C6DD36A"},"plaintext":"HR-63 SPO2-95 STEPS-909","serverTime":1770300830211,"timestamp":181479,"type":"encryption_update","ztmEnabled":true}
19:43:50.678 > [WebSocket] Processing message type: encryption_update
19:43:50.685 > [182.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:50.787 > [WebSocket] Received (87 bytes): {"heartRate":63,"spo2":95,"steps":909,"time":1770300830211,"type":"health_data_update"}
19:43:50.795 > [WebSocket] Processing message type: health_data_update
19:43:50.800 > [182.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:50.908 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2923,"encryptionTime":0.0,"finalPlaintext":"HR-63 SPO2-95 STEPS-909","handshakeSuccess":true,"totalTime":0.2923},"type":"session_summary_update"}
19:43:50.931 > [WebSocket] Processing message type: session_summary_update
19:43:50.936 > [182.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:51.041 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2923,"encryptedPacket":"82021700170004080400000005772DB00DE33A8858E0DB6830B6BFCE1061005EFF7DFAA4C460E14A8B9C6DD36A220412F94BDE4B8D776827E1BA12B554","finalPlaintext":"HR-63 SPO2-95 STEPS-909","healthData":{"heartRate":63,"spo2":95,"steps":909},"pipeline":{"afterDepad":"48522D36332053504F322D39352053544550532D39303900000000000000","afterLFSR":"48522D36332053504F322D39352053544550532D3930394D5000000000000000","afterTinkerbell":"1F724C63F4D0AAB3957BB4F6D474928CCC1B5E7FA14F4A861A04A65BA59F0DD1","afterTransposition":"D3886AB63A8BC44AE07D10CE5EE32DA46858B077FADBE1BF9C30000DFF616D60"},"serverTime":1770300830212,"type":"decryption_update"}
19:43:51.100 > [WebSocket] Processing message type: decryption_update
19:43:51.105 > [WebSocket] Server decryption completed
19:43:51.108 > [WebSocket] Health data - HR: 63, SPO2: 95, Steps: 909
19:43:51.113 > [182.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:51.215 > [WebSocket] Received (646 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":14,"pipeline":{"afterLFSR":"1F724C63F4D0AAB3957BB4F6D474928CCC1B5E7FA14F4A861A04A65BA59F0DD1","afterSalt":"48522D36332053504F322D39352053544550532D3930394D50","afterTinkerbell":"D3886AB63A8BC44AE07D10CE5EE32DA46858B077FADBE1BF9C30000DFF616D60","afterTransposition":"772DB00DE33A8858E0DB6830B6BFCE1061005EFF7DFAA4C460E14A8B9C6DD36A","finalPacket":"82021700170004080400000005772DB00DE33A8858E0DB6830B6BFCE1061005EFF7DFAA4C460E14A8B9C6DD36A220412F94BDE4B8D776827E1BA12B554"},"plaintext":"HR-63 SPO2-95 STEPS-909","timestamp":181753,"type":"encryption_pipeline","ztmEnabled":true}
19:43:51.273 > [WebSocket] Processing message type: encryption_pipeline
19:43:51.278 > [182.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:51.377 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":14,"message":"Health data #15 sent successfully","state":7,"success":true,"timestamp":181758,"type":"health_data_sent"}
19:43:51.394 > [WebSocket] Processing message type: health_data_sent
19:43:51.397 > [182.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:51.502 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300830620,"threatLevel":0,"type":"heuristics_update"}
19:43:51.532 > [WebSocket] Processing message type: heuristics_update
19:43:51.535 > [182.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:51.644 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300831630,"threatLevel":0,"type":"heuristics_update"}
19:43:51.675 > [WebSocket] Processing message type: heuristics_update
19:43:51.679 > [183.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:51.788 > [183.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:51.888 > [183.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:51.989 > [183.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:52.090 > [183.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:52.191 > [183.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:52.292 > [183.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:52.393 > [183.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:52.495 > [183.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:52.595 > [184.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:52.697 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300832645,"threatLevel":0,"type":"heuristics_update"}
19:43:52.727 > [WebSocket] Processing message type: heuristics_update
19:43:52.730 > [184.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:52.839 > [184.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:52.939 > [184.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:53.040 > [184.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:53.142 > [184.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:53.243 > [184.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:53.345 > [184.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:53.445 > [184.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:53.545 > [184.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:53.647 > [185.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:53.748 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300833656,"threatLevel":0,"type":"heuristics_update"}
19:43:53.779 > [WebSocket] Processing message type: heuristics_update
19:43:53.782 > [185.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:53.890 > [185.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:53.992 > [185.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:54.093 > [185.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:54.194 > [185.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:54.294 > [185.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:54.396 > [185.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:54.496 > [185.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:54.597 > [186.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:54.699 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300834667,"threatLevel":0,"type":"heuristics_update"}
19:43:54.730 > [WebSocket] Processing message type: heuristics_update
19:43:54.733 > [186.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:54.842 > [186.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:54.943 > [186.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:55.044 > [186.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:55.145 > [186.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:55.246 > [186.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:55.347 > [186.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:55.448 > [186.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:55.549 > [186.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:55.650 > [187.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:55.755 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300835675,"threatLevel":0,"type":"heuristics_update"}
19:43:55.785 > [WebSocket] Processing message type: heuristics_update
19:43:55.788 > [187.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:55.897 > [187.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:55.998 > [187.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:56.098 > [187.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:56.200 > [187.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:56.301 > [187.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:56.402 > [187.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:56.502 > [187.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:56.604 > [188.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:56.705 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300836689,"threatLevel":0,"type":"heuristics_update"}
19:43:56.736 > [WebSocket] Processing message type: heuristics_update
19:43:56.738 > [188.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:56.849 > [188.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:56.949 > [188.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:57.050 > [188.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:57.151 > [188.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:57.252 > [188.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:57.353 > [188.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:57.454 > [188.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:57.555 > [188.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:57.656 > [189.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:57.758 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300837703,"threatLevel":0,"type":"heuristics_update"}
19:43:57.788 > [WebSocket] Processing message type: heuristics_update
19:43:57.791 > [189.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:57.900 > [189.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:58.000 > [189.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:58.102 > [189.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:58.203 > [189.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:58.304 > [189.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:58.405 > [189.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:58.506 > [189.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:58.606 > [190.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:58.708 > [190.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:58.809 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300838714,"threatLevel":0,"type":"heuristics_update"}
19:43:58.840 > [WebSocket] Processing message type: heuristics_update
19:43:58.843 > [190.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:58.951 > [190.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:59.052 > [190.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:59.154 > [190.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:59.254 > [190.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:59.356 > [190.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:59.457 > [190.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:59.558 > [190.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:59.659 > [191.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:59.761 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300839726,"threatLevel":0,"type":"heuristics_update"}
19:43:59.791 > [WebSocket] Processing message type: heuristics_update
19:43:59.794 > [191.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:43:59.903 > [191.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:44:00.003 > [191.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:44:00.104 > [191.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:44:00.206 > [191.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:44:00.306 > [191.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:44:00.408 > [191.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 15 | WS: CONNECTED
19:44:00.413 > [RETRY] Attempting to send health data (Max retries: 3)
19:44:00.419 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 6 for all retry attempts (saved: 5)
19:44:00.436 > Generated health data: HR-63 SPO2-95 STEPS-982
19:44:00.441 > [ESP32] ========================================
19:44:00.444 > [ESP32] ENCRYPTION PIPELINE START
19:44:00.447 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:44:00.452 > [ESP32] Active Algorithms for this packet:
19:44:00.458 > [ESP32]   + LFSR
19:44:00.458 > [ESP32]   + Tinkerbell
19:44:00.461 > [ESP32]   + Transposition
19:44:00.463 > [ESP32]   - ChaCha20
19:44:00.463 > [ESP32]   - Salsa20
19:44:00.467 > [ESP32] ========================================
19:44:00.472 > [ESP32] MsgKeys: lfsrSeed=0x8BEDAE05 tnk[0..3]=DBF0C1D6 trn[0..3]=A3949D72
19:44:00.477 > 1_After_Salt (25): 48522D36332053504F322D3935205354 4550532D3938324D50
19:44:00.483 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D3938324D5000000000000000 
19:44:00.491 > [ESP32][LFSR] Initializing - Seed: 0x8BEDAE05 SeedBe: 0x05AEED8B ChaosKey[0..3]: DBF0C1D6 InitialTap: 0x0029 State: 0x8BEDAE05
19:44:00.502 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:44:00.511 > 3_After_LFSR (32): 4DFCC0BDBA0E47A889EA29F5BD96FCDC 40A81FA5D0C33A2F5295FBD5583703C0 
19:44:00.519 > [ESP32][LFSR] Keystream (first 16 bytes): 05AEED8B892E14F8C6D804CC88B6AF88
19:44:00.525 > [ESP32][4D] LFSR keystream (first 32 bytes): 05AEED8B892E14F8C6D804CC88B6AF8805F84C88E9FB08620295FBD5583703C0
19:44:00.533 > [ESP32][TINKERBELL] Input (first 16 bytes): 4DFCC0BDBA0E47A889EA29F5BD96FCDC Nonce: 0x00000006 Buffer size: 32 bytes
19:44:00.543 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000006 Counter: 0 (must start at 0) Key[0..3]: DBF0C1D6
19:44:00.555 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 6E7D8C8F8A54E2A83585DFC6587934A8
19:44:00.563 > 4_After_Tinkerbell (32): 23814C32305AA500BC6FF633E5EFC874 31BB67954449079F5B83C36C8664E7C0 
19:44:00.571 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 6E7D8C8F8A54E2A83585DFC6587934A8
19:44:00.577 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 6E7D8C8F8A54E2A83585DFC6587934A871137830948A3DB0091638B9DE53E400
19:44:00.589 > 5_After_Transposition (32): 5B95A567F6BBC33107006FC89FC086E5 744C815A646C44324933BC30EF83E723 
19:44:00.597 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000006
19:44:00.602 > [ESP32] === HMAC DEBUG INFO ===
19:44:00.604 > [ESP32] HMAC Key being used: B18DCE08F2B9643BF08F1E40B05F2B0C1597731850A09134B401AE76AE5A1B94
19:44:00.613 > [ESP32] HMAC Input length: 45 bytes
19:44:00.616 > [ESP32] HMAC Input (first 32 bytes): 820217001700040804000000065B95A567F6BBC33107006FC89FC086E5744C81
19:44:00.625 > [ESP32] Nonce: 0x00000006
19:44:00.627 > [ESP32] Packet size before HMAC: 61
19:44:00.630 > [ESP32] Computed HMAC Tag: 15327893523BFFD576BFF8364A7CD510
19:44:00.636 > [ESP32] === END HMAC DEBUG ===
19:44:00.638 > 6_Final_Packet (61): 820217001700040804000000065B95A5 67F6BBC33107006FC89FC086E5744C81 ...
19:44:00.646 > [RETRY] Attempt 1/3 (nonce: 6)
19:44:00.649 > POST http://10.249.92.115:8081/health-data with pipeline data
19:44:00.655 > Sending pipeline data to server (606 bytes)
19:44:00.890 > [HTTP] Response code: 200
19:44:00.890 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:44:00.902 > [RETRY] Health data sent successfully!
19:44:00.904 > ✓ Health data #16 sent successfully
19:44:01.006 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":5,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300840727,"threatLevel":0,"type":"heuristics_update"}
19:44:01.037 > [WebSocket] Processing message type: heuristics_update
19:44:01.039 > [192.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:01.149 > [WebSocket] Received (633 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820217001700040804000000065B95A567F6BBC33107006FC89FC086E5744C815A646C44324933BC30EF83E72315327893523BFFD576BFF8364A7CD510","pipeline":{"afterLFSR":"4DFCC0BDBA0E47A889EA29F5BD96FCDC40A81FA5D0C33A2F5295FBD5583703C0","afterSalt":"48522D36332053504F322D39352053544550532D3938324D50","afterTinkerbell":"23814C32305AA500BC6FF633E5EFC87431BB67954449079F5B83C36C8664E7C0","afterTransposition":"5B95A567F6BBC33107006FC89FC086E5744C815A646C44324933BC30EF83E723"},"plaintext":"HR-63 SPO2-95 STEPS-982","serverTime":1770300840775,"timestamp":192023,"type":"encryption_update","ztmEnabled":true}
19:44:01.204 > [WebSocket] Processing message type: encryption_update
19:44:01.211 > [192.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:01.312 > [WebSocket] Received (87 bytes): {"heartRate":63,"spo2":95,"steps":982,"time":1770300840775,"type":"health_data_update"}
19:44:01.320 > [WebSocket] Processing message type: health_data_update
19:44:01.326 > [192.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:01.434 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2594,"encryptionTime":0.0,"finalPlaintext":"HR-63 SPO2-95 STEPS-982","handshakeSuccess":true,"totalTime":0.2594},"type":"session_summary_update"}
19:44:01.456 > [WebSocket] Processing message type: session_summary_update
19:44:01.462 > [192.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:01.566 > [WebSocket] Received (658 bytes): {"decryptionTime":0.2594,"encryptedPacket":"820217001700040804000000065B95A567F6BBC33107006FC89FC086E5744C815A646C44324933BC30EF83E72315327893523BFFD576BFF8364A7CD510","finalPlaintext":"HR-63 SPO2-95 STEPS-982","healthData":{"heartRate":63,"spo2":95,"steps":982},"pipeline":{"afterDepad":"48522D36332053504F322D39352053544550532D39383200000000000000","afterLFSR":"48522D36332053504F322D39352053544550532D3938324D5000000000000000","afterTinkerbell":"4DFCC0BDBA0E47A889EA29F5BD96FCDC40A81FA5D0C33A2F5295FBD5583703C0","afterTransposition":"23814C32305AA500BC6FF633E5EFC87431BB67954449079F5B83C36C8664E7C0"},"serverTime":1770300840776,"type":"decryption_update"}
19:44:01.625 > [WebSocket] Processing message type: decryption_update
19:44:01.630 > [WebSocket] Server decryption completed
19:44:01.633 > [WebSocket] Health data - HR: 63, SPO2: 95, Steps: 982
19:44:01.639 > [193.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:01.740 > [WebSocket] Received (646 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":15,"pipeline":{"afterLFSR":"4DFCC0BDBA0E47A889EA29F5BD96FCDC40A81FA5D0C33A2F5295FBD5583703C0","afterSalt":"48522D36332053504F322D39352053544550532D3938324D50","afterTinkerbell":"23814C32305AA500BC6FF633E5EFC87431BB67954449079F5B83C36C8664E7C0","afterTransposition":"5B95A567F6BBC33107006FC89FC086E5744C815A646C44324933BC30EF83E723","finalPacket":"820217001700040804000000065B95A567F6BBC33107006FC89FC086E5744C815A646C44324933BC30EF83E72315327893523BFFD576BFF8364A7CD510"},"plaintext":"HR-63 SPO2-95 STEPS-982","timestamp":192269,"type":"encryption_pipeline","ztmEnabled":true}
19:44:01.798 > [WebSocket] Processing message type: encryption_pipeline
19:44:01.804 > [193.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:01.902 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":15,"message":"Health data #16 sent successfully","state":7,"success":true,"timestamp":192274,"type":"health_data_sent"}
19:44:01.920 > [WebSocket] Processing message type: health_data_sent
19:44:01.923 > [193.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:02.027 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300841743,"threatLevel":0,"type":"heuristics_update"}
19:44:02.058 > [WebSocket] Processing message type: heuristics_update
19:44:02.061 > [193.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:02.169 > [193.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:02.270 > [193.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:02.372 > [193.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:02.472 > [193.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:02.574 > [194.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:02.675 > [194.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:02.776 > [194.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:02.878 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300842756,"threatLevel":0,"type":"heuristics_update"}
19:44:02.908 > [WebSocket] Processing message type: heuristics_update
19:44:02.911 > [194.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:03.020 > [194.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:03.120 > [194.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:03.222 > [194.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:03.323 > [194.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:03.424 > [194.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:03.525 > [194.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:03.626 > [195.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:03.727 > [195.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:03.829 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300843765,"threatLevel":0,"type":"heuristics_update"}
19:44:03.859 > [WebSocket] Processing message type: heuristics_update
19:44:03.862 > [195.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:03.971 > [195.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:04.072 > [195.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:04.173 > [195.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:04.274 > [195.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:04.375 > [195.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:04.476 > [195.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:04.577 > [196.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:04.677 > [196.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:04.778 > [196.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:04.880 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300844780,"threatLevel":0,"type":"heuristics_update"}
19:44:04.911 > [WebSocket] Processing message type: heuristics_update
19:44:04.914 > [196.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:05.024 > [196.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:05.124 > [196.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:05.225 > [196.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:05.326 > [196.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:05.428 > [196.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:05.529 > [196.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:05.630 > [197.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:05.730 > [197.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:05.833 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300845794,"threatLevel":0,"type":"heuristics_update"}
19:44:05.863 > [WebSocket] Processing message type: heuristics_update
19:44:05.866 > [197.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:05.975 > [197.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:06.076 > [197.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:06.176 > [197.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:06.277 > [197.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:06.378 > [197.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:06.480 > [197.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:06.581 > [198.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:06.682 > [198.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:06.783 > [198.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:06.886 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300846805,"threatLevel":0,"type":"heuristics_update"}
19:44:06.917 > [WebSocket] Processing message type: heuristics_update
19:44:06.920 > [198.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:07.029 > [198.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:07.130 > [198.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:07.231 > [198.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:07.332 > [198.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:07.433 > [198.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:07.534 > [198.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:07.635 > [199.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:07.735 > [199.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:07.837 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300847818,"threatLevel":0,"type":"heuristics_update"}
19:44:07.868 > [WebSocket] Processing message type: heuristics_update
19:44:07.871 > [199.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:07.980 > [199.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:08.081 > [199.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:08.182 > [199.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:08.283 > [199.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:08.384 > [199.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:08.484 > [199.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:08.585 > [200.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:08.687 > [200.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:08.788 > [200.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:08.890 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300848831,"threatLevel":0,"type":"heuristics_update"}
19:44:08.919 > [WebSocket] Processing message type: heuristics_update
19:44:08.923 > [200.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:09.031 > [200.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:09.133 > [200.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:09.233 > [200.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:09.335 > [200.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:09.436 > [200.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:09.536 > [200.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:09.637 > [201.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:09.739 > [201.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:09.840 > [201.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:09.942 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300849844,"threatLevel":0,"type":"heuristics_update"}
19:44:09.972 > [WebSocket] Processing message type: heuristics_update
19:44:09.974 > [201.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:10.083 > [201.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:10.185 > [201.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:10.285 > [201.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:10.387 > [201.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:10.488 > [201.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:10.588 > [202.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:10.689 > [202.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:10.790 > [202.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:10.892 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":6,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300850853,"threatLevel":0,"type":"heuristics_update"}
19:44:10.922 > [WebSocket] Processing message type: heuristics_update
19:44:10.925 > [202.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 16 | WS: CONNECTED
19:44:10.934 > [RETRY] Attempting to send health data (Max retries: 3)
19:44:10.939 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 7 for all retry attempts (saved: 6)
19:44:10.956 > Generated health data: HR-63 SPO2-95 STEPS-1020
19:44:10.962 > [ESP32] ========================================
19:44:10.964 > [ESP32] ENCRYPTION PIPELINE START
19:44:10.967 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:44:10.973 > [ESP32] Active Algorithms for this packet:
19:44:10.979 > [ESP32]   + LFSR
19:44:10.979 > [ESP32]   + Tinkerbell
19:44:10.981 > [ESP32]   + Transposition
19:44:10.984 > [ESP32]   - ChaCha20
19:44:10.984 > [ESP32]   - Salsa20
19:44:10.987 > [ESP32] ========================================
19:44:10.989 > [ESP32] MsgKeys: lfsrSeed=0x3DD12CAA tnk[0..3]=899EDA86 trn[0..3]=B54D464C
19:44:10.998 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313032304D50
19:44:11.003 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313032304D50000000000000 
19:44:11.012 > [ESP32][LFSR] Initializing - Seed: 0x3DD12CAA SeedBe: 0xAA2CD13D ChaosKey[0..3]: 899EDA86 InitialTap: 0x0029 State: 0x3DD12CAA
19:44:11.022 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:44:11.031 > 3_After_LFSR (32): E27EFC0BA03C9620EB7D5334599C437B 88021B1A84496BE92EC1B1865205A2D4 
19:44:11.039 > [ESP32][LFSR] Keystream (first 16 bytes): AA2CD13D931CC570A44F7E0D6CBC102F
19:44:11.045 > [ESP32][4D] LFSR keystream (first 32 bytes): AA2CD13D931CC570A44F7E0D6CBC102FCD524837B57959D96391B1865205A2D4
19:44:11.053 > [ESP32][TINKERBELL] Input (first 16 bytes): E27EFC0BA03C9620EB7D5334599C437B Nonce: 0x00000007 Buffer size: 32 bytes
19:44:11.064 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000007 Counter: 0 (must start at 0) Key[0..3]: 899EDA86
19:44:11.076 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): CE95AC8B9843CD93D4955690888FB104
19:44:11.084 > 4_After_Tinkerbell (32): 2CEB5080387F5BB33FE805A4D113F27F 95C867356B9CBF85553CBF1956AC3A6E 
19:44:11.090 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): CE95AC8B9843CD93D4955690888FB104
19:44:11.098 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): CE95AC8B9843CD93D4955690888FB1041DCA7C2FEFD5D46C7BFD0E9F04A998BA
19:44:11.109 > 5_After_Transposition (32): 675B3F95802CD135BF6BF23AB350EBBF 55E813053C6E7F38AC7F9C56C819A485 
19:44:11.117 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000007
19:44:11.123 > [ESP32] === HMAC DEBUG INFO ===
19:44:11.126 > [ESP32] HMAC Key being used: B18DCE08F2B9643BF08F1E40B05F2B0C1597731850A09134B401AE76AE5A1B94
19:44:11.134 > [ESP32] HMAC Input length: 45 bytes
19:44:11.137 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000007675B3F95802CD135BF6BF23AB350EBBF55E813
19:44:11.145 > [ESP32] Nonce: 0x00000007
19:44:11.148 > [ESP32] Packet size before HMAC: 61
19:44:11.150 > [ESP32] Computed HMAC Tag: 7A542567534038D2088F7FAB78B780BA
19:44:11.156 > [ESP32] === END HMAC DEBUG ===
19:44:11.159 > 6_Final_Packet (61): 82021800180004080400000007675B3F 95802CD135BF6BF23AB350EBBF55E813 ...
19:44:11.167 > [RETRY] Attempt 1/3 (nonce: 7)
19:44:11.170 > POST http://10.249.92.115:8081/health-data with pipeline data
19:44:11.173 > Sending pipeline data to server (609 bytes)
19:44:11.419 > [HTTP] Response code: 200
19:44:11.419 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:44:11.432 > [RETRY] Health data sent successfully!
19:44:11.435 > ✓ Health data #17 sent successfully
19:44:11.535 > [WebSocket] Received (636 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:82021800180004080400000007675B3F95802CD135BF6BF23AB350EBBF55E813053C6E7F38AC7F9C56C819A4857A542567534038D2088F7FAB78B780BA","pipeline":{"afterLFSR":"E27EFC0BA03C9620EB7D5334599C437B88021B1A84496BE92EC1B1865205A2D4","afterSalt":"48522D36332053504F322D39352053544550532D313032304D50","afterTinkerbell":"2CEB5080387F5BB33FE805A4D113F27F95C867356B9CBF85553CBF1956AC3A6E","afterTransposition":"675B3F95802CD135BF6BF23AB350EBBF55E813053C6E7F38AC7F9C56C819A485"},"plaintext":"HR-63 SPO2-95 STEPS-1020","serverTime":1770300851276,"timestamp":202550,"type":"encryption_update","ztmEnabled":true}
19:44:11.591 > [WebSocket] Processing message type: encryption_update
19:44:11.596 > [203.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:11.699 > [WebSocket] Received (88 bytes): {"heartRate":63,"spo2":95,"steps":1020,"time":1770300851276,"type":"health_data_update"}
19:44:11.707 > [WebSocket] Processing message type: health_data_update
19:44:11.713 > [203.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:11.821 > [WebSocket] Received (226 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2582,"encryptionTime":0.0,"finalPlaintext":"HR-63 SPO2-95 STEPS-1020","handshakeSuccess":true,"totalTime":0.2582},"type":"session_summary_update"}
19:44:11.843 > [WebSocket] Processing message type: session_summary_update
19:44:11.849 > [203.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:11.953 > [WebSocket] Received (660 bytes): {"decryptionTime":0.2582,"encryptedPacket":"82021800180004080400000007675B3F95802CD135BF6BF23AB350EBBF55E813053C6E7F38AC7F9C56C819A4857A542567534038D2088F7FAB78B780BA","finalPlaintext":"HR-63 SPO2-95 STEPS-1020","healthData":{"heartRate":63,"spo2":95,"steps":1020},"pipeline":{"afterDepad":"48522D36332053504F322D39352053544550532D31303230000000000000","afterLFSR":"48522D36332053504F322D39352053544550532D313032304D50000000000000","afterTinkerbell":"E27EFC0BA03C9620EB7D5334599C437B88021B1A84496BE92EC1B1865205A2D4","afterTransposition":"2CEB5080387F5BB33FE805A4D113F27F95C867356B9CBF85553CBF1956AC3A6E"},"serverTime":1770300851277,"type":"decryption_update"}
19:44:12.012 > [WebSocket] Processing message type: decryption_update
19:44:12.017 > [WebSocket] Server decryption completed
19:44:12.020 > [WebSocket] Health data - HR: 63, SPO2: 95, Steps: 1020
19:44:12.026 > [203.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:12.127 > [WebSocket] Received (649 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":16,"pipeline":{"afterLFSR":"E27EFC0BA03C9620EB7D5334599C437B88021B1A84496BE92EC1B1865205A2D4","afterSalt":"48522D36332053504F322D39352053544550532D313032304D50","afterTinkerbell":"2CEB5080387F5BB33FE805A4D113F27F95C867356B9CBF85553CBF1956AC3A6E","afterTransposition":"675B3F95802CD135BF6BF23AB350EBBF55E813053C6E7F38AC7F9C56C819A485","finalPacket":"82021800180004080400000007675B3F95802CD135BF6BF23AB350EBBF55E813053C6E7F38AC7F9C56C819A4857A542567534038D2088F7FAB78B780BA"},"plaintext":"HR-63 SPO2-95 STEPS-1020","timestamp":202799,"type":"encryption_pipeline","ztmEnabled":true}
19:44:12.185 > [WebSocket] Processing message type: encryption_pipeline
19:44:12.191 > [203.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:12.290 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":16,"message":"Health data #17 sent successfully","state":7,"success":true,"timestamp":202803,"type":"health_data_sent"}
19:44:12.306 > [WebSocket] Processing message type: health_data_sent
19:44:12.309 > [203.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:12.412 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300851862,"threatLevel":0,"type":"heuristics_update"}
19:44:12.442 > [WebSocket] Processing message type: heuristics_update
19:44:12.445 > [203.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:12.555 > [203.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:12.656 > [204.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:12.757 > [204.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:12.858 > [204.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:12.961 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300852871,"threatLevel":0,"type":"heuristics_update"}
19:44:12.991 > [WebSocket] Processing message type: heuristics_update
19:44:12.993 > [204.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:13.104 > [204.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:13.205 > [204.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:13.304 > [204.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:13.407 > [204.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:13.508 > [204.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:13.609 > [205.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:13.709 > [205.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:13.811 > [205.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:13.914 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300853884,"threatLevel":0,"type":"heuristics_update"}
19:44:13.944 > [WebSocket] Processing message type: heuristics_update
19:44:13.947 > [205.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:14.057 > [205.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:14.158 > [205.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:14.259 > [205.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:14.359 > [205.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:14.461 > [205.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:14.561 > [205.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:14.662 > [206.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:14.763 > [206.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:14.864 > [206.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:14.966 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300854896,"threatLevel":0,"type":"heuristics_update"}
19:44:14.996 > [WebSocket] Processing message type: heuristics_update
19:44:14.999 > [206.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:15.108 > [206.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:15.210 > [206.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:15.310 > [206.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:15.412 > [206.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:15.512 > [206.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:15.613 > [207.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:15.715 > [207.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:15.815 > [207.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:15.920 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300855902,"threatLevel":0,"type":"heuristics_update"}
19:44:15.951 > [WebSocket] Processing message type: heuristics_update
19:44:15.954 > [207.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:16.063 > [207.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:16.163 > [207.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:16.264 > [207.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:16.364 > [207.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:16.466 > [207.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:16.567 > [207.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:16.668 > [208.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:16.770 > [208.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:16.871 > [208.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:16.972 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300856912,"threatLevel":0,"type":"heuristics_update"}
19:44:17.002 > [WebSocket] Processing message type: heuristics_update
19:44:17.006 > [208.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:17.115 > [208.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:17.215 > [208.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:17.316 > [208.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:17.417 > [208.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:17.518 > [208.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:17.620 > [209.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:17.720 > [209.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:17.821 > [209.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:17.922 > [209.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:18.027 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300857922,"threatLevel":0,"type":"heuristics_update"}
19:44:18.057 > [WebSocket] Processing message type: heuristics_update
19:44:18.060 > [209.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:18.168 > [209.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:18.269 > [209.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:18.371 > [209.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:18.472 > [209.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:18.573 > [209.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:18.673 > [210.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:18.775 > [210.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:18.875 > [210.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:18.977 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300858937,"threatLevel":0,"type":"heuristics_update"}
19:44:19.008 > [WebSocket] Processing message type: heuristics_update
19:44:19.010 > [210.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:19.120 > [210.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:19.221 > [210.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:19.321 > [210.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:19.423 > [210.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:19.524 > [210.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:19.625 > [211.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:19.726 > [211.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:19.827 > [211.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:19.928 > [211.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:20.029 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300859947,"threatLevel":0,"type":"heuristics_update"}
19:44:20.059 > [WebSocket] Processing message type: heuristics_update
19:44:20.062 > [211.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:20.171 > [211.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:20.272 > [211.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:20.373 > [211.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:20.475 > [211.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:20.575 > [212.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:20.676 > [212.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:20.777 > [212.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:20.878 > [212.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:20.979 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":7,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300860960,"threatLevel":0,"type":"heuristics_update"}
19:44:21.011 > [WebSocket] Processing message type: heuristics_update
19:44:21.014 > [212.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:21.122 > [212.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:21.223 > [212.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:21.324 > [212.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:21.425 > [212.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:21.526 > [212.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 17 | WS: CONNECTED
19:44:21.531 > [RETRY] Attempting to send health data (Max retries: 3)
19:44:21.537 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 8 for all retry attempts (saved: 7)
19:44:21.554 > Generated health data: HR-63 SPO2-95 STEPS-1108
19:44:21.560 > [ESP32] ========================================
19:44:21.562 > [ESP32] ENCRYPTION PIPELINE START
19:44:21.567 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:44:21.571 > [ESP32] Active Algorithms for this packet:
19:44:21.576 > [ESP32]   + LFSR
19:44:21.576 > [ESP32]   + Tinkerbell
19:44:21.578 > [ESP32]   + Transposition
19:44:21.582 > [ESP32]   - ChaCha20
19:44:21.582 > [ESP32]   - Salsa20
19:44:21.585 > [ESP32] ========================================
19:44:21.590 > [ESP32] MsgKeys: lfsrSeed=0x1EBE11E7 tnk[0..3]=BB8B3CBC trn[0..3]=94337433
19:44:21.595 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313130384D50
19:44:21.601 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313130384D50000000000000 
19:44:21.609 > [ESP32][LFSR] Initializing - Seed: 0x1EBE11E7 SeedBe: 0xE711BE1E ChaosKey[0..3]: BB8B3CBC InitialTap: 0x0029 State: 0x1EBE11E7
19:44:21.621 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:44:21.628 > 3_After_LFSR (32): AF4393280D401CA8BCB28AA5F8F4ED52 74F3A6E4159F33C5DBDE039D68855EE1 
19:44:21.637 > [ESP32][LFSR] Keystream (first 16 bytes): E711BE1E3E604FF8F380A79CCDD4BE06
19:44:21.643 > [ESP32][4D] LFSR keystream (first 32 bytes): E711BE1E3E604FF8F380A79CCDD4BE0631A3F5C924AE03FD968E039D68855EE1
19:44:21.654 > [ESP32][TINKERBELL] Input (first 16 bytes): AF4393280D401CA8BCB28AA5F8F4ED52 Nonce: 0x00000008 Buffer size: 32 bytes
19:44:21.662 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000008 Counter: 0 (must start at 0) Key[0..3]: BB8B3CBC
19:44:21.673 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): AD4A50D91BCF7060A0C7303EDD5C5A1E
19:44:21.682 > 4_After_Tinkerbell (32): 0209C3F1168F6CC81C75BA9B25A8B74C 69AA69D12BE113BB9941C361D1B4B41A 
19:44:21.690 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): AD4A50D91BCF7060A0C7303EDD5C5A1E
19:44:21.695 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): AD4A50D91BCF7060A0C7303EDD5C5A1E1D59CF353E7E207E429FC0FCB931EAFB
19:44:21.707 > 5_After_Transposition (32): 1AB44C09F1E11C75B49B6C6913D102D1 25BA69AA41C8C3B799168FA82B61BBC3 
19:44:21.715 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000008
19:44:21.721 > [ESP32] === HMAC DEBUG INFO ===
19:44:21.723 > [ESP32] HMAC Key being used: B18DCE08F2B9643BF08F1E40B05F2B0C1597731850A09134B401AE76AE5A1B94
19:44:21.732 > [ESP32] HMAC Input length: 45 bytes
19:44:21.735 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000081AB44C09F1E11C75B49B6C6913D102D125BA69
19:44:21.742 > [ESP32] Nonce: 0x00000008
19:44:21.745 > [ESP32] Packet size before HMAC: 61
19:44:21.749 > [ESP32] Computed HMAC Tag: 6EEC8CF21CD39F735FDB5D0590604B94
19:44:21.753 > [ESP32] === END HMAC DEBUG ===
19:44:21.757 > 6_Final_Packet (61): 820218001800040804000000081AB44C 09F1E11C75B49B6C6913D102D125BA69 ...
19:44:21.765 > [RETRY] Attempt 1/3 (nonce: 8)
19:44:21.768 > POST http://10.249.92.115:8081/health-data with pipeline data
19:44:21.774 > Sending pipeline data to server (609 bytes)
19:44:21.937 > [HTTP] Response code: 200
19:44:21.938 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:44:21.950 > [RETRY] Health data sent successfully!
19:44:21.953 > ✓ Health data #18 sent successfully
19:44:22.054 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":4,"serverTime":1770300861858,"type":"security_update"}
19:44:22.071 > [WebSocket] Processing message type: security_update
19:44:22.076 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
19:44:22.082 > [213.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:22.188 > [WebSocket] Received (636 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820218001800040804000000081AB44C09F1E11C75B49B6C6913D102D125BA69AA41C8C3B799168FA82B61BBC36EEC8CF21CD39F735FDB5D0590604B94","pipeline":{"afterLFSR":"AF4393280D401CA8BCB28AA5F8F4ED5274F3A6E4159F33C5DBDE039D68855EE1","afterSalt":"48522D36332053504F322D39352053544550532D313130384D50","afterTinkerbell":"0209C3F1168F6CC81C75BA9B25A8B74C69AA69D12BE113BB9941C361D1B4B41A","afterTransposition":"1AB44C09F1E11C75B49B6C6913D102D125BA69AA41C8C3B799168FA82B61BBC3"},"plaintext":"HR-63 SPO2-95 STEPS-1108","serverTime":1770300861858,"timestamp":213152,"type":"encryption_update","ztmEnabled":true}
19:44:22.243 > [WebSocket] Processing message type: encryption_update
19:44:22.248 > [213.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:22.350 > [WebSocket] Received (88 bytes): {"heartRate":63,"spo2":95,"steps":1108,"time":1770300861858,"type":"health_data_update"}
19:44:22.358 > [WebSocket] Processing message type: health_data_update
19:44:22.364 > [213.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:22.473 > [WebSocket] Received (226 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2407,"encryptionTime":0.0,"finalPlaintext":"HR-63 SPO2-95 STEPS-1108","handshakeSuccess":true,"totalTime":0.2407},"type":"session_summary_update"}
19:44:22.495 > [WebSocket] Processing message type: session_summary_update
19:44:22.500 > [213.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:22.605 > [WebSocket] Received (660 bytes): {"decryptionTime":0.2407,"encryptedPacket":"820218001800040804000000081AB44C09F1E11C75B49B6C6913D102D125BA69AA41C8C3B799168FA82B61BBC36EEC8CF21CD39F735FDB5D0590604B94","finalPlaintext":"HR-63 SPO2-95 STEPS-1108","healthData":{"heartRate":63,"spo2":95,"steps":1108},"pipeline":{"afterDepad":"48522D36332053504F322D39352053544550532D31313038000000000000","afterLFSR":"48522D36332053504F322D39352053544550532D313130384D50000000000000","afterTinkerbell":"AF4393280D401CA8BCB28AA5F8F4ED5274F3A6E4159F33C5DBDE039D68855EE1","afterTransposition":"0209C3F1168F6CC81C75BA9B25A8B74C69AA69D12BE113BB9941C361D1B4B41A"},"serverTime":1770300861859,"type":"decryption_update"}
19:44:22.664 > [WebSocket] Processing message type: decryption_update
19:44:22.669 > [WebSocket] Server decryption completed
19:44:22.672 > [WebSocket] Health data - HR: 63, SPO2: 95, Steps: 1108
19:44:22.677 > [214.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:22.779 > [WebSocket] Received (649 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":17,"pipeline":{"afterLFSR":"AF4393280D401CA8BCB28AA5F8F4ED5274F3A6E4159F33C5DBDE039D68855EE1","afterSalt":"48522D36332053504F322D39352053544550532D313130384D50","afterTinkerbell":"0209C3F1168F6CC81C75BA9B25A8B74C69AA69D12BE113BB9941C361D1B4B41A","afterTransposition":"1AB44C09F1E11C75B49B6C6913D102D125BA69AA41C8C3B799168FA82B61BBC3","finalPacket":"820218001800040804000000081AB44C09F1E11C75B49B6C6913D102D125BA69AA41C8C3B799168FA82B61BBC36EEC8CF21CD39F735FDB5D0590604B94"},"plaintext":"HR-63 SPO2-95 STEPS-1108","timestamp":213317,"type":"encryption_pipeline","ztmEnabled":true}
19:44:22.837 > [WebSocket] Processing message type: encryption_pipeline
19:44:22.842 > [214.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:22.942 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":17,"message":"Health data #18 sent successfully","state":7,"success":true,"timestamp":213322,"type":"health_data_sent"}
19:44:22.958 > [WebSocket] Processing message type: health_data_sent
19:44:22.961 > [214.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:23.066 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300861975,"threatLevel":0,"type":"heuristics_update"}
19:44:23.096 > [WebSocket] Processing message type: heuristics_update
19:44:23.100 > [214.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:23.209 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300862984,"threatLevel":0,"type":"heuristics_update"}
19:44:23.239 > [WebSocket] Processing message type: heuristics_update
19:44:23.242 > [214.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:23.351 > [214.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:23.452 > [214.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:23.553 > [214.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:23.655 > [215.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:23.756 > [215.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:23.856 > [215.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:23.956 > [215.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:24.059 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300863997,"threatLevel":0,"type":"heuristics_update"}
19:44:24.090 > [WebSocket] Processing message type: heuristics_update
19:44:24.093 > [215.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:24.201 > [215.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:24.302 > [215.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:24.403 > [215.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:24.504 > [215.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:24.605 > [216.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:24.707 > [216.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:24.807 > [216.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:24.908 > [216.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:25.009 > [216.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:25.111 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300865007,"threatLevel":0,"type":"heuristics_update"}
19:44:25.141 > [WebSocket] Processing message type: heuristics_update
19:44:25.144 > [216.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:25.253 > [216.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:25.354 > [216.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:25.455 > [216.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:25.556 > [216.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:25.657 > [217.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:25.758 > [217.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:25.859 > [217.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:25.960 > [217.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:26.062 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300866022,"threatLevel":0,"type":"heuristics_update"}
19:44:26.092 > [WebSocket] Processing message type: heuristics_update
19:44:26.095 > [217.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:26.205 > [217.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:26.305 > [217.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:26.406 > [217.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:26.507 > [217.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:26.608 > [218.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:26.709 > [218.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:26.810 > [218.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:26.911 > [218.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:27.012 > [218.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:27.113 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300867034,"threatLevel":0,"type":"heuristics_update"}
19:44:27.144 > [WebSocket] Processing message type: heuristics_update
19:44:27.147 > [218.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:27.256 > [218.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:27.358 > [218.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:27.458 > [218.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:27.559 > [218.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:27.661 > [219.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:27.761 > [219.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:27.863 > [219.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:27.964 > [219.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:28.067 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300868044,"threatLevel":0,"type":"heuristics_update"}
19:44:28.097 > [WebSocket] Processing message type: heuristics_update
19:44:28.100 > [219.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:28.209 > [219.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:28.310 > [219.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:28.411 > [219.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:28.511 > [219.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:28.613 > [220.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:28.714 > [220.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:28.816 > [220.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:28.916 > [220.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:29.017 > [220.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:29.118 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300869058,"threatLevel":0,"type":"heuristics_update"}
19:44:29.149 > [WebSocket] Processing message type: heuristics_update
19:44:29.152 > [220.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:29.261 > [220.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:29.363 > [220.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:29.463 > [220.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:29.565 > [220.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:29.665 > [221.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:29.766 > [221.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:29.867 > [221.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:29.968 > [221.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:30.069 > [221.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:30.171 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300870062,"threatLevel":0,"type":"heuristics_update"}
19:44:30.202 > [WebSocket] Processing message type: heuristics_update
19:44:30.204 > [221.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:30.314 > [221.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:30.414 > [221.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:30.515 > [221.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:30.615 > [222.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:30.717 > [222.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:30.818 > [222.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:30.919 > [222.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:31.019 > [222.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:31.121 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300871073,"threatLevel":0,"type":"heuristics_update"}
19:44:31.152 > [WebSocket] Processing message type: heuristics_update
19:44:31.154 > [222.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:31.264 > [222.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:31.365 > [222.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:31.466 > [222.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:31.567 > [222.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:31.667 > [223.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:31.769 > [223.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:31.870 > [223.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:31.971 > [223.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 18 | WS: CONNECTED
19:44:31.976 > [RETRY] Attempting to send health data (Max retries: 3)
19:44:31.982 > [BOUNDARY_CHECK] SwitchState=0 PendingActive=0 CommitNonce=12884901889\n[BOUNDARY_CHECK] Not ready to apply: SwitchState=0, PendingActive=0\n[RETRY] Using nonce 9 for all retry attempts (saved: 8)
19:44:31.999 > Generated health data: HR-63 SPO2-95 STEPS-1134
19:44:32.004 > [ESP32] ========================================
19:44:32.007 > [ESP32] ENCRYPTION PIPELINE START
19:44:32.012 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
19:44:32.015 > [ESP32] Active Algorithms for this packet:
19:44:32.021 > [ESP32]   + LFSR
19:44:32.021 > [ESP32]   + Tinkerbell
19:44:32.024 > [ESP32]   + Transposition
19:44:32.026 > [ESP32]   - ChaCha20
19:44:32.026 > [ESP32]   - Salsa20
19:44:32.029 > [ESP32] ========================================
19:44:32.035 > [ESP32] MsgKeys: lfsrSeed=0x2AEBE20D tnk[0..3]=5D7E67A5 trn[0..3]=3618BAAB
19:44:32.052 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313133344D50
19:44:32.052 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313133344D50000000000000 
19:44:32.068 > [ESP32][LFSR] Initializing - Seed: 0x2AEBE20D SeedBe: 0x0DE2EB2A ChaosKey[0..3]: 5D7E67A5 InitialTap: 0x0029 State: 0x2AEBE20D
19:44:32.068 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
19:44:32.076 > 3_After_LFSR (32): 45B0C61CAE22888D268DF4274F4F6FB8 88259469BC46FBCF9823CE27A0B855E5 
19:44:32.084 > [ESP32][LFSR] Keystream (first 16 bytes): 0DE2EB2A9D02DBDD69BFD91E7A6F3CEC
19:44:32.088 > [ESP32][4D] LFSR keystream (first 32 bytes): 0DE2EB2A9D02DBDD69BFD91E7A6F3CECCD75C7448D77C8FBD573CE27A0B855E5
19:44:32.106 > [ESP32][TINKERBELL] Input (first 16 bytes): 45B0C61CAE22888D268DF4274F4F6FB8 Nonce: 0x00000009 Buffer size: 32 bytes
19:44:32.106 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000009 Counter: 0 (must start at 0) Key[0..3]: 5D7E67A5
19:44:32.118 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 814AC151A3713F692DD01B59CCD0774B
19:44:32.127 > 4_After_Tinkerbell (32): C4FA074D0D53B7E40B5DEF7E839F18F3 E16149585177503D0BF0CE1B426ACD45 
19:44:32.135 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 814AC151A3713F692DD01B59CCD0774B
19:44:32.141 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 814AC151A3713F692DD01B59CCD0774B6944DD31ED31ABF293D3003CE2D298A0
19:44:32.151 > 5_After_Transposition (32): 0DB73DCE58519F830BF0534561EF4950 E15D427718E47E07F30B6AC41B4DCDFA 
19:44:32.160 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000009
19:44:32.165 > [ESP32] === HMAC DEBUG INFO ===
19:44:32.168 > [ESP32] HMAC Key being used: B18DCE08F2B9643BF08F1E40B05F2B0C1597731850A09134B401AE76AE5A1B94
19:44:32.177 > [ESP32] HMAC Input length: 45 bytes
19:44:32.180 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000090DB73DCE58519F830BF0534561EF4950E15D42
19:44:32.186 > [ESP32] Nonce: 0x00000009
19:44:32.190 > [ESP32] Packet size before HMAC: 61
19:44:32.193 > [ESP32] Computed HMAC Tag: 4EF75D815DD6885B851CAB2FBB8D2176
19:44:32.199 > [ESP32] === END HMAC DEBUG ===
19:44:32.202 > 6_Final_Packet (61): 820218001800040804000000090DB73D CE58519F830BF0534561EF4950E15D42 ...
19:44:32.210 > [RETRY] Attempt 1/3 (nonce: 9)
19:44:32.212 > POST http://10.249.92.115:8081/health-data with pipeline data
19:44:32.219 > Sending pipeline data to server (609 bytes)
19:44:32.459 > [HTTP] Response code: 200
19:44:32.460 > [HTTP] Response: {"status":"OK:DECRYPTED"}
19:44:32.471 > [RETRY] Health data sent successfully!
19:44:32.474 > ✓ Health data #19 sent successfully
19:44:32.576 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":8,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300872084,"threatLevel":0,"type":"heuristics_update"}
19:44:32.607 > [WebSocket] Processing message type: heuristics_update
19:44:32.610 > [224.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:32.719 > [WebSocket] Received (636 bytes): {"currentRecipe":"CHAOS_ONLY","encData":"ENC_DATA:820218001800040804000000090DB73DCE58519F830BF0534561EF4950E15D427718E47E07F30B6AC41B4DCDFA4EF75D815DD6885B851CAB2FBB8D2176","pipeline":{"afterLFSR":"45B0C61CAE22888D268DF4274F4F6FB888259469BC46FBCF9823CE27A0B855E5","afterSalt":"48522D36332053504F322D39352053544550532D313133344D50","afterTinkerbell":"C4FA074D0D53B7E40B5DEF7E839F18F3E16149585177503D0BF0CE1B426ACD45","afterTransposition":"0DB73DCE58519F830BF0534561EF4950E15D427718E47E07F30B6AC41B4DCDFA"},"plaintext":"HR-63 SPO2-95 STEPS-1134","serverTime":1770300872310,"timestamp":223597,"type":"encryption_update","ztmEnabled":true}
19:44:32.774 > [WebSocket] Processing message type: encryption_update
19:44:32.780 > [224.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:32.882 > [WebSocket] Received (88 bytes): {"heartRate":63,"spo2":95,"steps":1134,"time":1770300872310,"type":"health_data_update"}
19:44:32.891 > [WebSocket] Processing message type: health_data_update
19:44:32.896 > [224.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:33.004 > [WebSocket] Received (226 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3249,"encryptionTime":0.0,"finalPlaintext":"HR-63 SPO2-95 STEPS-1134","handshakeSuccess":true,"totalTime":0.3249},"type":"session_summary_update"}
19:44:33.026 > [WebSocket] Processing message type: session_summary_update
19:44:33.032 > [224.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:33.137 > [WebSocket] Received (660 bytes): {"decryptionTime":0.3249,"encryptedPacket":"820218001800040804000000090DB73DCE58519F830BF0534561EF4950E15D427718E47E07F30B6AC41B4DCDFA4EF75D815DD6885B851CAB2FBB8D2176","finalPlaintext":"HR-63 SPO2-95 STEPS-1134","healthData":{"heartRate":63,"spo2":95,"steps":1134},"pipeline":{"afterDepad":"48522D36332053504F322D39352053544550532D31313334000000000000","afterLFSR":"48522D36332053504F322D39352053544550532D313133344D50000000000000","afterTinkerbell":"45B0C61CAE22888D268DF4274F4F6FB888259469BC46FBCF9823CE27A0B855E5","afterTransposition":"C4FA074D0D53B7E40B5DEF7E839F18F3E16149585177503D0BF0CE1B426ACD45"},"serverTime":1770300872311,"type":"decryption_update"}
19:44:33.195 > [WebSocket] Processing message type: decryption_update
19:44:33.201 > [WebSocket] Server decryption completed
19:44:33.204 > [WebSocket] Health data - HR: 63, SPO2: 95, Steps: 1134
19:44:33.209 > [224.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:33.311 > [WebSocket] Received (649 bytes): {"currentRecipe":"CHAOS_ONLY","deviceId":"f9641d44","healthSendCount":18,"pipeline":{"afterLFSR":"45B0C61CAE22888D268DF4274F4F6FB888259469BC46FBCF9823CE27A0B855E5","afterSalt":"48522D36332053504F322D39352053544550532D313133344D50","afterTinkerbell":"C4FA074D0D53B7E40B5DEF7E839F18F3E16149585177503D0BF0CE1B426ACD45","afterTransposition":"0DB73DCE58519F830BF0534561EF4950E15D427718E47E07F30B6AC41B4DCDFA","finalPacket":"820218001800040804000000090DB73DCE58519F830BF0534561EF4950E15D427718E47E07F30B6AC41B4DCDFA4EF75D815DD6885B851CAB2FBB8D2176"},"plaintext":"HR-63 SPO2-95 STEPS-1134","timestamp":223840,"type":"encryption_pipeline","ztmEnabled":true}
19:44:33.370 > [WebSocket] Processing message type: encryption_pipeline
19:44:33.375 > [224.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:33.474 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":18,"message":"Health data #19 sent successfully","state":7,"success":true,"timestamp":223845,"type":"health_data_sent"}
19:44:33.491 > [WebSocket] Processing message type: health_data_sent
19:44:33.493 > [224.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:33.596 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300873096,"threatLevel":0,"type":"heuristics_update"}
19:44:33.627 > [WebSocket] Processing message type: heuristics_update
19:44:33.630 > [225.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:33.740 > [225.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:33.840 > [225.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:33.940 > [225.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:34.041 > [225.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:34.143 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300874106,"threatLevel":0,"type":"heuristics_update"}
19:44:34.174 > [WebSocket] Processing message type: heuristics_update
19:44:34.177 > [225.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:34.286 > [225.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:34.386 > [225.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:34.488 > [225.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:34.589 > [226.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:34.690 > [226.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:34.790 > [226.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:34.891 > [226.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:34.993 > [226.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:35.094 > [226.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:35.195 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300875116,"threatLevel":0,"type":"heuristics_update"}
19:44:35.225 > [WebSocket] Processing message type: heuristics_update
19:44:35.229 > [226.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:35.338 > [226.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:35.439 > [226.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:35.539 > [226.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:35.641 > [227.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:35.741 > [227.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:35.842 > [227.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:35.943 > [227.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:36.044 > [227.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:36.146 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300876128,"threatLevel":0,"type":"heuristics_update"}
19:44:36.177 > [WebSocket] Processing message type: heuristics_update
19:44:36.180 > [227.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:36.289 > [227.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:36.389 > [227.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:36.491 > [227.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:36.591 > [228.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:36.692 > [228.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:36.793 > [228.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:36.895 > [228.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:36.995 > [228.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:37.097 > [228.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:37.200 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300877139,"threatLevel":0,"type":"heuristics_update"}
19:44:37.232 > [WebSocket] Processing message type: heuristics_update
19:44:37.234 > [228.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:37.343 > [228.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:37.444 > [228.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:37.545 > [228.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:37.646 > [229.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:37.746 > [229.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:37.847 > [229.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:37.949 > [229.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:38.049 > [229.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:38.151 > [229.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
19:44:38.253 > [WebSocket] Received (321 bytes): {"currentRecipe":"CHAOS_ONLY","epoch":8,"lastCommitNonce":12884901889,"lastSeenNonce":9,"metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770300878153,"threatLevel":0,"type":"heuristics_update"}
19:44:38.283 > [WebSocket] Processing message type: heuristics_update
19:44:38.286 > [229.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 19 | WS: CONNECTED
