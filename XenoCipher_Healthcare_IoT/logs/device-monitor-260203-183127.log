18:31:27.511 > ets Jul 29 2019 12:21:46
18:31:27.511 > 
18:31:27.511 > rst:0x1 (POWERON_RESET),boot:0x13 (SPI_FAST_FLASH_BOOT)
18:31:27.516 > configsip: 0, SPIWP:0xee
18:31:27.519 > clk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00
18:31:27.525 > mode:DIO, clock div:2
18:31:27.528 > load:0x3fff0030,len:1184
18:31:27.530 > load:0x40078000,len:13232
18:31:27.533 > load:0x40080400,len:3028
18:31:27.533 > entry 0x400805e4
18:31:28.967 > === XenoCipher ESP32 Booting ===
18:31:28.970 > Free heap: 292976 bytes
18:31:28.970 > Nonce counter reset for new session
18:31:28.973 > [RECIPE] Recipe map version: 1
18:31:28.975 > [RECIPE] Mapping: 1=FULL_STACK 2=CHACHA_HEAVY 3=SALSA_LIGHT 4=CHAOS_ONLY 5=STREAM_FOCUS
18:31:28.983 > [1.0] STATE: INIT_NVS | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:28.992 > ✓ NVS initialized
18:31:29.089 > [1.2] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:29.104 > Connecting to motorola edge 40_6753
18:31:29.300 > [WiFi] STA Start
18:31:29.412 > [1.5] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:29.512 > [1.6] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:29.612 > [1.7] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:29.711 > [1.8] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:29.811 > [1.9] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:29.912 > [2.0] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:30.012 > [2.1] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:30.112 > [2.2] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:30.212 > [2.3] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:30.312 > [2.4] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:30.411 > [2.5] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:30.512 > [2.6] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:30.612 > [2.7] STATE: CONNECT_WIFI | WiFi: DOWN | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:30.626 > [WiFi] Connected to AP
18:31:30.657 > [WiFi] Got IP: 10.249.92.171
18:31:30.657 > [WebSocket] Initialized - Server: 10.249.92.115:8081/api/ws
18:31:30.712 > [2.8] STATE: CONNECT_WIFI | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:30.718 > ✓ WiFi connected! IP: 10.249.92.171
18:31:30.812 > [2.9] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:30.821 > ✓ Public key loaded from NVS
18:31:30.917 > [3.0] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:31.018 > [3.1] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:31.026 > Generating fresh master key from entropy...
18:31:31.033 > Generated master key (32): C47D67BEAB24834FE36EF0AEB51B9870 CADEBD3FAF84DA7953D8F49365FEDCB0 
18:31:31.039 > Using reduced master key (byte % 3) for NTRU encryption only
18:31:31.049 > NTRU encrypted master key (502): 0063005B00400066001500440008006C 00380005001E000C006C006E0023000D ...
18:31:31.057 > POST http://10.249.92.115:8081/master-key
18:31:36.072 > Retry 1/3 for master key
18:31:39.192 > [11.3] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:39.200 > Generating fresh master key from entropy...
18:31:39.206 > Generated master key (32): 65917AC08C1CD3BEB28A1FE7918D51DD 2F4219AAB3E2856AF7433526531CEC5F 
18:31:39.212 > Using reduced master key (byte % 3) for NTRU encryption only
18:31:39.221 > NTRU encrypted master key (502): 0064005A00410065001700450007006C 00370003001F000C006C006E0021000E ...
18:31:39.230 > POST http://10.249.92.115:8081/master-key
18:31:39.433 > ✓ Master key exchange completed
18:31:39.535 > [11.6] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: PENDING | HealthSent: 0 | WS: DISCONNECTED
18:31:39.544 > Loading master key from NVS and deriving symmetric keys...
18:31:39.546 > Loaded master key from NVS (32): 65917AC08C1CD3BEB28A1FE7918D51DD 2F4219AAB3E2856AF7433526531CEC5F 
18:31:39.558 > Derived HMAC key (32): 041533A32D31E770D61FA07F54D8C702 7A4342F9B6D2E054408FB62569FAF374 
18:31:39.563 > Derived Tinkerbell key (16): 9C15CB1B6FE218A6AB8F07F93F556742 
18:31:39.569 > Derived Transposition key (16): 305809744CC5D5095E297B441F456CAD 
18:31:39.577 > ✓ Symmetric keys derived successfully
18:31:39.580 > Nonce tracker reset - new session started
18:31:40.084 > Waiting for server to process master key...
18:31:40.086 > ✓ Symmetric keys ready - starting health data transmission
18:31:40.185 > [12.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
18:31:40.286 > [12.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
18:31:40.386 > [12.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: DISCONNECTED
18:31:40.487 > [WebSocket] ========================================[WebSocket] CONNECTED to: /api/ws
18:31:40.493 > [WebSocket] WebSocket connection established[WebSocket] Ready to receive ZTM activation requests[WebSocket] ========================================[WebSocket] Sent hello message (hello_from_esp32)
18:31:40.509 > [12.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:40.616 > [WebSocket] Received (151 bytes): {"message":"Connected to XenoCipher Server","serverTime":1770123699191,"sessionId":"1770123699191-41","totalClients":2,"type":"connection_established"}
18:31:40.630 > [WebSocket] Processing message type: connection_established
18:31:40.635 > [WebSocket] Connection established - Session: 1770123699191-41
18:31:40.641 > [12.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:40.749 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770123699337,"type":"master_key_received"}
18:31:40.762 > [WebSocket] Processing message type: master_key_received
18:31:40.765 > [12.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:40.871 > [WebSocket] Received (112 bytes): {"message":"ESP32 connection acknowledged","serverTime":1770123700520,"status":"ready","type":"esp32_connected"}
18:31:40.882 > [WebSocket] Processing message type: esp32_connected
18:31:40.888 > [12.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:40.993 > [13.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:41.094 > [13.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:41.195 > [13.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:41.296 > [13.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:41.397 > [13.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:41.498 > [13.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:41.599 > [13.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:41.701 > [13.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:41.801 > [13.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:41.902 > [14.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:42.003 > [14.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:42.104 > [14.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:42.205 > [14.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:42.305 > [14.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:42.407 > [14.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:42.507 > [14.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:42.608 > [14.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:42.710 > [14.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:42.811 > [14.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:42.912 > [15.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:43.012 > [15.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:43.113 > [15.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:43.214 > [15.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:43.315 > [15.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:43.416 > [15.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:43.518 > [15.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:43.619 > [15.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:43.720 > [15.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:43.821 > [15.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:43.922 > [16.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:44.023 > [16.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:44.123 > [16.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:44.224 > [16.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:44.326 > [16.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:44.426 > [16.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:44.528 > [16.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:44.629 > [16.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:44.730 > [16.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:44.831 > [16.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:44.932 > [17.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:45.033 > [17.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:45.133 > [17.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:45.234 > [17.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:45.336 > [17.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:45.436 > [17.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:45.538 > [17.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:45.638 > [17.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:45.740 > [17.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:45.840 > [17.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:45.942 > [18.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:46.043 > [18.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:46.144 > [18.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:46.245 > [18.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:46.346 > [18.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:46.447 > [18.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:46.548 > [18.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:46.649 > [18.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:46.750 > [18.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:46.850 > [18.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:46.952 > [19.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:47.053 > [19.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:47.154 > [19.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:47.255 > [19.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:47.356 > [19.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:47.457 > [19.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:47.557 > [19.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:47.658 > [19.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:47.759 > [19.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:47.861 > [19.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:47.961 > [20.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:48.063 > [20.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:48.164 > [20.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:48.264 > [20.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:48.366 > [20.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:48.467 > [20.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:48.568 > [20.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:48.668 > [20.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:48.770 > [20.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:48.871 > [20.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:48.972 > [21.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:49.073 > [21.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:49.174 > [21.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:49.275 > [21.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:49.376 > [21.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:49.477 > [21.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:49.578 > [21.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:49.679 > [21.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:49.780 > [21.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:49.881 > [21.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:49.982 > [22.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:50.083 > [22.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 0 | WS: CONNECTED
18:31:50.088 > [RETRY] Attempting to send health data (Max retries: 3)
18:31:50.094 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:31:50.100 > Generated health data: HR-60 SPO2-95 STEPS-118
18:31:50.102 > [ESP32] ========================================
18:31:50.108 > [ESP32] ENCRYPTION PIPELINE START
18:31:50.110 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:31:50.119 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:31:50.124 > [ESP32] ========================================
18:31:50.127 > [ESP32] MsgKeys: lfsrSeed=0xCAD17F8D tnk[0..3]=2CF048C6 trn[0..3]=D393056C
18:31:50.136 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3131384D50
18:31:50.142 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3131384D5000000000000000 
18:31:50.150 > [ESP32][LFSR] Initializing - Seed: 0xCAD17F8D SeedBe: 0x8D7FD1CA ChaosKey[0..3]: 2CF048C6 InitialTap: 0x0029 State: 0xCAD17F8D
18:31:50.160 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
18:31:50.169 > 3_After_LFSR (32): C52DFCFC6CD956F35B5F8762E5059F6F 1C5CAD305931D2C5D9D8C9FF1B6D9954 
18:31:50.174 > [ESP32][LFSR] Keystream (first 16 bytes): 8D7FD1CA5CF905A3146DAA5BD025CC3B
18:31:50.183 > [ESP32][4D] LFSR keystream (first 32 bytes): 8D7FD1CA5CF905A3146DAA5BD025CC3B590CFE1D6800EA8889D8C9FF1B6D9954
18:31:50.191 > [ESP32][TINKERBELL] Input (first 16 bytes): C52DFCFC6CD956F35B5F8762E5059F6F Nonce: 0x00000001 Buffer size: 32 bytes
18:31:50.202 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 2CF048C6
18:31:50.213 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 1245540A96F78A82A02DCCFF90CE5E13
18:31:50.219 > 4_After_Tinkerbell (32): D768A8F6FA2EDC71FB724B9D75CBC17C 83BC2401ED7F17AE8E5F8CE1723CAF6D 
18:31:50.227 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 1245540A96F78A82A02DCCFF90CE5E13
18:31:50.236 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 1245540A96F78A82A02DCCFF90CE5E139FE08931B44EC56B5787451E69513639
18:31:50.247 > 5_After_Transposition (32): 6D723CAF8E5F8CE1AEED7F17D768A8F6 7C75CBC1FB724B9D71FA2EDC83BC2401 
18:31:50.255 > [ESP32] === HMAC DEBUG INFO ===
18:31:50.258 > [ESP32] HMAC Key being used: 041533A32D31E770D61FA07F54D8C7027A4342F9B6D2E054408FB62569FAF374
18:31:50.266 > [ESP32] HMAC Input length: 44 bytes
18:31:50.270 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000016D723CAF8E5F8CE1AEED7F17D768A8F67C75CBC1
18:31:50.278 > [ESP32] Nonce: 0x00000001
18:31:50.280 > [ESP32] Packet size before HMAC: 60
18:31:50.283 > [ESP32] Computed HMAC Tag: D8DF8EA696AE8978A87582C2A659411F
18:31:50.289 > [ESP32] === END HMAC DEBUG ===
18:31:50.291 > 6_Final_Packet (60): 8102170017000408000000016D723CAF 8E5F8CE1AEED7F17D768A8F67C75CBC1 ...
18:31:50.300 > [RETRY] Attempt 1/3 (nonce: 1)
18:31:50.303 > POST http://10.249.92.115:8081/health-data with pipeline data
18:31:50.308 > Sending pipeline data to server (654 bytes)
18:31:50.447 > [HTTP] Response code: 200
18:31:50.447 > [HTTP] Response: {"status":"OK:DECRYPTED"}
18:31:50.458 > [RETRY] Health data sent successfully!
18:31:50.461 > ✓ Health data #1 sent successfully
18:31:50.563 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":1,"serverTime":1770123710402,"type":"security_update"}
18:31:50.579 > [WebSocket] Processing message type: security_update
18:31:50.584 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
18:31:50.591 > [22.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:50.696 > [WebSocket] Received (681 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","encData":"ENC_DATA:8102170017000408000000016D723CAF8E5F8CE1AEED7F17D768A8F67C75CBC1FB724B9D71FA2EDC83BC2401D8DF8EA696AE8978A87582C2A659411F","pipeline":{"afterLFSR":"C52DFCFC6CD956F35B5F8762E5059F6F1C5CAD305931D2C5D9D8C9FF1B6D9954","afterSalt":"48522D36302053504F322D39352053544550532D3131384D50","afterTinkerbell":"D768A8F6FA2EDC71FB724B9D75CBC17C83BC2401ED7F17AE8E5F8CE1723CAF6D","afterTransposition":"6D723CAF8E5F8CE1AEED7F17D768A8F67C75CBC1FB724B9D71FA2EDC83BC2401"},"plaintext":"HR-60 SPO2-95 STEPS-118","serverTime":1770123710402,"timestamp":22362,"type":"encryption_update","ztmEnabled":false}
18:31:50.757 > [WebSocket] Processing message type: encryption_update
18:31:50.762 > [22.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:50.870 > [WebSocket] Received (87 bytes): {"heartRate":60,"spo2":95,"steps":118,"time":1770123710402,"type":"health_data_update"}
18:31:50.877 > [WebSocket] Processing message type: health_data_update
18:31:50.884 > [22.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:50.992 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3266,"encryptionTime":0.0,"finalPlaintext":"HR-60 SPO2-95 STEPS-118","handshakeSuccess":true,"totalTime":0.3266},"type":"session_summary_update"}
18:31:51.015 > [WebSocket] Processing message type: session_summary_update
18:31:51.019 > [23.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:51.126 > [WebSocket] Received (656 bytes): {"decryptionTime":0.3266,"encryptedPacket":"8102170017000408000000016D723CAF8E5F8CE1AEED7F17D768A8F67C75CBC1FB724B9D71FA2EDC83BC2401D8DF8EA696AE8978A87582C2A659411F","finalPlaintext":"HR-60 SPO2-95 STEPS-118","healthData":{"heartRate":60,"spo2":95,"steps":118},"pipeline":{"afterDepad":"48522D36302053504F322D39352053544550532D31313800000000000000","afterLFSR":"48522D36302053504F322D39352053544550532D3131384D5000000000000000","afterTinkerbell":"C52DFCFC6CD956F35B5F8762E5059F6F1C5CAD305931D2C5D9D8C9FF1B6D9954","afterTransposition":"D768A8F6FA2EDC71FB724B9D75CBC17C83BC2401ED7F17AE8E5F8CE1723CAF6D"},"serverTime":1770123710403,"type":"decryption_update"}
18:31:51.184 > [WebSocket] Processing message type: decryption_update
18:31:51.189 > [WebSocket] Server decryption completed
18:31:51.192 > [WebSocket] Health data - HR: 60, SPO2: 95, Steps: 118
18:31:51.198 > [23.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:51.298 > [WebSocket] Received (693 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","healthSendCount":0,"pipeline":{"afterLFSR":"C52DFCFC6CD956F35B5F8762E5059F6F1C5CAD305931D2C5D9D8C9FF1B6D9954","afterSalt":"48522D36302053504F322D39352053544550532D3131384D50","afterTinkerbell":"D768A8F6FA2EDC71FB724B9D75CBC17C83BC2401ED7F17AE8E5F8CE1723CAF6D","afterTransposition":"6D723CAF8E5F8CE1AEED7F17D768A8F67C75CBC1FB724B9D71FA2EDC83BC2401","finalPacket":"8102170017000408000000016D723CAF8E5F8CE1AEED7F17D768A8F67C75CBC1FB724B9D71FA2EDC83BC2401D8DF8EA696AE8978A87582C2A659411F"},"plaintext":"HR-60 SPO2-95 STEPS-118","timestamp":22512,"type":"encryption_pipeline","ztmEnabled":false}
18:31:51.360 > [WebSocket] Processing message type: encryption_pipeline
18:31:51.365 > [23.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:51.474 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":0,"message":"Health data #1 sent successfully","state":7,"success":true,"timestamp":22517,"type":"health_data_sent"}
18:31:51.489 > [WebSocket] Processing message type: health_data_sent
18:31:51.493 > [23.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:51.595 > [23.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:51.696 > [23.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:51.797 > [23.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:51.898 > [24.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:51.998 > [24.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:52.100 > [24.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:52.201 > [24.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:52.302 > [24.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:52.403 > [24.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:52.503 > [24.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:52.605 > [24.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:52.706 > [24.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:52.807 > [24.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:52.908 > [25.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:53.009 > [25.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:53.110 > [25.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:53.211 > [25.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:53.311 > [25.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:53.413 > [25.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:53.514 > [25.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:53.615 > [25.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:53.715 > [25.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:53.817 > [25.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:53.917 > [26.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:54.019 > [26.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:54.120 > [26.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:54.221 > [26.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:54.322 > [26.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:54.422 > [26.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:54.523 > [26.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:54.624 > [26.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:54.725 > [26.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:54.826 > [26.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:54.927 > [27.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:55.028 > [27.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:55.129 > [27.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:55.230 > [27.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:55.332 > [27.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:55.433 > [27.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:55.533 > [27.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:55.633 > [27.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:55.736 > [27.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:55.836 > [27.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:55.936 > [28.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:56.038 > [28.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:56.140 > [28.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:56.241 > [28.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:56.341 > [28.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:56.442 > [28.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:56.544 > [28.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:56.645 > [28.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:56.745 > [28.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:56.847 > [28.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:56.948 > [29.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:57.048 > [29.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:57.150 > [29.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:57.251 > [29.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:57.352 > [29.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:57.452 > [29.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:57.553 > [29.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:57.654 > [29.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:57.755 > [29.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:57.856 > [29.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:57.958 > [30.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:58.059 > [30.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:58.160 > [30.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:58.261 > [30.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:58.361 > [30.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:58.462 > [30.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:58.563 > [30.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:58.664 > [30.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:58.766 > [30.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:58.867 > [30.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:58.968 > [31.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:59.068 > [31.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:59.170 > [31.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:59.270 > [31.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:59.371 > [31.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:59.473 > [31.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:59.573 > [31.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:59.675 > [31.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:59.775 > [31.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:59.877 > [31.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:31:59.977 > [32.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:00.078 > [32.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:00.180 > [32.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:00.281 > [32.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:00.382 > [32.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:00.483 > [32.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:00.488 > [RETRY] Attempting to send health data (Max retries: 3)
18:32:00.493 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:32:00.498 > Generated health data: HR-60 SPO2-95 STEPS-180
18:32:00.502 > [ESP32] ========================================
18:32:00.508 > [ESP32] ENCRYPTION PIPELINE START
18:32:00.511 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:32:00.519 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:32:00.524 > [ESP32] ========================================
18:32:00.527 > [ESP32] MsgKeys: lfsrSeed=0x2F86E323 tnk[0..3]=790153C7 trn[0..3]=F2B44F83
18:32:00.536 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3138304D50
18:32:00.541 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3138304D5000000000000000 
18:32:00.550 > [ESP32][LFSR] Initializing - Seed: 0x2F86E323 SeedBe: 0x23E3862F ChaosKey[0..3]: 790153C7 InitialTap: 0x0029 State: 0x2F86E323
18:32:00.561 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
18:32:00.569 > 3_After_LFSR (32): 6BB1AB19635DE9388E304B17BD8A7006 37DA49FAB105043D2A0260DA9061EAFE 
18:32:00.574 > [ESP32][LFSR] Keystream (first 16 bytes): 23E3862F537DBA68C102662E88AA2352
18:32:00.583 > [ESP32][4D] LFSR keystream (first 32 bytes): 23E3862F537DBA68C102662E88AA2352728A1AD7803D34707A0260DA9061EAFE
18:32:00.591 > [ESP32][TINKERBELL] Input (first 16 bytes): 6BB1AB19635DE9388E304B17BD8A7006 Nonce: 0x00000002 Buffer size: 32 bytes
18:32:00.602 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 790153C7
18:32:00.614 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 8E0C07AE01ACEF0FB7CA15D09CB741D3
18:32:00.618 > 4_After_Tinkerbell (32): E5BDACB762F1063739FA5EC7213D31D5 7E2D009C9AA1D2BF2B5A1806B0ECE1BC 
18:32:00.627 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 8E0C07AE01ACEF0FB7CA15D09CB741D3
18:32:00.635 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 8E0C07AE01ACEF0FB7CA15D09CB741D349F749662BA4D682015878DC208D0B42
18:32:00.646 > 5_After_Transposition (32): D262395E9CBFA1BD319A7E00B7D5F1FA 0621E5ACC7373D2D2B5AECBCB01806E1 
18:32:00.654 > [ESP32] === HMAC DEBUG INFO ===
18:32:00.657 > [ESP32] HMAC Key being used: 041533A32D31E770D61FA07F54D8C7027A4342F9B6D2E054408FB62569FAF374
18:32:00.666 > [ESP32] HMAC Input length: 44 bytes
18:32:00.668 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000002D262395E9CBFA1BD319A7E00B7D5F1FA0621E5AC
18:32:00.677 > [ESP32] Nonce: 0x00000002
18:32:00.680 > [ESP32] Packet size before HMAC: 60
18:32:00.683 > [ESP32] Computed HMAC Tag: 36856614823CCC493410768B905E45B3
18:32:00.688 > [ESP32] === END HMAC DEBUG ===
18:32:00.691 > 6_Final_Packet (60): 810217001700040800000002D262395E 9CBFA1BD319A7E00B7D5F1FA0621E5AC ...
18:32:00.700 > [RETRY] Attempt 1/3 (nonce: 2)
18:32:00.702 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:00.708 > Sending pipeline data to server (654 bytes)
18:32:00.960 > [HTTP] Response code: 400
18:32:00.960 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:00.965 > [HTTP] Request failed with code: 400
18:32:00.968 > [RETRY] Send failed, waiting 100 ms before retry
18:32:01.068 > [RETRY] Attempt 2/3 (nonce: 2)
18:32:01.069 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:01.073 > Sending pipeline data to server (654 bytes)
18:32:01.444 > [HTTP] Response code: 400
18:32:01.444 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:01.450 > [HTTP] Request failed with code: 400
18:32:01.452 > [RETRY] Send failed, waiting 200 ms before retry
18:32:01.652 > [RETRY] Attempt 3/3 (nonce: 2)
18:32:01.652 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:01.658 > Sending pipeline data to server (654 bytes)
18:32:01.949 > [HTTP] Response code: 400
18:32:01.949 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:01.955 > [HTTP] Request failed with code: 400
18:32:01.958 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:32:01.963 > [RETRY] Consecutive failures: 1
18:32:01.966 > Health data send failed (retry count: 1/3)
18:32:02.071 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":33024,"type":"health_data_error"}
18:32:02.085 > [WebSocket] Processing message type: health_data_error
18:32:02.091 > [34.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:02.098 > [RETRY] Attempting to send health data (Max retries: 3)
18:32:02.104 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:32:02.110 > Generated health data: HR-60 SPO2-95 STEPS-206
18:32:02.113 > [ESP32] ========================================
18:32:02.118 > [ESP32] ENCRYPTION PIPELINE START
18:32:02.121 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:32:02.127 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:32:02.135 > [ESP32] ========================================
18:32:02.138 > [ESP32] MsgKeys: lfsrSeed=0x2F86E323 tnk[0..3]=790153C7 trn[0..3]=F2B44F83
18:32:02.144 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3230364D50
18:32:02.152 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3230364D5000000000000000 
18:32:02.157 > [ESP32][LFSR] Initializing - Seed: 0x2F86E323 SeedBe: 0x23E3862F ChaosKey[0..3]: 790153C7 InitialTap: 0x0029 State: 0x2F86E323
18:32:02.169 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
18:32:02.177 > 3_After_LFSR (32): 6BB1AB19635DE9388E304B17BD8A7006 37DA49FAB20D023D2A0260DA9061EAFE 
18:32:02.185 > [ESP32][LFSR] Keystream (first 16 bytes): 23E3862F537DBA68C102662E88AA2352
18:32:02.191 > [ESP32][4D] LFSR keystream (first 32 bytes): 23E3862F537DBA68C102662E88AA2352728A1AD7803D34707A0260DA9061EAFE
18:32:02.202 > [ESP32][TINKERBELL] Input (first 16 bytes): 6BB1AB19635DE9388E304B17BD8A7006 Nonce: 0x00000002 Buffer size: 32 bytes
18:32:02.213 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 790153C7
18:32:02.221 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 8E0C07AE01ACEF0FB7CA15D09CB741D3
18:32:02.229 > 4_After_Tinkerbell (32): E5BDACB762F1063739FA5EC7213D31D5 7E2D009C99A9D4BF2B5A1806B0ECE1BC 
18:32:02.238 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 8E0C07AE01ACEF0FB7CA15D09CB741D3
18:32:02.247 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 8E0C07AE01ACEF0FB7CA15D09CB741D349F749662BA4D682015878DC208D0B42
18:32:02.255 > 5_After_Transposition (32): D462395E9CBFA9BD31997E00B7D5F1FA 0621E5ACC7373D2D2B5AECBCB01806E1 
18:32:02.263 > [ESP32] === HMAC DEBUG INFO ===
18:32:02.266 > [ESP32] HMAC Key being used: 041533A32D31E770D61FA07F54D8C7027A4342F9B6D2E054408FB62569FAF374
18:32:02.274 > [ESP32] HMAC Input length: 44 bytes
18:32:02.280 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000002D462395E9CBFA9BD31997E00B7D5F1FA0621E5AC
18:32:02.288 > [ESP32] Nonce: 0x00000002
18:32:02.291 > [ESP32] Packet size before HMAC: 60
18:32:02.293 > [ESP32] Computed HMAC Tag: 77908361BF6E7E61B1BAEC5A3776B0DA
18:32:02.300 > [ESP32] === END HMAC DEBUG ===
18:32:02.302 > 6_Final_Packet (60): 810217001700040800000002D462395E 9CBFA9BD31997E00B7D5F1FA0621E5AC ...
18:32:02.307 > [RETRY] Attempt 1/3 (nonce: 2)
18:32:02.310 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:02.316 > Sending pipeline data to server (654 bytes)
18:32:02.452 > [HTTP] Response code: 400
18:32:02.452 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:02.457 > [HTTP] Request failed with code: 400
18:32:02.460 > [RETRY] Send failed, waiting 100 ms before retry
18:32:02.561 > [RETRY] Attempt 2/3 (nonce: 2)
18:32:02.562 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:02.567 > Sending pipeline data to server (654 bytes)
18:32:02.698 > [HTTP] Response code: 400
18:32:02.698 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:02.704 > [HTTP] Request failed with code: 400
18:32:02.707 > [RETRY] Send failed, waiting 200 ms before retry
18:32:02.907 > [RETRY] Attempt 3/3 (nonce: 2)
18:32:02.907 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:02.912 > Sending pipeline data to server (654 bytes)
18:32:03.241 > [HTTP] Response code: 400
18:32:03.241 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:03.247 > [HTTP] Request failed with code: 400
18:32:03.250 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:32:03.255 > [RETRY] Consecutive failures: 2
18:32:03.258 > Health data send failed (retry count: 2/3)
18:32:03.361 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":33509,"type":"health_data_error"}
18:32:03.374 > [WebSocket] Processing message type: health_data_error
18:32:03.380 > [35.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:03.389 > [RETRY] Attempting to send health data (Max retries: 3)
18:32:03.394 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:32:03.399 > Generated health data: HR-60 SPO2-95 STEPS-185
18:32:03.402 > [ESP32] ========================================
18:32:03.408 > [ESP32] ENCRYPTION PIPELINE START
18:32:03.410 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:32:03.416 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:32:03.425 > [ESP32] ========================================
18:32:03.427 > [ESP32] MsgKeys: lfsrSeed=0x2F86E323 tnk[0..3]=790153C7 trn[0..3]=F2B44F83
18:32:03.433 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3138354D50
18:32:03.441 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3138354D5000000000000000 
18:32:03.447 > [ESP32][LFSR] Initializing - Seed: 0x2F86E323 SeedBe: 0x23E3862F ChaosKey[0..3]: 790153C7 InitialTap: 0x0029 State: 0x2F86E323
18:32:03.458 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
18:32:03.466 > 3_After_LFSR (32): 6BB1AB19635DE9388E304B17BD8A7006 37DA49FAB105013D2A0260DA9061EAFE 
18:32:03.475 > [ESP32][LFSR] Keystream (first 16 bytes): 23E3862F537DBA68C102662E88AA2352
18:32:03.480 > [ESP32][4D] LFSR keystream (first 32 bytes): 23E3862F537DBA68C102662E88AA2352728A1AD7803D34707A0260DA9061EAFE
18:32:03.491 > [ESP32][TINKERBELL] Input (first 16 bytes): 6BB1AB19635DE9388E304B17BD8A7006 Nonce: 0x00000002 Buffer size: 32 bytes
18:32:03.502 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 790153C7
18:32:03.511 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 8E0C07AE01ACEF0FB7CA15D09CB741D3
18:32:03.518 > 4_After_Tinkerbell (32): E5BDACB762F1063739FA5EC7213D31D5 7E2D009C9AA1D7BF2B5A1806B0ECE1BC 
18:32:03.528 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 8E0C07AE01ACEF0FB7CA15D09CB741D3
18:32:03.535 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 8E0C07AE01ACEF0FB7CA15D09CB741D349F749662BA4D682015878DC208D0B42
18:32:03.544 > 5_After_Transposition (32): D762395E9CBFA1BD319A7E00B7D5F1FA 0621E5ACC7373D2D2B5AECBCB01806E1 
18:32:03.552 > [ESP32] === HMAC DEBUG INFO ===
18:32:03.555 > [ESP32] HMAC Key being used: 041533A32D31E770D61FA07F54D8C7027A4342F9B6D2E054408FB62569FAF374
18:32:03.564 > [ESP32] HMAC Input length: 44 bytes
18:32:03.569 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000002D762395E9CBFA1BD319A7E00B7D5F1FA0621E5AC
18:32:03.578 > [ESP32] Nonce: 0x00000002
18:32:03.580 > [ESP32] Packet size before HMAC: 60
18:32:03.583 > [ESP32] Computed HMAC Tag: 210902544E4C97E6C246F1DB22D586CA
18:32:03.589 > [ESP32] === END HMAC DEBUG ===
18:32:03.592 > 6_Final_Packet (60): 810217001700040800000002D762395E 9CBFA1BD319A7E00B7D5F1FA0621E5AC ...
18:32:03.597 > [RETRY] Attempt 1/3 (nonce: 2)
18:32:03.600 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:03.605 > Sending pipeline data to server (654 bytes)
18:32:03.716 > [HTTP] Response code: 400
18:32:03.716 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:03.720 > [HTTP] Request failed with code: 400
18:32:03.723 > [RETRY] Send failed, waiting 100 ms before retry
18:32:03.825 > [RETRY] Attempt 2/3 (nonce: 2)
18:32:03.825 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:03.829 > Sending pipeline data to server (654 bytes)
18:32:03.966 > [HTTP] Response code: 400
18:32:03.966 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:03.972 > [HTTP] Request failed with code: 400
18:32:03.975 > [RETRY] Send failed, waiting 200 ms before retry
18:32:04.173 > [RETRY] Attempt 3/3 (nonce: 2)
18:32:04.174 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:04.180 > Sending pipeline data to server (654 bytes)
18:32:04.468 > [HTTP] Response code: 400
18:32:04.468 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:04.473 > [HTTP] Request failed with code: 400
18:32:04.477 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:32:04.482 > [RETRY] Consecutive failures: 3
18:32:04.484 > Health data send failed (retry count: 3/3)
18:32:04.488 > Health data transmission failed after max retries
18:32:04.588 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":34014,"type":"health_data_error"}
18:32:04.602 > [WebSocket] Processing message type: health_data_error
18:32:04.607 > [36.7] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:04.616 > ERROR state - attempting recovery
18:32:04.618 > [RETRY] Attempting to send health data (Max retries: 3)
18:32:04.623 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:32:04.626 > Generated health data: HR-60 SPO2-95 STEPS-186
18:32:04.632 > [ESP32] ========================================
18:32:04.635 > [ESP32] ENCRYPTION PIPELINE START
18:32:04.637 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:32:04.646 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:32:04.652 > [ESP32] ========================================
18:32:04.657 > [ESP32] MsgKeys: lfsrSeed=0x2F86E323 tnk[0..3]=790153C7 trn[0..3]=F2B44F83
18:32:04.663 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3138364D50
18:32:04.668 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3138364D5000000000000000 
18:32:04.676 > [ESP32][LFSR] Initializing - Seed: 0x2F86E323 SeedBe: 0x23E3862F ChaosKey[0..3]: 790153C7 InitialTap: 0x0029 State: 0x2F86E323
18:32:04.688 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
18:32:04.696 > 3_After_LFSR (32): 6BB1AB19635DE9388E304B17BD8A7006 37DA49FAB105023D2A0260DA9061EAFE 
18:32:04.704 > [ESP32][LFSR] Keystream (first 16 bytes): 23E3862F537DBA68C102662E88AA2352
18:32:04.709 > [ESP32][4D] LFSR keystream (first 32 bytes): 23E3862F537DBA68C102662E88AA2352728A1AD7803D34707A0260DA9061EAFE
18:32:04.721 > [ESP32][TINKERBELL] Input (first 16 bytes): 6BB1AB19635DE9388E304B17BD8A7006 Nonce: 0x00000002 Buffer size: 32 bytes
18:32:04.729 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 790153C7
18:32:04.741 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 8E0C07AE01ACEF0FB7CA15D09CB741D3
18:32:04.748 > 4_After_Tinkerbell (32): E5BDACB762F1063739FA5EC7213D31D5 7E2D009C9AA1D4BF2B5A1806B0ECE1BC 
18:32:04.757 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 8E0C07AE01ACEF0FB7CA15D09CB741D3
18:32:04.766 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 8E0C07AE01ACEF0FB7CA15D09CB741D349F749662BA4D682015878DC208D0B42
18:32:04.773 > 5_After_Transposition (32): D462395E9CBFA1BD319A7E00B7D5F1FA 0621E5ACC7373D2D2B5AECBCB01806E1 
18:32:04.782 > [ESP32] === HMAC DEBUG INFO ===
18:32:04.785 > [ESP32] HMAC Key being used: 041533A32D31E770D61FA07F54D8C7027A4342F9B6D2E054408FB62569FAF374
18:32:04.793 > [ESP32] HMAC Input length: 44 bytes
18:32:04.796 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000002D462395E9CBFA1BD319A7E00B7D5F1FA0621E5AC
18:32:04.807 > [ESP32] Nonce: 0x00000002
18:32:04.807 > [ESP32] Packet size before HMAC: 60
18:32:04.810 > [ESP32] Computed HMAC Tag: 76EA1A924C350DA531780E702FF158E3
18:32:04.816 > [ESP32] === END HMAC DEBUG ===
18:32:04.818 > 6_Final_Packet (60): 810217001700040800000002D462395E 9CBFA1BD319A7E00B7D5F1FA0621E5AC ...
18:32:04.826 > [RETRY] Attempt 1/3 (nonce: 2)
18:32:04.829 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:04.835 > Sending pipeline data to server (654 bytes)
18:32:04.980 > [HTTP] Response code: 400
18:32:04.981 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:04.986 > [HTTP] Request failed with code: 400
18:32:04.989 > [RETRY] Send failed, waiting 100 ms before retry
18:32:05.090 > [RETRY] Attempt 2/3 (nonce: 2)
18:32:05.090 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:05.095 > Sending pipeline data to server (654 bytes)
18:32:05.227 > [HTTP] Response code: 400
18:32:05.227 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:05.232 > [HTTP] Request failed with code: 400
18:32:05.234 > [RETRY] Send failed, waiting 200 ms before retry
18:32:05.434 > [RETRY] Attempt 3/3 (nonce: 2)
18:32:05.434 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:05.439 > Sending pipeline data to server (654 bytes)
18:32:05.728 > [HTTP] Response code: 400
18:32:05.728 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:05.732 > [HTTP] Request failed with code: 400
18:32:05.735 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:32:05.741 > [RETRY] Consecutive failures: 4
18:32:05.744 > ✗ Auto-recovery failed - restarting key exchange
18:32:07.848 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":34517,"type":"health_data_error"}
18:32:07.861 > [WebSocket] Processing message type: health_data_error
18:32:07.866 > [39.9] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:07.875 > ✓ Public key loaded from NVS
18:32:07.973 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":34763,"type":"health_data_error"}
18:32:07.988 > [WebSocket] Processing message type: health_data_error
18:32:07.993 > [40.0] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:08.097 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":35306,"type":"health_data_error"}
18:32:08.110 > [WebSocket] Processing message type: health_data_error
18:32:08.116 > [40.2] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:08.124 > Generating fresh master key from entropy...
18:32:08.133 > Generated master key (32): 5C8D5CC00F0C877379526D60E547B1EB 08955F8B90467F0D13C988E999FE87A9 
18:32:08.139 > Using reduced master key (byte % 3) for NTRU encryption only
18:32:08.148 > NTRU encrypted master key (502): 0064005900410065001500440006006C 00370004001F000C006C00700021000D ...
18:32:08.157 > POST http://10.249.92.115:8081/master-key
18:32:08.478 > ✓ Master key exchange completed
18:32:08.580 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":35780,"type":"health_data_error"}
18:32:08.594 > [WebSocket] Processing message type: health_data_error
18:32:08.599 > [40.7] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:08.608 > Loading master key from NVS and deriving symmetric keys...
18:32:08.613 > Loaded master key from NVS (32): 5C8D5CC00F0C877379526D60E547B1EB 08955F8B90467F0D13C988E999FE87A9 
18:32:08.621 > Derived HMAC key (32): A9D248FABDDA31BE9BB79048DD645EF5 EAD96D04FEC7075DB643C95BBCCA09D2 
18:32:08.630 > Derived Tinkerbell key (16): DDC4D2474DD670E704A007777E043953 
18:32:08.636 > Derived Transposition key (16): C4F954A48395016BCF387B394A5D6DE6 
18:32:08.640 > ✓ Symmetric keys derived successfully
18:32:08.644 > Nonce tracker reset - new session started
18:32:09.140 > Waiting for server to process master key...
18:32:09.143 > ✓ Symmetric keys ready - starting health data transmission
18:32:09.246 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":36031,"type":"health_data_error"}
18:32:09.259 > [WebSocket] Processing message type: health_data_error
18:32:09.265 > [41.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:09.368 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":36533,"type":"health_data_error"}
18:32:09.382 > [WebSocket] Processing message type: health_data_error
18:32:09.388 > [41.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:09.490 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":8,"success":false,"timestamp":37046,"type":"health_data_error"}
18:32:09.504 > [WebSocket] Processing message type: health_data_error
18:32:09.510 > [41.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:09.613 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":8,"success":false,"timestamp":37291,"type":"health_data_error"}
18:32:09.626 > [WebSocket] Processing message type: health_data_error
18:32:09.633 > [41.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:09.738 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":8,"success":false,"timestamp":37792,"type":"health_data_error"}
18:32:09.752 > [WebSocket] Processing message type: health_data_error
18:32:09.757 > [41.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:09.861 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770123728237,"type":"master_key_received"}
18:32:09.875 > [WebSocket] Processing message type: master_key_received
18:32:09.877 > [41.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:09.982 > [WebSocket] Received (174 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":40535,"type":"master_key_exchanged"}
18:32:09.999 > [WebSocket] Processing message type: master_key_exchanged
18:32:10.004 > [42.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:10.105 > [WebSocket] Received (166 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":41204,"type":"symmetric_keys_derived"}
18:32:10.121 > [WebSocket] Processing message type: symmetric_keys_derived
18:32:10.127 > [42.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:10.226 > [42.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:10.327 > [42.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:10.428 > [42.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:10.529 > [42.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:10.630 > [42.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:10.731 > [42.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:10.832 > [42.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:10.933 > [43.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:11.034 > [43.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:11.135 > [43.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:11.236 > [43.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:11.337 > [43.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:11.438 > [43.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:11.539 > [43.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:11.640 > [43.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:11.741 > [43.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:11.842 > [43.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:11.943 > [44.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:12.044 > [44.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:12.145 > [44.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:12.247 > [44.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:12.347 > [44.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:12.447 > [44.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:12.548 > [44.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:12.650 > [44.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:12.751 > [44.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:12.852 > [44.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:12.953 > [45.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:13.054 > [45.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:13.155 > [45.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:13.256 > [45.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:13.357 > [45.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:13.457 > [45.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:13.559 > [45.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:13.660 > [45.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:13.761 > [45.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:13.862 > [45.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:13.963 > [46.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:14.064 > [46.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:14.165 > [46.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:14.267 > [46.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:14.367 > [46.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:14.467 > [46.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:14.568 > [46.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:14.669 > [46.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:14.771 > [46.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:14.872 > [46.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:14.973 > [47.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:15.074 > [47.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:15.175 > [47.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:15.275 > [47.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:15.377 > [47.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:15.477 > [47.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:15.579 > [47.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:15.679 > [47.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:15.781 > [47.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:15.881 > [47.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:15.982 > [48.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:16.083 > [48.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:16.184 > [48.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:16.285 > [48.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:16.387 > [48.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:16.487 > [48.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:16.589 > [48.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:16.690 > [48.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:16.792 > [48.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:16.892 > [49.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:16.992 > [49.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:17.094 > [49.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:17.194 > [49.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:17.296 > [49.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:17.397 > [49.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:17.498 > [49.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:17.599 > [49.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:17.700 > [49.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:17.800 > [49.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:17.902 > [50.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:18.003 > [50.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:18.104 > [50.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:18.204 > [50.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:18.306 > [50.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:18.406 > [50.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:18.508 > [50.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:18.609 > [50.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:18.710 > [50.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:18.811 > [50.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:18.912 > [51.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:19.013 > [51.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:19.114 > [51.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:19.215 > [51.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:19.221 > [RETRY] Attempting to send health data (Max retries: 3)
18:32:19.227 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:32:19.231 > Generated health data: HR-60 SPO2-95 STEPS-270
18:32:19.234 > [ESP32] ========================================
18:32:19.240 > [ESP32] ENCRYPTION PIPELINE START
18:32:19.242 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:32:19.252 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:32:19.256 > [ESP32] ========================================
18:32:19.259 > [ESP32] MsgKeys: lfsrSeed=0x02094BE0 tnk[0..3]=3FE648EC trn[0..3]=F56E12CB
18:32:19.268 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3237304D50
18:32:19.273 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3237304D5000000000000000 
18:32:19.282 > [ESP32][LFSR] Initializing - Seed: 0x02094BE0 SeedBe: 0xE04B0902 ChaosKey[0..3]: 3FE648EC InitialTap: 0x0029 State: 0x02094BE0
18:32:19.293 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
18:32:19.301 > 3_After_LFSR (32): A81924341C2A5186132681B3CE24DBCB 5639675EC7FA75FE1EACB93663C22689 
18:32:19.307 > [ESP32][LFSR] Keystream (first 16 bytes): E04B09022C0A02D65C14AC8AFB04889F
18:32:19.315 > [ESP32][4D] LFSR keystream (first 32 bytes): E04B09022C0A02D65C14AC8AFB04889F13693473F5CD45B34EACB93663C22689
18:32:19.323 > [ESP32][TINKERBELL] Input (first 16 bytes): A81924341C2A5186132681B3CE24DBCB Nonce: 0x00000001 Buffer size: 32 bytes
18:32:19.335 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 3FE648EC
18:32:19.346 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A1FA5729870C69A692FA83873BE427B3
18:32:19.352 > 4_After_Tinkerbell (32): 09E3731D9B26382081DC0234F5C0FC78 804B7C5C617294ADBF5A13CBF4CE2051 
18:32:19.359 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A1FA5729870C69A692FA83873BE427B3
18:32:19.368 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A1FA5729870C69A692FA83873BE427B3D6721B02A688E153A1F6AAFD970C06D8
18:32:19.379 > 5_After_Transposition (32): DC8102804B7C2051E30973BF5A1394AD 5C61721D9B263820CBF4CE34F5C0FC78 
18:32:19.388 > [ESP32] === HMAC DEBUG INFO ===
18:32:19.390 > [ESP32] HMAC Key being used: A9D248FABDDA31BE9BB79048DD645EF5EAD96D04FEC7075DB643C95BBCCA09D2
18:32:19.399 > [ESP32] HMAC Input length: 44 bytes
18:32:19.401 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001DC8102804B7C2051E30973BF5A1394AD5C61721D
18:32:19.409 > [ESP32] Nonce: 0x00000001
18:32:19.412 > [ESP32] Packet size before HMAC: 60
18:32:19.415 > [ESP32] Computed HMAC Tag: 88D67A224FBE8AA4825938F542D67701
18:32:19.421 > [ESP32] === END HMAC DEBUG ===
18:32:19.423 > 6_Final_Packet (60): 810217001700040800000001DC810280 4B7C2051E30973BF5A1394AD5C61721D ...
18:32:19.432 > [RETRY] Attempt 1/3 (nonce: 1)
18:32:19.435 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:19.442 > Sending pipeline data to server (654 bytes)
18:32:19.742 > [HTTP] Response code: 400
18:32:19.742 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:19.747 > [HTTP] Request failed with code: 400
18:32:19.751 > [RETRY] Send failed, waiting 100 ms before retry
18:32:19.850 > [RETRY] Attempt 2/3 (nonce: 1)
18:32:19.850 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:19.856 > Sending pipeline data to server (654 bytes)
18:32:19.982 > [HTTP] Response code: 400
18:32:19.982 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:19.986 > [HTTP] Request failed with code: 400
18:32:19.990 > [RETRY] Send failed, waiting 200 ms before retry
18:32:20.190 > [RETRY] Attempt 3/3 (nonce: 1)
18:32:20.190 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:20.195 > Sending pipeline data to server (654 bytes)
18:32:20.490 > [HTTP] Response code: 400
18:32:20.490 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:20.495 > [HTTP] Request failed with code: 400
18:32:20.497 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:32:20.503 > [RETRY] Consecutive failures: 5
18:32:20.506 > [EMERGENCY] Triggering emergency reset!
18:32:20.508 > [CRYPTO] Resetting cryptographic state
18:32:20.515 > [CRYPTO] Crypto state reset complete
18:32:20.517 > [CRYPTO] Packet counter: 1
18:32:20.520 > [EMERGENCY] Emergency reset complete
18:32:20.522 > Health data send failed (retry count: 1/3)
18:32:20.619 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":51807,"type":"health_data_error"}
18:32:20.633 > [WebSocket] Processing message type: health_data_error
18:32:20.639 > [52.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:20.648 > [RETRY] Attempting to send health data (Max retries: 3)
18:32:20.653 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:32:20.659 > Generated health data: HR-60 SPO2-95 STEPS-281
18:32:20.661 > [ESP32] ========================================
18:32:20.667 > [ESP32] ENCRYPTION PIPELINE START
18:32:20.670 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:32:20.675 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:32:20.684 > [ESP32] ========================================
18:32:20.686 > [ESP32] MsgKeys: lfsrSeed=0x02094BE0 tnk[0..3]=3FE648EC trn[0..3]=F56E12CB
18:32:20.692 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3238314D50
18:32:20.700 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3238314D5000000000000000 
18:32:20.706 > [ESP32][LFSR] Initializing - Seed: 0x02094BE0 SeedBe: 0xE04B0902 ChaosKey[0..3]: 3FE648EC InitialTap: 0x0029 State: 0x02094BE0
18:32:20.717 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
18:32:20.726 > 3_After_LFSR (32): A81924341C2A5186132681B3CE24DBCB 5639675EC7F574FE1EACB93663C22689 
18:32:20.733 > [ESP32][LFSR] Keystream (first 16 bytes): E04B09022C0A02D65C14AC8AFB04889F
18:32:20.739 > [ESP32][4D] LFSR keystream (first 32 bytes): E04B09022C0A02D65C14AC8AFB04889F13693473F5CD45B34EACB93663C22689
18:32:20.750 > [ESP32][TINKERBELL] Input (first 16 bytes): A81924341C2A5186132681B3CE24DBCB Nonce: 0x00000001 Buffer size: 32 bytes
18:32:20.762 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 3FE648EC
18:32:20.770 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A1FA5729870C69A692FA83873BE427B3
18:32:20.778 > 4_After_Tinkerbell (32): 09E3731D9B26382081DC0234F5C0FC78 804B7C5C617D95ADBF5A13CBF4CE2051 
18:32:20.787 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A1FA5729870C69A692FA83873BE427B3
18:32:20.795 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A1FA5729870C69A692FA83873BE427B3D6721B02A688E153A1F6AAFD970C06D8
18:32:20.803 > 5_After_Transposition (32): DC8102804B7C2051E30973BF5A1395AD 5C617D1D9B263820CBF4CE34F5C0FC78 
18:32:20.812 > [ESP32] === HMAC DEBUG INFO ===
18:32:20.814 > [ESP32] HMAC Key being used: A9D248FABDDA31BE9BB79048DD645EF5EAD96D04FEC7075DB643C95BBCCA09D2
18:32:20.823 > [ESP32] HMAC Input length: 44 bytes
18:32:20.827 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001DC8102804B7C2051E30973BF5A1395AD5C617D1D
18:32:20.837 > [ESP32] Nonce: 0x00000001
18:32:20.839 > [ESP32] Packet size before HMAC: 60
18:32:20.842 > [ESP32] Computed HMAC Tag: DC75A89B01DE9E4FDF173879CD3E101B
18:32:20.848 > [ESP32] === END HMAC DEBUG ===
18:32:20.850 > 6_Final_Packet (60): 810217001700040800000001DC810280 4B7C2051E30973BF5A1395AD5C617D1D ...
18:32:20.856 > [RETRY] Attempt 1/3 (nonce: 1)
18:32:20.859 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:20.864 > Sending pipeline data to server (654 bytes)
18:32:20.990 > [HTTP] Response code: 400
18:32:20.990 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:20.996 > [HTTP] Request failed with code: 400
18:32:20.998 > [RETRY] Send failed, waiting 100 ms before retry
18:32:21.099 > [RETRY] Attempt 2/3 (nonce: 1)
18:32:21.099 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:21.104 > Sending pipeline data to server (654 bytes)
18:32:21.242 > [HTTP] Response code: 400
18:32:21.242 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:21.248 > [HTTP] Request failed with code: 400
18:32:21.250 > [RETRY] Send failed, waiting 200 ms before retry
18:32:21.451 > [RETRY] Attempt 3/3 (nonce: 1)
18:32:21.451 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:21.456 > Sending pipeline data to server (654 bytes)
18:32:21.750 > [HTTP] Response code: 400
18:32:21.750 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:21.756 > [HTTP] Request failed with code: 400
18:32:21.759 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:32:21.765 > [RETRY] Consecutive failures: 1
18:32:21.767 > Health data send failed (retry count: 2/3)
18:32:21.871 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":52047,"type":"health_data_error"}
18:32:21.884 > [WebSocket] Processing message type: health_data_error
18:32:21.890 > [53.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:21.898 > [RETRY] Attempting to send health data (Max retries: 3)
18:32:21.904 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:32:21.909 > Generated health data: HR-60 SPO2-95 STEPS-279
18:32:21.912 > [ESP32] ========================================
18:32:21.917 > [ESP32] ENCRYPTION PIPELINE START
18:32:21.920 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:32:21.926 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:32:21.934 > [ESP32] ========================================
18:32:21.937 > [ESP32] MsgKeys: lfsrSeed=0x02094BE0 tnk[0..3]=3FE648EC trn[0..3]=F56E12CB
18:32:21.942 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3237394D50
18:32:21.951 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3237394D5000000000000000 
18:32:21.956 > [ESP32][LFSR] Initializing - Seed: 0x02094BE0 SeedBe: 0xE04B0902 ChaosKey[0..3]: 3FE648EC InitialTap: 0x0029 State: 0x02094BE0
18:32:21.967 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
18:32:21.976 > 3_After_LFSR (32): A81924341C2A5186132681B3CE24DBCB 5639675EC7FA7CFE1EACB93663C22689 
18:32:21.984 > [ESP32][LFSR] Keystream (first 16 bytes): E04B09022C0A02D65C14AC8AFB04889F
18:32:21.990 > [ESP32][4D] LFSR keystream (first 32 bytes): E04B09022C0A02D65C14AC8AFB04889F13693473F5CD45B34EACB93663C22689
18:32:22.001 > [ESP32][TINKERBELL] Input (first 16 bytes): A81924341C2A5186132681B3CE24DBCB Nonce: 0x00000001 Buffer size: 32 bytes
18:32:22.012 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 3FE648EC
18:32:22.020 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A1FA5729870C69A692FA83873BE427B3
18:32:22.029 > 4_After_Tinkerbell (32): 09E3731D9B26382081DC0234F5C0FC78 804B7C5C61729DADBF5A13CBF4CE2051 
18:32:22.037 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A1FA5729870C69A692FA83873BE427B3
18:32:22.046 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A1FA5729870C69A692FA83873BE427B3D6721B02A688E153A1F6AAFD970C06D8
18:32:22.053 > 5_After_Transposition (32): DC8102804B7C2051E30973BF5A139DAD 5C61721D9B263820CBF4CE34F5C0FC78 
18:32:22.062 > [ESP32] === HMAC DEBUG INFO ===
18:32:22.065 > [ESP32] HMAC Key being used: A9D248FABDDA31BE9BB79048DD645EF5EAD96D04FEC7075DB643C95BBCCA09D2
18:32:22.073 > [ESP32] HMAC Input length: 44 bytes
18:32:22.078 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001DC8102804B7C2051E30973BF5A139DAD5C61721D
18:32:22.086 > [ESP32] Nonce: 0x00000001
18:32:22.090 > [ESP32] Packet size before HMAC: 60
18:32:22.092 > [ESP32] Computed HMAC Tag: 5BF5207735C59513FFBBCC4003EF2F9B
18:32:22.098 > [ESP32] === END HMAC DEBUG ===
18:32:22.101 > 6_Final_Packet (60): 810217001700040800000001DC810280 4B7C2051E30973BF5A139DAD5C61721D ...
18:32:22.107 > [RETRY] Attempt 1/3 (nonce: 1)
18:32:22.109 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:22.115 > Sending pipeline data to server (654 bytes)
18:32:22.256 > [HTTP] Response code: 400
18:32:22.256 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:22.261 > [HTTP] Request failed with code: 400
18:32:22.264 > [RETRY] Send failed, waiting 100 ms before retry
18:32:22.364 > [RETRY] Attempt 2/3 (nonce: 1)
18:32:22.364 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:22.369 > Sending pipeline data to server (654 bytes)
18:32:22.504 > [HTTP] Response code: 400
18:32:22.504 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:22.510 > [HTTP] Request failed with code: 400
18:32:22.512 > [RETRY] Send failed, waiting 200 ms before retry
18:32:22.712 > [RETRY] Attempt 3/3 (nonce: 1)
18:32:22.713 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:22.717 > Sending pipeline data to server (654 bytes)
18:32:23.011 > [HTTP] Response code: 400
18:32:23.011 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:23.017 > [HTTP] Request failed with code: 400
18:32:23.019 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:32:23.025 > [RETRY] Consecutive failures: 2
18:32:23.028 > Health data send failed (retry count: 3/3)
18:32:23.030 > Health data transmission failed after max retries
18:32:23.131 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":52555,"type":"health_data_error"}
18:32:23.144 > [WebSocket] Processing message type: health_data_error
18:32:23.149 > [55.2] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:23.185 > ERROR state - attempting recovery
18:32:23.185 > [RETRY] Attempting to send health data (Max retries: 3)
18:32:23.185 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:32:23.185 > Generated health data: HR-60 SPO2-95 STEPS-309
18:32:23.185 > [ESP32] ========================================
18:32:23.185 > [ESP32] ENCRYPTION PIPELINE START
18:32:23.185 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:32:23.189 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:32:23.193 > [ESP32] ========================================
18:32:23.200 > [ESP32] MsgKeys: lfsrSeed=0x02094BE0 tnk[0..3]=3FE648EC trn[0..3]=F56E12CB
18:32:23.206 > 1_After_Salt (25): 48522D36302053504F322D3935205354 4550532D3330394D50
18:32:23.210 > 2_After_Padding (32): 48522D36302053504F322D3935205354 4550532D3330394D5000000000000000 
18:32:23.219 > [ESP32][LFSR] Initializing - Seed: 0x02094BE0 SeedBe: 0xE04B0902 ChaosKey[0..3]: 3FE648EC InitialTap: 0x0029 State: 0x02094BE0
18:32:23.230 > [ESP32][LFSR] Input (first 16 bytes): 48522D36302053504F322D3935205354 Buffer size: 32 bytes
18:32:23.238 > 3_After_LFSR (32): A81924341C2A5186132681B3CE24DBCB 5639675EC6FD7CFE1EACB93663C22689 
18:32:23.247 > [ESP32][LFSR] Keystream (first 16 bytes): E04B09022C0A02D65C14AC8AFB04889F
18:32:23.252 > [ESP32][4D] LFSR keystream (first 32 bytes): E04B09022C0A02D65C14AC8AFB04889F13693473F5CD45B34EACB93663C22689
18:32:23.263 > [ESP32][TINKERBELL] Input (first 16 bytes): A81924341C2A5186132681B3CE24DBCB Nonce: 0x00000001 Buffer size: 32 bytes
18:32:23.272 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 3FE648EC
18:32:23.283 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A1FA5729870C69A692FA83873BE427B3
18:32:23.291 > 4_After_Tinkerbell (32): 09E3731D9B26382081DC0234F5C0FC78 804B7C5C60759DADBF5A13CBF4CE2051 
18:32:23.300 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A1FA5729870C69A692FA83873BE427B3
18:32:23.308 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A1FA5729870C69A692FA83873BE427B3D6721B02A688E153A1F6AAFD970C06D8
18:32:23.316 > 5_After_Transposition (32): DC8102804B7C2051E30973BF5A139DAD 5C60751D9B263820CBF4CE34F5C0FC78 
18:32:23.324 > [ESP32] === HMAC DEBUG INFO ===
18:32:23.328 > [ESP32] HMAC Key being used: A9D248FABDDA31BE9BB79048DD645EF5EAD96D04FEC7075DB643C95BBCCA09D2
18:32:23.336 > [ESP32] HMAC Input length: 44 bytes
18:32:23.338 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001DC8102804B7C2051E30973BF5A139DAD5C60751D
18:32:23.350 > [ESP32] Nonce: 0x00000001
18:32:23.350 > [ESP32] Packet size before HMAC: 60
18:32:23.352 > [ESP32] Computed HMAC Tag: 5A3ECB5D80EF07154CC88DB0A077B114
18:32:23.358 > [ESP32] === END HMAC DEBUG ===
18:32:23.361 > 6_Final_Packet (60): 810217001700040800000001DC810280 4B7C2051E30973BF5A139DAD5C60751D ...
18:32:23.369 > [RETRY] Attempt 1/3 (nonce: 1)
18:32:23.371 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:23.378 > Sending pipeline data to server (654 bytes)
18:32:23.594 > [HTTP] Response code: 400
18:32:23.594 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:23.599 > [HTTP] Request failed with code: 400
18:32:23.602 > [RETRY] Send failed, waiting 100 ms before retry
18:32:23.703 > [RETRY] Attempt 2/3 (nonce: 1)
18:32:23.703 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:23.709 > Sending pipeline data to server (654 bytes)
18:32:24.014 > [HTTP] Response code: 400
18:32:24.015 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:24.020 > [HTTP] Request failed with code: 400
18:32:24.023 > [RETRY] Send failed, waiting 200 ms before retry
18:32:24.225 > [RETRY] Attempt 3/3 (nonce: 1)
18:32:24.226 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:24.231 > Sending pipeline data to server (654 bytes)
18:32:24.519 > [HTTP] Response code: 400
18:32:24.519 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:24.525 > [HTTP] Request failed with code: 400
18:32:24.527 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:32:24.532 > [RETRY] Consecutive failures: 3
18:32:24.535 > ✗ Auto-recovery failed - restarting key exchange
18:32:26.642 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":53055,"type":"health_data_error"}
18:32:26.656 > [WebSocket] Processing message type: health_data_error
18:32:26.661 > [58.7] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:26.670 > ✓ Public key loaded from NVS
18:32:26.767 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":53307,"type":"health_data_error"}
18:32:26.782 > [WebSocket] Processing message type: health_data_error
18:32:26.786 > [58.8] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:26.890 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":53816,"type":"health_data_error"}
18:32:26.905 > [WebSocket] Processing message type: health_data_error
18:32:26.910 > [59.0] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:26.919 > Generating fresh master key from entropy...
18:32:26.928 > Generated master key (32): FE55A76EA182A27F20C24E3F28DCE146 3E442C1DB3977674B450C38B65F467B3 
18:32:26.933 > Using reduced master key (byte % 3) for NTRU encryption only
18:32:26.943 > NTRU encrypted master key (502): 0064005A00410067001700450006006C 00380005001E000C006C006F0021000D ...
18:32:26.952 > POST http://10.249.92.115:8081/master-key
18:32:27.283 > ✓ Master key exchange completed
18:32:27.384 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":54320,"type":"health_data_error"}
18:32:27.398 > [WebSocket] Processing message type: health_data_error
18:32:27.404 > [59.5] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:27.412 > Loading master key from NVS and deriving symmetric keys...
18:32:27.417 > Loaded master key from NVS (32): FE55A76EA182A27F20C24E3F28DCE146 3E442C1DB3977674B450C38B65F467B3 
18:32:27.426 > Derived HMAC key (32): 77D0A70E8FE548AAB4B955AF8D6EEED8 4A427A6C7D42C6EC8704F88D0DE51DEC 
18:32:27.434 > Derived Tinkerbell key (16): 89ED2A5AF5783B7D3BB4BE11AFE6C7EE 
18:32:27.440 > Derived Transposition key (16): D8353F55FCA1B6F460AE6056EABE21E9 
18:32:27.446 > ✓ Symmetric keys derived successfully
18:32:27.448 > Nonce tracker reset - new session started
18:32:27.944 > Waiting for server to process master key...
18:32:27.948 > ✓ Symmetric keys ready - starting health data transmission
18:32:28.050 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":54569,"type":"health_data_error"}
18:32:28.064 > [WebSocket] Processing message type: health_data_error
18:32:28.070 > [60.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:28.173 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":7,"success":false,"timestamp":55076,"type":"health_data_error"}
18:32:28.186 > [WebSocket] Processing message type: health_data_error
18:32:28.192 > [60.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:28.294 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":8,"success":false,"timestamp":55659,"type":"health_data_error"}
18:32:28.309 > [WebSocket] Processing message type: health_data_error
18:32:28.315 > [60.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:28.417 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":8,"success":false,"timestamp":56080,"type":"health_data_error"}
18:32:28.431 > [WebSocket] Processing message type: health_data_error
18:32:28.437 > [60.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:28.539 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Failed to send health data","state":8,"success":false,"timestamp":56584,"type":"health_data_error"}
18:32:28.554 > [WebSocket] Processing message type: health_data_error
18:32:28.560 > [60.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:28.661 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770123747060,"type":"master_key_received"}
18:32:28.676 > [WebSocket] Processing message type: master_key_received
18:32:28.679 > [60.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:28.783 > [WebSocket] Received (174 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":59341,"type":"master_key_exchanged"}
18:32:28.800 > [WebSocket] Processing message type: master_key_exchanged
18:32:28.806 > [60.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:28.906 > [WebSocket] Received (166 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":60009,"type":"symmetric_keys_derived"}
18:32:28.923 > [WebSocket] Processing message type: symmetric_keys_derived
18:32:28.927 > [61.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:29.028 > [61.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:29.128 > [61.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:29.229 > [61.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:29.330 > [61.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:29.431 > [61.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:29.532 > [61.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:29.634 > [61.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:29.734 > [61.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:29.835 > [61.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:29.936 > [62.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:30.038 > [62.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:30.139 > [62.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:30.239 > [62.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:30.340 > [62.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:30.442 > [62.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:30.542 > [62.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:30.643 > [62.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:30.744 > [62.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:30.846 > [62.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:30.947 > [63.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:31.047 > [63.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:31.149 > [63.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:31.249 > [63.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:31.351 > [63.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:31.452 > [63.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:31.552 > [63.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:31.653 > [63.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:31.754 > [63.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:31.855 > [63.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:31.957 > [64.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:32.057 > [64.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:32.158 > [64.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:32.259 > [64.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:32.360 > [64.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:32.461 > [64.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:32.563 > [64.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:32.663 > [64.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:32.765 > [64.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:32.865 > [64.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:32.966 > [65.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:33.068 > [65.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:33.169 > [65.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:33.269 > [65.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:33.371 > [65.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:33.471 > [65.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:33.572 > [65.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:33.673 > [65.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:33.774 > [65.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:33.876 > [65.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:33.976 > [66.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:34.077 > [66.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:34.178 > [66.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:34.279 > [66.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:34.380 > [66.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:34.481 > [66.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:34.581 > [66.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:34.683 > [66.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:34.784 > [66.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:34.885 > [66.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:34.986 > [67.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:35.088 > [67.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:35.188 > [67.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:35.290 > [67.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:35.391 > [67.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:35.491 > [67.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:35.592 > [67.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:35.694 > [67.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:35.794 > [67.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:35.896 > [68.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:35.996 > [68.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:36.098 > [68.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:36.198 > [68.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:36.299 > [68.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:36.400 > [68.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:36.501 > [68.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:36.602 > [68.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:36.703 > [68.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:36.804 > [68.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:36.905 > [69.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:37.006 > [69.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:37.107 > [69.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:37.208 > [69.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:37.309 > [69.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:37.410 > [69.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:37.511 > [69.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:37.612 > [69.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:37.713 > [69.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:37.814 > [69.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:37.915 > [70.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:38.016 > [70.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 1 | WS: CONNECTED
18:32:38.021 > [RETRY] Attempting to send health data (Max retries: 3)
18:32:38.027 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:32:38.033 > Generated health data: HR-61 SPO2-95 STEPS-384
18:32:38.036 > [ESP32] ========================================
18:32:38.041 > [ESP32] ENCRYPTION PIPELINE START
18:32:38.044 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:32:38.053 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:32:38.057 > [ESP32] ========================================
18:32:38.061 > [ESP32] MsgKeys: lfsrSeed=0x3A029FF1 tnk[0..3]=33C9B088 trn[0..3]=1BDAA13A
18:32:38.070 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3338344D50
18:32:38.075 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3338344D5000000000000000 
18:32:38.083 > [ESP32][LFSR] Initializing - Seed: 0x3A029FF1 SeedBe: 0xF19F023A ChaosKey[0..3]: 33C9B088 InitialTap: 0x0029 State: 0x3A029FF1
18:32:38.095 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
18:32:38.103 > 3_After_LFSR (32): B9CD2F0CAFA082A5A3382EB53FF1CF35 976BA60468D9841EBF14E132BA59104C 
18:32:38.108 > [ESP32][LFSR] Keystream (first 16 bytes): F19F023A9E80D1F5EC0A038C0AD19C61
18:32:38.117 > [ESP32][4D] LFSR keystream (first 32 bytes): F19F023A9E80D1F5EC0A038C0AD19C61D23BF5295BE1B053EF14E132BA59104C
18:32:38.125 > [ESP32][TINKERBELL] Input (first 16 bytes): B9CD2F0CAFA082A5A3382EB53FF1CF35 Nonce: 0x00000001 Buffer size: 32 bytes
18:32:38.136 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 33C9B088
18:32:38.147 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 400F7707045E04D095C09386B1F6A862
18:32:38.152 > 4_After_Tinkerbell (32): F9C2580BABFE867536F8BD338E076757 1D7ABE469D73773ADE20F83C51DD9EF8 
18:32:38.161 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 400F7707045E04D095C09386B1F6A862
18:32:38.169 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 400F7707045E04D095C09386B1F6A8628A111842F5AAF3246134190EEB848EB4
18:32:38.181 > 5_After_Transposition (32): F9C258FEAB0B675736F8BD078E33773A 1D7ABE739D469EF8DE20F8DD513C8675 
18:32:38.189 > [ESP32] === HMAC DEBUG INFO ===
18:32:38.192 > [ESP32] HMAC Key being used: 77D0A70E8FE548AAB4B955AF8D6EEED84A427A6C7D42C6EC8704F88D0DE51DEC
18:32:38.200 > [ESP32] HMAC Input length: 44 bytes
18:32:38.202 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001F9C258FEAB0B675736F8BD078E33773A1D7ABE73
18:32:38.211 > [ESP32] Nonce: 0x00000001
18:32:38.214 > [ESP32] Packet size before HMAC: 60
18:32:38.217 > [ESP32] Computed HMAC Tag: EDDAC8495B03C78E3707498BB648489B
18:32:38.222 > [ESP32] === END HMAC DEBUG ===
18:32:38.225 > 6_Final_Packet (60): 810217001700040800000001F9C258FE AB0B675736F8BD078E33773A1D7ABE73 ...
18:32:38.233 > [RETRY] Attempt 1/3 (nonce: 1)
18:32:38.236 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:38.244 > Sending pipeline data to server (654 bytes)
18:32:38.525 > [HTTP] Response code: 200
18:32:38.525 > [HTTP] Response: {"status":"OK:DECRYPTED"}
18:32:38.537 > [RETRY] Health data sent successfully!
18:32:38.538 > ✓ Health data #2 sent successfully
18:32:38.641 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":1,"serverTime":1770123758341,"type":"security_update"}
18:32:38.657 > [WebSocket] Processing message type: security_update
18:32:38.662 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
18:32:38.669 > [70.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:38.773 > [WebSocket] Received (681 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","encData":"ENC_DATA:810217001700040800000001F9C258FEAB0B675736F8BD078E33773A1D7ABE739D469EF8DE20F8DD513C8675EDDAC8495B03C78E3707498BB648489B","pipeline":{"afterLFSR":"B9CD2F0CAFA082A5A3382EB53FF1CF35976BA60468D9841EBF14E132BA59104C","afterSalt":"48522D36312053504F322D39352053544550532D3338344D50","afterTinkerbell":"F9C2580BABFE867536F8BD338E0767571D7ABE469D73773ADE20F83C51DD9EF8","afterTransposition":"F9C258FEAB0B675736F8BD078E33773A1D7ABE739D469EF8DE20F8DD513C8675"},"plaintext":"HR-61 SPO2-95 STEPS-384","serverTime":1770123758341,"timestamp":70307,"type":"encryption_update","ztmEnabled":false}
18:32:38.834 > [WebSocket] Processing message type: encryption_update
18:32:38.840 > [70.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:38.948 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":384,"time":1770123758341,"type":"health_data_update"}
18:32:38.955 > [WebSocket] Processing message type: health_data_update
18:32:38.961 > [71.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:39.069 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2634,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-384","handshakeSuccess":true,"totalTime":0.2634},"type":"session_summary_update"}
18:32:39.092 > [WebSocket] Processing message type: session_summary_update
18:32:39.097 > [71.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:39.203 > [WebSocket] Received (656 bytes): {"decryptionTime":0.2634,"encryptedPacket":"810217001700040800000001F9C258FEAB0B675736F8BD078E33773A1D7ABE739D469EF8DE20F8DD513C8675EDDAC8495B03C78E3707498BB648489B","finalPlaintext":"HR-61 SPO2-95 STEPS-384","healthData":{"heartRate":61,"spo2":95,"steps":384},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D33383400000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3338344D5000000000000000","afterTinkerbell":"B9CD2F0CAFA082A5A3382EB53FF1CF35976BA60468D9841EBF14E132BA59104C","afterTransposition":"F9C2580BABFE867536F8BD338E0767571D7ABE469D73773ADE20F83C51DD9EF8"},"serverTime":1770123758342,"type":"decryption_update"}
18:32:39.261 > [WebSocket] Processing message type: decryption_update
18:32:39.267 > [WebSocket] Server decryption completed
18:32:39.269 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 384
18:32:39.275 > [71.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:39.376 > [WebSocket] Received (693 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","healthSendCount":1,"pipeline":{"afterLFSR":"B9CD2F0CAFA082A5A3382EB53FF1CF35976BA60468D9841EBF14E132BA59104C","afterSalt":"48522D36312053504F322D39352053544550532D3338344D50","afterTinkerbell":"F9C2580BABFE867536F8BD338E0767571D7ABE469D73773ADE20F83C51DD9EF8","afterTransposition":"F9C258FEAB0B675736F8BD078E33773A1D7ABE739D469EF8DE20F8DD513C8675","finalPacket":"810217001700040800000001F9C258FEAB0B675736F8BD078E33773A1D7ABE739D469EF8DE20F8DD513C8675EDDAC8495B03C78E3707498BB648489B"},"plaintext":"HR-61 SPO2-95 STEPS-384","timestamp":70591,"type":"encryption_pipeline","ztmEnabled":false}
18:32:39.438 > [WebSocket] Processing message type: encryption_pipeline
18:32:39.442 > [71.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:39.550 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":1,"message":"Health data #2 sent successfully","state":7,"success":true,"timestamp":70596,"type":"health_data_sent"}
18:32:39.567 > [WebSocket] Processing message type: health_data_sent
18:32:39.570 > [71.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:39.673 > [71.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:39.773 > [71.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:39.874 > [71.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:39.974 > [72.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:40.075 > [72.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:40.177 > [72.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:40.278 > [72.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:40.379 > [72.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:40.480 > [72.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:40.581 > [72.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:40.682 > [72.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:40.783 > [72.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:40.884 > [72.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:40.984 > [73.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:41.087 > [73.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:41.187 > [73.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:41.288 > [73.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:41.389 > [73.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:41.490 > [73.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:41.591 > [73.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:41.692 > [73.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:41.792 > [73.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:41.894 > [74.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:41.995 > [74.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:42.096 > [74.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:42.198 > [74.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:42.298 > [74.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:42.400 > [74.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:42.500 > [74.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:42.602 > [74.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:42.702 > [74.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:42.803 > [74.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:42.904 > [75.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:43.005 > [75.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:43.106 > [75.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:43.207 > [75.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:43.307 > [75.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:43.409 > [75.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:43.510 > [75.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:43.611 > [75.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:43.712 > [75.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:43.813 > [75.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:43.914 > [76.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:44.015 > [76.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:44.115 > [76.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:44.217 > [76.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:44.319 > [76.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:44.419 > [76.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:44.520 > [76.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:44.621 > [76.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:44.722 > [76.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:44.823 > [76.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:44.923 > [77.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:45.024 > [77.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:45.126 > [77.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:45.226 > [77.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:45.328 > [77.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:45.429 > [77.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:45.530 > [77.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:45.631 > [77.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:45.732 > [77.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:45.833 > [77.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:45.934 > [78.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:46.035 > [78.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:46.137 > [78.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:46.237 > [78.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:46.338 > [78.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:46.439 > [78.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:46.540 > [78.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:46.641 > [78.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:46.743 > [78.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:46.843 > [78.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:46.944 > [79.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:47.045 > [79.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:47.146 > [79.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:47.248 > [79.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:47.347 > [79.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:47.448 > [79.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:47.550 > [79.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:47.652 > [79.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:47.752 > [79.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:47.853 > [79.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:47.954 > [80.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:48.055 > [80.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:48.155 > [80.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:48.257 > [80.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:48.357 > [80.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:48.458 > [80.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:48.559 > [80.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 2 | WS: CONNECTED
18:32:48.565 > [RETRY] Attempting to send health data (Max retries: 3)
18:32:48.570 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:32:48.576 > Generated health data: HR-61 SPO2-95 STEPS-446
18:32:48.579 > [ESP32] ========================================
18:32:48.585 > [ESP32] ENCRYPTION PIPELINE START
18:32:48.588 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:32:48.596 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:32:48.602 > [ESP32] ========================================
18:32:48.605 > [ESP32] MsgKeys: lfsrSeed=0x90162C34 tnk[0..3]=DD4E1C2E trn[0..3]=DB13983D
18:32:48.613 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3434364D50
18:32:48.619 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3434364D5000000000000000 
18:32:48.627 > [ESP32][LFSR] Initializing - Seed: 0x90162C34 SeedBe: 0x342C1690 ChaosKey[0..3]: DD4E1C2E InitialTap: 0x0029 State: 0x90162C34
18:32:48.638 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
18:32:48.646 > 3_After_LFSR (32): 7C7E3BA6C45700D1F4F8E3BC8E1121A8 65E6CB3E1A81331CD72AE46DB14CD4D7 
18:32:48.652 > [ESP32][LFSR] Keystream (first 16 bytes): 342C1690F5775381BBCACE85BB3172FC
18:32:48.661 > [ESP32][4D] LFSR keystream (first 32 bytes): 342C1690F5775381BBCACE85BB3172FC20B698132EB50551872AE46DB14CD4D7
18:32:48.669 > [ESP32][TINKERBELL] Input (first 16 bytes): 7C7E3BA6C45700D1F4F8E3BC8E1121A8 Nonce: 0x00000002 Buffer size: 32 bytes
18:32:48.680 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: DD4E1C2E
18:32:48.691 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): AB12623C59E55BC4D755CF3B90E67327
18:32:48.697 > 4_After_Tinkerbell (32): D76C599A9DB25B1523AD2C871EF7528F 5D559990B794D9D1DA12BC64B722DFFA 
18:32:48.705 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): AB12623C59E55BC4D755CF3B90E67327
18:32:48.713 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): AB12623C59E55BC4D755CF3B90E6732738B352AEAD15EACD0D385809066E0B2D
18:32:48.724 > 5_After_Transposition (32): DABC12645B159DB25D995590528F1EF7 232CAD87D9D1B794D7596C9ADFFAB722 
18:32:48.733 > [ESP32] === HMAC DEBUG INFO ===
18:32:48.736 > [ESP32] HMAC Key being used: 77D0A70E8FE548AAB4B955AF8D6EEED84A427A6C7D42C6EC8704F88D0DE51DEC
18:32:48.744 > [ESP32] HMAC Input length: 44 bytes
18:32:48.746 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000002DABC12645B159DB25D995590528F1EF7232CAD87
18:32:48.755 > [ESP32] Nonce: 0x00000002
18:32:48.758 > [ESP32] Packet size before HMAC: 60
18:32:48.761 > [ESP32] Computed HMAC Tag: B0D6E21347E570099DEC0D9FBCA9A5F2
18:32:48.766 > [ESP32] === END HMAC DEBUG ===
18:32:48.769 > 6_Final_Packet (60): 810217001700040800000002DABC1264 5B159DB25D995590528F1EF7232CAD87 ...
18:32:48.777 > [RETRY] Attempt 1/3 (nonce: 2)
18:32:48.780 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:48.786 > Sending pipeline data to server (654 bytes)
18:32:49.038 > [HTTP] Response code: 200
18:32:49.038 > [HTTP] Response: {"status":"OK:DECRYPTED"}
18:32:49.049 > [RETRY] Health data sent successfully!
18:32:49.052 > ✓ Health data #3 sent successfully
18:32:49.154 > [WebSocket] Received (681 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","encData":"ENC_DATA:810217001700040800000002DABC12645B159DB25D995590528F1EF7232CAD87D9D1B794D7596C9ADFFAB722B0D6E21347E570099DEC0D9FBCA9A5F2","pipeline":{"afterLFSR":"7C7E3BA6C45700D1F4F8E3BC8E1121A865E6CB3E1A81331CD72AE46DB14CD4D7","afterSalt":"48522D36312053504F322D39352053544550532D3434364D50","afterTinkerbell":"D76C599A9DB25B1523AD2C871EF7528F5D559990B794D9D1DA12BC64B722DFFA","afterTransposition":"DABC12645B159DB25D995590528F1EF7232CAD87D9D1B794D7596C9ADFFAB722"},"plaintext":"HR-61 SPO2-95 STEPS-446","serverTime":1770123768860,"timestamp":80851,"type":"encryption_update","ztmEnabled":false}
18:32:49.215 > [WebSocket] Processing message type: encryption_update
18:32:49.221 > [81.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:49.329 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":446,"time":1770123768860,"type":"health_data_update"}
18:32:49.337 > [WebSocket] Processing message type: health_data_update
18:32:49.343 > [81.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:49.452 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2384,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-446","handshakeSuccess":true,"totalTime":0.2384},"type":"session_summary_update"}
18:32:49.474 > [WebSocket] Processing message type: session_summary_update
18:32:49.479 > [81.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:49.585 > [WebSocket] Received (656 bytes): {"decryptionTime":0.2384,"encryptedPacket":"810217001700040800000002DABC12645B159DB25D995590528F1EF7232CAD87D9D1B794D7596C9ADFFAB722B0D6E21347E570099DEC0D9FBCA9A5F2","finalPlaintext":"HR-61 SPO2-95 STEPS-446","healthData":{"heartRate":61,"spo2":95,"steps":446},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D34343600000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3434364D5000000000000000","afterTinkerbell":"7C7E3BA6C45700D1F4F8E3BC8E1121A865E6CB3E1A81331CD72AE46DB14CD4D7","afterTransposition":"D76C599A9DB25B1523AD2C871EF7528F5D559990B794D9D1DA12BC64B722DFFA"},"serverTime":1770123768861,"type":"decryption_update"}
18:32:49.643 > [WebSocket] Processing message type: decryption_update
18:32:49.648 > [WebSocket] Server decryption completed
18:32:49.652 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 446
18:32:49.657 > [81.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:49.759 > [WebSocket] Received (693 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","healthSendCount":2,"pipeline":{"afterLFSR":"7C7E3BA6C45700D1F4F8E3BC8E1121A865E6CB3E1A81331CD72AE46DB14CD4D7","afterSalt":"48522D36312053504F322D39352053544550532D3434364D50","afterTinkerbell":"D76C599A9DB25B1523AD2C871EF7528F5D559990B794D9D1DA12BC64B722DFFA","afterTransposition":"DABC12645B159DB25D995590528F1EF7232CAD87D9D1B794D7596C9ADFFAB722","finalPacket":"810217001700040800000002DABC12645B159DB25D995590528F1EF7232CAD87D9D1B794D7596C9ADFFAB722B0D6E21347E570099DEC0D9FBCA9A5F2"},"plaintext":"HR-61 SPO2-95 STEPS-446","timestamp":81103,"type":"encryption_pipeline","ztmEnabled":false}
18:32:49.820 > [WebSocket] Processing message type: encryption_pipeline
18:32:49.824 > [81.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:49.932 > [WebSocket] Received (157 bytes): {"deviceId":"f9641d44","healthSendCount":2,"message":"Health data #3 sent successfully","state":7,"success":true,"timestamp":81108,"type":"health_data_sent"}
18:32:49.948 > [WebSocket] Processing message type: health_data_sent
18:32:49.952 > [82.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:50.054 > [82.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:50.155 > [82.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:50.256 > [82.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:50.357 > [82.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:50.457 > [82.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:50.558 > [82.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:50.660 > [82.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:50.761 > [82.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:50.862 > [82.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:50.963 > [83.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:51.064 > [83.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:51.165 > [83.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:51.265 > [83.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:51.366 > [83.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:51.468 > [83.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:51.569 > [83.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:51.670 > [83.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:51.770 > [83.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:51.872 > [83.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:51.973 > [84.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:52.074 > [84.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:52.175 > [84.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:52.276 > [84.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:52.377 > [84.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:52.478 > [84.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:52.579 > [84.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:52.680 > [84.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:52.781 > [84.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:52.881 > [84.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:52.983 > [85.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:53.084 > [85.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:53.184 > [85.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:53.285 > [85.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:53.386 > [85.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:53.488 > [85.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:53.589 > [85.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:53.690 > [85.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:53.791 > [85.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:53.892 > [86.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:53.993 > [86.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:54.094 > [86.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:54.195 > [86.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:54.296 > [86.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:54.397 > [86.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:54.498 > [86.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:54.599 > [86.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:54.700 > [86.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:54.800 > [86.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:54.902 > [87.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:55.003 > [87.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:55.104 > [87.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:55.205 > [87.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:55.305 > [87.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:55.406 > [87.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:55.508 > [87.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:55.609 > [87.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:55.709 > [87.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:55.810 > [87.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:55.911 > [88.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:56.013 > [88.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:56.114 > [88.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:56.214 > [88.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:56.316 > [88.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:56.416 > [88.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:56.517 > [88.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:56.619 > [88.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:56.720 > [88.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:56.821 > [88.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:56.921 > [89.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:57.022 > [89.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:57.123 > [89.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:57.225 > [89.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:57.326 > [89.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:57.426 > [89.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:57.528 > [89.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:57.629 > [89.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:57.730 > [89.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:57.830 > [89.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:57.931 > [90.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:58.033 > [90.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:58.133 > [90.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:58.235 > [90.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:58.335 > [90.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:58.437 > [90.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:58.538 > [90.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:58.639 > [90.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:58.740 > [90.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:58.841 > [90.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:58.942 > [91.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:59.043 > [91.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:59.144 > [91.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:32:59.149 > [RETRY] Attempting to send health data (Max retries: 3)
18:32:59.155 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
18:32:59.160 > Generated health data: HR-61 SPO2-95 STEPS-472
18:32:59.164 > [ESP32] ========================================
18:32:59.169 > [ESP32] ENCRYPTION PIPELINE START
18:32:59.172 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:32:59.180 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:32:59.186 > [ESP32] ========================================
18:32:59.189 > [ESP32] MsgKeys: lfsrSeed=0xCBDF1788 tnk[0..3]=E6898F4F trn[0..3]=E0183EA5
18:32:59.197 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3437324D50
18:32:59.202 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3437324D5000000000000000 
18:32:59.211 > [ESP32][LFSR] Initializing - Seed: 0xCBDF1788 SeedBe: 0x8817DFCB ChaosKey[0..3]: E6898F4F InitialTap: 0x0029 State: 0xCBDF1788
18:32:59.222 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
18:32:59.230 > 3_After_LFSR (32): C045F2FD6694C1A684B35FDBE4088333 231F681D96A38FB757A9271E6FA1B400 
18:32:59.236 > [ESP32][LFSR] Keystream (first 16 bytes): 8817DFCB57B492F6CB8172E2D128D067
18:32:59.244 > [ESP32][4D] LFSR keystream (first 32 bytes): 8817DFCB57B492F6CB8172E2D128D067664F3B30A294BDFA07A9271E6FA1B400
18:32:59.253 > [ESP32][TINKERBELL] Input (first 16 bytes): C045F2FD6694C1A684B35FDBE4088333 Nonce: 0x00000003 Buffer size: 32 bytes
18:32:59.263 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: E6898F4F
18:32:59.274 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E0BAC334DA0756C5AF5C5FD57BFC6E2C
18:32:59.280 > 4_After_Tinkerbell (32): 20FF31C9BC9397632BEF000E9FF4ED1F 41865B82421D6B1419B79CBC8A4DFE9A 
18:32:59.288 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E0BAC334DA0756C5AF5C5FD57BFC6E2C
18:32:59.297 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E0BAC334DA0756C5AF5C5FD57BFC6E2C6299339FD4BEE4A34E1EBBA2E5EC4A9A
18:32:59.308 > 5_After_Transposition (32): 93BCFEBC9F0063ED411D6B42B78A8697 2B19FF14821FEF0E314D20C95BF49C9A 
18:32:59.316 > [ESP32] === HMAC DEBUG INFO ===
18:32:59.319 > [ESP32] HMAC Key being used: 77D0A70E8FE548AAB4B955AF8D6EEED84A427A6C7D42C6EC8704F88D0DE51DEC
18:32:59.327 > [ESP32] HMAC Input length: 44 bytes
18:32:59.330 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000393BCFEBC9F0063ED411D6B42B78A86972B19FF14
18:32:59.339 > [ESP32] Nonce: 0x00000003
18:32:59.341 > [ESP32] Packet size before HMAC: 60
18:32:59.344 > [ESP32] Computed HMAC Tag: B3A80BDD7895C9F6C8BEA564A52D004E
18:32:59.349 > [ESP32] === END HMAC DEBUG ===
18:32:59.352 > 6_Final_Packet (60): 81021700170004080000000393BCFEBC 9F0063ED411D6B42B78A86972B19FF14 ...
18:32:59.361 > [RETRY] Attempt 1/3 (nonce: 3)
18:32:59.364 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:59.368 > Sending pipeline data to server (654 bytes)
18:32:59.553 > [HTTP] Response code: 400
18:32:59.553 > [HTTP] Error response: {"error":"Decryption failed"}
18:32:59.559 > [HTTP] Request failed with code: 400
18:32:59.562 > [RETRY] Send failed, waiting 100 ms before retry
18:32:59.661 > [RETRY] Attempt 2/3 (nonce: 3)
18:32:59.661 > POST http://10.249.92.115:8081/health-data with pipeline data
18:32:59.666 > Sending pipeline data to server (654 bytes)
18:33:00.046 > [HTTP] Response code: 400
18:33:00.046 > [HTTP] Error response: {"error":"Decryption failed"}
18:33:00.052 > [HTTP] Request failed with code: 400
18:33:00.054 > [RETRY] Send failed, waiting 200 ms before retry
18:33:00.254 > [RETRY] Attempt 3/3 (nonce: 3)
18:33:00.254 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:00.260 > Sending pipeline data to server (654 bytes)
18:33:00.556 > [HTTP] Response code: 400
18:33:00.557 > [HTTP] Error response: {"error":"Decryption failed"}
18:33:00.562 > [HTTP] Request failed with code: 400
18:33:00.565 > [RETRY] All retry attempts failed - rolled back nonce to 2
18:33:00.571 > [RETRY] Consecutive failures: 1
18:33:00.573 > Health data send failed (retry count: 1/3)
18:33:00.678 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Failed to send health data","state":7,"success":false,"timestamp":91619,"type":"health_data_error"}
18:33:00.693 > [WebSocket] Processing message type: health_data_error
18:33:00.698 > [92.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:00.707 > [RETRY] Attempting to send health data (Max retries: 3)
18:33:00.712 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
18:33:00.717 > Generated health data: HR-61 SPO2-95 STEPS-460
18:33:00.721 > [ESP32] ========================================
18:33:00.726 > [ESP32] ENCRYPTION PIPELINE START
18:33:00.729 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:33:00.734 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:33:00.743 > [ESP32] ========================================
18:33:00.745 > [ESP32] MsgKeys: lfsrSeed=0xCBDF1788 tnk[0..3]=E6898F4F trn[0..3]=E0183EA5
18:33:00.751 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3436304D50
18:33:00.759 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3436304D5000000000000000 
18:33:00.764 > [ESP32][LFSR] Initializing - Seed: 0xCBDF1788 SeedBe: 0x8817DFCB ChaosKey[0..3]: E6898F4F InitialTap: 0x0029 State: 0xCBDF1788
18:33:00.775 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
18:33:00.784 > 3_After_LFSR (32): C045F2FD6694C1A684B35FDBE4088333 231F681D96A28DB757A9271E6FA1B400 
18:33:00.792 > [ESP32][LFSR] Keystream (first 16 bytes): 8817DFCB57B492F6CB8172E2D128D067
18:33:00.798 > [ESP32][4D] LFSR keystream (first 32 bytes): 8817DFCB57B492F6CB8172E2D128D067664F3B30A294BDFA07A9271E6FA1B400
18:33:00.809 > [ESP32][TINKERBELL] Input (first 16 bytes): C045F2FD6694C1A684B35FDBE4088333 Nonce: 0x00000003 Buffer size: 32 bytes
18:33:00.820 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: E6898F4F
18:33:00.829 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E0BAC334DA0756C5AF5C5FD57BFC6E2C
18:33:00.837 > 4_After_Tinkerbell (32): 20FF31C9BC9397632BEF000E9FF4ED1F 41865B82421C691419B79CBC8A4DFE9A 
18:33:00.845 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E0BAC334DA0756C5AF5C5FD57BFC6E2C
18:33:00.853 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E0BAC334DA0756C5AF5C5FD57BFC6E2C6299339FD4BEE4A34E1EBBA2E5EC4A9A
18:33:00.862 > 5_After_Transposition (32): 93BCFEBC9F0063ED411C6942B78A8697 2B19FF14821FEF0E314D20C95BF49C9A 
18:33:00.871 > [ESP32] === HMAC DEBUG INFO ===
18:33:00.873 > [ESP32] HMAC Key being used: 77D0A70E8FE548AAB4B955AF8D6EEED84A427A6C7D42C6EC8704F88D0DE51DEC
18:33:00.881 > [ESP32] HMAC Input length: 44 bytes
18:33:00.887 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000393BCFEBC9F0063ED411C6942B78A86972B19FF14
18:33:00.895 > [ESP32] Nonce: 0x00000003
18:33:00.898 > [ESP32] Packet size before HMAC: 60
18:33:00.901 > [ESP32] Computed HMAC Tag: ED4FB8832601F8A9714B55C38317CB5B
18:33:00.907 > [ESP32] === END HMAC DEBUG ===
18:33:00.909 > 6_Final_Packet (60): 81021700170004080000000393BCFEBC 9F0063ED411C6942B78A86972B19FF14 ...
18:33:00.914 > [RETRY] Attempt 1/3 (nonce: 3)
18:33:00.918 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:00.923 > Sending pipeline data to server (654 bytes)
18:33:01.048 > [HTTP] Response code: 400
18:33:01.048 > [HTTP] Error response: {"error":"Decryption failed"}
18:33:01.053 > [HTTP] Request failed with code: 400
18:33:01.056 > [RETRY] Send failed, waiting 100 ms before retry
18:33:01.156 > [RETRY] Attempt 2/3 (nonce: 3)
18:33:01.157 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:01.167 > Sending pipeline data to server (654 bytes)
18:33:01.300 > [HTTP] Response code: 400
18:33:01.300 > [HTTP] Error response: {"error":"Decryption failed"}
18:33:01.306 > [HTTP] Request failed with code: 400
18:33:01.308 > [RETRY] Send failed, waiting 200 ms before retry
18:33:01.508 > [RETRY] Attempt 3/3 (nonce: 3)
18:33:01.508 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:01.514 > Sending pipeline data to server (654 bytes)
18:33:01.816 > [HTTP] Response code: 400
18:33:01.816 > [HTTP] Error response: {"error":"Decryption failed"}
18:33:01.822 > [HTTP] Request failed with code: 400
18:33:01.825 > [RETRY] All retry attempts failed - rolled back nonce to 2
18:33:01.830 > [RETRY] Consecutive failures: 2
18:33:01.833 > Health data send failed (retry count: 2/3)
18:33:01.936 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Failed to send health data","state":7,"success":false,"timestamp":92112,"type":"health_data_error"}
18:33:01.951 > [WebSocket] Processing message type: health_data_error
18:33:01.956 > [94.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:01.964 > [RETRY] Attempting to send health data (Max retries: 3)
18:33:01.970 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
18:33:01.975 > Generated health data: HR-61 SPO2-95 STEPS-497
18:33:01.979 > [ESP32] ========================================
18:33:01.984 > [ESP32] ENCRYPTION PIPELINE START
18:33:01.987 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:33:01.992 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:33:02.000 > [ESP32] ========================================
18:33:02.004 > [ESP32] MsgKeys: lfsrSeed=0xCBDF1788 tnk[0..3]=E6898F4F trn[0..3]=E0183EA5
18:33:02.009 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3439374D50
18:33:02.018 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3439374D5000000000000000 
18:33:02.023 > [ESP32][LFSR] Initializing - Seed: 0xCBDF1788 SeedBe: 0x8817DFCB ChaosKey[0..3]: E6898F4F InitialTap: 0x0029 State: 0xCBDF1788
18:33:02.034 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
18:33:02.043 > 3_After_LFSR (32): C045F2FD6694C1A684B35FDBE4088333 231F681D96AD8AB757A9271E6FA1B400 
18:33:02.051 > [ESP32][LFSR] Keystream (first 16 bytes): 8817DFCB57B492F6CB8172E2D128D067
18:33:02.056 > [ESP32][4D] LFSR keystream (first 32 bytes): 8817DFCB57B492F6CB8172E2D128D067664F3B30A294BDFA07A9271E6FA1B400
18:33:02.067 > [ESP32][TINKERBELL] Input (first 16 bytes): C045F2FD6694C1A684B35FDBE4088333 Nonce: 0x00000003 Buffer size: 32 bytes
18:33:02.079 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: E6898F4F
18:33:02.087 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E0BAC334DA0756C5AF5C5FD57BFC6E2C
18:33:02.095 > 4_After_Tinkerbell (32): 20FF31C9BC9397632BEF000E9FF4ED1F 41865B8242136E1419B79CBC8A4DFE9A 
18:33:02.104 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E0BAC334DA0756C5AF5C5FD57BFC6E2C
18:33:02.112 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E0BAC334DA0756C5AF5C5FD57BFC6E2C6299339FD4BEE4A34E1EBBA2E5EC4A9A
18:33:02.120 > 5_After_Transposition (32): 93BCFEBC9F0063ED41136E42B78A8697 2B19FF14821FEF0E314D20C95BF49C9A 
18:33:02.129 > [ESP32] === HMAC DEBUG INFO ===
18:33:02.131 > [ESP32] HMAC Key being used: 77D0A70E8FE548AAB4B955AF8D6EEED84A427A6C7D42C6EC8704F88D0DE51DEC
18:33:02.140 > [ESP32] HMAC Input length: 44 bytes
18:33:02.145 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000393BCFEBC9F0063ED41136E42B78A86972B19FF14
18:33:02.154 > [ESP32] Nonce: 0x00000003
18:33:02.157 > [ESP32] Packet size before HMAC: 60
18:33:02.159 > [ESP32] Computed HMAC Tag: 1941158542CFCF6A4373A13E501E4123
18:33:02.165 > [ESP32] === END HMAC DEBUG ===
18:33:02.167 > 6_Final_Packet (60): 81021700170004080000000393BCFEBC 9F0063ED41136E42B78A86972B19FF14 ...
18:33:02.173 > [RETRY] Attempt 1/3 (nonce: 3)
18:33:02.176 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:02.181 > Sending pipeline data to server (654 bytes)
18:33:02.310 > [HTTP] Response code: 400
18:33:02.310 > [HTTP] Error response: {"error":"Decryption failed"}
18:33:02.315 > [HTTP] Request failed with code: 400
18:33:02.319 > [RETRY] Send failed, waiting 100 ms before retry
18:33:02.421 > [RETRY] Attempt 2/3 (nonce: 3)
18:33:02.422 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:02.427 > Sending pipeline data to server (654 bytes)
18:33:02.812 > [HTTP] Response code: 400
18:33:02.812 > [HTTP] Error response: {"error":"Decryption failed"}
18:33:02.818 > [HTTP] Request failed with code: 400
18:33:02.821 > [RETRY] Send failed, waiting 200 ms before retry
18:33:03.020 > [RETRY] Attempt 3/3 (nonce: 3)
18:33:03.021 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:03.026 > Sending pipeline data to server (654 bytes)
18:33:03.338 > [HTTP] Response code: 400
18:33:03.338 > [HTTP] Error response: {"error":"Decryption failed"}
18:33:03.344 > [HTTP] Request failed with code: 400
18:33:03.346 > [RETRY] All retry attempts failed - rolled back nonce to 2
18:33:03.352 > [RETRY] Consecutive failures: 3
18:33:03.354 > Health data send failed (retry count: 3/3)
18:33:03.357 > Health data transmission failed after max retries
18:33:03.460 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Failed to send health data","state":7,"success":false,"timestamp":92623,"type":"health_data_error"}
18:33:03.474 > [WebSocket] Processing message type: health_data_error
18:33:03.479 > [95.5] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:03.488 > ERROR state - attempting recovery
18:33:03.491 > [RETRY] Attempting to send health data (Max retries: 3)
18:33:03.495 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
18:33:03.498 > Generated health data: HR-61 SPO2-95 STEPS-510
18:33:03.504 > [ESP32] ========================================
18:33:03.507 > [ESP32] ENCRYPTION PIPELINE START
18:33:03.510 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:33:03.518 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:33:03.523 > [ESP32] ========================================
18:33:03.529 > [ESP32] MsgKeys: lfsrSeed=0xCBDF1788 tnk[0..3]=E6898F4F trn[0..3]=E0183EA5
18:33:03.535 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3531304D50
18:33:03.541 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3531304D5000000000000000 
18:33:03.548 > [ESP32][LFSR] Initializing - Seed: 0xCBDF1788 SeedBe: 0x8817DFCB ChaosKey[0..3]: E6898F4F InitialTap: 0x0029 State: 0xCBDF1788
18:33:03.560 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
18:33:03.569 > 3_After_LFSR (32): C045F2FD6694C1A684B35FDBE4088333 231F681D97A58DB757A9271E6FA1B400 
18:33:03.577 > [ESP32][LFSR] Keystream (first 16 bytes): 8817DFCB57B492F6CB8172E2D128D067
18:33:03.582 > [ESP32][4D] LFSR keystream (first 32 bytes): 8817DFCB57B492F6CB8172E2D128D067664F3B30A294BDFA07A9271E6FA1B400
18:33:03.593 > [ESP32][TINKERBELL] Input (first 16 bytes): C045F2FD6694C1A684B35FDBE4088333 Nonce: 0x00000003 Buffer size: 32 bytes
18:33:03.602 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: E6898F4F
18:33:03.613 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E0BAC334DA0756C5AF5C5FD57BFC6E2C
18:33:03.621 > 4_After_Tinkerbell (32): 20FF31C9BC9397632BEF000E9FF4ED1F 41865B82431B691419B79CBC8A4DFE9A 
18:33:03.629 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E0BAC334DA0756C5AF5C5FD57BFC6E2C
18:33:03.638 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E0BAC334DA0756C5AF5C5FD57BFC6E2C6299339FD4BEE4A34E1EBBA2E5EC4A9A
18:33:03.646 > 5_After_Transposition (32): 93BCFEBC9F0063ED411B6943B78A8697 2B19FF14821FEF0E314D20C95BF49C9A 
18:33:03.654 > [ESP32] === HMAC DEBUG INFO ===
18:33:03.656 > [ESP32] HMAC Key being used: 77D0A70E8FE548AAB4B955AF8D6EEED84A427A6C7D42C6EC8704F88D0DE51DEC
18:33:03.666 > [ESP32] HMAC Input length: 44 bytes
18:33:03.668 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000393BCFEBC9F0063ED411B6943B78A86972B19FF14
18:33:03.680 > [ESP32] Nonce: 0x00000003
18:33:03.680 > [ESP32] Packet size before HMAC: 60
18:33:03.682 > [ESP32] Computed HMAC Tag: B612829D7491A20EC41D6C429EDAAB45
18:33:03.688 > [ESP32] === END HMAC DEBUG ===
18:33:03.691 > 6_Final_Packet (60): 81021700170004080000000393BCFEBC 9F0063ED411B6943B78A86972B19FF14 ...
18:33:03.698 > [RETRY] Attempt 1/3 (nonce: 3)
18:33:03.702 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:03.708 > Sending pipeline data to server (654 bytes)
18:33:04.049 > [HTTP] Response code: 400
18:33:04.049 > [HTTP] Error response: {"error":"Decryption failed"}
18:33:04.054 > [HTTP] Request failed with code: 400
18:33:04.057 > [RETRY] Send failed, waiting 100 ms before retry
18:33:04.157 > [RETRY] Attempt 2/3 (nonce: 3)
18:33:04.157 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:04.163 > Sending pipeline data to server (654 bytes)
18:33:04.570 > [HTTP] Response code: 400
18:33:04.570 > [HTTP] Error response: {"error":"Decryption failed"}
18:33:04.575 > [HTTP] Request failed with code: 400
18:33:04.578 > [RETRY] Send failed, waiting 200 ms before retry
18:33:04.777 > [RETRY] Attempt 3/3 (nonce: 3)
18:33:04.777 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:04.783 > Sending pipeline data to server (654 bytes)
18:33:05.118 > [HTTP] Response code: 400
18:33:05.118 > [HTTP] Error response: {"error":"Decryption failed"}
18:33:05.123 > [HTTP] Request failed with code: 400
18:33:05.126 > [RETRY] All retry attempts failed - rolled back nonce to 2
18:33:05.131 > [RETRY] Consecutive failures: 4
18:33:05.134 > ✗ Auto-recovery failed - restarting key exchange
18:33:07.237 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Failed to send health data","state":7,"success":false,"timestamp":93114,"type":"health_data_error"}
18:33:07.250 > [WebSocket] Processing message type: health_data_error
18:33:07.256 > [99.3] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:07.264 > ✓ Public key loaded from NVS
18:33:07.363 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Failed to send health data","state":7,"success":false,"timestamp":93366,"type":"health_data_error"}
18:33:07.377 > [WebSocket] Processing message type: health_data_error
18:33:07.382 > [99.4] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:07.485 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Failed to send health data","state":7,"success":false,"timestamp":93883,"type":"health_data_error"}
18:33:07.500 > [WebSocket] Processing message type: health_data_error
18:33:07.505 > [99.6] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:07.513 > Generating fresh master key from entropy...
18:33:07.522 > Generated master key (32): 741FA6ADE23FB711ACB1BFE0E4AA13A5 03A23CB49E83A85EA91C26D064DFB752 
18:33:07.527 > Using reduced master key (byte % 3) for NTRU encryption only
18:33:07.538 > NTRU encrypted master key (502): 0064005A00400067001600440006006D 003700030020000E006B00700022000C ...
18:33:07.546 > POST http://10.249.92.115:8081/master-key
18:33:07.834 > ✓ Master key exchange completed
18:33:07.935 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Failed to send health data","state":7,"success":false,"timestamp":94377,"type":"health_data_error"}
18:33:07.948 > [WebSocket] Processing message type: health_data_error
18:33:07.955 > [100.0] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:07.963 > Loading master key from NVS and deriving symmetric keys...
18:33:07.969 > Loaded master key from NVS (32): 741FA6ADE23FB711ACB1BFE0E4AA13A5 03A23CB49E83A85EA91C26D064DFB752 
18:33:07.977 > Derived HMAC key (32): B7C0DDCA1011A83BB679FA587D344B41 BC3D4F8849B71F533ECE08EE044BB4A1 
18:33:07.985 > Derived Tinkerbell key (16): 4ACDF978B91983923DE6905523666C82 
18:33:07.991 > Derived Transposition key (16): E61439EF81D43F1A4DFEFBCBBD6F432B 
18:33:07.996 > ✓ Symmetric keys derived successfully
18:33:07.998 > Nonce tracker reset - new session started
18:33:08.495 > Waiting for server to process master key...
18:33:08.499 > ✓ Symmetric keys ready - starting health data transmission
18:33:08.601 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Failed to send health data","state":7,"success":false,"timestamp":94879,"type":"health_data_error"}
18:33:08.615 > [WebSocket] Processing message type: health_data_error
18:33:08.620 > [100.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:08.723 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Failed to send health data","state":7,"success":false,"timestamp":95404,"type":"health_data_error"}
18:33:08.738 > [WebSocket] Processing message type: health_data_error
18:33:08.743 > [100.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:08.846 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Failed to send health data","state":8,"success":false,"timestamp":96115,"type":"health_data_error"}
18:33:08.859 > [WebSocket] Processing message type: health_data_error
18:33:08.865 > [100.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:08.971 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Failed to send health data","state":8,"success":false,"timestamp":96637,"type":"health_data_error"}
18:33:08.985 > [WebSocket] Processing message type: health_data_error
18:33:08.991 > [101.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:09.094 > [WebSocket] Received (153 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Failed to send health data","state":8,"success":false,"timestamp":97184,"type":"health_data_error"}
18:33:09.107 > [WebSocket] Processing message type: health_data_error
18:33:09.113 > [101.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:09.216 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770123787663,"type":"master_key_received"}
18:33:09.229 > [WebSocket] Processing message type: master_key_received
18:33:09.232 > [101.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:09.338 > [WebSocket] Received (174 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":99893,"type":"master_key_exchanged"}
18:33:09.354 > [WebSocket] Processing message type: master_key_exchanged
18:33:09.360 > [101.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:09.459 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":100561,"type":"symmetric_keys_derived"}
18:33:09.476 > [WebSocket] Processing message type: symmetric_keys_derived
18:33:09.481 > [101.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:09.581 > [101.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:09.682 > [101.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:09.783 > [101.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:09.884 > [101.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:09.986 > [102.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:10.086 > [102.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:10.188 > [102.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:10.288 > [102.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:10.390 > [102.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:10.491 > [102.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:10.592 > [102.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:10.692 > [102.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:10.794 > [102.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:10.894 > [103.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:10.996 > [103.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:11.096 > [103.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:11.197 > [103.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:11.298 > [103.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:11.400 > [103.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:11.500 > [103.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:11.601 > [103.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:11.702 > [103.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:11.803 > [103.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:11.904 > [104.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:12.004 > [104.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:12.106 > [104.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:12.207 > [104.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:12.308 > [104.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:12.409 > [104.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:12.510 > [104.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:12.611 > [104.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:12.712 > [104.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:12.813 > [104.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:12.914 > [105.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:13.015 > [105.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:13.116 > [105.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:13.217 > [105.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:13.318 > [105.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:13.419 > [105.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:13.520 > [105.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:13.621 > [105.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:13.722 > [105.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:13.823 > [105.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:13.924 > [106.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:14.025 > [106.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:14.126 > [106.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:14.227 > [106.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:14.328 > [106.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:14.429 > [106.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:14.530 > [106.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:14.631 > [106.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:14.732 > [106.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:14.833 > [106.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:14.934 > [107.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:15.035 > [107.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:15.135 > [107.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:15.236 > [107.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:15.338 > [107.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:15.439 > [107.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:15.540 > [107.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:15.641 > [107.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:15.742 > [107.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:15.843 > [107.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:15.944 > [108.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:16.045 > [108.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:16.146 > [108.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:16.247 > [108.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:16.347 > [108.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:16.448 > [108.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:16.550 > [108.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:16.651 > [108.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:16.752 > [108.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:16.853 > [108.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:16.954 > [109.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:17.055 > [109.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:17.156 > [109.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:17.257 > [109.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:17.358 > [109.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:17.459 > [109.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:17.560 > [109.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:17.661 > [109.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:17.762 > [109.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:17.863 > [109.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:17.964 > [110.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:18.065 > [110.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:18.166 > [110.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:18.267 > [110.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:18.367 > [110.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:18.469 > [110.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:18.570 > [110.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 3 | WS: CONNECTED
18:33:18.576 > [RETRY] Attempting to send health data (Max retries: 3)
18:33:18.581 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:33:18.586 > Generated health data: HR-61 SPO2-95 STEPS-589
18:33:18.590 > [ESP32] ========================================
18:33:18.595 > [ESP32] ENCRYPTION PIPELINE START
18:33:18.599 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:33:18.606 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:33:18.612 > [ESP32] ========================================
18:33:18.617 > [ESP32] MsgKeys: lfsrSeed=0x1E4A3724 tnk[0..3]=7A2B1027 trn[0..3]=953B8FD9
18:33:18.623 > 1_After_Salt (25): 48522D36312053504F322D3935205354 4550532D3538394D50
18:33:18.628 > 2_After_Padding (32): 48522D36312053504F322D3935205354 4550532D3538394D5000000000000000 
18:33:18.637 > [ESP32][LFSR] Initializing - Seed: 0x1E4A3724 SeedBe: 0x24374A1E ChaosKey[0..3]: 7A2B1027 InitialTap: 0x0029 State: 0x1E4A3724
18:33:18.648 > [ESP32][LFSR] Input (first 16 bytes): 48522D36312053504F322D3935205354 Buffer size: 32 bytes
18:33:18.657 > 3_After_LFSR (32): 6C6567288A1F555D84524D50F4B0D25C 56D96DBEFF529F42BE1518F4E3FF3A6B 
18:33:18.664 > [ESP32][LFSR] Keystream (first 16 bytes): 24374A1EBB3F060DCB606069C1908108
18:33:18.671 > [ESP32][4D] LFSR keystream (first 32 bytes): 24374A1EBB3F060DCB606069C190810813893E93CA6AA60FEE1518F4E3FF3A6B
18:33:18.679 > [ESP32][TINKERBELL] Input (first 16 bytes): 6C6567288A1F555D84524D50F4B0D25C Nonce: 0x00000001 Buffer size: 32 bytes
18:33:18.690 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 7A2B1027
18:33:18.700 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B9571052CF5C6BFABDC91974E585F0E4
18:33:18.709 > 4_After_Tinkerbell (32): D532777A45433EA7399B5424113522B8 02AA1230FC8EF95D28EC85428BD65C69 
18:33:18.715 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B9571052CF5C6BFABDC91974E585F0E4
18:33:18.723 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): B9571052CF5C6BFABDC91974E585F0E454737F8E03DC661F96F99DB668296602
18:33:18.734 > 5_After_Transposition (32): FC8EF95DB82235118BD65C69A73E4345 30AA1202D532777A42EC8528399B5424 
18:33:18.742 > [ESP32] === HMAC DEBUG INFO ===
18:33:18.745 > [ESP32] HMAC Key being used: B7C0DDCA1011A83BB679FA587D344B41BC3D4F8849B71F533ECE08EE044BB4A1
18:33:18.754 > [ESP32] HMAC Input length: 44 bytes
18:33:18.757 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000001FC8EF95DB82235118BD65C69A73E434530AA1202
18:33:18.764 > [ESP32] Nonce: 0x00000001
18:33:18.768 > [ESP32] Packet size before HMAC: 60
18:33:18.770 > [ESP32] Computed HMAC Tag: C7CC55FBB6451C2D1D9EDBBC11535AB6
18:33:18.776 > [ESP32] === END HMAC DEBUG ===
18:33:18.778 > 6_Final_Packet (60): 810217001700040800000001FC8EF95D B82235118BD65C69A73E434530AA1202 ...
18:33:18.787 > [RETRY] Attempt 1/3 (nonce: 1)
18:33:18.790 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:18.797 > Sending pipeline data to server (655 bytes)
18:33:19.084 > [HTTP] Response code: 200
18:33:19.084 > [HTTP] Response: {"status":"OK:DECRYPTED"}
18:33:19.095 > [RETRY] Health data sent successfully!
18:33:19.098 > ✓ Health data #4 sent successfully
18:33:19.196 > [WebSocket] Received (183 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":15,"serverTime":1770123798874,"type":"security_update"}
18:33:19.214 > [WebSocket] Processing message type: security_update
18:33:19.220 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
18:33:19.224 > [111.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:19.331 > [WebSocket] Received (682 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","encData":"ENC_DATA:810217001700040800000001FC8EF95DB82235118BD65C69A73E434530AA1202D532777A42EC8528399B5424C7CC55FBB6451C2D1D9EDBBC11535AB6","pipeline":{"afterLFSR":"6C6567288A1F555D84524D50F4B0D25C56D96DBEFF529F42BE1518F4E3FF3A6B","afterSalt":"48522D36312053504F322D39352053544550532D3538394D50","afterTinkerbell":"D532777A45433EA7399B5424113522B802AA1230FC8EF95D28EC85428BD65C69","afterTransposition":"FC8EF95DB82235118BD65C69A73E434530AA1202D532777A42EC8528399B5424"},"plaintext":"HR-61 SPO2-95 STEPS-589","serverTime":1770123798875,"timestamp":110862,"type":"encryption_update","ztmEnabled":false}
18:33:19.392 > [WebSocket] Processing message type: encryption_update
18:33:19.397 > [111.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:19.504 > [WebSocket] Received (87 bytes): {"heartRate":61,"spo2":95,"steps":589,"time":1770123798875,"type":"health_data_update"}
18:33:19.513 > [WebSocket] Processing message type: health_data_update
18:33:19.518 > [111.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:19.627 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3454,"encryptionTime":0.0,"finalPlaintext":"HR-61 SPO2-95 STEPS-589","handshakeSuccess":true,"totalTime":0.3454},"type":"session_summary_update"}
18:33:19.648 > [WebSocket] Processing message type: session_summary_update
18:33:19.654 > [111.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:19.760 > [WebSocket] Received (656 bytes): {"decryptionTime":0.3454,"encryptedPacket":"810217001700040800000001FC8EF95DB82235118BD65C69A73E434530AA1202D532777A42EC8528399B5424C7CC55FBB6451C2D1D9EDBBC11535AB6","finalPlaintext":"HR-61 SPO2-95 STEPS-589","healthData":{"heartRate":61,"spo2":95,"steps":589},"pipeline":{"afterDepad":"48522D36312053504F322D39352053544550532D35383900000000000000","afterLFSR":"48522D36312053504F322D39352053544550532D3538394D5000000000000000","afterTinkerbell":"6C6567288A1F555D84524D50F4B0D25C56D96DBEFF529F42BE1518F4E3FF3A6B","afterTransposition":"D532777A45433EA7399B5424113522B802AA1230FC8EF95D28EC85428BD65C69"},"serverTime":1770123798875,"type":"decryption_update"}
18:33:19.819 > [WebSocket] Processing message type: decryption_update
18:33:19.824 > [WebSocket] Server decryption completed
18:33:19.827 > [WebSocket] Health data - HR: 61, SPO2: 95, Steps: 589
18:33:19.832 > [111.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:19.934 > [WebSocket] Received (694 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","healthSendCount":3,"pipeline":{"afterLFSR":"6C6567288A1F555D84524D50F4B0D25C56D96DBEFF529F42BE1518F4E3FF3A6B","afterSalt":"48522D36312053504F322D39352053544550532D3538394D50","afterTinkerbell":"D532777A45433EA7399B5424113522B802AA1230FC8EF95D28EC85428BD65C69","afterTransposition":"FC8EF95DB82235118BD65C69A73E434530AA1202D532777A42EC8528399B5424","finalPacket":"810217001700040800000001FC8EF95DB82235118BD65C69A73E434530AA1202D532777A42EC8528399B5424C7CC55FBB6451C2D1D9EDBBC11535AB6"},"plaintext":"HR-61 SPO2-95 STEPS-589","timestamp":111151,"type":"encryption_pipeline","ztmEnabled":false}
18:33:19.996 > [WebSocket] Processing message type: encryption_pipeline
18:33:20.001 > [112.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:20.108 > [WebSocket] Received (158 bytes): {"deviceId":"f9641d44","healthSendCount":3,"message":"Health data #4 sent successfully","state":7,"success":true,"timestamp":111155,"type":"health_data_sent"}
18:33:20.125 > [WebSocket] Processing message type: health_data_sent
18:33:20.128 > [112.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:20.229 > [112.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:20.331 > [112.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:20.432 > [112.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:20.533 > [112.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:20.634 > [112.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:20.735 > [112.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:20.835 > [112.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:20.937 > [113.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:21.038 > [113.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:21.139 > [113.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:21.240 > [113.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:21.341 > [113.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:21.442 > [113.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:21.543 > [113.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:21.644 > [113.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:21.745 > [113.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:21.845 > [113.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:21.947 > [114.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:22.047 > [114.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:22.148 > [114.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:22.250 > [114.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:22.351 > [114.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:22.452 > [114.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:22.553 > [114.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:22.654 > [114.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:22.755 > [114.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:22.856 > [114.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:22.957 > [115.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:23.058 > [115.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:23.159 > [115.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:23.260 > [115.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:23.361 > [115.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:23.462 > [115.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:23.562 > [115.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:23.664 > [115.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:23.765 > [115.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:23.866 > [115.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:23.967 > [116.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:24.068 > [116.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:24.169 > [116.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:24.270 > [116.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:24.371 > [116.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:24.472 > [116.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:24.573 > [116.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:24.674 > [116.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:24.775 > [116.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:24.876 > [116.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:24.977 > [117.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:25.078 > [117.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:25.179 > [117.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:25.280 > [117.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:25.381 > [117.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:25.482 > [117.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:25.583 > [117.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:25.683 > [117.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:25.785 > [117.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:25.886 > [118.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:25.987 > [118.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:26.088 > [118.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:26.189 > [118.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:26.290 > [118.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:26.391 > [118.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:26.492 > [118.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:26.593 > [118.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:26.694 > [118.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:26.795 > [118.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:26.896 > [119.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:26.996 > [119.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:27.098 > [119.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:27.199 > [119.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:27.300 > [119.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:27.401 > [119.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:27.502 > [119.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:27.603 > [119.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:27.704 > [119.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:27.805 > [119.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:27.906 > [120.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:28.007 > [120.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:28.108 > [120.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:28.209 > [120.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:28.310 > [120.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:28.410 > [120.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:28.512 > [120.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:28.613 > [120.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:28.714 > [120.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:28.815 > [120.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:28.916 > [121.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:29.017 > [121.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:29.118 > [121.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 4 | WS: CONNECTED
18:33:29.123 > [RETRY] Attempting to send health data (Max retries: 3)
18:33:29.129 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:33:29.134 > Generated health data: HR-62 SPO2-95 STEPS-642
18:33:29.138 > [ESP32] ========================================
18:33:29.143 > [ESP32] ENCRYPTION PIPELINE START
18:33:29.146 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:33:29.154 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:33:29.160 > [ESP32] ========================================
18:33:29.165 > [ESP32] MsgKeys: lfsrSeed=0xCAD4D70B tnk[0..3]=3E49962A trn[0..3]=57EA0C6B
18:33:29.171 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3634324D50
18:33:29.177 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3634324D5000000000000000 
18:33:29.185 > [ESP32][LFSR] Initializing - Seed: 0xCAD4D70B SeedBe: 0x0BD7D4CA ChaosKey[0..3]: 3E49962A InitialTap: 0x0029 State: 0xCAD4D70B
18:33:29.195 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
18:33:29.204 > 3_After_LFSR (32): 4385F9FCDEDB7A36E9225D6A8F8FA356 A7E42A80F4B6484B2616B8EDB198EA16 
18:33:29.212 > [ESP32][LFSR] Keystream (first 16 bytes): 0BD7D4CAECFB2966A6107053BAAFF002
18:33:29.219 > [ESP32][4D] LFSR keystream (first 32 bytes): 0BD7D4CAECFB2966A6107053BAAFF002E2B479ADC2827A067616B8EDB198EA16
18:33:29.227 > [ESP32][TINKERBELL] Input (first 16 bytes): 4385F9FCDEDB7A36E9225D6A8F8FA356 Nonce: 0x00000002 Buffer size: 32 bytes
18:33:29.238 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 3E49962A
18:33:29.248 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 3EB0EBB5242F11DE3D3FB5ED07365779
18:33:29.257 > 4_After_Tinkerbell (32): 7D351249FAF46BE8D41DE88788B9F42F 28EF197B110E087735656B4DDE4B66BD 
18:33:29.262 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 3EB0EBB5242F11DE3D3FB5ED07365779
18:33:29.271 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 3EB0EBB5242F11DE3D3FB5ED073657798F0B33FBE5B8403C1373D3A06FD38CAB
18:33:29.282 > 5_After_Transposition (32): F4FA49E81DD46BE8B9888719EF28F42F 0E117B6B653508774BDE4D12357D66BD 
18:33:29.291 > [ESP32] === HMAC DEBUG INFO ===
18:33:29.293 > [ESP32] HMAC Key being used: B7C0DDCA1011A83BB679FA587D344B41BC3D4F8849B71F533ECE08EE044BB4A1
18:33:29.302 > [ESP32] HMAC Input length: 44 bytes
18:33:29.304 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000002F4FA49E81DD46BE8B9888719EF28F42F0E117B6B
18:33:29.312 > [ESP32] Nonce: 0x00000002
18:33:29.315 > [ESP32] Packet size before HMAC: 60
18:33:29.319 > [ESP32] Computed HMAC Tag: 64339FEB73D652842303CB201A8E2A29
18:33:29.324 > [ESP32] === END HMAC DEBUG ===
18:33:29.326 > 6_Final_Packet (60): 810217001700040800000002F4FA49E8 1DD46BE8B9888719EF28F42F0E117B6B ...
18:33:29.335 > [RETRY] Attempt 1/3 (nonce: 2)
18:33:29.338 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:29.345 > Sending pipeline data to server (655 bytes)
18:33:29.591 > [HTTP] Response code: 200
18:33:29.591 > [HTTP] Response: {"status":"OK:DECRYPTED"}
18:33:29.602 > [RETRY] Health data sent successfully!
18:33:29.605 > ✓ Health data #5 sent successfully
18:33:29.707 > [WebSocket] Received (682 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","encData":"ENC_DATA:810217001700040800000002F4FA49E81DD46BE8B9888719EF28F42F0E117B6B653508774BDE4D12357D66BD64339FEB73D652842303CB201A8E2A29","pipeline":{"afterLFSR":"4385F9FCDEDB7A36E9225D6A8F8FA356A7E42A80F4B6484B2616B8EDB198EA16","afterSalt":"48522D36322053504F322D39352053544550532D3634324D50","afterTinkerbell":"7D351249FAF46BE8D41DE88788B9F42F28EF197B110E087735656B4DDE4B66BD","afterTransposition":"F4FA49E81DD46BE8B9888719EF28F42F0E117B6B653508774BDE4D12357D66BD"},"plaintext":"HR-62 SPO2-95 STEPS-642","serverTime":1770123809452,"timestamp":121410,"type":"encryption_update","ztmEnabled":false}
18:33:29.768 > [WebSocket] Processing message type: encryption_update
18:33:29.774 > [121.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:29.881 > [WebSocket] Received (87 bytes): {"heartRate":62,"spo2":95,"steps":642,"time":1770123809452,"type":"health_data_update"}
18:33:29.889 > [WebSocket] Processing message type: health_data_update
18:33:29.895 > [122.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:30.003 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3077,"encryptionTime":0.0,"finalPlaintext":"HR-62 SPO2-95 STEPS-642","handshakeSuccess":true,"totalTime":0.3077},"type":"session_summary_update"}
18:33:30.026 > [WebSocket] Processing message type: session_summary_update
18:33:30.030 > [122.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:30.137 > [WebSocket] Received (656 bytes): {"decryptionTime":0.3077,"encryptedPacket":"810217001700040800000002F4FA49E81DD46BE8B9888719EF28F42F0E117B6B653508774BDE4D12357D66BD64339FEB73D652842303CB201A8E2A29","finalPlaintext":"HR-62 SPO2-95 STEPS-642","healthData":{"heartRate":62,"spo2":95,"steps":642},"pipeline":{"afterDepad":"48522D36322053504F322D39352053544550532D36343200000000000000","afterLFSR":"48522D36322053504F322D39352053544550532D3634324D5000000000000000","afterTinkerbell":"4385F9FCDEDB7A36E9225D6A8F8FA356A7E42A80F4B6484B2616B8EDB198EA16","afterTransposition":"7D351249FAF46BE8D41DE88788B9F42F28EF197B110E087735656B4DDE4B66BD"},"serverTime":1770123809453,"type":"decryption_update"}
18:33:30.195 > [WebSocket] Processing message type: decryption_update
18:33:30.201 > [WebSocket] Server decryption completed
18:33:30.203 > [WebSocket] Health data - HR: 62, SPO2: 95, Steps: 642
18:33:30.209 > [122.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:30.310 > [WebSocket] Received (694 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","healthSendCount":4,"pipeline":{"afterLFSR":"4385F9FCDEDB7A36E9225D6A8F8FA356A7E42A80F4B6484B2616B8EDB198EA16","afterSalt":"48522D36322053504F322D39352053544550532D3634324D50","afterTinkerbell":"7D351249FAF46BE8D41DE88788B9F42F28EF197B110E087735656B4DDE4B66BD","afterTransposition":"F4FA49E81DD46BE8B9888719EF28F42F0E117B6B653508774BDE4D12357D66BD","finalPacket":"810217001700040800000002F4FA49E81DD46BE8B9888719EF28F42F0E117B6B653508774BDE4D12357D66BD64339FEB73D652842303CB201A8E2A29"},"plaintext":"HR-62 SPO2-95 STEPS-642","timestamp":121658,"type":"encryption_pipeline","ztmEnabled":false}
18:33:30.372 > [WebSocket] Processing message type: encryption_pipeline
18:33:30.376 > [122.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:30.484 > [WebSocket] Received (158 bytes): {"deviceId":"f9641d44","healthSendCount":4,"message":"Health data #5 sent successfully","state":7,"success":true,"timestamp":121663,"type":"health_data_sent"}
18:33:30.501 > [WebSocket] Processing message type: health_data_sent
18:33:30.503 > [122.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:30.606 > [122.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:30.706 > [122.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:30.807 > [122.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:30.909 > [123.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:31.010 > [123.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:31.110 > [123.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:31.211 > [123.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:31.313 > [123.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:31.414 > [123.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:31.515 > [123.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:31.616 > [123.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:31.717 > [123.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:31.817 > [123.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:31.919 > [124.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:32.020 > [124.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:32.121 > [124.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:32.222 > [124.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:32.323 > [124.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:32.423 > [124.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:32.525 > [124.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:32.625 > [124.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:32.727 > [124.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:32.828 > [124.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:32.929 > [125.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:33.029 > [125.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:33.130 > [125.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:33.232 > [125.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:33.333 > [125.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:33.433 > [125.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:33.534 > [125.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:33.636 > [125.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:33.736 > [125.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:33.838 > [125.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:33.939 > [126.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:34.039 > [126.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:34.141 > [126.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:34.242 > [126.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:34.343 > [126.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:34.444 > [126.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:34.544 > [126.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:34.646 > [126.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:34.747 > [126.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:34.848 > [126.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:34.948 > [127.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:35.049 > [127.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:35.151 > [127.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:35.252 > [127.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:35.353 > [127.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:35.453 > [127.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:35.555 > [127.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:35.655 > [127.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:35.756 > [127.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:35.858 > [127.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:35.959 > [128.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:36.059 > [128.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:36.161 > [128.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:36.262 > [128.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:36.363 > [128.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:36.464 > [128.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:36.565 > [128.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:36.665 > [128.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:36.767 > [128.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:36.868 > [128.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:36.969 > [129.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:37.069 > [129.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:37.171 > [129.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:37.272 > [129.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:37.372 > [129.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:37.474 > [129.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:37.575 > [129.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:37.676 > [129.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:37.777 > [129.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:37.878 > [129.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:37.978 > [130.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:38.079 > [130.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:38.180 > [130.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:38.281 > [130.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:38.382 > [130.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:38.484 > [130.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:38.585 > [130.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:38.685 > [130.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:38.787 > [130.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:38.888 > [131.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:38.988 > [131.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:39.089 > [131.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:39.190 > [131.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:39.292 > [131.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:39.393 > [131.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:39.492 > [131.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:39.595 > [131.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:39.695 > [131.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 5 | WS: CONNECTED
18:33:39.702 > [RETRY] Attempting to send health data (Max retries: 3)
18:33:39.707 > [RETRY] Using nonce 3 for all retry attempts (saved: 2)
18:33:39.712 > Generated health data: HR-62 SPO2-95 STEPS-682
18:33:39.716 > [ESP32] ========================================
18:33:39.721 > [ESP32] ENCRYPTION PIPELINE START
18:33:39.723 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:33:39.732 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:33:39.738 > [ESP32] ========================================
18:33:39.743 > [ESP32] MsgKeys: lfsrSeed=0xF77177B8 tnk[0..3]=63B277F7 trn[0..3]=729BD65A
18:33:39.748 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3638324D50
18:33:39.754 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3638324D5000000000000000 
18:33:39.762 > [ESP32][LFSR] Initializing - Seed: 0xF77177B8 SeedBe: 0xB87771F7 ChaosKey[0..3]: 63B277F7 InitialTap: 0x0029 State: 0xF77177B8
18:33:39.773 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
18:33:39.782 > 3_After_LFSR (32): F0255CC117A4763CE9E331055D58FCC3 8FC82256C9F78AE89FE232A9D6DF17A1 
18:33:39.790 > [ESP32][LFSR] Keystream (first 16 bytes): B87771F72584256CA6D11C3C6878AF97
18:33:39.795 > [ESP32][4D] LFSR keystream (first 32 bytes): B87771F72584256CA6D11C3C6878AF97CA98717BFFCFB8A5CFE232A9D6DF17A1
18:33:39.804 > [ESP32][TINKERBELL] Input (first 16 bytes): F0255CC117A4763CE9E331055D58FCC3 Nonce: 0x00000003 Buffer size: 32 bytes
18:33:39.815 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000003 Counter: 0 (must start at 0) Key[0..3]: 63B277F7
18:33:39.826 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): B9816DF9E3EDE6B4928A854EAE70E05B
18:33:39.835 > 4_After_Tinkerbell (32): 49A43138F44990887B69B44BF3281C98 6FD94DE33BBA8056CB7E04B53A81B8A2 
18:33:39.841 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): B9816DF9E3EDE6B4928A854EAE70E05B
18:33:39.848 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): B9816DF9E3EDE6B4928A854EAE70E05BE0116FB5F24D0ABE549C361CEC5EAF03
18:33:39.860 > 5_After_Transposition (32): F449908849A43138F3281C987B69B44B 3BBA80566FD94DE3CB7E04B53A81B8A2 
18:33:39.867 > [ESP32] === HMAC DEBUG INFO ===
18:33:39.871 > [ESP32] HMAC Key being used: B7C0DDCA1011A83BB679FA587D344B41BC3D4F8849B71F533ECE08EE044BB4A1
18:33:39.879 > [ESP32] HMAC Input length: 44 bytes
18:33:39.882 > [ESP32] HMAC Input (first 32 bytes): 810217001700040800000003F449908849A43138F3281C987B69B44B3BBA8056
18:33:39.891 > [ESP32] Nonce: 0x00000003
18:33:39.893 > [ESP32] Packet size before HMAC: 60
18:33:39.896 > [ESP32] Computed HMAC Tag: 731086BA6E863556B26E106D77CF0EFF
18:33:39.901 > [ESP32] === END HMAC DEBUG ===
18:33:39.904 > 6_Final_Packet (60): 810217001700040800000003F4499088 49A43138F3281C987B69B44B3BBA8056 ...
18:33:39.912 > [RETRY] Attempt 1/3 (nonce: 3)
18:33:39.916 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:39.922 > Sending pipeline data to server (655 bytes)
18:33:40.113 > [HTTP] Response code: 200
18:33:40.113 > [HTTP] Response: {"status":"OK:DECRYPTED"}
18:33:40.125 > [RETRY] Health data sent successfully!
18:33:40.128 > ✓ Health data #6 sent successfully
18:33:40.229 > [WebSocket] Received (682 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","encData":"ENC_DATA:810217001700040800000003F449908849A43138F3281C987B69B44B3BBA80566FD94DE3CB7E04B53A81B8A2731086BA6E863556B26E106D77CF0EFF","pipeline":{"afterLFSR":"F0255CC117A4763CE9E331055D58FCC38FC82256C9F78AE89FE232A9D6DF17A1","afterSalt":"48522D36322053504F322D39352053544550532D3638324D50","afterTinkerbell":"49A43138F44990887B69B44BF3281C986FD94DE33BBA8056CB7E04B53A81B8A2","afterTransposition":"F449908849A43138F3281C987B69B44B3BBA80566FD94DE3CB7E04B53A81B8A2"},"plaintext":"HR-62 SPO2-95 STEPS-682","serverTime":1770123820025,"timestamp":131988,"type":"encryption_update","ztmEnabled":false}
18:33:40.291 > [WebSocket] Processing message type: encryption_update
18:33:40.297 > [132.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:40.404 > [WebSocket] Received (87 bytes): {"heartRate":62,"spo2":95,"steps":682,"time":1770123820025,"type":"health_data_update"}
18:33:40.412 > [WebSocket] Processing message type: health_data_update
18:33:40.417 > [132.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:40.526 > [WebSocket] Received (223 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.311,"encryptionTime":0.0,"finalPlaintext":"HR-62 SPO2-95 STEPS-682","handshakeSuccess":true,"totalTime":0.311},"type":"session_summary_update"}
18:33:40.548 > [WebSocket] Processing message type: session_summary_update
18:33:40.550 > [132.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:40.659 > [WebSocket] Received (655 bytes): {"decryptionTime":0.311,"encryptedPacket":"810217001700040800000003F449908849A43138F3281C987B69B44B3BBA80566FD94DE3CB7E04B53A81B8A2731086BA6E863556B26E106D77CF0EFF","finalPlaintext":"HR-62 SPO2-95 STEPS-682","healthData":{"heartRate":62,"spo2":95,"steps":682},"pipeline":{"afterDepad":"48522D36322053504F322D39352053544550532D36383200000000000000","afterLFSR":"48522D36322053504F322D39352053544550532D3638324D5000000000000000","afterTinkerbell":"F0255CC117A4763CE9E331055D58FCC38FC82256C9F78AE89FE232A9D6DF17A1","afterTransposition":"49A43138F44990887B69B44BF3281C986FD94DE33BBA8056CB7E04B53A81B8A2"},"serverTime":1770123820026,"type":"decryption_update"}
18:33:40.718 > [WebSocket] Processing message type: decryption_update
18:33:40.723 > [WebSocket] Server decryption completed
18:33:40.726 > [WebSocket] Health data - HR: 62, SPO2: 95, Steps: 682
18:33:40.731 > [132.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:40.833 > [WebSocket] Received (694 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","healthSendCount":5,"pipeline":{"afterLFSR":"F0255CC117A4763CE9E331055D58FCC38FC82256C9F78AE89FE232A9D6DF17A1","afterSalt":"48522D36322053504F322D39352053544550532D3638324D50","afterTinkerbell":"49A43138F44990887B69B44BF3281C986FD94DE33BBA8056CB7E04B53A81B8A2","afterTransposition":"F449908849A43138F3281C987B69B44B3BBA80566FD94DE3CB7E04B53A81B8A2","finalPacket":"810217001700040800000003F449908849A43138F3281C987B69B44B3BBA80566FD94DE3CB7E04B53A81B8A2731086BA6E863556B26E106D77CF0EFF"},"plaintext":"HR-62 SPO2-95 STEPS-682","timestamp":132180,"type":"encryption_pipeline","ztmEnabled":false}
18:33:40.894 > [WebSocket] Processing message type: encryption_pipeline
18:33:40.900 > [133.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:41.007 > [WebSocket] Received (158 bytes): {"deviceId":"f9641d44","healthSendCount":5,"message":"Health data #6 sent successfully","state":7,"success":true,"timestamp":132185,"type":"health_data_sent"}
18:33:41.023 > [WebSocket] Processing message type: health_data_sent
18:33:41.027 > [133.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:41.128 > [133.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:41.229 > [133.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:41.330 > [133.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:41.431 > [133.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:41.532 > [133.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:41.634 > [133.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:41.734 > [133.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:41.835 > [133.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:41.936 > [134.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:42.038 > [134.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:42.139 > [134.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:42.240 > [134.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:42.341 > [134.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:42.442 > [134.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:42.542 > [134.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:42.644 > [134.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:42.744 > [134.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:42.845 > [134.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:42.946 > [135.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:43.047 > [135.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:43.148 > [135.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:43.249 > [135.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:43.351 > [135.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:43.451 > [135.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:43.552 > [135.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:43.652 > [135.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:43.754 > [135.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:43.855 > [135.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:43.956 > [136.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:44.057 > [136.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:44.159 > [136.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:44.260 > [136.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:44.361 > [136.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:44.461 > [136.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:44.563 > [136.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:44.663 > [136.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:44.764 > [136.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:44.866 > [136.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:44.967 > [137.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:45.068 > [137.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:45.168 > [137.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:45.270 > [137.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:45.370 > [137.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:45.472 > [137.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:45.573 > [137.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:45.674 > [137.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:45.774 > [137.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:45.876 > [137.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:45.977 > [138.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:46.077 > [138.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:46.178 > [138.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:46.279 > [138.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:46.380 > [138.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:46.481 > [138.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:46.582 > [138.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:46.683 > [138.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:46.784 > [138.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:46.885 > [139.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:46.986 > [139.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:47.087 > [139.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:47.188 > [139.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:47.289 > [139.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:47.390 > [139.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:47.491 > [139.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:47.592 > [139.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:47.693 > [139.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:47.794 > [139.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:47.895 > [140.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:47.996 > [140.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:48.097 > [140.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:48.198 > [140.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:48.299 > [140.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:48.400 > [140.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:48.502 > [140.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:48.602 > [140.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:48.703 > [140.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:48.804 > [140.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:48.905 > [141.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:49.006 > [141.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:49.107 > [141.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:49.208 > [141.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:49.309 > [141.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:49.410 > [141.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:49.510 > [141.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:49.611 > [141.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:49.713 > [141.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:49.815 > [141.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:49.916 > [142.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:50.017 > [142.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:50.117 > [142.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:50.217 > [142.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 6 | WS: CONNECTED
18:33:50.224 > [RETRY] Attempting to send health data (Max retries: 3)
18:33:50.229 > [RETRY] Using nonce 4 for all retry attempts (saved: 3)
18:33:50.235 > Generated health data: HR-62 SPO2-95 STEPS-714
18:33:50.238 > [ESP32] ========================================
18:33:50.244 > [ESP32] ENCRYPTION PIPELINE START
18:33:50.246 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:33:50.254 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:33:50.261 > [ESP32] ========================================
18:33:50.266 > [ESP32] MsgKeys: lfsrSeed=0xB511F6E4 tnk[0..3]=0EC0F29F trn[0..3]=1A7B36EA
18:33:50.271 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3731344D50
18:33:50.277 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3731344D5000000000000000 
18:33:50.285 > [ESP32][LFSR] Initializing - Seed: 0xB511F6E4 SeedBe: 0xE4F611B5 ChaosKey[0..3]: 0EC0F29F InitialTap: 0x0029 State: 0xB511F6E4
18:33:50.297 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
18:33:50.305 > 3_After_LFSR (32): ACA43C839241C18974FB251BDDF66E32 2F7B842E475108AFC4E42D3ADF6130FE 
18:33:50.313 > [ESP32][LFSR] Keystream (first 16 bytes): E4F611B5A06192D93BC90822E8D63D66
18:33:50.318 > [ESP32][4D] LFSR keystream (first 32 bytes): E4F611B5A06192D93BC90822E8D63D666A2BD70370603CE294E42D3ADF6130FE
18:33:50.327 > [ESP32][TINKERBELL] Input (first 16 bytes): ACA43C839241C18974FB251BDDF66E32 Nonce: 0x00000004 Buffer size: 32 bytes
18:33:50.338 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000004 Counter: 0 (must start at 0) Key[0..3]: 0EC0F29F
18:33:50.349 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 2BD3335106529EF7C298021C07B346B3
18:33:50.358 > 4_After_Tinkerbell (32): 87770FD294135F7EB6632707DA452881 2000382148CD4F157736A1488B6D016B 
18:33:50.363 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 2BD3335106529EF7C298021C07B346B3
18:33:50.372 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 2BD3335106529EF7C298021C07B346B30F7BBC0F0F9C47BAB3D28C72540C3195
18:33:50.383 > 5_After_Transposition (32): 20003821945F137EB6632707DA284581 87770FD2484FCD1548A136778B6D016B 
18:33:50.391 > [ESP32] === HMAC DEBUG INFO ===
18:33:50.394 > [ESP32] HMAC Key being used: B7C0DDCA1011A83BB679FA587D344B41BC3D4F8849B71F533ECE08EE044BB4A1
18:33:50.402 > [ESP32] HMAC Input length: 44 bytes
18:33:50.405 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000420003821945F137EB6632707DA28458187770FD2
18:33:50.413 > [ESP32] Nonce: 0x00000004
18:33:50.415 > [ESP32] Packet size before HMAC: 60
18:33:50.419 > [ESP32] Computed HMAC Tag: 25B672908205394B285D688588206D40
18:33:50.425 > [ESP32] === END HMAC DEBUG ===
18:33:50.427 > 6_Final_Packet (60): 81021700170004080000000420003821 945F137EB6632707DA28458187770FD2 ...
18:33:50.436 > [RETRY] Attempt 1/3 (nonce: 4)
18:33:50.438 > POST http://10.249.92.115:8081/health-data with pipeline data
18:33:50.445 > Sending pipeline data to server (655 bytes)
18:33:50.602 > [HTTP] Response code: 200
18:33:50.603 > [HTTP] Response: {"status":"OK:DECRYPTED"}
18:33:50.613 > [RETRY] Health data sent successfully!
18:33:50.616 > ✓ Health data #7 sent successfully
18:33:50.718 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":2,"serverTime":1770123830536,"type":"security_update"}
18:33:50.734 > [WebSocket] Processing message type: security_update
18:33:50.740 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
18:33:50.745 > [142.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:50.852 > [WebSocket] Received (682 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","encData":"ENC_DATA:81021700170004080000000420003821945F137EB6632707DA28458187770FD2484FCD1548A136778B6D016B25B672908205394B285D688588206D40","pipeline":{"afterLFSR":"ACA43C839241C18974FB251BDDF66E322F7B842E475108AFC4E42D3ADF6130FE","afterSalt":"48522D36322053504F322D39352053544550532D3731344D50","afterTinkerbell":"87770FD294135F7EB6632707DA4528812000382148CD4F157736A1488B6D016B","afterTransposition":"20003821945F137EB6632707DA28458187770FD2484FCD1548A136778B6D016B"},"plaintext":"HR-62 SPO2-95 STEPS-714","serverTime":1770123830536,"timestamp":142511,"type":"encryption_update","ztmEnabled":false}
18:33:50.913 > [WebSocket] Processing message type: encryption_update
18:33:50.918 > [143.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:51.025 > [WebSocket] Received (87 bytes): {"heartRate":62,"spo2":95,"steps":714,"time":1770123830536,"type":"health_data_update"}
18:33:51.034 > [WebSocket] Processing message type: health_data_update
18:33:51.039 > [143.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:51.148 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3046,"encryptionTime":0.0,"finalPlaintext":"HR-62 SPO2-95 STEPS-714","handshakeSuccess":true,"totalTime":0.3046},"type":"session_summary_update"}
18:33:51.170 > [WebSocket] Processing message type: session_summary_update
18:33:51.175 > [143.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:51.280 > [WebSocket] Received (656 bytes): {"decryptionTime":0.3046,"encryptedPacket":"81021700170004080000000420003821945F137EB6632707DA28458187770FD2484FCD1548A136778B6D016B25B672908205394B285D688588206D40","finalPlaintext":"HR-62 SPO2-95 STEPS-714","healthData":{"heartRate":62,"spo2":95,"steps":714},"pipeline":{"afterDepad":"48522D36322053504F322D39352053544550532D37313400000000000000","afterLFSR":"48522D36322053504F322D39352053544550532D3731344D5000000000000000","afterTinkerbell":"ACA43C839241C18974FB251BDDF66E322F7B842E475108AFC4E42D3ADF6130FE","afterTransposition":"87770FD294135F7EB6632707DA4528812000382148CD4F157736A1488B6D016B"},"serverTime":1770123830537,"type":"decryption_update"}
18:33:51.339 > [WebSocket] Processing message type: decryption_update
18:33:51.346 > [WebSocket] Server decryption completed
18:33:51.348 > [WebSocket] Health data - HR: 62, SPO2: 95, Steps: 714
18:33:51.353 > [143.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:51.456 > [WebSocket] Received (694 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","healthSendCount":6,"pipeline":{"afterLFSR":"ACA43C839241C18974FB251BDDF66E322F7B842E475108AFC4E42D3ADF6130FE","afterSalt":"48522D36322053504F322D39352053544550532D3731344D50","afterTinkerbell":"87770FD294135F7EB6632707DA4528812000382148CD4F157736A1488B6D016B","afterTransposition":"20003821945F137EB6632707DA28458187770FD2484FCD1548A136778B6D016B","finalPacket":"81021700170004080000000420003821945F137EB6632707DA28458187770FD2484FCD1548A136778B6D016B25B672908205394B285D688588206D40"},"plaintext":"HR-62 SPO2-95 STEPS-714","timestamp":142670,"type":"encryption_pipeline","ztmEnabled":false}
18:33:51.517 > [WebSocket] Processing message type: encryption_pipeline
18:33:51.523 > [143.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:51.629 > [WebSocket] Received (158 bytes): {"deviceId":"f9641d44","healthSendCount":6,"message":"Health data #7 sent successfully","state":7,"success":true,"timestamp":142675,"type":"health_data_sent"}
18:33:51.646 > [WebSocket] Processing message type: health_data_sent
18:33:51.649 > [143.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:51.752 > [143.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:51.852 > [143.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:51.953 > [144.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:52.054 > [144.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:52.155 > [144.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:52.256 > [144.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:52.357 > [144.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:52.458 > [144.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:52.560 > [144.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:52.660 > [144.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:52.761 > [144.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:52.862 > [144.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:52.963 > [145.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:53.064 > [145.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:53.166 > [145.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:53.266 > [145.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:53.367 > [145.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:53.467 > [145.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:53.569 > [145.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:53.670 > [145.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:53.771 > [145.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:53.872 > [145.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:53.973 > [146.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:54.074 > [146.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:54.175 > [146.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:54.276 > [146.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:54.377 > [146.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:54.478 > [146.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:54.578 > [146.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:54.680 > [146.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:54.781 > [146.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:54.882 > [146.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:54.982 > [147.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:55.085 > [147.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:55.185 > [147.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:55.286 > [147.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:55.387 > [147.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:55.488 > [147.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:55.589 > [147.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:55.690 > [147.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:55.791 > [147.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:55.892 > [148.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:55.993 > [148.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:56.094 > [148.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:56.195 > [148.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:56.296 > [148.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:56.397 > [148.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:56.497 > [148.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:56.599 > [148.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:56.700 > [148.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:56.801 > [148.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:56.902 > [149.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:57.003 > [149.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:57.104 > [149.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:57.205 > [149.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:57.306 > [149.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:57.406 > [149.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:57.507 > [149.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:57.609 > [149.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:57.710 > [149.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:57.811 > [149.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:57.912 > [150.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:58.013 > [150.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:58.114 > [150.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:58.215 > [150.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:58.316 > [150.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:58.416 > [150.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:58.518 > [150.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:58.619 > [150.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:58.720 > [150.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:58.821 > [150.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:58.921 > [151.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:59.023 > [151.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:59.124 > [151.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:59.225 > [151.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:59.326 > [151.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:59.427 > [151.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:59.528 > [151.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:59.629 > [151.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:59.729 > [151.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:59.830 > [151.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:33:59.932 > [152.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:00.032 > [152.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:00.133 > [152.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:00.234 > [152.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:00.336 > [152.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:00.436 > [152.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:00.538 > [152.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:00.639 > [152.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:00.645 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:00.650 > [RETRY] Using nonce 5 for all retry attempts (saved: 4)
18:34:00.656 > Generated health data: HR-62 SPO2-95 STEPS-803
18:34:00.659 > [ESP32] ========================================
18:34:00.664 > [ESP32] ENCRYPTION PIPELINE START
18:34:00.667 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:00.676 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:00.681 > [ESP32] ========================================
18:34:00.687 > [ESP32] MsgKeys: lfsrSeed=0x8FE8BBF2 tnk[0..3]=43B1894F trn[0..3]=A9BBB824
18:34:00.692 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3830334D50
18:34:00.697 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3830334D5000000000000000 
18:34:00.706 > [ESP32][LFSR] Initializing - Seed: 0x8FE8BBF2 SeedBe: 0xF2BBE88F ChaosKey[0..3]: 43B1894F InitialTap: 0x0029 State: 0x8FE8BBF2
18:34:00.717 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
18:34:00.726 > 3_After_LFSR (32): BAE9C5B9A6B7736F43D18FAB1F8CD7AF 91812D980EAE7F79B9D7DE1A18AAC89A 
18:34:00.734 > [ESP32][LFSR] Keystream (first 16 bytes): F2BBE88F9497203F0CE3A2922AAC84FB
18:34:00.739 > [ESP32][4D] LFSR keystream (first 32 bytes): F2BBE88F9497203F0CE3A2922AAC84FBD4D17EB5369E4C34E9D7DE1A18AAC89A
18:34:00.748 > [ESP32][TINKERBELL] Input (first 16 bytes): BAE9C5B9A6B7736F43D18FAB1F8CD7AF Nonce: 0x00000005 Buffer size: 32 bytes
18:34:00.758 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000005 Counter: 0 (must start at 0) Key[0..3]: 43B1894F
18:34:00.770 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): EE87CBD994D42D3310BD9563043875CA
18:34:00.777 > 4_After_Tinkerbell (32): 546E0E6032635E5C536C1AC81BB4A265 15C5C08F297DE4F7832AE07AA8FD8668 
18:34:00.784 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): EE87CBD994D42D3310BD9563043875CA
18:34:00.791 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): EE87CBD994D42D3310BD9563043875CA8444ED1727D39B8E3AFD3E60B0574EF2
18:34:00.803 > 5_After_Transposition (32): 32635E5CF77DE4291BB4A26568FD86A8 2A7A83E0536C1AC8C58F15C0546E0E60 
18:34:00.810 > [ESP32] === HMAC DEBUG INFO ===
18:34:00.814 > [ESP32] HMAC Key being used: B7C0DDCA1011A83BB679FA587D344B41BC3D4F8849B71F533ECE08EE044BB4A1
18:34:00.822 > [ESP32] HMAC Input length: 44 bytes
18:34:00.826 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000532635E5CF77DE4291BB4A26568FD86A82A7A83E0
18:34:00.834 > [ESP32] Nonce: 0x00000005
18:34:00.837 > [ESP32] Packet size before HMAC: 60
18:34:00.840 > [ESP32] Computed HMAC Tag: 8664532208A8F7415FFFD461DF9BDE06
18:34:00.844 > [ESP32] === END HMAC DEBUG ===
18:34:00.847 > 6_Final_Packet (60): 81021700170004080000000532635E5C F77DE4291BB4A26568FD86A82A7A83E0 ...
18:34:00.856 > [RETRY] Attempt 1/3 (nonce: 5)
18:34:00.859 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:00.866 > Sending pipeline data to server (655 bytes)
18:34:01.107 > [HTTP] Response code: 400
18:34:01.107 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:01.113 > [HTTP] Request failed with code: 400
18:34:01.116 > [RETRY] Send failed, waiting 100 ms before retry
18:34:01.215 > [RETRY] Attempt 2/3 (nonce: 5)
18:34:01.215 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:01.221 > Sending pipeline data to server (655 bytes)
18:34:01.361 > [HTTP] Response code: 400
18:34:01.361 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:01.367 > [HTTP] Request failed with code: 400
18:34:01.369 > [RETRY] Send failed, waiting 200 ms before retry
18:34:01.569 > [RETRY] Attempt 3/3 (nonce: 5)
18:34:01.569 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:01.574 > Sending pipeline data to server (655 bytes)
18:34:01.866 > [HTTP] Response code: 400
18:34:01.867 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:01.872 > [HTTP] Request failed with code: 400
18:34:01.874 > [RETRY] All retry attempts failed - rolled back nonce to 4
18:34:01.880 > [RETRY] Consecutive failures: 1
18:34:01.883 > Health data send failed (retry count: 1/3)
18:34:01.988 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":153175,"type":"health_data_error"}
18:34:02.002 > [WebSocket] Processing message type: health_data_error
18:34:02.008 > [154.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:02.016 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:02.021 > [RETRY] Using nonce 5 for all retry attempts (saved: 4)
18:34:02.027 > Generated health data: HR-62 SPO2-95 STEPS-794
18:34:02.030 > [ESP32] ========================================
18:34:02.036 > [ESP32] ENCRYPTION PIPELINE START
18:34:02.038 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:02.044 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:02.052 > [ESP32] ========================================
18:34:02.055 > [ESP32] MsgKeys: lfsrSeed=0x8FE8BBF2 tnk[0..3]=43B1894F trn[0..3]=A9BBB824
18:34:02.060 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3739344D50
18:34:02.069 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3739344D5000000000000000 
18:34:02.077 > [ESP32][LFSR] Initializing - Seed: 0x8FE8BBF2 SeedBe: 0xF2BBE88F ChaosKey[0..3]: 43B1894F InitialTap: 0x0029 State: 0x8FE8BBF2
18:34:02.088 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
18:34:02.094 > 3_After_LFSR (32): BAE9C5B9A6B7736F43D18FAB1F8CD7AF 91812D9801A77879B9D7DE1A18AAC89A 
18:34:02.102 > [ESP32][LFSR] Keystream (first 16 bytes): F2BBE88F9497203F0CE3A2922AAC84FB
18:34:02.110 > [ESP32][4D] LFSR keystream (first 32 bytes): F2BBE88F9497203F0CE3A2922AAC84FBD4D17EB5369E4C34E9D7DE1A18AAC89A
18:34:02.119 > [ESP32][TINKERBELL] Input (first 16 bytes): BAE9C5B9A6B7736F43D18FAB1F8CD7AF Nonce: 0x00000005 Buffer size: 32 bytes
18:34:02.130 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000005 Counter: 0 (must start at 0) Key[0..3]: 43B1894F
18:34:02.138 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): EE87CBD994D42D3310BD9563043875CA
18:34:02.146 > 4_After_Tinkerbell (32): 546E0E6032635E5C536C1AC81BB4A265 15C5C08F2674E3F7832AE07AA8FD8668 
18:34:02.155 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): EE87CBD994D42D3310BD9563043875CA
18:34:02.163 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): EE87CBD994D42D3310BD9563043875CA8444ED1727D39B8E3AFD3E60B0574EF2
18:34:02.174 > 5_After_Transposition (32): 32635E5CF774E3261BB4A26568FD86A8 2A7A83E0536C1AC8C58F15C0546E0E60 
18:34:02.183 > [ESP32] === HMAC DEBUG INFO ===
18:34:02.185 > [ESP32] HMAC Key being used: B7C0DDCA1011A83BB679FA587D344B41BC3D4F8849B71F533ECE08EE044BB4A1
18:34:02.191 > [ESP32] HMAC Input length: 44 bytes
18:34:02.196 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000532635E5CF774E3261BB4A26568FD86A82A7A83E0
18:34:02.205 > [ESP32] Nonce: 0x00000005
18:34:02.208 > [ESP32] Packet size before HMAC: 60
18:34:02.210 > [ESP32] Computed HMAC Tag: 00CE1DD2C1836444BFA6F2B1805A58E2
18:34:02.215 > [ESP32] === END HMAC DEBUG ===
18:34:02.219 > 6_Final_Packet (60): 81021700170004080000000532635E5C F774E3261BB4A26568FD86A82A7A83E0 ...
18:34:02.227 > [RETRY] Attempt 1/3 (nonce: 5)
18:34:02.227 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:02.232 > Sending pipeline data to server (655 bytes)
18:34:02.365 > [HTTP] Response code: 400
18:34:02.365 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:02.371 > [HTTP] Request failed with code: 400
18:34:02.373 > [RETRY] Send failed, waiting 100 ms before retry
18:34:02.473 > [RETRY] Attempt 2/3 (nonce: 5)
18:34:02.473 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:02.479 > Sending pipeline data to server (655 bytes)
18:34:02.645 > [HTTP] Response code: 400
18:34:02.645 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:02.650 > [HTTP] Request failed with code: 400
18:34:02.653 > [RETRY] Send failed, waiting 200 ms before retry
18:34:02.854 > [RETRY] Attempt 3/3 (nonce: 5)
18:34:02.854 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:02.859 > Sending pipeline data to server (655 bytes)
18:34:03.123 > [HTTP] Response code: 400
18:34:03.123 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:03.128 > [HTTP] Request failed with code: 400
18:34:03.131 > [RETRY] All retry attempts failed - rolled back nonce to 4
18:34:03.137 > [RETRY] Consecutive failures: 2
18:34:03.139 > Health data send failed (retry count: 2/3)
18:34:03.243 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":153429,"type":"health_data_error"}
18:34:03.256 > [WebSocket] Processing message type: health_data_error
18:34:03.262 > [155.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:03.270 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:03.275 > [RETRY] Using nonce 5 for all retry attempts (saved: 4)
18:34:03.281 > Generated health data: HR-62 SPO2-95 STEPS-777
18:34:03.284 > [ESP32] ========================================
18:34:03.290 > [ESP32] ENCRYPTION PIPELINE START
18:34:03.292 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:03.297 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:03.306 > [ESP32] ========================================
18:34:03.309 > [ESP32] MsgKeys: lfsrSeed=0x8FE8BBF2 tnk[0..3]=43B1894F trn[0..3]=A9BBB824
18:34:03.315 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3737374D50
18:34:03.323 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3737374D5000000000000000 
18:34:03.331 > [ESP32][LFSR] Initializing - Seed: 0x8FE8BBF2 SeedBe: 0xF2BBE88F ChaosKey[0..3]: 43B1894F InitialTap: 0x0029 State: 0x8FE8BBF2
18:34:03.342 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
18:34:03.348 > 3_After_LFSR (32): BAE9C5B9A6B7736F43D18FAB1F8CD7AF 91812D9801A97B79B9D7DE1A18AAC89A 
18:34:03.356 > [ESP32][LFSR] Keystream (first 16 bytes): F2BBE88F9497203F0CE3A2922AAC84FB
18:34:03.364 > [ESP32][4D] LFSR keystream (first 32 bytes): F2BBE88F9497203F0CE3A2922AAC84FBD4D17EB5369E4C34E9D7DE1A18AAC89A
18:34:03.373 > [ESP32][TINKERBELL] Input (first 16 bytes): BAE9C5B9A6B7736F43D18FAB1F8CD7AF Nonce: 0x00000005 Buffer size: 32 bytes
18:34:03.384 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000005 Counter: 0 (must start at 0) Key[0..3]: 43B1894F
18:34:03.392 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): EE87CBD994D42D3310BD9563043875CA
18:34:03.400 > 4_After_Tinkerbell (32): 546E0E6032635E5C536C1AC81BB4A265 15C5C08F267AE0F7832AE07AA8FD8668 
18:34:03.408 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): EE87CBD994D42D3310BD9563043875CA
18:34:03.417 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): EE87CBD994D42D3310BD9563043875CA8444ED1727D39B8E3AFD3E60B0574EF2
18:34:03.428 > 5_After_Transposition (32): 32635E5CF77AE0261BB4A26568FD86A8 2A7A83E0536C1AC8C58F15C0546E0E60 
18:34:03.437 > [ESP32] === HMAC DEBUG INFO ===
18:34:03.440 > [ESP32] HMAC Key being used: B7C0DDCA1011A83BB679FA587D344B41BC3D4F8849B71F533ECE08EE044BB4A1
18:34:03.445 > [ESP32] HMAC Input length: 44 bytes
18:34:03.451 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000532635E5CF77AE0261BB4A26568FD86A82A7A83E0
18:34:03.458 > [ESP32] Nonce: 0x00000005
18:34:03.461 > [ESP32] Packet size before HMAC: 60
18:34:03.464 > [ESP32] Computed HMAC Tag: D7CE07BC4ACA648FB2B59F5F2965E4C8
18:34:03.470 > [ESP32] === END HMAC DEBUG ===
18:34:03.473 > 6_Final_Packet (60): 81021700170004080000000532635E5C F77AE0261BB4A26568FD86A82A7A83E0 ...
18:34:03.481 > [RETRY] Attempt 1/3 (nonce: 5)
18:34:03.481 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:03.487 > Sending pipeline data to server (655 bytes)
18:34:03.627 > [HTTP] Response code: 400
18:34:03.627 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:03.634 > [HTTP] Request failed with code: 400
18:34:03.636 > [RETRY] Send failed, waiting 100 ms before retry
18:34:03.735 > [RETRY] Attempt 2/3 (nonce: 5)
18:34:03.736 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:03.741 > Sending pipeline data to server (655 bytes)
18:34:03.878 > [HTTP] Response code: 400
18:34:03.879 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:03.884 > [HTTP] Request failed with code: 400
18:34:03.887 > [RETRY] Send failed, waiting 200 ms before retry
18:34:04.086 > [RETRY] Attempt 3/3 (nonce: 5)
18:34:04.086 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:04.092 > Sending pipeline data to server (655 bytes)
18:34:04.410 > [HTTP] Response code: 400
18:34:04.410 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:04.416 > [HTTP] Request failed with code: 400
18:34:04.419 > [RETRY] All retry attempts failed - rolled back nonce to 4
18:34:04.424 > [RETRY] Consecutive failures: 3
18:34:04.426 > Health data send failed (retry count: 3/3)
18:34:04.430 > Health data transmission failed after max retries
18:34:04.531 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":153934,"type":"health_data_error"}
18:34:04.544 > [WebSocket] Processing message type: health_data_error
18:34:04.550 > [156.6] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:04.557 > ERROR state - attempting recovery
18:34:04.560 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:04.566 > [RETRY] Using nonce 5 for all retry attempts (saved: 4)
18:34:04.569 > Generated health data: HR-62 SPO2-95 STEPS-822
18:34:04.575 > [ESP32] ========================================
18:34:04.578 > [ESP32] ENCRYPTION PIPELINE START
18:34:04.580 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:04.588 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:04.594 > [ESP32] ========================================
18:34:04.600 > [ESP32] MsgKeys: lfsrSeed=0x8FE8BBF2 tnk[0..3]=43B1894F trn[0..3]=A9BBB824
18:34:04.605 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3832324D50
18:34:04.611 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3832324D5000000000000000 
18:34:04.619 > [ESP32][LFSR] Initializing - Seed: 0x8FE8BBF2 SeedBe: 0xF2BBE88F ChaosKey[0..3]: 43B1894F InitialTap: 0x0029 State: 0x8FE8BBF2
18:34:04.630 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
18:34:04.639 > 3_After_LFSR (32): BAE9C5B9A6B7736F43D18FAB1F8CD7AF 91812D980EAC7E79B9D7DE1A18AAC89A 
18:34:04.647 > [ESP32][LFSR] Keystream (first 16 bytes): F2BBE88F9497203F0CE3A2922AAC84FB
18:34:04.653 > [ESP32][4D] LFSR keystream (first 32 bytes): F2BBE88F9497203F0CE3A2922AAC84FBD4D17EB5369E4C34E9D7DE1A18AAC89A
18:34:04.664 > [ESP32][TINKERBELL] Input (first 16 bytes): BAE9C5B9A6B7736F43D18FAB1F8CD7AF Nonce: 0x00000005 Buffer size: 32 bytes
18:34:04.672 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000005 Counter: 0 (must start at 0) Key[0..3]: 43B1894F
18:34:04.683 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): EE87CBD994D42D3310BD9563043875CA
18:34:04.691 > 4_After_Tinkerbell (32): 546E0E6032635E5C536C1AC81BB4A265 15C5C08F297FE5F7832AE07AA8FD8668 
18:34:04.700 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): EE87CBD994D42D3310BD9563043875CA
18:34:04.708 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): EE87CBD994D42D3310BD9563043875CA8444ED1727D39B8E3AFD3E60B0574EF2
18:34:04.717 > 5_After_Transposition (32): 32635E5CF77FE5291BB4A26568FD86A8 2A7A83E0536C1AC8C58F15C0546E0E60 
18:34:04.725 > [ESP32] === HMAC DEBUG INFO ===
18:34:04.727 > [ESP32] HMAC Key being used: B7C0DDCA1011A83BB679FA587D344B41BC3D4F8849B71F533ECE08EE044BB4A1
18:34:04.735 > [ESP32] HMAC Input length: 44 bytes
18:34:04.739 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000532635E5CF77FE5291BB4A26568FD86A82A7A83E0
18:34:04.749 > [ESP32] Nonce: 0x00000005
18:34:04.749 > [ESP32] Packet size before HMAC: 60
18:34:04.755 > [ESP32] Computed HMAC Tag: 7C3EF1ED96D2470D3A2BB6C2B082BCBC
18:34:04.758 > [ESP32] === END HMAC DEBUG ===
18:34:04.760 > 6_Final_Packet (60): 81021700170004080000000532635E5C F77FE5291BB4A26568FD86A82A7A83E0 ...
18:34:04.769 > [RETRY] Attempt 1/3 (nonce: 5)
18:34:04.771 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:04.777 > Sending pipeline data to server (655 bytes)
18:34:05.121 > [HTTP] Response code: 400
18:34:05.121 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:05.126 > [HTTP] Request failed with code: 400
18:34:05.129 > [RETRY] Send failed, waiting 100 ms before retry
18:34:05.228 > [RETRY] Attempt 2/3 (nonce: 5)
18:34:05.229 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:05.234 > Sending pipeline data to server (655 bytes)
18:34:05.387 > [HTTP] Response code: 400
18:34:05.387 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:05.391 > [HTTP] Request failed with code: 400
18:34:05.395 > [RETRY] Send failed, waiting 200 ms before retry
18:34:05.595 > [RETRY] Attempt 3/3 (nonce: 5)
18:34:05.596 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:05.601 > Sending pipeline data to server (655 bytes)
18:34:05.894 > [HTTP] Response code: 400
18:34:05.894 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:05.900 > [HTTP] Request failed with code: 400
18:34:05.903 > [RETRY] All retry attempts failed - rolled back nonce to 4
18:34:05.908 > [RETRY] Consecutive failures: 4
18:34:05.911 > ✗ Auto-recovery failed - restarting key exchange
18:34:08.015 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":154433,"type":"health_data_error"}
18:34:08.028 > [WebSocket] Processing message type: health_data_error
18:34:08.034 > [160.1] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:08.043 > ✓ Public key loaded from NVS
18:34:08.141 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":154713,"type":"health_data_error"}
18:34:08.155 > [WebSocket] Processing message type: health_data_error
18:34:08.161 > [160.2] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:08.264 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":155191,"type":"health_data_error"}
18:34:08.278 > [WebSocket] Processing message type: health_data_error
18:34:08.283 > [160.3] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:08.292 > Generating fresh master key from entropy...
18:34:08.300 > Generated master key (32): 347C140FBCD6E80254CF74C45DB9B440 83DB2BF3172A6E0DDC6546596AA1C8BE 
18:34:08.306 > Using reduced master key (byte % 3) for NTRU encryption only
18:34:08.316 > NTRU encrypted master key (502): 0063005A00410065001700450007006D 003600030020000D006B00700021000D ...
18:34:08.324 > POST http://10.249.92.115:8081/master-key
18:34:08.669 > ✓ Master key exchange completed
18:34:08.771 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":155697,"type":"health_data_error"}
18:34:08.784 > [WebSocket] Processing message type: health_data_error
18:34:08.790 > [160.8] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:08.798 > Loading master key from NVS and deriving symmetric keys...
18:34:08.804 > Loaded master key from NVS (32): 347C140FBCD6E80254CF74C45DB9B440 83DB2BF3172A6E0DDC6546596AA1C8BE 
18:34:08.812 > Derived HMAC key (32): E73E530603BC4921A8935E61EDC74BA1 D1F8AB245A88871DEF09335BF746A2F9 
18:34:08.820 > Derived Tinkerbell key (16): DA72435993178ED09D8AEADBDD563A54 
18:34:08.826 > Derived Transposition key (16): E06F177E2CF36BE3EB4572C692140B8C 
18:34:08.832 > ✓ Symmetric keys derived successfully
18:34:08.834 > Nonce tracker reset - new session started
18:34:09.331 > Waiting for server to process master key...
18:34:09.334 > ✓ Symmetric keys ready - starting health data transmission
18:34:09.436 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":155947,"type":"health_data_error"}
18:34:09.450 > [WebSocket] Processing message type: health_data_error
18:34:09.455 > [161.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:09.559 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":156478,"type":"health_data_error"}
18:34:09.573 > [WebSocket] Processing message type: health_data_error
18:34:09.578 > [161.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:09.680 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":8,"success":false,"timestamp":157189,"type":"health_data_error"}
18:34:09.704 > [WebSocket] Processing message type: health_data_error
18:34:09.704 > [161.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:09.806 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":8,"success":false,"timestamp":157454,"type":"health_data_error"}
18:34:09.820 > [WebSocket] Processing message type: health_data_error
18:34:09.826 > [161.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:09.927 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":8,"success":false,"timestamp":157962,"type":"health_data_error"}
18:34:09.942 > [WebSocket] Processing message type: health_data_error
18:34:09.947 > [162.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:10.050 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770123848425,"type":"master_key_received"}
18:34:10.064 > [WebSocket] Processing message type: master_key_received
18:34:10.067 > [162.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:10.172 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":160729,"type":"master_key_exchanged"}
18:34:10.189 > [WebSocket] Processing message type: master_key_exchanged
18:34:10.194 > [162.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:10.294 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":161398,"type":"symmetric_keys_derived"}
18:34:10.311 > [WebSocket] Processing message type: symmetric_keys_derived
18:34:10.317 > [162.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:10.416 > [162.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:10.517 > [162.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:10.618 > [162.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:10.718 > [162.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:10.820 > [162.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:10.920 > [163.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:11.022 > [163.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:11.123 > [163.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:11.223 > [163.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:11.324 > [163.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:11.426 > [163.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:11.526 > [163.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:11.628 > [163.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:11.728 > [163.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:11.830 > [163.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:11.931 > [164.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:12.032 > [164.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:12.132 > [164.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:12.233 > [164.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:12.334 > [164.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:12.436 > [164.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:12.537 > [164.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:12.637 > [164.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:12.739 > [164.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:12.840 > [164.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:12.940 > [165.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:13.041 > [165.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:13.142 > [165.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:13.243 > [165.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:13.344 > [165.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:13.445 > [165.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:13.547 > [165.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:13.648 > [165.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:13.748 > [165.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:13.850 > [165.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:13.951 > [166.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:14.052 > [166.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:14.153 > [166.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:14.254 > [166.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:14.354 > [166.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:14.455 > [166.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:14.557 > [166.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:14.657 > [166.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:14.759 > [166.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:14.859 > [166.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:14.961 > [167.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:15.061 > [167.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:15.162 > [167.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:15.263 > [167.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:15.365 > [167.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:15.466 > [167.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:15.567 > [167.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:15.668 > [167.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:15.769 > [167.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:15.870 > [167.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:15.971 > [168.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:16.072 > [168.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:16.172 > [168.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:16.273 > [168.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:16.374 > [168.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:16.476 > [168.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:16.577 > [168.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:16.677 > [168.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:16.778 > [168.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:16.879 > [168.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:16.980 > [169.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:17.082 > [169.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:17.182 > [169.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:17.284 > [169.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:17.384 > [169.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:17.485 > [169.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:17.587 > [169.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:17.687 > [169.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:17.788 > [169.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:17.890 > [170.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:17.991 > [170.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:18.091 > [170.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:18.192 > [170.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:18.292 > [170.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:18.394 > [170.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:18.496 > [170.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:18.597 > [170.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:18.697 > [170.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:18.798 > [170.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:18.900 > [171.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:19.000 > [171.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:19.102 > [171.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:19.202 > [171.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:19.304 > [171.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:19.404 > [171.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:19.409 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:19.416 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:34:19.421 > Generated health data: HR-62 SPO2-95 STEPS-887
18:34:19.423 > [ESP32] ========================================
18:34:19.429 > [ESP32] ENCRYPTION PIPELINE START
18:34:19.432 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:19.441 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:19.446 > [ESP32] ========================================
18:34:19.452 > [ESP32] MsgKeys: lfsrSeed=0x504A0EBE tnk[0..3]=62726DCD trn[0..3]=8E1852C2
18:34:19.457 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3838374D50
18:34:19.463 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3838374D5000000000000000 
18:34:19.471 > [ESP32][LFSR] Initializing - Seed: 0x504A0EBE SeedBe: 0xBE0E4A50 ChaosKey[0..3]: 62726DCD InitialTap: 0x0029 State: 0x504A0EBE
18:34:19.482 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
18:34:19.491 > 3_After_LFSR (32): F65C67668384D06D7BDB147DF2FC76C2 7AD64083ACE737E40CD21F190896B770 
18:34:19.498 > [ESP32][LFSR] Keystream (first 16 bytes): BE0E4A50B1A4833D34E93944C7DC2596
18:34:19.504 > [ESP32][4D] LFSR keystream (first 32 bytes): BE0E4A50B1A4833D34E93944C7DC25963F8613AE94DF00A95CD21F190896B770
18:34:19.512 > [ESP32][TINKERBELL] Input (first 16 bytes): F65C67668384D06D7BDB147DF2FC76C2 Nonce: 0x00000001 Buffer size: 32 bytes
18:34:19.523 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 62726DCD
18:34:19.535 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A50D9C02AA33E30299E03CAB3000FB08
18:34:19.543 > 4_After_Tinkerbell (32): 5351FB6429B7336FE23B28D6C2FC8DCA 6EE2BB3BF2B672F5DC95C8B4A706D9A6 
18:34:19.549 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A50D9C02AA33E30299E03CAB3000FB08
18:34:19.557 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A50D9C02AA33E30299E03CAB3000FB081434FBB85E514511D047D7ADAF906ED6
18:34:19.569 > 5_After_Transposition (32): 6FBBF26453FC3351CA28C2D6E2B7723B F5FB293B6EB68DE2DCA7D9A69506B4C8 
18:34:19.576 > [ESP32] === HMAC DEBUG INFO ===
18:34:19.579 > [ESP32] HMAC Key being used: E73E530603BC4921A8935E61EDC74BA1D1F8AB245A88871DEF09335BF746A2F9
18:34:19.588 > [ESP32] HMAC Input length: 44 bytes
18:34:19.591 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000016FBBF26453FC3351CA28C2D6E2B7723BF5FB293B
18:34:19.598 > [ESP32] Nonce: 0x00000001
18:34:19.602 > [ESP32] Packet size before HMAC: 60
18:34:19.604 > [ESP32] Computed HMAC Tag: 4791728C72D06DE3D61CC0B8FAB12CA6
18:34:19.610 > [ESP32] === END HMAC DEBUG ===
18:34:19.612 > 6_Final_Packet (60): 8102170017000408000000016FBBF264 53FC3351CA28C2D6E2B7723BF5FB293B ...
18:34:19.621 > [RETRY] Attempt 1/3 (nonce: 1)
18:34:19.624 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:19.631 > Sending pipeline data to server (655 bytes)
18:34:19.901 > [HTTP] Response code: 400
18:34:19.901 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:19.906 > [HTTP] Request failed with code: 400
18:34:19.909 > [RETRY] Send failed, waiting 100 ms before retry
18:34:20.010 > [RETRY] Attempt 2/3 (nonce: 1)
18:34:20.010 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:20.015 > Sending pipeline data to server (655 bytes)
18:34:20.159 > [HTTP] Response code: 400
18:34:20.159 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:20.164 > [HTTP] Request failed with code: 400
18:34:20.167 > [RETRY] Send failed, waiting 200 ms before retry
18:34:20.368 > [RETRY] Attempt 3/3 (nonce: 1)
18:34:20.368 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:20.373 > Sending pipeline data to server (655 bytes)
18:34:20.662 > [HTTP] Response code: 400
18:34:20.662 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:20.667 > [HTTP] Request failed with code: 400
18:34:20.669 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:34:20.675 > [RETRY] Consecutive failures: 5
18:34:20.677 > [EMERGENCY] Triggering emergency reset!
18:34:20.681 > [CRYPTO] Resetting cryptographic state
18:34:20.686 > [CRYPTO] Crypto state reset complete
18:34:20.690 > [CRYPTO] Packet counter: 2
18:34:20.692 > [EMERGENCY] Emergency reset complete
18:34:20.695 > Health data send failed (retry count: 1/3)
18:34:20.792 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":171969,"type":"health_data_error"}
18:34:20.806 > [WebSocket] Processing message type: health_data_error
18:34:20.812 > [172.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:20.820 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:20.826 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:34:20.831 > Generated health data: HR-62 SPO2-95 STEPS-862
18:34:20.833 > [ESP32] ========================================
18:34:20.839 > [ESP32] ENCRYPTION PIPELINE START
18:34:20.842 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:20.848 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:20.856 > [ESP32] ========================================
18:34:20.858 > [ESP32] MsgKeys: lfsrSeed=0x504A0EBE tnk[0..3]=62726DCD trn[0..3]=8E1852C2
18:34:20.865 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3836324D50
18:34:20.873 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3836324D5000000000000000 
18:34:20.881 > [ESP32][LFSR] Initializing - Seed: 0x504A0EBE SeedBe: 0xBE0E4A50 ChaosKey[0..3]: 62726DCD InitialTap: 0x0029 State: 0x504A0EBE
18:34:20.892 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
18:34:20.898 > 3_After_LFSR (32): F65C67668384D06D7BDB147DF2FC76C2 7AD64083ACE932E40CD21F190896B770 
18:34:20.906 > [ESP32][LFSR] Keystream (first 16 bytes): BE0E4A50B1A4833D34E93944C7DC2596
18:34:20.914 > [ESP32][4D] LFSR keystream (first 32 bytes): BE0E4A50B1A4833D34E93944C7DC25963F8613AE94DF00A95CD21F190896B770
18:34:20.923 > [ESP32][TINKERBELL] Input (first 16 bytes): F65C67668384D06D7BDB147DF2FC76C2 Nonce: 0x00000001 Buffer size: 32 bytes
18:34:20.934 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 62726DCD
18:34:20.942 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A50D9C02AA33E30299E03CAB3000FB08
18:34:20.951 > 4_After_Tinkerbell (32): 5351FB6429B7336FE23B28D6C2FC8DCA 6EE2BB3BF2B877F5DC95C8B4A706D9A6 
18:34:20.958 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A50D9C02AA33E30299E03CAB3000FB08
18:34:20.967 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A50D9C02AA33E30299E03CAB3000FB081434FBB85E514511D047D7ADAF906ED6
18:34:20.978 > 5_After_Transposition (32): 6FBBF26453FC3351CA28C2D6E2B7773B F5FB293B6EB88DE2DCA7D9A69506B4C8 
18:34:20.986 > [ESP32] === HMAC DEBUG INFO ===
18:34:20.990 > [ESP32] HMAC Key being used: E73E530603BC4921A8935E61EDC74BA1D1F8AB245A88871DEF09335BF746A2F9
18:34:20.995 > [ESP32] HMAC Input length: 44 bytes
18:34:21.000 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000016FBBF26453FC3351CA28C2D6E2B7773BF5FB293B
18:34:21.008 > [ESP32] Nonce: 0x00000001
18:34:21.011 > [ESP32] Packet size before HMAC: 60
18:34:21.015 > [ESP32] Computed HMAC Tag: 07AEC7BA5424982D864597B659D4875D
18:34:21.019 > [ESP32] === END HMAC DEBUG ===
18:34:21.022 > 6_Final_Packet (60): 8102170017000408000000016FBBF264 53FC3351CA28C2D6E2B7773BF5FB293B ...
18:34:21.031 > [RETRY] Attempt 1/3 (nonce: 1)
18:34:21.031 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:21.037 > Sending pipeline data to server (655 bytes)
18:34:21.186 > [HTTP] Response code: 400
18:34:21.186 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:21.191 > [HTTP] Request failed with code: 400
18:34:21.194 > [RETRY] Send failed, waiting 100 ms before retry
18:34:21.294 > [RETRY] Attempt 2/3 (nonce: 1)
18:34:21.294 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:21.299 > Sending pipeline data to server (655 bytes)
18:34:21.423 > [HTTP] Response code: 400
18:34:21.423 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:21.429 > [HTTP] Request failed with code: 400
18:34:21.432 > [RETRY] Send failed, waiting 200 ms before retry
18:34:21.632 > [RETRY] Attempt 3/3 (nonce: 1)
18:34:21.632 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:21.637 > Sending pipeline data to server (655 bytes)
18:34:21.958 > [HTTP] Response code: 400
18:34:21.958 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:21.964 > [HTTP] Request failed with code: 400
18:34:21.966 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:34:21.971 > [RETRY] Consecutive failures: 1
18:34:21.975 > Health data send failed (retry count: 2/3)
18:34:22.077 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":172227,"type":"health_data_error"}
18:34:22.091 > [WebSocket] Processing message type: health_data_error
18:34:22.096 > [174.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:22.104 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:22.110 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:34:22.116 > Generated health data: HR-62 SPO2-95 STEPS-879
18:34:22.118 > [ESP32] ========================================
18:34:22.124 > [ESP32] ENCRYPTION PIPELINE START
18:34:22.127 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:22.132 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:22.141 > [ESP32] ========================================
18:34:22.143 > [ESP32] MsgKeys: lfsrSeed=0x504A0EBE tnk[0..3]=62726DCD trn[0..3]=8E1852C2
18:34:22.148 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3837394D50
18:34:22.157 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3837394D5000000000000000 
18:34:22.165 > [ESP32][LFSR] Initializing - Seed: 0x504A0EBE SeedBe: 0xBE0E4A50 ChaosKey[0..3]: 62726DCD InitialTap: 0x0029 State: 0x504A0EBE
18:34:22.177 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
18:34:22.182 > 3_After_LFSR (32): F65C67668384D06D7BDB147DF2FC76C2 7AD64083ACE839E40CD21F190896B770 
18:34:22.191 > [ESP32][LFSR] Keystream (first 16 bytes): BE0E4A50B1A4833D34E93944C7DC2596
18:34:22.198 > [ESP32][4D] LFSR keystream (first 32 bytes): BE0E4A50B1A4833D34E93944C7DC25963F8613AE94DF00A95CD21F190896B770
18:34:22.207 > [ESP32][TINKERBELL] Input (first 16 bytes): F65C67668384D06D7BDB147DF2FC76C2 Nonce: 0x00000001 Buffer size: 32 bytes
18:34:22.218 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 62726DCD
18:34:22.226 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A50D9C02AA33E30299E03CAB3000FB08
18:34:22.235 > 4_After_Tinkerbell (32): 5351FB6429B7336FE23B28D6C2FC8DCA 6EE2BB3BF2B97CF5DC95C8B4A706D9A6 
18:34:22.243 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A50D9C02AA33E30299E03CAB3000FB08
18:34:22.252 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A50D9C02AA33E30299E03CAB3000FB081434FBB85E514511D047D7ADAF906ED6
18:34:22.263 > 5_After_Transposition (32): 6FBBF26453FC3351CA28C2D6E2B77C3B F5FB293B6EB98DE2DCA7D9A69506B4C8 
18:34:22.271 > [ESP32] === HMAC DEBUG INFO ===
18:34:22.273 > [ESP32] HMAC Key being used: E73E530603BC4921A8935E61EDC74BA1D1F8AB245A88871DEF09335BF746A2F9
18:34:22.279 > [ESP32] HMAC Input length: 44 bytes
18:34:22.285 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000016FBBF26453FC3351CA28C2D6E2B77C3BF5FB293B
18:34:22.293 > [ESP32] Nonce: 0x00000001
18:34:22.296 > [ESP32] Packet size before HMAC: 60
18:34:22.298 > [ESP32] Computed HMAC Tag: 97C82BF3B218114FDEDA0921838E8174
18:34:22.305 > [ESP32] === END HMAC DEBUG ===
18:34:22.307 > 6_Final_Packet (60): 8102170017000408000000016FBBF264 53FC3351CA28C2D6E2B77C3BF5FB293B ...
18:34:22.315 > [RETRY] Attempt 1/3 (nonce: 1)
18:34:22.316 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:22.321 > Sending pipeline data to server (655 bytes)
18:34:22.673 > [HTTP] Response code: 400
18:34:22.673 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:22.678 > [HTTP] Request failed with code: 400
18:34:22.680 > [RETRY] Send failed, waiting 100 ms before retry
18:34:22.780 > [RETRY] Attempt 2/3 (nonce: 1)
18:34:22.780 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:22.786 > Sending pipeline data to server (655 bytes)
18:34:22.924 > [HTTP] Response code: 400
18:34:22.924 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:22.929 > [HTTP] Request failed with code: 400
18:34:22.931 > [RETRY] Send failed, waiting 200 ms before retry
18:34:23.130 > [RETRY] Attempt 3/3 (nonce: 1)
18:34:23.131 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:23.135 > Sending pipeline data to server (655 bytes)
18:34:23.440 > [HTTP] Response code: 400
18:34:23.440 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:23.445 > [HTTP] Request failed with code: 400
18:34:23.448 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:34:23.454 > [RETRY] Consecutive failures: 2
18:34:23.456 > Health data send failed (retry count: 3/3)
18:34:23.459 > Health data transmission failed after max retries
18:34:23.559 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":172730,"type":"health_data_error"}
18:34:23.573 > [WebSocket] Processing message type: health_data_error
18:34:23.578 > [175.6] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:23.587 > ERROR state - attempting recovery
18:34:23.589 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:23.595 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:34:23.598 > Generated health data: HR-62 SPO2-95 STEPS-907
18:34:23.603 > [ESP32] ========================================
18:34:23.605 > [ESP32] ENCRYPTION PIPELINE START
18:34:23.609 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:23.617 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:23.623 > [ESP32] ========================================
18:34:23.628 > [ESP32] MsgKeys: lfsrSeed=0x504A0EBE tnk[0..3]=62726DCD trn[0..3]=8E1852C2
18:34:23.634 > 1_After_Salt (25): 48522D36322053504F322D3935205354 4550532D3930374D50
18:34:23.639 > 2_After_Padding (32): 48522D36322053504F322D3935205354 4550532D3930374D5000000000000000 
18:34:23.647 > [ESP32][LFSR] Initializing - Seed: 0x504A0EBE SeedBe: 0xBE0E4A50 ChaosKey[0..3]: 62726DCD InitialTap: 0x0029 State: 0x504A0EBE
18:34:23.659 > [ESP32][LFSR] Input (first 16 bytes): 48522D36322053504F322D3935205354 Buffer size: 32 bytes
18:34:23.667 > 3_After_LFSR (32): F65C67668384D06D7BDB147DF2FC76C2 7AD64083ADEF37E40CD21F190896B770 
18:34:23.675 > [ESP32][LFSR] Keystream (first 16 bytes): BE0E4A50B1A4833D34E93944C7DC2596
18:34:23.681 > [ESP32][4D] LFSR keystream (first 32 bytes): BE0E4A50B1A4833D34E93944C7DC25963F8613AE94DF00A95CD21F190896B770
18:34:23.692 > [ESP32][TINKERBELL] Input (first 16 bytes): F65C67668384D06D7BDB147DF2FC76C2 Nonce: 0x00000001 Buffer size: 32 bytes
18:34:23.700 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 62726DCD
18:34:23.711 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): A50D9C02AA33E30299E03CAB3000FB08
18:34:23.720 > 4_After_Tinkerbell (32): 5351FB6429B7336FE23B28D6C2FC8DCA 6EE2BB3BF3BE72F5DC95C8B4A706D9A6 
18:34:23.727 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): A50D9C02AA33E30299E03CAB3000FB08
18:34:23.736 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): A50D9C02AA33E30299E03CAB3000FB081434FBB85E514511D047D7ADAF906ED6
18:34:23.744 > 5_After_Transposition (32): 6FBBF36453FC3351CA28C2D6E2B7723B F5FB293B6EBE8DE2DCA7D9A69506B4C8 
18:34:23.753 > [ESP32] === HMAC DEBUG INFO ===
18:34:23.755 > [ESP32] HMAC Key being used: E73E530603BC4921A8935E61EDC74BA1D1F8AB245A88871DEF09335BF746A2F9
18:34:23.764 > [ESP32] HMAC Input length: 44 bytes
18:34:23.767 > [ESP32] HMAC Input (first 32 bytes): 8102170017000408000000016FBBF36453FC3351CA28C2D6E2B7723BF5FB293B
18:34:23.778 > [ESP32] Nonce: 0x00000001
18:34:23.778 > [ESP32] Packet size before HMAC: 60
18:34:23.783 > [ESP32] Computed HMAC Tag: 30A038828B360DB9F81F8303F307CAAB
18:34:23.786 > [ESP32] === END HMAC DEBUG ===
18:34:23.789 > 6_Final_Packet (60): 8102170017000408000000016FBBF364 53FC3351CA28C2D6E2B7723BF5FB293B ...
18:34:23.798 > [RETRY] Attempt 1/3 (nonce: 1)
18:34:23.801 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:23.806 > Sending pipeline data to server (655 bytes)
18:34:23.934 > [HTTP] Response code: 400
18:34:23.934 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:23.940 > [HTTP] Request failed with code: 400
18:34:23.942 > [RETRY] Send failed, waiting 100 ms before retry
18:34:24.043 > [RETRY] Attempt 2/3 (nonce: 1)
18:34:24.043 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:24.049 > Sending pipeline data to server (655 bytes)
18:34:24.439 > [HTTP] Response code: 400
18:34:24.439 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:24.445 > [HTTP] Request failed with code: 400
18:34:24.448 > [RETRY] Send failed, waiting 200 ms before retry
18:34:24.649 > [RETRY] Attempt 3/3 (nonce: 1)
18:34:24.650 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:24.655 > Sending pipeline data to server (655 bytes)
18:34:24.940 > [HTTP] Response code: 400
18:34:24.940 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:24.945 > [HTTP] Request failed with code: 400
18:34:24.948 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:34:24.952 > [RETRY] Consecutive failures: 3
18:34:24.956 > ✗ Auto-recovery failed - restarting key exchange
18:34:27.063 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":173254,"type":"health_data_error"}
18:34:27.076 > [WebSocket] Processing message type: health_data_error
18:34:27.082 > [179.1] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:27.091 > ✓ Public key loaded from NVS
18:34:27.190 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":173492,"type":"health_data_error"}
18:34:27.203 > [WebSocket] Processing message type: health_data_error
18:34:27.209 > [179.3] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:27.312 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":174027,"type":"health_data_error"}
18:34:27.326 > [WebSocket] Processing message type: health_data_error
18:34:27.332 > [179.4] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:27.340 > Generating fresh master key from entropy...
18:34:27.349 > Generated master key (32): 8685A0B7765A2346138ED80B8B285E0D EEDD32093DD4C8E5248E4F4D92CB1D67 
18:34:27.354 > Using reduced master key (byte % 3) for NTRU encryption only
18:34:27.365 > NTRU encrypted master key (502): 0064005A00400065001600440008006C 00370004001E000E006C006F0022000D ...
18:34:27.373 > POST http://10.249.92.115:8081/master-key
18:34:27.700 > ✓ Master key exchange completed
18:34:27.803 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":174741,"type":"health_data_error"}
18:34:27.817 > [WebSocket] Processing message type: health_data_error
18:34:27.822 > [179.9] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:27.830 > Loading master key from NVS and deriving symmetric keys...
18:34:27.836 > Loaded master key from NVS (32): 8685A0B7765A2346138ED80B8B285E0D EEDD32093DD4C8E5248E4F4D92CB1D67 
18:34:27.844 > Derived HMAC key (32): A566C59C610A0AE9CB6D2E6C5998E212 0E695853C48378A6D3FE19047108C1EE 
18:34:27.853 > Derived Tinkerbell key (16): 4FD7FE83D2D4ECFB8B3977CE811836C7 
18:34:27.859 > Derived Transposition key (16): 809183DF4EE093E1A6755A58EE64DCD8 
18:34:27.864 > ✓ Symmetric keys derived successfully
18:34:27.867 > Nonce tracker reset - new session started
18:34:28.363 > Waiting for server to process master key...
18:34:28.367 > ✓ Symmetric keys ready - starting health data transmission
18:34:28.469 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":174992,"type":"health_data_error"}
18:34:28.482 > [WebSocket] Processing message type: health_data_error
18:34:28.488 > [180.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:28.591 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":7,"success":false,"timestamp":175509,"type":"health_data_error"}
18:34:28.605 > [WebSocket] Processing message type: health_data_error
18:34:28.611 > [180.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:28.714 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":8,"success":false,"timestamp":176003,"type":"health_data_error"}
18:34:28.727 > [WebSocket] Processing message type: health_data_error
18:34:28.733 > [180.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:28.836 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":8,"success":false,"timestamp":176508,"type":"health_data_error"}
18:34:28.850 > [WebSocket] Processing message type: health_data_error
18:34:28.856 > [180.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:28.959 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Failed to send health data","state":8,"success":false,"timestamp":177008,"type":"health_data_error"}
18:34:28.973 > [WebSocket] Processing message type: health_data_error
18:34:28.978 > [181.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:29.081 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770123867471,"type":"master_key_received"}
18:34:29.094 > [WebSocket] Processing message type: master_key_received
18:34:29.097 > [181.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:29.202 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":179762,"type":"master_key_exchanged"}
18:34:29.219 > [WebSocket] Processing message type: master_key_exchanged
18:34:29.224 > [181.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:29.325 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":180431,"type":"symmetric_keys_derived"}
18:34:29.341 > [WebSocket] Processing message type: symmetric_keys_derived
18:34:29.347 > [181.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:29.446 > [181.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:29.547 > [181.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:29.648 > [181.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:29.749 > [181.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:29.850 > [181.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:29.951 > [182.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:30.052 > [182.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:30.153 > [182.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:30.254 > [182.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:30.355 > [182.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:30.456 > [182.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:30.557 > [182.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:30.658 > [182.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:30.758 > [182.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:30.860 > [182.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:30.961 > [183.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:31.062 > [183.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:31.163 > [183.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:31.264 > [183.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:31.365 > [183.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:31.466 > [183.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:31.567 > [183.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:31.668 > [183.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:31.769 > [183.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:31.869 > [183.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:31.971 > [184.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:32.071 > [184.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:32.173 > [184.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:32.273 > [184.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:32.374 > [184.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:32.476 > [184.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:32.576 > [184.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:32.678 > [184.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:32.778 > [184.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:32.879 > [184.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:32.981 > [185.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:33.082 > [185.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:33.183 > [185.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:33.283 > [185.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:33.384 > [185.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:33.485 > [185.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:33.587 > [185.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:33.688 > [185.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:33.789 > [185.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:33.890 > [186.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:33.991 > [186.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:34.092 > [186.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:34.192 > [186.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:34.294 > [186.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:34.395 > [186.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:34.495 > [186.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:34.597 > [186.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:34.698 > [186.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:34.798 > [186.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:34.900 > [187.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:35.001 > [187.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:35.102 > [187.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:35.203 > [187.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:35.304 > [187.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:35.405 > [187.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:35.506 > [187.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:35.606 > [187.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:35.707 > [187.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:35.808 > [187.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:35.909 > [188.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:36.010 > [188.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:36.111 > [188.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:36.212 > [188.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:36.314 > [188.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:36.415 > [188.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:36.516 > [188.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:36.617 > [188.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:36.718 > [188.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:36.819 > [188.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:36.920 > [189.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:37.021 > [189.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:37.122 > [189.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:37.223 > [189.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:37.324 > [189.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:37.425 > [189.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:37.525 > [189.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:37.627 > [189.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:37.727 > [189.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:37.829 > [189.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:37.930 > [190.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:38.031 > [190.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:38.132 > [190.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:38.233 > [190.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:38.334 > [190.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:38.434 > [190.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 7 | WS: CONNECTED
18:34:38.440 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:38.446 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:34:38.452 > Generated health data: HR-63 SPO2-95 STEPS-952
18:34:38.455 > [ESP32] ========================================
18:34:38.459 > [ESP32] ENCRYPTION PIPELINE START
18:34:38.463 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:38.470 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:38.476 > [ESP32] ========================================
18:34:38.482 > [ESP32] MsgKeys: lfsrSeed=0x4CAE82ED tnk[0..3]=FD92B20F trn[0..3]=7B2E4B31
18:34:38.488 > 1_After_Salt (25): 48522D36332053504F322D3935205354 4550532D3935324D50
18:34:38.493 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D3935324D5000000000000000 
18:34:38.502 > [ESP32][LFSR] Initializing - Seed: 0x4CAE82ED SeedBe: 0xED82AE4C ChaosKey[0..3]: FD92B20F InitialTap: 0x0029 State: 0x4CAE82ED
18:34:38.513 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
18:34:38.521 > 3_After_LFSR (32): A5D0837A75D14599205CCD9E053F565F FA09AA9F643CF05463A101AAC5405BFF 
18:34:38.529 > [ESP32][LFSR] Keystream (first 16 bytes): ED82AE4C46F116C96F6EE0A7301F050B
18:34:38.535 > [ESP32][4D] LFSR keystream (first 32 bytes): ED82AE4C46F116C96F6EE0A7301F050BBF59F9B25D09C21933A101AAC5405BFF
18:34:38.543 > [ESP32][TINKERBELL] Input (first 16 bytes): A5D0837A75D14599205CCD9E053F565F Nonce: 0x00000001 Buffer size: 32 bytes
18:34:38.554 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: FD92B20F
18:34:38.566 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): DA1DBE2BFDDDE322F7198AD7D14AFA39
18:34:38.573 > 4_After_Tinkerbell (32): 7FCD3D51880CA6BBD7454749D475AC66 C02AD87325CBF8921F269EC0E3260409 
18:34:38.579 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): DA1DBE2BFDDDE322F7198AD7D14AFA39
18:34:38.588 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): DA1DBE2BFDDDE322F7198AD7D14AFA393A2372EC41F708C67C879F6A26665FF6
18:34:38.598 > 5_After_Transposition (32): 51880C9E1F26BBA649D4753D7FCD66AC 7325CB47D74592F8C0E326D8C02A0904 
18:34:38.607 > [ESP32] === HMAC DEBUG INFO ===
18:34:38.609 > [ESP32] HMAC Key being used: A566C59C610A0AE9CB6D2E6C5998E2120E695853C48378A6D3FE19047108C1EE
18:34:38.618 > [ESP32] HMAC Input length: 44 bytes
18:34:38.621 > [ESP32] HMAC Input (first 32 bytes): 81021700170004080000000151880C9E1F26BBA649D4753D7FCD66AC7325CB47
18:34:38.630 > [ESP32] Nonce: 0x00000001
18:34:38.633 > [ESP32] Packet size before HMAC: 60
18:34:38.635 > [ESP32] Computed HMAC Tag: 1588D28BB178C374FA4F2279A0F9B444
18:34:38.641 > [ESP32] === END HMAC DEBUG ===
18:34:38.643 > 6_Final_Packet (60): 81021700170004080000000151880C9E 1F26BBA649D4753D7FCD66AC7325CB47 ...
18:34:38.652 > [RETRY] Attempt 1/3 (nonce: 1)
18:34:38.655 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:38.661 > Sending pipeline data to server (655 bytes)
18:34:38.957 > [HTTP] Response code: 200
18:34:38.957 > [HTTP] Response: {"status":"OK:DECRYPTED"}
18:34:38.967 > [RETRY] Health data sent successfully!
18:34:38.971 > ✓ Health data #8 sent successfully
18:34:39.073 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":1,"serverTime":1770123878740,"type":"security_update"}
18:34:39.089 > [WebSocket] Processing message type: security_update
18:34:39.096 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
18:34:39.101 > [191.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:39.206 > [WebSocket] Received (682 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","encData":"ENC_DATA:81021700170004080000000151880C9E1F26BBA649D4753D7FCD66AC7325CB47D74592F8C0E326D8C02A09041588D28BB178C374FA4F2279A0F9B444","pipeline":{"afterLFSR":"A5D0837A75D14599205CCD9E053F565FFA09AA9F643CF05463A101AAC5405BFF","afterSalt":"48522D36332053504F322D39352053544550532D3935324D50","afterTinkerbell":"7FCD3D51880CA6BBD7454749D475AC66C02AD87325CBF8921F269EC0E3260409","afterTransposition":"51880C9E1F26BBA649D4753D7FCD66AC7325CB47D74592F8C0E326D8C02A0904"},"plaintext":"HR-63 SPO2-95 STEPS-952","serverTime":1770123878740,"timestamp":190729,"type":"encryption_update","ztmEnabled":false}
18:34:39.267 > [WebSocket] Processing message type: encryption_update
18:34:39.273 > [191.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:39.380 > [WebSocket] Received (87 bytes): {"heartRate":63,"spo2":95,"steps":952,"time":1770123878740,"type":"health_data_update"}
18:34:39.388 > [WebSocket] Processing message type: health_data_update
18:34:39.394 > [191.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:39.502 > [WebSocket] Received (225 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3134,"encryptionTime":0.0,"finalPlaintext":"HR-63 SPO2-95 STEPS-952","handshakeSuccess":true,"totalTime":0.3134},"type":"session_summary_update"}
18:34:39.525 > [WebSocket] Processing message type: session_summary_update
18:34:39.530 > [191.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:39.636 > [WebSocket] Received (656 bytes): {"decryptionTime":0.3134,"encryptedPacket":"81021700170004080000000151880C9E1F26BBA649D4753D7FCD66AC7325CB47D74592F8C0E326D8C02A09041588D28BB178C374FA4F2279A0F9B444","finalPlaintext":"HR-63 SPO2-95 STEPS-952","healthData":{"heartRate":63,"spo2":95,"steps":952},"pipeline":{"afterDepad":"48522D36332053504F322D39352053544550532D39353200000000000000","afterLFSR":"48522D36332053504F322D39352053544550532D3935324D5000000000000000","afterTinkerbell":"A5D0837A75D14599205CCD9E053F565FFA09AA9F643CF05463A101AAC5405BFF","afterTransposition":"7FCD3D51880CA6BBD7454749D475AC66C02AD87325CBF8921F269EC0E3260409"},"serverTime":1770123878741,"type":"decryption_update"}
18:34:39.694 > [WebSocket] Processing message type: decryption_update
18:34:39.699 > [WebSocket] Server decryption completed
18:34:39.702 > [WebSocket] Health data - HR: 63, SPO2: 95, Steps: 952
18:34:39.708 > [191.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:39.809 > [WebSocket] Received (694 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","healthSendCount":7,"pipeline":{"afterLFSR":"A5D0837A75D14599205CCD9E053F565FFA09AA9F643CF05463A101AAC5405BFF","afterSalt":"48522D36332053504F322D39352053544550532D3935324D50","afterTinkerbell":"7FCD3D51880CA6BBD7454749D475AC66C02AD87325CBF8921F269EC0E3260409","afterTransposition":"51880C9E1F26BBA649D4753D7FCD66AC7325CB47D74592F8C0E326D8C02A0904","finalPacket":"81021700170004080000000151880C9E1F26BBA649D4753D7FCD66AC7325CB47D74592F8C0E326D8C02A09041588D28BB178C374FA4F2279A0F9B444"},"plaintext":"HR-63 SPO2-95 STEPS-952","timestamp":191026,"type":"encryption_pipeline","ztmEnabled":false}
18:34:39.871 > [WebSocket] Processing message type: encryption_pipeline
18:34:39.876 > [191.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:39.983 > [WebSocket] Received (158 bytes): {"deviceId":"f9641d44","healthSendCount":7,"message":"Health data #8 sent successfully","state":7,"success":true,"timestamp":191031,"type":"health_data_sent"}
18:34:40.000 > [WebSocket] Processing message type: health_data_sent
18:34:40.003 > [192.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:40.105 > [192.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:40.206 > [192.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:40.307 > [192.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:40.408 > [192.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:40.509 > [192.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:40.609 > [192.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:40.711 > [192.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:40.811 > [192.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:40.913 > [193.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:41.014 > [193.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:41.115 > [193.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:41.216 > [193.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:41.316 > [193.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:41.417 > [193.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:41.518 > [193.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:41.619 > [193.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:41.721 > [193.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:41.822 > [193.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:41.922 > [194.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:42.024 > [194.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:42.125 > [194.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:42.225 > [194.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:42.327 > [194.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:42.427 > [194.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:42.529 > [194.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:42.629 > [194.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:42.731 > [194.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:42.831 > [194.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:42.932 > [195.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:43.034 > [195.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:43.135 > [195.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:43.235 > [195.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:43.337 > [195.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:43.438 > [195.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:43.539 > [195.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:43.639 > [195.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:43.740 > [195.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:43.841 > [195.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:43.942 > [196.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:44.044 > [196.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:44.144 > [196.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:44.245 > [196.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:44.347 > [196.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:44.448 > [196.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:44.549 > [196.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:44.650 > [196.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:44.751 > [196.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:44.852 > [196.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:44.952 > [197.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:45.054 > [197.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:45.154 > [197.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:45.256 > [197.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:45.357 > [197.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:45.458 > [197.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:45.558 > [197.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:45.659 > [197.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:45.761 > [197.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:45.861 > [197.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:45.963 > [198.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:46.063 > [198.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:46.165 > [198.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:46.265 > [198.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:46.367 > [198.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:46.467 > [198.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:46.569 > [198.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:46.669 > [198.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:46.770 > [198.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:46.871 > [198.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:46.973 > [199.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:47.073 > [199.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:47.175 > [199.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:47.275 > [199.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:47.377 > [199.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:47.478 > [199.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:47.579 > [199.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:47.679 > [199.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:47.781 > [199.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:47.881 > [199.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:47.983 > [200.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:48.083 > [200.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:48.185 > [200.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:48.286 > [200.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:48.386 > [200.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:48.488 > [200.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:48.589 > [200.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:48.690 > [200.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:48.791 > [200.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:48.891 > [201.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:48.992 > [201.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:48.998 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:49.004 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:34:49.009 > Generated health data: HR-63 SPO2-95 STEPS-1006
18:34:49.012 > [ESP32] ========================================
18:34:49.018 > [ESP32] ENCRYPTION PIPELINE START
18:34:49.021 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:49.029 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:49.035 > [ESP32] ========================================
18:34:49.040 > [ESP32] MsgKeys: lfsrSeed=0xF78D88C2 tnk[0..3]=A16B8A1D trn[0..3]=4690A795
18:34:49.046 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313030364D50
18:34:49.051 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313030364D50000000000000 
18:34:49.059 > [ESP32][LFSR] Initializing - Seed: 0xF78D88C2 SeedBe: 0xC2888DF7 ChaosKey[0..3]: A16B8A1D InitialTap: 0x0029 State: 0xF78D88C2
18:34:49.071 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
18:34:49.079 > 3_After_LFSR (32): 8ADAA0C1CADEE6E847A901B6A8A3B3FA A5922D6BED618B5274CF079EF9292631 
18:34:49.087 > [ESP32][LFSR] Keystream (first 16 bytes): C2888DF7F9FEB5B8089B2C8F9D83E0AE
18:34:49.092 > [ESP32][4D] LFSR keystream (first 32 bytes): C2888DF7F9FEB5B8089B2C8F9D83E0AEE0C27E46DC51BB64399F079EF9292631
18:34:49.101 > [ESP32][TINKERBELL] Input (first 16 bytes): 8ADAA0C1CADEE6E847A901B6A8A3B3FA Nonce: 0x00000002 Buffer size: 32 bytes
18:34:49.113 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: A16B8A1D
18:34:49.123 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E8714C0FBEC4C9A6A3456E07FEFDB7A9
18:34:49.132 > 4_After_Tinkerbell (32): 62ABECCE741A2F4EE4EC6FB1565E0453 F5D905993F733AEEF1FF1DAAAF98C638 
18:34:49.140 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E8714C0FBEC4C9A6A3456E07FEFDB7A9
18:34:49.145 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E8714C0FBEC4C9A6A3456E07FEFDB7A9504B28F2D212B1BC85301A3456B1E009
18:34:49.157 > 5_After_Transposition (32): 055EAB3A3F4E62996F73EC045653E4B1 EC1AD92F74EEF5CEC6FF38F1AAAF981D 
18:34:49.165 > [ESP32] === HMAC DEBUG INFO ===
18:34:49.168 > [ESP32] HMAC Key being used: A566C59C610A0AE9CB6D2E6C5998E2120E695853C48378A6D3FE19047108C1EE
18:34:49.176 > [ESP32] HMAC Input length: 44 bytes
18:34:49.179 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002055EAB3A3F4E62996F73EC045653E4B1EC1AD92F
18:34:49.186 > [ESP32] Nonce: 0x00000002
18:34:49.190 > [ESP32] Packet size before HMAC: 60
18:34:49.193 > [ESP32] Computed HMAC Tag: 34904B624BBB2D3FCB375952DD489A72
18:34:49.198 > [ESP32] === END HMAC DEBUG ===
18:34:49.201 > 6_Final_Packet (60): 810218001800040800000002055EAB3A 3F4E62996F73EC045653E4B1EC1AD92F ...
18:34:49.210 > [RETRY] Attempt 1/3 (nonce: 2)
18:34:49.212 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:49.218 > Sending pipeline data to server (658 bytes)
18:34:49.454 > [HTTP] Response code: 400
18:34:49.454 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:49.460 > [HTTP] Request failed with code: 400
18:34:49.463 > [RETRY] Send failed, waiting 100 ms before retry
18:34:49.562 > [RETRY] Attempt 2/3 (nonce: 2)
18:34:49.562 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:49.567 > Sending pipeline data to server (658 bytes)
18:34:49.709 > [HTTP] Response code: 400
18:34:49.709 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:49.714 > [HTTP] Request failed with code: 400
18:34:49.717 > [RETRY] Send failed, waiting 200 ms before retry
18:34:49.917 > [RETRY] Attempt 3/3 (nonce: 2)
18:34:49.917 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:49.923 > Sending pipeline data to server (658 bytes)
18:34:50.213 > [HTTP] Response code: 400
18:34:50.213 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:50.219 > [HTTP] Request failed with code: 400
18:34:50.221 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:34:50.226 > [RETRY] Consecutive failures: 1
18:34:50.229 > Health data send failed (retry count: 1/3)
18:34:50.334 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":201524,"type":"health_data_error"}
18:34:50.347 > [WebSocket] Processing message type: health_data_error
18:34:50.353 > [202.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:50.361 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:50.368 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:34:50.373 > Generated health data: HR-63 SPO2-95 STEPS-1024
18:34:50.375 > [ESP32] ========================================
18:34:50.381 > [ESP32] ENCRYPTION PIPELINE START
18:34:50.384 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:50.390 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:50.397 > [ESP32] ========================================
18:34:50.400 > [ESP32] MsgKeys: lfsrSeed=0xF78D88C2 tnk[0..3]=A16B8A1D trn[0..3]=4690A795
18:34:50.408 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313032344D50
18:34:50.415 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313032344D50000000000000 
18:34:50.423 > [ESP32][LFSR] Initializing - Seed: 0xF78D88C2 SeedBe: 0xC2888DF7 ChaosKey[0..3]: A16B8A1D InitialTap: 0x0029 State: 0xF78D88C2
18:34:50.434 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
18:34:50.442 > 3_After_LFSR (32): 8ADAA0C1CADEE6E847A901B6A8A3B3FA A5922D6BED61895074CF079EF9292631 
18:34:50.448 > [ESP32][LFSR] Keystream (first 16 bytes): C2888DF7F9FEB5B8089B2C8F9D83E0AE
18:34:50.456 > [ESP32][4D] LFSR keystream (first 32 bytes): C2888DF7F9FEB5B8089B2C8F9D83E0AEE0C27E46DC51BB64399F079EF9292631
18:34:50.464 > [ESP32][TINKERBELL] Input (first 16 bytes): 8ADAA0C1CADEE6E847A901B6A8A3B3FA Nonce: 0x00000002 Buffer size: 32 bytes
18:34:50.475 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: A16B8A1D
18:34:50.484 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E8714C0FBEC4C9A6A3456E07FEFDB7A9
18:34:50.492 > 4_After_Tinkerbell (32): 62ABECCE741A2F4EE4EC6FB1565E0453 F5D905993F7338ECF1FF1DAAAF98C638 
18:34:50.500 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E8714C0FBEC4C9A6A3456E07FEFDB7A9
18:34:50.509 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E8714C0FBEC4C9A6A3456E07FEFDB7A9504B28F2D212B1BC85301A3456B1E009
18:34:50.520 > 5_After_Transposition (32): 055EAB383F4E62996F73EC045653E4B1 EC1AD92F74ECF5CEC6FF38F1AAAF981D 
18:34:50.527 > [ESP32] === HMAC DEBUG INFO ===
18:34:50.531 > [ESP32] HMAC Key being used: A566C59C610A0AE9CB6D2E6C5998E2120E695853C48378A6D3FE19047108C1EE
18:34:50.539 > [ESP32] HMAC Input length: 44 bytes
18:34:50.542 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002055EAB383F4E62996F73EC045653E4B1EC1AD92F
18:34:50.551 > [ESP32] Nonce: 0x00000002
18:34:50.554 > [ESP32] Packet size before HMAC: 60
18:34:50.556 > [ESP32] Computed HMAC Tag: 822BA5FCA8408627F112E8196382662F
18:34:50.561 > [ESP32] === END HMAC DEBUG ===
18:34:50.564 > 6_Final_Packet (60): 810218001800040800000002055EAB38 3F4E62996F73EC045653E4B1EC1AD92F ...
18:34:50.573 > [RETRY] Attempt 1/3 (nonce: 2)
18:34:50.575 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:50.581 > Sending pipeline data to server (658 bytes)
18:34:50.716 > [HTTP] Response code: 400
18:34:50.716 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:50.722 > [HTTP] Request failed with code: 400
18:34:50.724 > [RETRY] Send failed, waiting 100 ms before retry
18:34:50.824 > [RETRY] Attempt 2/3 (nonce: 2)
18:34:50.824 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:50.829 > Sending pipeline data to server (658 bytes)
18:34:51.191 > [HTTP] Response code: 400
18:34:51.191 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:51.196 > [HTTP] Request failed with code: 400
18:34:51.198 > [RETRY] Send failed, waiting 200 ms before retry
18:34:51.399 > [RETRY] Attempt 3/3 (nonce: 2)
18:34:51.400 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:51.404 > Sending pipeline data to server (658 bytes)
18:34:51.715 > [HTTP] Response code: 400
18:34:51.715 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:51.721 > [HTTP] Request failed with code: 400
18:34:51.723 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:34:51.728 > [RETRY] Consecutive failures: 2
18:34:51.731 > Health data send failed (retry count: 2/3)
18:34:51.836 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":201778,"type":"health_data_error"}
18:34:51.850 > [WebSocket] Processing message type: health_data_error
18:34:51.855 > [203.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:51.863 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:51.869 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:34:51.874 > Generated health data: HR-63 SPO2-95 STEPS-1026
18:34:51.877 > [ESP32] ========================================
18:34:51.883 > [ESP32] ENCRYPTION PIPELINE START
18:34:51.885 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:51.891 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:51.899 > [ESP32] ========================================
18:34:51.903 > [ESP32] MsgKeys: lfsrSeed=0xF78D88C2 tnk[0..3]=A16B8A1D trn[0..3]=4690A795
18:34:51.910 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313032364D50
18:34:51.916 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313032364D50000000000000 
18:34:51.924 > [ESP32][LFSR] Initializing - Seed: 0xF78D88C2 SeedBe: 0xC2888DF7 ChaosKey[0..3]: A16B8A1D InitialTap: 0x0029 State: 0xF78D88C2
18:34:51.936 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
18:34:51.944 > 3_After_LFSR (32): 8ADAA0C1CADEE6E847A901B6A8A3B3FA A5922D6BED61895274CF079EF9292631 
18:34:51.950 > [ESP32][LFSR] Keystream (first 16 bytes): C2888DF7F9FEB5B8089B2C8F9D83E0AE
18:34:51.958 > [ESP32][4D] LFSR keystream (first 32 bytes): C2888DF7F9FEB5B8089B2C8F9D83E0AEE0C27E46DC51BB64399F079EF9292631
18:34:51.967 > [ESP32][TINKERBELL] Input (first 16 bytes): 8ADAA0C1CADEE6E847A901B6A8A3B3FA Nonce: 0x00000002 Buffer size: 32 bytes
18:34:51.977 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: A16B8A1D
18:34:51.986 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E8714C0FBEC4C9A6A3456E07FEFDB7A9
18:34:51.994 > 4_After_Tinkerbell (32): 62ABECCE741A2F4EE4EC6FB1565E0453 F5D905993F7338EEF1FF1DAAAF98C638 
18:34:52.002 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E8714C0FBEC4C9A6A3456E07FEFDB7A9
18:34:52.011 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E8714C0FBEC4C9A6A3456E07FEFDB7A9504B28F2D212B1BC85301A3456B1E009
18:34:52.022 > 5_After_Transposition (32): 055EAB383F4E62996F73EC045653E4B1 EC1AD92F74EEF5CEC6FF38F1AAAF981D 
18:34:52.030 > [ESP32] === HMAC DEBUG INFO ===
18:34:52.032 > [ESP32] HMAC Key being used: A566C59C610A0AE9CB6D2E6C5998E2120E695853C48378A6D3FE19047108C1EE
18:34:52.041 > [ESP32] HMAC Input length: 44 bytes
18:34:52.044 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002055EAB383F4E62996F73EC045653E4B1EC1AD92F
18:34:52.052 > [ESP32] Nonce: 0x00000002
18:34:52.055 > [ESP32] Packet size before HMAC: 60
18:34:52.057 > [ESP32] Computed HMAC Tag: 22C881330FBDD15C4A035F72D767B2A1
18:34:52.063 > [ESP32] === END HMAC DEBUG ===
18:34:52.066 > 6_Final_Packet (60): 810218001800040800000002055EAB38 3F4E62996F73EC045653E4B1EC1AD92F ...
18:34:52.074 > [RETRY] Attempt 1/3 (nonce: 2)
18:34:52.077 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:52.083 > Sending pipeline data to server (658 bytes)
18:34:52.223 > [HTTP] Response code: 400
18:34:52.223 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:52.227 > [HTTP] Request failed with code: 400
18:34:52.232 > [RETRY] Send failed, waiting 100 ms before retry
18:34:52.331 > [RETRY] Attempt 2/3 (nonce: 2)
18:34:52.331 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:52.336 > Sending pipeline data to server (658 bytes)
18:34:52.722 > [HTTP] Response code: 400
18:34:52.722 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:52.728 > [HTTP] Request failed with code: 400
18:34:52.730 > [RETRY] Send failed, waiting 200 ms before retry
18:34:52.930 > [RETRY] Attempt 3/3 (nonce: 2)
18:34:52.930 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:52.935 > Sending pipeline data to server (658 bytes)
18:34:53.232 > [HTTP] Response code: 400
18:34:53.232 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:53.236 > [HTTP] Request failed with code: 400
18:34:53.240 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:34:53.245 > [RETRY] Consecutive failures: 3
18:34:53.248 > Health data send failed (retry count: 3/3)
18:34:53.250 > Health data transmission failed after max retries
18:34:53.351 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":202282,"type":"health_data_error"}
18:34:53.365 > [WebSocket] Processing message type: health_data_error
18:34:53.370 > [205.4] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:53.379 > ERROR state - attempting recovery
18:34:53.381 > [RETRY] Attempting to send health data (Max retries: 3)
18:34:53.387 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:34:53.389 > Generated health data: HR-63 SPO2-95 STEPS-1029
18:34:53.395 > [ESP32] ========================================
18:34:53.398 > [ESP32] ENCRYPTION PIPELINE START
18:34:53.401 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:34:53.441 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:34:53.441 > [ESP32] ========================================
18:34:53.441 > [ESP32] MsgKeys: lfsrSeed=0xF78D88C2 tnk[0..3]=A16B8A1D trn[0..3]=4690A795
18:34:53.441 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313032394D50
18:34:53.441 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313032394D50000000000000 
18:34:53.441 > [ESP32][LFSR] Initializing - Seed: 0xF78D88C2 SeedBe: 0xC2888DF7 ChaosKey[0..3]: A16B8A1D InitialTap: 0x0029 State: 0xF78D88C2
18:34:53.454 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
18:34:53.459 > 3_After_LFSR (32): 8ADAA0C1CADEE6E847A901B6A8A3B3FA A5922D6BED61895D74CF079EF9292631 
18:34:53.475 > [ESP32][LFSR] Keystream (first 16 bytes): C2888DF7F9FEB5B8089B2C8F9D83E0AE
18:34:53.475 > [ESP32][4D] LFSR keystream (first 32 bytes): C2888DF7F9FEB5B8089B2C8F9D83E0AEE0C27E46DC51BB64399F079EF9292631
18:34:53.483 > [ESP32][TINKERBELL] Input (first 16 bytes): 8ADAA0C1CADEE6E847A901B6A8A3B3FA Nonce: 0x00000002 Buffer size: 32 bytes
18:34:53.493 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: A16B8A1D
18:34:53.504 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): E8714C0FBEC4C9A6A3456E07FEFDB7A9
18:34:53.512 > 4_After_Tinkerbell (32): 62ABECCE741A2F4EE4EC6FB1565E0453 F5D905993F7338E1F1FF1DAAAF98C638 
18:34:53.520 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): E8714C0FBEC4C9A6A3456E07FEFDB7A9
18:34:53.527 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): E8714C0FBEC4C9A6A3456E07FEFDB7A9504B28F2D212B1BC85301A3456B1E009
18:34:53.537 > 5_After_Transposition (32): 055EAB383F4E62996F73EC045653E4B1 EC1AD92F74E1F5CEC6FF38F1AAAF981D 
18:34:53.545 > [ESP32] === HMAC DEBUG INFO ===
18:34:53.548 > [ESP32] HMAC Key being used: A566C59C610A0AE9CB6D2E6C5998E2120E695853C48378A6D3FE19047108C1EE
18:34:53.556 > [ESP32] HMAC Input length: 44 bytes
18:34:53.558 > [ESP32] HMAC Input (first 32 bytes): 810218001800040800000002055EAB383F4E62996F73EC045653E4B1EC1AD92F
18:34:53.570 > [ESP32] Nonce: 0x00000002
18:34:53.570 > [ESP32] Packet size before HMAC: 60
18:34:53.575 > [ESP32] Computed HMAC Tag: 2AD6ED6707C2582560C00022E87E76D9
18:34:53.581 > [ESP32] === END HMAC DEBUG ===
18:34:53.581 > 6_Final_Packet (60): 810218001800040800000002055EAB38 3F4E62996F73EC045653E4B1EC1AD92F ...
18:34:53.590 > [RETRY] Attempt 1/3 (nonce: 2)
18:34:53.593 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:53.598 > Sending pipeline data to server (658 bytes)
18:34:53.733 > [HTTP] Response code: 400
18:34:53.733 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:53.738 > [HTTP] Request failed with code: 400
18:34:53.741 > [RETRY] Send failed, waiting 100 ms before retry
18:34:53.841 > [RETRY] Attempt 2/3 (nonce: 2)
18:34:53.841 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:53.846 > Sending pipeline data to server (658 bytes)
18:34:53.983 > [HTTP] Response code: 400
18:34:53.983 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:53.988 > [HTTP] Request failed with code: 400
18:34:53.991 > [RETRY] Send failed, waiting 200 ms before retry
18:34:54.190 > [RETRY] Attempt 3/3 (nonce: 2)
18:34:54.190 > POST http://10.249.92.115:8081/health-data with pipeline data
18:34:54.196 > Sending pipeline data to server (658 bytes)
18:34:54.497 > [HTTP] Response code: 400
18:34:54.497 > [HTTP] Error response: {"error":"Decryption failed"}
18:34:54.502 > [HTTP] Request failed with code: 400
18:34:54.505 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:34:54.510 > [RETRY] Consecutive failures: 4
18:34:54.514 > ✗ Auto-recovery failed - restarting key exchange
18:34:56.616 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":202785,"type":"health_data_error"}
18:34:56.630 > [WebSocket] Processing message type: health_data_error
18:34:56.636 > [208.7] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:56.644 > ✓ Public key loaded from NVS
18:34:56.742 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":203260,"type":"health_data_error"}
18:34:56.756 > [WebSocket] Processing message type: health_data_error
18:34:56.762 > [208.8] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:56.866 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":203785,"type":"health_data_error"}
18:34:56.879 > [WebSocket] Processing message type: health_data_error
18:34:56.885 > [208.9] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:56.892 > Generating fresh master key from entropy...
18:34:56.902 > Generated master key (32): EBF437D0B26EC7D643F53FA98382DAA2 EF301CC1B7813D7B186FAAEAA53C5DF9 
18:34:56.908 > Using reduced master key (byte % 3) for NTRU encryption only
18:34:56.917 > NTRU encrypted master key (502): 0063005A00400066001600460007006C 00370005001E000D006D006F0023000C ...
18:34:56.927 > POST http://10.249.92.115:8081/master-key
18:34:57.250 > ✓ Master key exchange completed
18:34:57.351 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":204293,"type":"health_data_error"}
18:34:57.364 > [WebSocket] Processing message type: health_data_error
18:34:57.371 > [209.4] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:57.378 > Loading master key from NVS and deriving symmetric keys...
18:34:57.384 > Loaded master key from NVS (32): EBF437D0B26EC7D643F53FA98382DAA2 EF301CC1B7813D7B186FAAEAA53C5DF9 
18:34:57.392 > Derived HMAC key (32): 897F1E4AE347AB4D46C80FF1F1B6FEBE ACE66812E54CE09F83507035A0D19043 
18:34:57.400 > Derived Tinkerbell key (16): DAC9BD8AF887EE89983079CC1F52806B 
18:34:57.406 > Derived Transposition key (16): 3A2643001E1E97E981BF3EFA99BAC20C 
18:34:57.412 > ✓ Symmetric keys derived successfully
18:34:57.414 > Nonce tracker reset - new session started
18:34:57.910 > Waiting for server to process master key...
18:34:57.914 > ✓ Symmetric keys ready - starting health data transmission
18:34:58.017 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":204791,"type":"health_data_error"}
18:34:58.030 > [WebSocket] Processing message type: health_data_error
18:34:58.036 > [210.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:58.139 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":205301,"type":"health_data_error"}
18:34:58.153 > [WebSocket] Processing message type: health_data_error
18:34:58.159 > [210.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:58.261 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":8,"success":false,"timestamp":205802,"type":"health_data_error"}
18:34:58.275 > [WebSocket] Processing message type: health_data_error
18:34:58.281 > [210.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:58.387 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":8,"success":false,"timestamp":206052,"type":"health_data_error"}
18:34:58.400 > [WebSocket] Processing message type: health_data_error
18:34:58.406 > [210.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:58.508 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":8,"success":false,"timestamp":206566,"type":"health_data_error"}
18:34:58.523 > [WebSocket] Processing message type: health_data_error
18:34:58.527 > [210.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:58.631 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770123897022,"type":"master_key_received"}
18:34:58.644 > [WebSocket] Processing message type: master_key_received
18:34:58.647 > [210.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:58.752 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":209312,"type":"master_key_exchanged"}
18:34:58.769 > [WebSocket] Processing message type: master_key_exchanged
18:34:58.775 > [210.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:58.874 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":209980,"type":"symmetric_keys_derived"}
18:34:58.891 > [WebSocket] Processing message type: symmetric_keys_derived
18:34:58.897 > [211.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:58.997 > [211.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:59.097 > [211.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:59.199 > [211.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:59.300 > [211.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:59.400 > [211.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:59.500 > [211.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:59.602 > [211.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:59.703 > [211.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:59.804 > [211.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:34:59.904 > [212.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:00.005 > [212.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:00.107 > [212.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:00.208 > [212.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:00.309 > [212.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:00.410 > [212.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:00.511 > [212.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:00.612 > [212.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:00.712 > [212.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:00.814 > [212.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:00.915 > [213.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:01.016 > [213.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:01.117 > [213.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:01.218 > [213.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:01.319 > [213.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:01.420 > [213.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:01.521 > [213.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:01.622 > [213.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:01.723 > [213.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:01.824 > [213.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:01.925 > [214.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:02.026 > [214.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:02.126 > [214.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:02.227 > [214.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:02.329 > [214.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:02.430 > [214.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:02.531 > [214.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:02.632 > [214.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:02.734 > [214.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:02.834 > [214.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:02.935 > [215.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:03.036 > [215.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:03.137 > [215.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:03.238 > [215.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:03.339 > [215.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:03.440 > [215.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:03.540 > [215.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:03.642 > [215.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:03.743 > [215.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:03.844 > [215.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:03.945 > [216.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:04.046 > [216.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:04.147 > [216.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:04.248 > [216.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:04.349 > [216.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:04.450 > [216.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:04.551 > [216.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:04.652 > [216.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:04.752 > [216.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:04.854 > [216.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:04.955 > [217.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:05.056 > [217.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:05.157 > [217.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:05.258 > [217.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:05.359 > [217.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:05.460 > [217.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:05.560 > [217.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:05.662 > [217.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:05.763 > [217.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:05.863 > [217.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:05.965 > [218.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:06.066 > [218.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:06.167 > [218.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:06.267 > [218.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:06.369 > [218.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:06.470 > [218.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:06.571 > [218.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:06.672 > [218.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:06.773 > [218.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:06.873 > [218.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:06.975 > [219.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:07.075 > [219.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:07.176 > [219.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:07.277 > [219.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:07.379 > [219.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:07.480 > [219.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:07.581 > [219.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:07.681 > [219.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:07.782 > [219.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:07.884 > [220.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:07.984 > [220.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:07.990 > [RETRY] Attempting to send health data (Max retries: 3)
18:35:07.996 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:35:08.001 > Generated health data: HR-63 SPO2-95 STEPS-1123
18:35:08.004 > [ESP32] ========================================
18:35:08.010 > [ESP32] ENCRYPTION PIPELINE START
18:35:08.013 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:35:08.022 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:35:08.027 > [ESP32] ========================================
18:35:08.032 > [ESP32] MsgKeys: lfsrSeed=0xB97EE61C tnk[0..3]=73DE1A96 trn[0..3]=7EA0736C
18:35:08.038 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313132334D50
18:35:08.043 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313132334D50000000000000 
18:35:08.052 > [ESP32][LFSR] Initializing - Seed: 0xB97EE61C SeedBe: 0x1CE67EB9 ChaosKey[0..3]: 73DE1A96 InitialTap: 0x0029 State: 0xB97EE61C
18:35:08.063 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
18:35:08.072 > 3_After_LFSR (32): 54B4538F83E2BCBB57226ECE7F7991C8 DCD92D95976D9F10CFE54A178E9F77DC 
18:35:08.079 > [ESP32][LFSR] Keystream (first 16 bytes): 1CE67EB9B0C2EFEB181043F74A59C29C
18:35:08.085 > [ESP32][4D] LFSR keystream (first 32 bytes): 1CE67EB9B0C2EFEB181043F74A59C29C99897EB8A65CAD2382B54A178E9F77DC
18:35:08.094 > [ESP32][TINKERBELL] Input (first 16 bytes): 54B4538F83E2BCBB57226ECE7F7991C8 Nonce: 0x00000001 Buffer size: 32 bytes
18:35:08.105 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 73DE1A96
18:35:08.116 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 636462397E2C7D70EA519B2457876BE4
18:35:08.124 > 4_After_Tinkerbell (32): 37D031B6FDCEC1CBBD73F5EA28FEFA2C 5E501500B30784ACD16F4ABA41FD0156 
18:35:08.132 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 636462397E2C7D70EA519B2457876BE4
18:35:08.138 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 636462397E2C7D70EA519B2457876BE482893895246A1BBC1E8A00ADCF62768A
18:35:08.149 > 5_After_Transposition (32): 15ACC137CEB6B3D0F5CBFABDFEEAFD73 312C845E0700285001FD4A41BA6F56D1 
18:35:08.157 > [ESP32] === HMAC DEBUG INFO ===
18:35:08.160 > [ESP32] HMAC Key being used: 897F1E4AE347AB4D46C80FF1F1B6FEBEACE66812E54CE09F83507035A0D19043
18:35:08.169 > [ESP32] HMAC Input length: 44 bytes
18:35:08.172 > [ESP32] HMAC Input (first 32 bytes): 81021800180004080000000115ACC137CEB6B3D0F5CBFABDFEEAFD73312C845E
18:35:08.179 > [ESP32] Nonce: 0x00000001
18:35:08.182 > [ESP32] Packet size before HMAC: 60
18:35:08.185 > [ESP32] Computed HMAC Tag: 3F987FA2D6496C639B13D7FE3FD8454A
18:35:08.191 > [ESP32] === END HMAC DEBUG ===
18:35:08.193 > 6_Final_Packet (60): 81021800180004080000000115ACC137 CEB6B3D0F5CBFABDFEEAFD73312C845E ...
18:35:08.202 > [RETRY] Attempt 1/3 (nonce: 1)
18:35:08.205 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:08.211 > Sending pipeline data to server (658 bytes)
18:35:08.492 > [HTTP] Response code: 400
18:35:08.492 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:08.497 > [HTTP] Request failed with code: 400
18:35:08.501 > [RETRY] Send failed, waiting 100 ms before retry
18:35:08.601 > [RETRY] Attempt 2/3 (nonce: 1)
18:35:08.601 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:08.606 > Sending pipeline data to server (658 bytes)
18:35:08.748 > [HTTP] Response code: 400
18:35:08.748 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:08.754 > [HTTP] Request failed with code: 400
18:35:08.757 > [RETRY] Send failed, waiting 200 ms before retry
18:35:08.957 > [RETRY] Attempt 3/3 (nonce: 1)
18:35:08.957 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:08.963 > Sending pipeline data to server (658 bytes)
18:35:09.261 > [HTTP] Response code: 400
18:35:09.261 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:09.267 > [HTTP] Request failed with code: 400
18:35:09.269 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:35:09.275 > [RETRY] Consecutive failures: 5
18:35:09.278 > [EMERGENCY] Triggering emergency reset!
18:35:09.281 > [CRYPTO] Resetting cryptographic state
18:35:09.286 > [CRYPTO] Crypto state reset complete
18:35:09.289 > [CRYPTO] Packet counter: 3
18:35:09.292 > [EMERGENCY] Emergency reset complete
18:35:09.294 > Health data send failed (retry count: 1/3)
18:35:09.391 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":220562,"type":"health_data_error"}
18:35:09.405 > [WebSocket] Processing message type: health_data_error
18:35:09.411 > [221.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:09.419 > [RETRY] Attempting to send health data (Max retries: 3)
18:35:09.425 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:35:09.431 > Generated health data: HR-63 SPO2-95 STEPS-1146
18:35:09.434 > [ESP32] ========================================
18:35:09.439 > [ESP32] ENCRYPTION PIPELINE START
18:35:09.442 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:35:09.448 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:35:09.456 > [ESP32] ========================================
18:35:09.458 > [ESP32] MsgKeys: lfsrSeed=0xB97EE61C tnk[0..3]=73DE1A96 trn[0..3]=7EA0736C
18:35:09.467 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313134364D50
18:35:09.473 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313134364D50000000000000 
18:35:09.481 > [ESP32][LFSR] Initializing - Seed: 0xB97EE61C SeedBe: 0x1CE67EB9 ChaosKey[0..3]: 73DE1A96 InitialTap: 0x0029 State: 0xB97EE61C
18:35:09.492 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
18:35:09.500 > 3_After_LFSR (32): 54B4538F83E2BCBB57226ECE7F7991C8 DCD92D95976D9915CFE54A178E9F77DC 
18:35:09.506 > [ESP32][LFSR] Keystream (first 16 bytes): 1CE67EB9B0C2EFEB181043F74A59C29C
18:35:09.514 > [ESP32][4D] LFSR keystream (first 32 bytes): 1CE67EB9B0C2EFEB181043F74A59C29C99897EB8A65CAD2382B54A178E9F77DC
18:35:09.523 > [ESP32][TINKERBELL] Input (first 16 bytes): 54B4538F83E2BCBB57226ECE7F7991C8 Nonce: 0x00000001 Buffer size: 32 bytes
18:35:09.533 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 73DE1A96
18:35:09.542 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 636462397E2C7D70EA519B2457876BE4
18:35:09.550 > 4_After_Tinkerbell (32): 37D031B6FDCEC1CBBD73F5EA28FEFA2C 5E501500B30782A9D16F4ABA41FD0156 
18:35:09.558 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 636462397E2C7D70EA519B2457876BE4
18:35:09.567 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 636462397E2C7D70EA519B2457876BE482893895246A1BBC1E8A00ADCF62768A
18:35:09.577 > 5_After_Transposition (32): 15A9C137CEB6B3D0F5CBFABDFEEAFD73 312C825E0700285001FD4A41BA6F56D1 
18:35:09.586 > [ESP32] === HMAC DEBUG INFO ===
18:35:09.589 > [ESP32] HMAC Key being used: 897F1E4AE347AB4D46C80FF1F1B6FEBEACE66812E54CE09F83507035A0D19043
18:35:09.597 > [ESP32] HMAC Input length: 44 bytes
18:35:09.600 > [ESP32] HMAC Input (first 32 bytes): 81021800180004080000000115A9C137CEB6B3D0F5CBFABDFEEAFD73312C825E
18:35:09.608 > [ESP32] Nonce: 0x00000001
18:35:09.611 > [ESP32] Packet size before HMAC: 60
18:35:09.614 > [ESP32] Computed HMAC Tag: BA355B31D76682EA48A38070F86A40E1
18:35:09.620 > [ESP32] === END HMAC DEBUG ===
18:35:09.623 > 6_Final_Packet (60): 81021800180004080000000115A9C137 CEB6B3D0F5CBFABDFEEAFD73312C825E ...
18:35:09.631 > [RETRY] Attempt 1/3 (nonce: 1)
18:35:09.634 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:09.639 > Sending pipeline data to server (658 bytes)
18:35:09.757 > [HTTP] Response code: 400
18:35:09.757 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:09.762 > [HTTP] Request failed with code: 400
18:35:09.765 > [RETRY] Send failed, waiting 100 ms before retry
18:35:09.865 > [RETRY] Attempt 2/3 (nonce: 1)
18:35:09.866 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:09.871 > Sending pipeline data to server (658 bytes)
18:35:10.006 > [HTTP] Response code: 400
18:35:10.007 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:10.013 > [HTTP] Request failed with code: 400
18:35:10.015 > [RETRY] Send failed, waiting 200 ms before retry
18:35:10.218 > [RETRY] Attempt 3/3 (nonce: 1)
18:35:10.218 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:10.223 > Sending pipeline data to server (658 bytes)
18:35:10.516 > [HTTP] Response code: 400
18:35:10.516 > [HTTP] Error response: {"error":"MISSING_RECIPE","message":"ZTM mode requires 0x82 packet with recipeId"}
18:35:10.527 > [HTTP] Request failed with code: 400
18:35:10.535 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:35:10.538 > [RETRY] Consecutive failures: 1
18:35:10.540 > Health data send failed (retry count: 2/3)
18:35:10.646 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":220818,"type":"health_data_error"}
18:35:10.660 > [WebSocket] Processing message type: health_data_error
18:35:10.665 > [222.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:10.675 > [RETRY] Attempting to send health data (Max retries: 3)
18:35:10.679 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:35:10.685 > Generated health data: HR-63 SPO2-95 STEPS-1128
18:35:10.688 > [ESP32] ========================================
18:35:10.694 > [ESP32] ENCRYPTION PIPELINE START
18:35:10.696 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:35:10.702 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:35:10.711 > [ESP32] ========================================
18:35:10.713 > [ESP32] MsgKeys: lfsrSeed=0xB97EE61C tnk[0..3]=73DE1A96 trn[0..3]=7EA0736C
18:35:10.721 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313132384D50
18:35:10.727 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313132384D50000000000000 
18:35:10.735 > [ESP32][LFSR] Initializing - Seed: 0xB97EE61C SeedBe: 0x1CE67EB9 ChaosKey[0..3]: 73DE1A96 InitialTap: 0x0029 State: 0xB97EE61C
18:35:10.746 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
18:35:10.754 > 3_After_LFSR (32): 54B4538F83E2BCBB57226ECE7F7991C8 DCD92D95976D9F1BCFE54A178E9F77DC 
18:35:10.760 > [ESP32][LFSR] Keystream (first 16 bytes): 1CE67EB9B0C2EFEB181043F74A59C29C
18:35:10.769 > [ESP32][4D] LFSR keystream (first 32 bytes): 1CE67EB9B0C2EFEB181043F74A59C29C99897EB8A65CAD2382B54A178E9F77DC
18:35:10.776 > [ESP32][TINKERBELL] Input (first 16 bytes): 54B4538F83E2BCBB57226ECE7F7991C8 Nonce: 0x00000001 Buffer size: 32 bytes
18:35:10.788 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 73DE1A96
18:35:10.797 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 636462397E2C7D70EA519B2457876BE4
18:35:10.805 > 4_After_Tinkerbell (32): 37D031B6FDCEC1CBBD73F5EA28FEFA2C 5E501500B30784A7D16F4ABA41FD0156 
18:35:10.813 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 636462397E2C7D70EA519B2457876BE4
18:35:10.822 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 636462397E2C7D70EA519B2457876BE482893895246A1BBC1E8A00ADCF62768A
18:35:10.833 > 5_After_Transposition (32): 15A7C137CEB6B3D0F5CBFABDFEEAFD73 312C845E0700285001FD4A41BA6F56D1 
18:35:10.841 > [ESP32] === HMAC DEBUG INFO ===
18:35:10.844 > [ESP32] HMAC Key being used: 897F1E4AE347AB4D46C80FF1F1B6FEBEACE66812E54CE09F83507035A0D19043
18:35:10.852 > [ESP32] HMAC Input length: 44 bytes
18:35:10.854 > [ESP32] HMAC Input (first 32 bytes): 81021800180004080000000115A7C137CEB6B3D0F5CBFABDFEEAFD73312C845E
18:35:10.863 > [ESP32] Nonce: 0x00000001
18:35:10.866 > [ESP32] Packet size before HMAC: 60
18:35:10.869 > [ESP32] Computed HMAC Tag: FE756C7B73512FDD111CDAC1462E8776
18:35:10.874 > [ESP32] === END HMAC DEBUG ===
18:35:10.876 > 6_Final_Packet (60): 81021800180004080000000115A7C137 CEB6B3D0F5CBFABDFEEAFD73312C845E ...
18:35:10.885 > [RETRY] Attempt 1/3 (nonce: 1)
18:35:10.888 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:10.894 > Sending pipeline data to server (658 bytes)
18:35:11.049 > [HTTP] Response code: 400
18:35:11.049 > [HTTP] Error response: {"error":"MISSING_RECIPE","message":"ZTM mode requires 0x82 packet with recipeId"}
18:35:11.060 > [HTTP] Request failed with code: 400
18:35:11.067 > [RETRY] Send failed, waiting 100 ms before retry
18:35:11.167 > [RETRY] Attempt 2/3 (nonce: 1)
18:35:11.169 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:11.173 > Sending pipeline data to server (658 bytes)
18:35:11.509 > [HTTP] Response code: 400
18:35:11.509 > [HTTP] Error response: {"error":"MISSING_RECIPE","message":"ZTM mode requires 0x82 packet with recipeId"}
18:35:11.521 > [HTTP] Request failed with code: 400
18:35:11.527 > [RETRY] Send failed, waiting 200 ms before retry
18:35:11.727 > [RETRY] Attempt 3/3 (nonce: 1)
18:35:11.727 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:11.732 > Sending pipeline data to server (658 bytes)
18:35:12.023 > [HTTP] Response code: 400
18:35:12.024 > [HTTP] Error response: {"error":"MISSING_RECIPE","message":"ZTM mode requires 0x82 packet with recipeId"}
18:35:12.035 > [HTTP] Request failed with code: 400
18:35:12.043 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:35:12.044 > [RETRY] Consecutive failures: 2
18:35:12.048 > Health data send failed (retry count: 3/3)
18:35:12.053 > Health data transmission failed after max retries
18:35:12.154 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":221331,"type":"health_data_error"}
18:35:12.168 > [WebSocket] Processing message type: health_data_error
18:35:12.173 > [224.2] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:12.181 > ERROR state - attempting recovery
18:35:12.184 > [RETRY] Attempting to send health data (Max retries: 3)
18:35:12.190 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:35:12.192 > Generated health data: HR-63 SPO2-95 STEPS-1135
18:35:12.198 > [ESP32] ========================================
18:35:12.202 > [ESP32] ENCRYPTION PIPELINE START
18:35:12.204 > [ESP32] Mode: NORMAL | ZTM Enabled: FALSE | Recipe: CHAOS_ONLY (Normal Baseline)
18:35:12.212 > [ESP32] Active Algorithms: LFSR + Tinkerbell + Transposition (Normal Mode)
18:35:12.218 > [ESP32] ========================================
18:35:12.223 > [ESP32] MsgKeys: lfsrSeed=0xB97EE61C tnk[0..3]=73DE1A96 trn[0..3]=7EA0736C
18:35:12.229 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313133354D50
18:35:12.238 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313133354D50000000000000 
18:35:12.243 > [ESP32][LFSR] Initializing - Seed: 0xB97EE61C SeedBe: 0x1CE67EB9 ChaosKey[0..3]: 73DE1A96 InitialTap: 0x0029 State: 0xB97EE61C
18:35:12.254 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
18:35:12.262 > 3_After_LFSR (32): 54B4538F83E2BCBB57226ECE7F7991C8 DCD92D95976D9E16CFE54A178E9F77DC 
18:35:12.271 > [ESP32][LFSR] Keystream (first 16 bytes): 1CE67EB9B0C2EFEB181043F74A59C29C
18:35:12.276 > [ESP32][4D] LFSR keystream (first 32 bytes): 1CE67EB9B0C2EFEB181043F74A59C29C99897EB8A65CAD2382B54A178E9F77DC
18:35:12.286 > [ESP32][TINKERBELL] Input (first 16 bytes): 54B4538F83E2BCBB57226ECE7F7991C8 Nonce: 0x00000001 Buffer size: 32 bytes
18:35:12.296 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 73DE1A96
18:35:12.307 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 636462397E2C7D70EA519B2457876BE4
18:35:12.315 > 4_After_Tinkerbell (32): 37D031B6FDCEC1CBBD73F5EA28FEFA2C 5E501500B30785AAD16F4ABA41FD0156 
18:35:12.323 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 636462397E2C7D70EA519B2457876BE4
18:35:12.332 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 636462397E2C7D70EA519B2457876BE482893895246A1BBC1E8A00ADCF62768A
18:35:12.340 > 5_After_Transposition (32): 15AAC137CEB6B3D0F5CBFABDFEEAFD73 312C855E0700285001FD4A41BA6F56D1 
18:35:12.348 > [ESP32] === HMAC DEBUG INFO ===
18:35:12.352 > [ESP32] HMAC Key being used: 897F1E4AE347AB4D46C80FF1F1B6FEBEACE66812E54CE09F83507035A0D19043
18:35:12.360 > [ESP32] HMAC Input length: 44 bytes
18:35:12.363 > [ESP32] HMAC Input (first 32 bytes): 81021800180004080000000115AAC137CEB6B3D0F5CBFABDFEEAFD73312C855E
18:35:12.373 > [ESP32] Nonce: 0x00000001
18:35:12.373 > [ESP32] Packet size before HMAC: 60
18:35:12.379 > [ESP32] Computed HMAC Tag: CB9694096FA8F3AE4FE6608B14AF43DB
18:35:12.385 > [ESP32] === END HMAC DEBUG ===
18:35:12.385 > 6_Final_Packet (60): 81021800180004080000000115AAC137 CEB6B3D0F5CBFABDFEEAFD73312C855E ...
18:35:12.393 > [RETRY] Attempt 1/3 (nonce: 1)
18:35:12.396 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:12.402 > Sending pipeline data to server (658 bytes)
18:35:12.806 > [HTTP] Response code: 400
18:35:12.806 > [HTTP] Error response: {"error":"MISSING_RECIPE","message":"ZTM mode requires 0x82 packet with recipeId"}
18:35:12.817 > [HTTP] Request failed with code: 400
18:35:12.824 > [RETRY] Send failed, waiting 100 ms before retry
18:35:12.926 > [RETRY] Attempt 2/3 (nonce: 1)
18:35:12.926 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:12.931 > Sending pipeline data to server (658 bytes)
18:35:13.077 > [HTTP] Response code: 400
18:35:13.077 > [HTTP] Error response: {"error":"MISSING_RECIPE","message":"ZTM mode requires 0x82 packet with recipeId"}
18:35:13.089 > [HTTP] Request failed with code: 400
18:35:13.097 > [RETRY] Send failed, waiting 200 ms before retry
18:35:13.297 > [RETRY] Attempt 3/3 (nonce: 1)
18:35:13.297 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:13.303 > Sending pipeline data to server (658 bytes)
18:35:13.533 > [HTTP] Response code: 400
18:35:13.533 > [HTTP] Error response: {"error":"MISSING_RECIPE","message":"ZTM mode requires 0x82 packet with recipeId"}
18:35:13.543 > [HTTP] Request failed with code: 400
18:35:13.550 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:35:13.553 > [RETRY] Consecutive failures: 3
18:35:13.556 > ✗ Auto-recovery failed - restarting key exchange
18:35:15.665 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":221827,"type":"health_data_error"}
18:35:15.679 > [WebSocket] Processing message type: health_data_error
18:35:15.684 > [227.7] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:15.693 > ✓ Public key loaded from NVS
18:35:15.791 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":222077,"type":"health_data_error"}
18:35:15.805 > [WebSocket] Processing message type: health_data_error
18:35:15.811 > [227.9] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:15.914 > [WebSocket] Received (452 bytes): {"activatedAt":1770123910191,"active":true,"epoch":1,"heuristics":{"cpuUsage":20.0,"decryptFailures":0,"entropy":7.5,"hmacFailures":0,"latency":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"lastSwitchReason":"ZTM activated - baseline recipe","message":"Zero Trust Mode activated successfully","pendingProposals":0,"recipe":"CHAOS_ONLY","serverTime":1770123910191,"success":true,"threatLevel":0,"type":"ztm_activation_acknowledged"}
18:35:15.956 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:15.961 > [WebSocket] ========================================
18:35:15.964 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:15.973 > [WebSocket] ========================================
18:35:15.975 > [ZTM] Settings saved successfully
18:35:15.978 > [WebSocket] ✓ ZTM activated successfully
18:35:15.984 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:15.987 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:15.992 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:15.995 > [WebSocket] ========================================
18:35:16.004 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":228068,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:16.040 > [228.1] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:16.048 > Generating fresh master key from entropy...
18:35:16.054 > Generated master key (32): 7791CB8A4C4E0DC8DF9B425F00209C38 6265FE339579DD424DB8C7525FE30B22 
18:35:16.062 > Using reduced master key (byte % 3) for NTRU encryption only
18:35:16.069 > NTRU encrypted master key (502): 0064005A00410065001600440007006D 00370005001E000E006B00700021000E ...
18:35:16.078 > POST http://10.249.92.115:8081/master-key
18:35:16.318 > ✓ Master key exchange completed
18:35:16.420 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":222596,"type":"health_data_error"}
18:35:16.433 > [WebSocket] Processing message type: health_data_error
18:35:16.438 > [228.5] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:16.447 > Loading master key from NVS and deriving symmetric keys...
18:35:16.453 > Loaded master key from NVS (32): 7791CB8A4C4E0DC8DF9B425F00209C38 6265FE339579DD424DB8C7525FE30B22 
18:35:16.461 > Derived HMAC key (32): 4A57244B0AE71303A62E2B08B3CAF592 2B6F0D656A844B526F41F1C2F4775B0F 
18:35:16.470 > Derived Tinkerbell key (16): 2A8CA4C16B45835477BF33048ED799B3 
18:35:16.474 > Derived Transposition key (16): 678097AE54E2272FFC77FC1E141112B6 
18:35:16.479 > ✓ Symmetric keys derived successfully
18:35:16.483 > Nonce tracker reset - new session started
18:35:16.979 > Waiting for server to process master key...
18:35:16.982 > ✓ Symmetric keys ready - starting health data transmission
18:35:17.086 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":223129,"type":"health_data_error"}
18:35:17.098 > [WebSocket] Processing message type: health_data_error
18:35:17.105 > [229.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:17.208 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123911202,"threatLevel":0,"type":"heuristics_update"}
18:35:17.233 > [WebSocket] Processing message type: heuristics_update
18:35:17.239 > [229.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:17.342 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":223590,"type":"health_data_error"}
18:35:17.355 > [WebSocket] Processing message type: health_data_error
18:35:17.361 > [229.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:17.463 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":224104,"type":"health_data_error"}
18:35:17.478 > [WebSocket] Processing message type: health_data_error
18:35:17.483 > [229.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:17.586 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123912211,"threatLevel":0,"type":"heuristics_update"}
18:35:17.611 > [WebSocket] Processing message type: heuristics_update
18:35:17.617 > [229.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:17.719 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":8,"success":false,"timestamp":224887,"type":"health_data_error"}
18:35:17.733 > [WebSocket] Processing message type: health_data_error
18:35:17.739 > [229.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:17.841 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":8,"success":false,"timestamp":225159,"type":"health_data_error"}
18:35:17.854 > [WebSocket] Processing message type: health_data_error
18:35:17.860 > [229.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:17.963 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123913226,"threatLevel":0,"type":"heuristics_update"}
18:35:17.988 > [WebSocket] Processing message type: heuristics_update
18:35:17.993 > [230.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:18.096 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":8,"success":false,"timestamp":225613,"type":"health_data_error"}
18:35:18.109 > [WebSocket] Processing message type: health_data_error
18:35:18.115 > [230.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:18.219 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123914238,"threatLevel":0,"type":"heuristics_update"}
18:35:18.242 > [WebSocket] Processing message type: heuristics_update
18:35:18.248 > [230.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:18.350 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123915253,"threatLevel":0,"type":"heuristics_update"}
18:35:18.376 > [WebSocket] Processing message type: heuristics_update
18:35:18.381 > [230.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:18.483 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":228068,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:18.520 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:18.525 > [WebSocket] ========================================
18:35:18.531 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:18.537 > [WebSocket] ========================================
18:35:18.542 > [ZTM] Settings saved successfully
18:35:18.545 > [WebSocket] ✓ ZTM activated successfully
18:35:18.547 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:18.553 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:18.556 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:18.558 > [WebSocket] ========================================
18:35:18.564 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":230628,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:18.603 > [230.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:18.709 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":5,"success":true,"timestamp":228104,"type":"ztm_activated"}
18:35:18.726 > [WebSocket] Processing message type: ztm_activated
18:35:18.727 > [230.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:18.832 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770123916184,"type":"master_key_received"}
18:35:18.846 > [WebSocket] Processing message type: master_key_received
18:35:18.849 > [230.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:18.954 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123916269,"threatLevel":0,"type":"heuristics_update"}
18:35:18.979 > [WebSocket] Processing message type: heuristics_update
18:35:18.984 > [231.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:19.088 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":228381,"type":"master_key_exchanged"}
18:35:19.104 > [WebSocket] Processing message type: master_key_exchanged
18:35:19.110 > [231.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:19.209 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":229049,"type":"symmetric_keys_derived"}
18:35:19.226 > [WebSocket] Processing message type: symmetric_keys_derived
18:35:19.232 > [231.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:19.333 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123917282,"threatLevel":0,"type":"heuristics_update"}
18:35:19.358 > [WebSocket] Processing message type: heuristics_update
18:35:19.364 > [231.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:19.466 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123918296,"threatLevel":0,"type":"heuristics_update"}
18:35:19.491 > [WebSocket] Processing message type: heuristics_update
18:35:19.497 > [231.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:19.599 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":230628,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:19.635 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:19.640 > [WebSocket] ========================================
18:35:19.646 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:19.651 > [WebSocket] ========================================
18:35:19.657 > [ZTM] Settings saved successfully
18:35:19.660 > [WebSocket] ✓ ZTM activated successfully
18:35:19.663 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:19.667 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:19.671 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:19.673 > [WebSocket] ========================================
18:35:19.679 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":231742,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:19.717 > [231.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:19.824 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":230663,"type":"ztm_activated"}
18:35:19.841 > [WebSocket] Processing message type: ztm_activated
18:35:19.843 > [231.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:19.949 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123919298,"threatLevel":0,"type":"heuristics_update"}
18:35:19.975 > [WebSocket] Processing message type: heuristics_update
18:35:19.980 > [232.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:20.082 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":231742,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:20.118 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:20.124 > [WebSocket] ========================================
18:35:20.129 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:20.134 > [WebSocket] ========================================
18:35:20.140 > [ZTM] Settings saved successfully
18:35:20.142 > [WebSocket] ✓ ZTM activated successfully
18:35:20.146 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:20.151 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:20.154 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:20.156 > [WebSocket] ========================================
18:35:20.162 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":232225,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:20.202 > [232.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:20.307 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":231778,"type":"ztm_activated"}
18:35:20.324 > [WebSocket] Processing message type: ztm_activated
18:35:20.327 > [232.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:20.431 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":232225,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:20.467 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:20.472 > [WebSocket] ========================================
18:35:20.477 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:20.484 > [WebSocket] ========================================
18:35:20.489 > [ZTM] Settings saved successfully
18:35:20.492 > [WebSocket] ✓ ZTM activated successfully
18:35:20.494 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:20.500 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:20.502 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:20.506 > [WebSocket] ========================================
18:35:20.511 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":232574,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:20.550 > [232.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:20.656 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":232261,"type":"ztm_activated"}
18:35:20.672 > [WebSocket] Processing message type: ztm_activated
18:35:20.676 > [232.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:20.779 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123920305,"threatLevel":0,"type":"heuristics_update"}
18:35:20.804 > [WebSocket] Processing message type: heuristics_update
18:35:20.809 > [232.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:20.913 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":232574,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:20.948 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:20.955 > [WebSocket] ========================================
18:35:20.960 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:20.965 > [WebSocket] ========================================
18:35:20.971 > [ZTM] Settings saved successfully
18:35:20.974 > [WebSocket] ✓ ZTM activated successfully
18:35:20.976 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:20.982 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:20.985 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:20.988 > [WebSocket] ========================================
18:35:20.992 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":233056,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:21.032 > [233.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:21.138 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":232609,"type":"ztm_activated"}
18:35:21.155 > [WebSocket] Processing message type: ztm_activated
18:35:21.157 > [233.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:21.264 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":233056,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:21.299 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:21.305 > [WebSocket] ========================================
18:35:21.310 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:21.316 > [WebSocket] ========================================
18:35:21.321 > [ZTM] Settings saved successfully
18:35:21.324 > [WebSocket] ✓ ZTM activated successfully
18:35:21.327 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:21.333 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:21.335 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:21.339 > [WebSocket] ========================================
18:35:21.344 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":233407,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:21.383 > [233.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:21.491 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":233091,"type":"ztm_activated"}
18:35:21.508 > [WebSocket] Processing message type: ztm_activated
18:35:21.511 > [233.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:21.614 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123921321,"threatLevel":0,"type":"heuristics_update"}
18:35:21.640 > [WebSocket] Processing message type: heuristics_update
18:35:21.645 > [233.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:21.747 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":233407,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:21.783 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:21.789 > [WebSocket] ========================================
18:35:21.794 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:21.800 > [WebSocket] ========================================
18:35:21.806 > [ZTM] Settings saved successfully
18:35:21.808 > [WebSocket] ✓ ZTM activated successfully
18:35:21.811 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:21.816 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:21.819 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:21.822 > [WebSocket] ========================================
18:35:21.827 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":233890,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:21.866 > [233.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:21.972 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":233442,"type":"ztm_activated"}
18:35:21.988 > [WebSocket] Processing message type: ztm_activated
18:35:21.991 > [234.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:22.095 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":233890,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:22.131 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:22.137 > [WebSocket] ========================================
18:35:22.143 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:22.148 > [WebSocket] ========================================
18:35:22.154 > [ZTM] Settings saved successfully
18:35:22.157 > [WebSocket] ✓ ZTM activated successfully
18:35:22.160 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:22.165 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:22.168 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:22.171 > [WebSocket] ========================================
18:35:22.176 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":234239,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:22.214 > [234.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:22.322 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":233926,"type":"ztm_activated"}
18:35:22.338 > [WebSocket] Processing message type: ztm_activated
18:35:22.342 > [234.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:22.447 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":234239,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:22.484 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:22.489 > [WebSocket] ========================================
18:35:22.494 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:22.501 > [WebSocket] ========================================
18:35:22.505 > [ZTM] Settings saved successfully
18:35:22.508 > [WebSocket] ✓ ZTM activated successfully
18:35:22.512 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:22.517 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:22.520 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:22.522 > [WebSocket] ========================================
18:35:22.527 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":234591,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:22.567 > [234.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:22.673 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":234274,"type":"ztm_activated"}
18:35:22.689 > [WebSocket] Processing message type: ztm_activated
18:35:22.692 > [234.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:22.796 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123922331,"threatLevel":0,"type":"heuristics_update"}
18:35:22.820 > [WebSocket] Processing message type: heuristics_update
18:35:22.826 > [234.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:22.929 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":234591,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:22.966 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:22.971 > [WebSocket] ========================================
18:35:22.976 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:22.982 > [WebSocket] ========================================
18:35:22.988 > [ZTM] Settings saved successfully
18:35:22.990 > [WebSocket] ✓ ZTM activated successfully
18:35:22.993 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:22.998 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:23.002 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:23.004 > [WebSocket] ========================================
18:35:23.010 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":235073,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:23.049 > [235.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:23.155 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":234626,"type":"ztm_activated"}
18:35:23.172 > [WebSocket] Processing message type: ztm_activated
18:35:23.174 > [235.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:23.278 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":235073,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:23.315 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:23.320 > [WebSocket] ========================================
18:35:23.325 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:23.331 > [WebSocket] ========================================
18:35:23.337 > [ZTM] Settings saved successfully
18:35:23.339 > [WebSocket] ✓ ZTM activated successfully
18:35:23.342 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:23.347 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:23.351 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:23.353 > [WebSocket] ========================================
18:35:23.359 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":235422,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:23.398 > [235.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:23.504 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":235108,"type":"ztm_activated"}
18:35:23.520 > [WebSocket] Processing message type: ztm_activated
18:35:23.523 > [235.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:23.629 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123923343,"threatLevel":0,"type":"heuristics_update"}
18:35:23.654 > [WebSocket] Processing message type: heuristics_update
18:35:23.659 > [235.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:23.762 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":235422,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:23.798 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:23.804 > [WebSocket] ========================================
18:35:23.809 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:23.814 > [WebSocket] ========================================
18:35:23.820 > [ZTM] Settings saved successfully
18:35:23.822 > [WebSocket] ✓ ZTM activated successfully
18:35:23.826 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:23.830 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:23.833 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:23.836 > [WebSocket] ========================================
18:35:23.842 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":235905,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:23.881 > [235.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:23.987 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":235457,"type":"ztm_activated"}
18:35:24.003 > [WebSocket] Processing message type: ztm_activated
18:35:24.007 > [236.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:24.110 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":235905,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:24.146 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:24.152 > [WebSocket] ========================================
18:35:24.157 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:24.163 > [WebSocket] ========================================
18:35:24.169 > [ZTM] Settings saved successfully
18:35:24.171 > [WebSocket] ✓ ZTM activated successfully
18:35:24.174 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:24.180 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:24.183 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:24.185 > [WebSocket] ========================================
18:35:24.191 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":236254,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:24.230 > [236.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:24.336 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":235941,"type":"ztm_activated"}
18:35:24.353 > [WebSocket] Processing message type: ztm_activated
18:35:24.355 > [236.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:24.459 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":236254,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:24.495 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:24.501 > [WebSocket] ========================================
18:35:24.506 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:24.512 > [WebSocket] ========================================
18:35:24.518 > [ZTM] Settings saved successfully
18:35:24.521 > [WebSocket] ✓ ZTM activated successfully
18:35:24.523 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:24.528 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:24.531 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:24.534 > [WebSocket] ========================================
18:35:24.540 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":236603,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:24.579 > [236.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:24.686 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":236290,"type":"ztm_activated"}
18:35:24.703 > [WebSocket] Processing message type: ztm_activated
18:35:24.705 > [236.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:24.811 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123924356,"threatLevel":0,"type":"heuristics_update"}
18:35:24.836 > [WebSocket] Processing message type: heuristics_update
18:35:24.842 > [236.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:24.944 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":236603,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:24.979 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:24.985 > [WebSocket] ========================================
18:35:24.990 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:24.997 > [WebSocket] ========================================
18:35:25.002 > [ZTM] Settings saved successfully
18:35:25.004 > [WebSocket] ✓ ZTM activated successfully
18:35:25.007 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:25.013 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:25.016 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:25.019 > [WebSocket] ========================================
18:35:25.024 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":237087,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:25.063 > [237.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:25.171 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":236638,"type":"ztm_activated"}
18:35:25.186 > [WebSocket] Processing message type: ztm_activated
18:35:25.190 > [237.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:25.293 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":237087,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:25.328 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:25.334 > [WebSocket] ========================================
18:35:25.340 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:25.346 > [WebSocket] ========================================
18:35:25.351 > [ZTM] Settings saved successfully
18:35:25.354 > [WebSocket] ✓ ZTM activated successfully
18:35:25.357 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:25.362 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:25.365 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:25.368 > [WebSocket] ========================================
18:35:25.373 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":237436,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:25.412 > [237.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:25.519 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":237123,"type":"ztm_activated"}
18:35:25.537 > [WebSocket] Processing message type: ztm_activated
18:35:25.539 > [237.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:25.645 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123925364,"threatLevel":0,"type":"heuristics_update"}
18:35:25.671 > [WebSocket] Processing message type: heuristics_update
18:35:25.676 > [237.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:25.778 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":237436,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:25.814 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:25.820 > [WebSocket] ========================================
18:35:25.825 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:25.831 > [WebSocket] ========================================
18:35:25.836 > [ZTM] Settings saved successfully
18:35:25.839 > [WebSocket] ✓ ZTM activated successfully
18:35:25.842 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:25.847 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:25.850 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:25.852 > [WebSocket] ========================================
18:35:25.858 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":237921,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:25.897 > [238.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:26.002 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":237473,"type":"ztm_activated"}
18:35:26.020 > [WebSocket] Processing message type: ztm_activated
18:35:26.022 > [238.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:26.126 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":237921,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:26.162 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:26.167 > [WebSocket] ========================================
18:35:26.174 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:26.179 > [WebSocket] ========================================
18:35:26.184 > [ZTM] Settings saved successfully
18:35:26.188 > [WebSocket] ✓ ZTM activated successfully
18:35:26.190 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:26.195 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:26.198 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:26.201 > [WebSocket] ========================================
18:35:26.207 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":238270,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:26.245 > [238.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:26.352 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":237957,"type":"ztm_activated"}
18:35:26.369 > [WebSocket] Processing message type: ztm_activated
18:35:26.372 > [238.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:26.475 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":238270,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:26.511 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:26.516 > [WebSocket] ========================================
18:35:26.523 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:26.528 > [WebSocket] ========================================
18:35:26.534 > [ZTM] Settings saved successfully
18:35:26.537 > [WebSocket] ✓ ZTM activated successfully
18:35:26.539 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:26.545 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:26.547 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:26.551 > [WebSocket] ========================================
18:35:26.556 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":238619,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:26.595 > [238.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:26.701 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":238305,"type":"ztm_activated"}
18:35:26.718 > [WebSocket] Processing message type: ztm_activated
18:35:26.720 > [238.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:26.824 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123926375,"threatLevel":0,"type":"heuristics_update"}
18:35:26.848 > [WebSocket] Processing message type: heuristics_update
18:35:26.854 > [238.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:26.959 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":238619,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:26.996 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:27.001 > [WebSocket] ========================================
18:35:27.006 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:27.012 > [WebSocket] ========================================
18:35:27.017 > [ZTM] Settings saved successfully
18:35:27.020 > [WebSocket] ✓ ZTM activated successfully
18:35:27.022 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:27.029 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:27.031 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:27.035 > [WebSocket] ========================================
18:35:27.040 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":239103,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:27.079 > [239.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:27.086 > [RETRY] Attempting to send health data (Max retries: 3)
18:35:27.089 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:35:27.095 > Generated health data: HR-63 SPO2-95 STEPS-1211
18:35:27.100 > [ESP32] ========================================
18:35:27.104 > [ESP32] ENCRYPTION PIPELINE START
18:35:27.107 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:35:27.112 > [ESP32] Active Algorithms for this packet:
18:35:27.118 > [ESP32]   + LFSR
18:35:27.118 > [ESP32]   + Tinkerbell
18:35:27.121 > [ESP32]   + Transposition
18:35:27.123 > [ESP32]   - ChaCha20
18:35:27.123 > [ESP32]   - Salsa20
18:35:27.126 > [ESP32] ========================================
18:35:27.129 > [ESP32] MsgKeys: lfsrSeed=0x7E415401 tnk[0..3]=0DFA036A trn[0..3]=342C264F
18:35:27.137 > 1_After_Salt (26): 48522D36332053504F322D3935205354 4550532D313231314D50
18:35:27.143 > 2_After_Padding (32): 48522D36332053504F322D3935205354 4550532D313231314D50000000000000 
18:35:27.151 > [ESP32][LFSR] Initializing - Seed: 0x7E415401 SeedBe: 0x0154417E ChaosKey[0..3]: 0DFA036A InitialTap: 0x0029 State: 0x7E415401
18:35:27.162 > [ESP32][LFSR] Input (first 16 bytes): 48522D36332053504F322D3935205354 Buffer size: 32 bytes
18:35:27.171 > 3_After_LFSR (32): 49066C48DD1B0EADB026277A15C8FB52 114B2DCD54CD9FE0C4184D7273F84C44 
18:35:27.179 > [ESP32][LFSR] Keystream (first 16 bytes): 0154417EEE3B5DFDFF140A4320E8A806
18:35:27.185 > [ESP32][4D] LFSR keystream (first 32 bytes): 0154417EEE3B5DFDFF140A4320E8A806541B7EE065FFAED189484D7273F84C44
18:35:27.193 > [ESP32][TINKERBELL] Input (first 16 bytes): 49066C48DD1B0EADB026277A15C8FB52 Nonce: 0x00000001 Buffer size: 32 bytes
18:35:27.204 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 0DFA036A
18:35:27.215 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): EB1F2DC8BFB8674C6EF97AB64AB0E7BF
18:35:27.223 > 4_After_Tinkerbell (32): A219418062A369E1DEDF5DCC5F781CED 7100B59EB2809AD8E3EB25D94F1DBB2B 
18:35:27.229 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): EB1F2DC8BFB8674C6EF97AB64AB0E7BF
18:35:27.237 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): EB1F2DC8BFB8674C6EF97AB64AB0E7BF604B9853E64D053827F368AB3CE5F76F
18:35:27.248 > 5_After_Transposition (32): 809A62CCA2A34FDEB21CBB716980192B 9E5FD9E11DEDEB004178DFE3B5255DD8 
18:35:27.256 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:35:27.262 > [ESP32] === HMAC DEBUG INFO ===
18:35:27.265 > [ESP32] HMAC Key being used: 4A57244B0AE71303A62E2B08B3CAF5922B6F0D656A844B526F41F1C2F4775B0F
18:35:27.273 > [ESP32] HMAC Input length: 45 bytes
18:35:27.276 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001809A62CCA2A34FDEB21CBB716980192B9E5FD9
18:35:27.284 > [ESP32] Nonce: 0x00000001
18:35:27.287 > [ESP32] Packet size before HMAC: 61
18:35:27.290 > [ESP32] Computed HMAC Tag: B7741BECE41256CEA1512D5572051D82
18:35:27.295 > [ESP32] === END HMAC DEBUG ===
18:35:27.298 > 6_Final_Packet (61): 82021800180004080400000001809A62 CCA2A34FDEB21CBB716980192B9E5FD9 ...
18:35:27.306 > [RETRY] Attempt 1/3 (nonce: 1)
18:35:27.309 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:27.312 > Sending pipeline data to server (659 bytes)
18:35:27.592 > [HTTP] Response code: 400
18:35:27.592 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:27.597 > [HTTP] Request failed with code: 400
18:35:27.600 > [RETRY] Send failed, waiting 100 ms before retry
18:35:27.700 > [RETRY] Attempt 2/3 (nonce: 1)
18:35:27.701 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:27.706 > Sending pipeline data to server (659 bytes)
18:35:27.927 > [HTTP] Response code: 400
18:35:27.928 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:27.933 > [HTTP] Request failed with code: 400
18:35:27.936 > [RETRY] Send failed, waiting 200 ms before retry
18:35:28.137 > [RETRY] Attempt 3/3 (nonce: 1)
18:35:28.138 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:28.143 > Sending pipeline data to server (659 bytes)
18:35:28.353 > [HTTP] Response code: 400
18:35:28.353 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:28.358 > [HTTP] Request failed with code: 400
18:35:28.361 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:35:28.367 > [RETRY] Consecutive failures: 4
18:35:28.369 > Health data send failed (retry count: 1/3)
18:35:28.473 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":238654,"type":"ztm_activated"}
18:35:28.489 > [WebSocket] Processing message type: ztm_activated
18:35:28.492 > [240.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:28.501 > [RETRY] Attempting to send health data (Max retries: 3)
18:35:28.506 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:35:28.512 > Generated health data: HR-64 SPO2-95 STEPS-1206
18:35:28.515 > [ESP32] ========================================
18:35:28.520 > [ESP32] ENCRYPTION PIPELINE START
18:35:28.522 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:35:28.528 > [ESP32] Active Algorithms for this packet:
18:35:28.530 > [ESP32]   + LFSR
18:35:28.534 > [ESP32]   + Tinkerbell
18:35:28.534 > [ESP32]   + Transposition
18:35:28.536 > [ESP32]   - ChaCha20
18:35:28.540 > [ESP32]   - Salsa20
18:35:28.540 > [ESP32] ========================================
18:35:28.545 > [ESP32] MsgKeys: lfsrSeed=0x7E415401 tnk[0..3]=0DFA036A trn[0..3]=342C264F
18:35:28.550 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313230364D50
18:35:28.559 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313230364D50000000000000 
18:35:28.565 > [ESP32][LFSR] Initializing - Seed: 0x7E415401 SeedBe: 0x0154417E ChaosKey[0..3]: 0DFA036A InitialTap: 0x0029 State: 0x7E415401
18:35:28.575 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
18:35:28.583 > 3_After_LFSR (32): 49066C48DA1B0EADB026277A15C8FB52 114B2DCD54CD9EE7C4184D7273F84C44 
18:35:28.592 > [ESP32][LFSR] Keystream (first 16 bytes): 0154417EEE3B5DFDFF140A4320E8A806
18:35:28.598 > [ESP32][4D] LFSR keystream (first 32 bytes): 0154417EEE3B5DFDFF140A4320E8A806541B7EE065FFAED189484D7273F84C44
18:35:28.608 > [ESP32][TINKERBELL] Input (first 16 bytes): 49066C48DA1B0EADB026277A15C8FB52 Nonce: 0x00000001 Buffer size: 32 bytes
18:35:28.617 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 0DFA036A
18:35:28.628 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): EB1F2DC8BFB8674C6EF97AB64AB0E7BF
18:35:28.636 > 4_After_Tinkerbell (32): A219418065A369E1DEDF5DCC5F781CED 7100B59EB2809BDFE3EB25D94F1DBB2B 
18:35:28.645 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): EB1F2DC8BFB8674C6EF97AB64AB0E7BF
18:35:28.653 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): EB1F2DC8BFB8674C6EF97AB64AB0E7BF604B9853E64D053827F368AB3CE5F76F
18:35:28.662 > 5_After_Transposition (32): 809B65CCA2A34FDEB21CBB716980192B 9E5FD9E11DEDEB004178DFE3B5255DDF 
18:35:28.669 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:35:28.675 > [ESP32] === HMAC DEBUG INFO ===
18:35:28.678 > [ESP32] HMAC Key being used: 4A57244B0AE71303A62E2B08B3CAF5922B6F0D656A844B526F41F1C2F4775B0F
18:35:28.686 > [ESP32] HMAC Input length: 45 bytes
18:35:28.689 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001809B65CCA2A34FDEB21CBB716980192B9E5FD9
18:35:28.698 > [ESP32] Nonce: 0x00000001
18:35:28.701 > [ESP32] Packet size before HMAC: 61
18:35:28.703 > [ESP32] Computed HMAC Tag: A09A1724502210DC1A44343B405CD695
18:35:28.708 > [ESP32] === END HMAC DEBUG ===
18:35:28.712 > 6_Final_Packet (61): 82021800180004080400000001809B65 CCA2A34FDEB21CBB716980192B9E5FD9 ...
18:35:28.720 > [RETRY] Attempt 1/3 (nonce: 1)
18:35:28.723 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:28.728 > Sending pipeline data to server (659 bytes)
18:35:28.872 > [HTTP] Response code: 400
18:35:28.872 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:28.877 > [HTTP] Request failed with code: 400
18:35:28.879 > [RETRY] Send failed, waiting 100 ms before retry
18:35:28.980 > [RETRY] Attempt 2/3 (nonce: 1)
18:35:28.980 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:28.985 > Sending pipeline data to server (659 bytes)
18:35:29.109 > [HTTP] Response code: 400
18:35:29.109 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:29.115 > [HTTP] Request failed with code: 400
18:35:29.117 > [RETRY] Send failed, waiting 200 ms before retry
18:35:29.317 > [RETRY] Attempt 3/3 (nonce: 1)
18:35:29.317 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:29.322 > Sending pipeline data to server (659 bytes)
18:35:29.613 > [HTTP] Response code: 400
18:35:29.613 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:29.619 > [HTTP] Request failed with code: 400
18:35:29.621 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:35:29.626 > [RETRY] Consecutive failures: 5
18:35:29.629 > [EMERGENCY] Triggering emergency reset!
18:35:29.631 > [CRYPTO] Resetting cryptographic state
18:35:29.638 > [CRYPTO] Crypto state reset complete
18:35:29.641 > [CRYPTO] Packet counter: 4
18:35:29.644 > [EMERGENCY] Emergency reset complete
18:35:29.646 > Health data send failed (retry count: 2/3)
18:35:29.744 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":239103,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:29.779 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:29.785 > [WebSocket] ========================================
18:35:29.790 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:29.796 > [WebSocket] ========================================
18:35:29.802 > [ZTM] Settings saved successfully
18:35:29.805 > [WebSocket] ✓ ZTM activated successfully
18:35:29.807 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:29.812 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:29.816 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:29.819 > [WebSocket] ========================================
18:35:29.823 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":241887,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:29.862 > [241.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:29.871 > [RETRY] Attempting to send health data (Max retries: 3)
18:35:29.874 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:35:29.879 > Generated health data: HR-64 SPO2-95 STEPS-1239
18:35:29.884 > [ESP32] ========================================
18:35:29.888 > [ESP32] ENCRYPTION PIPELINE START
18:35:29.890 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:35:29.896 > [ESP32] Active Algorithms for this packet:
18:35:29.902 > [ESP32]   + LFSR
18:35:29.902 > [ESP32]   + Tinkerbell
18:35:29.905 > [ESP32]   + Transposition
18:35:29.907 > [ESP32]   - ChaCha20
18:35:29.907 > [ESP32]   - Salsa20
18:35:29.910 > [ESP32] ========================================
18:35:29.913 > [ESP32] MsgKeys: lfsrSeed=0x7E415401 tnk[0..3]=0DFA036A trn[0..3]=342C264F
18:35:29.921 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313233394D50
18:35:29.926 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313233394D50000000000000 
18:35:29.935 > [ESP32][LFSR] Initializing - Seed: 0x7E415401 SeedBe: 0x0154417E ChaosKey[0..3]: 0DFA036A InitialTap: 0x0029 State: 0x7E415401
18:35:29.946 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
18:35:29.954 > 3_After_LFSR (32): 49066C48DA1B0EADB026277A15C8FB52 114B2DCD54CD9DE8C4184D7273F84C44 
18:35:29.962 > [ESP32][LFSR] Keystream (first 16 bytes): 0154417EEE3B5DFDFF140A4320E8A806
18:35:29.968 > [ESP32][4D] LFSR keystream (first 32 bytes): 0154417EEE3B5DFDFF140A4320E8A806541B7EE065FFAED189484D7273F84C44
18:35:29.977 > [ESP32][TINKERBELL] Input (first 16 bytes): 49066C48DA1B0EADB026277A15C8FB52 Nonce: 0x00000001 Buffer size: 32 bytes
18:35:29.988 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 0DFA036A
18:35:29.998 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): EB1F2DC8BFB8674C6EF97AB64AB0E7BF
18:35:30.008 > 4_After_Tinkerbell (32): A219418065A369E1DEDF5DCC5F781CED 7100B59EB28098D0E3EB25D94F1DBB2B 
18:35:30.013 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): EB1F2DC8BFB8674C6EF97AB64AB0E7BF
18:35:30.021 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): EB1F2DC8BFB8674C6EF97AB64AB0E7BF604B9853E64D053827F368AB3CE5F76F
18:35:30.032 > 5_After_Transposition (32): 809865CCA2A34FDEB21CBB716980192B 9E5FD9E11DEDEB004178DFE3B5255DD0 
18:35:30.041 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:35:30.046 > [ESP32] === HMAC DEBUG INFO ===
18:35:30.049 > [ESP32] HMAC Key being used: 4A57244B0AE71303A62E2B08B3CAF5922B6F0D656A844B526F41F1C2F4775B0F
18:35:30.057 > [ESP32] HMAC Input length: 45 bytes
18:35:30.060 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001809865CCA2A34FDEB21CBB716980192B9E5FD9
18:35:30.068 > [ESP32] Nonce: 0x00000001
18:35:30.071 > [ESP32] Packet size before HMAC: 61
18:35:30.073 > [ESP32] Computed HMAC Tag: EBCDA43DCBE8B8834A0B19582F0E286F
18:35:30.079 > [ESP32] === END HMAC DEBUG ===
18:35:30.082 > 6_Final_Packet (61): 82021800180004080400000001809865 CCA2A34FDEB21CBB716980192B9E5FD9 ...
18:35:30.091 > [RETRY] Attempt 1/3 (nonce: 1)
18:35:30.094 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:30.096 > Sending pipeline data to server (659 bytes)
18:35:30.365 > [HTTP] Response code: 400
18:35:30.365 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:30.371 > [HTTP] Request failed with code: 400
18:35:30.373 > [RETRY] Send failed, waiting 100 ms before retry
18:35:30.472 > [RETRY] Attempt 2/3 (nonce: 1)
18:35:30.472 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:30.478 > Sending pipeline data to server (659 bytes)
18:35:30.616 > [HTTP] Response code: 400
18:35:30.616 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:30.620 > [HTTP] Request failed with code: 400
18:35:30.623 > [RETRY] Send failed, waiting 200 ms before retry
18:35:30.823 > [RETRY] Attempt 3/3 (nonce: 1)
18:35:30.823 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:30.828 > Sending pipeline data to server (659 bytes)
18:35:31.120 > [HTTP] Response code: 400
18:35:31.120 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:31.126 > [HTTP] Request failed with code: 400
18:35:31.128 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:35:31.133 > [RETRY] Consecutive failures: 1
18:35:31.137 > Health data send failed (retry count: 3/3)
18:35:31.139 > Health data transmission failed after max retries
18:35:31.240 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":239138,"type":"ztm_activated"}
18:35:31.256 > [WebSocket] Processing message type: ztm_activated
18:35:31.259 > [243.3] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:31.267 > ERROR state - attempting recovery
18:35:31.270 > [RETRY] Attempting to send health data (Max retries: 3)
18:35:31.275 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:35:31.279 > Generated health data: HR-64 SPO2-95 STEPS-1230
18:35:31.284 > [ESP32] ========================================
18:35:31.287 > [ESP32] ENCRYPTION PIPELINE START
18:35:31.292 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:35:31.295 > [ESP32] Active Algorithms for this packet:
18:35:31.301 > [ESP32]   + LFSR
18:35:31.301 > [ESP32]   + Tinkerbell
18:35:31.303 > [ESP32]   + Transposition
18:35:31.306 > [ESP32]   - ChaCha20
18:35:31.306 > [ESP32]   - Salsa20
18:35:31.309 > [ESP32] ========================================
18:35:31.315 > [ESP32] MsgKeys: lfsrSeed=0x7E415401 tnk[0..3]=0DFA036A trn[0..3]=342C264F
18:35:31.320 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313233304D50
18:35:31.325 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313233304D50000000000000 
18:35:31.333 > [ESP32][LFSR] Initializing - Seed: 0x7E415401 SeedBe: 0x0154417E ChaosKey[0..3]: 0DFA036A InitialTap: 0x0029 State: 0x7E415401
18:35:31.345 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
18:35:31.352 > 3_After_LFSR (32): 49066C48DA1B0EADB026277A15C8FB52 114B2DCD54CD9DE1C4184D7273F84C44 
18:35:31.362 > [ESP32][LFSR] Keystream (first 16 bytes): 0154417EEE3B5DFDFF140A4320E8A806
18:35:31.367 > [ESP32][4D] LFSR keystream (first 32 bytes): 0154417EEE3B5DFDFF140A4320E8A806541B7EE065FFAED189484D7273F84C44
18:35:31.379 > [ESP32][TINKERBELL] Input (first 16 bytes): 49066C48DA1B0EADB026277A15C8FB52 Nonce: 0x00000001 Buffer size: 32 bytes
18:35:31.386 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 0DFA036A
18:35:31.398 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): EB1F2DC8BFB8674C6EF97AB64AB0E7BF
18:35:31.406 > 4_After_Tinkerbell (32): A219418065A369E1DEDF5DCC5F781CED 7100B59EB28098D9E3EB25D94F1DBB2B 
18:35:31.414 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): EB1F2DC8BFB8674C6EF97AB64AB0E7BF
18:35:31.420 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): EB1F2DC8BFB8674C6EF97AB64AB0E7BF604B9853E64D053827F368AB3CE5F76F
18:35:31.431 > 5_After_Transposition (32): 809865CCA2A34FDEB21CBB716980192B 9E5FD9E11DEDEB004178DFE3B5255DD9 
18:35:31.439 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:35:31.445 > [ESP32] === HMAC DEBUG INFO ===
18:35:31.448 > [ESP32] HMAC Key being used: 4A57244B0AE71303A62E2B08B3CAF5922B6F0D656A844B526F41F1C2F4775B0F
18:35:31.456 > [ESP32] HMAC Input length: 45 bytes
18:35:31.459 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001809865CCA2A34FDEB21CBB716980192B9E5FD9
18:35:31.467 > [ESP32] Nonce: 0x00000001
18:35:31.470 > [ESP32] Packet size before HMAC: 61
18:35:31.473 > [ESP32] Computed HMAC Tag: ED8F3BA9049412A3AC96803410097EFF
18:35:31.479 > [ESP32] === END HMAC DEBUG ===
18:35:31.481 > 6_Final_Packet (61): 82021800180004080400000001809865 CCA2A34FDEB21CBB716980192B9E5FD9 ...
18:35:31.489 > [RETRY] Attempt 1/3 (nonce: 1)
18:35:31.493 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:31.498 > Sending pipeline data to server (659 bytes)
18:35:31.626 > [HTTP] Response code: 400
18:35:31.626 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:31.631 > [HTTP] Request failed with code: 400
18:35:31.634 > [RETRY] Send failed, waiting 100 ms before retry
18:35:31.734 > [RETRY] Attempt 2/3 (nonce: 1)
18:35:31.734 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:31.739 > Sending pipeline data to server (659 bytes)
18:35:31.881 > [HTTP] Response code: 400
18:35:31.881 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:31.887 > [HTTP] Request failed with code: 400
18:35:31.890 > [RETRY] Send failed, waiting 200 ms before retry
18:35:32.088 > [RETRY] Attempt 3/3 (nonce: 1)
18:35:32.089 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:32.095 > Sending pipeline data to server (659 bytes)
18:35:32.386 > [HTTP] Response code: 400
18:35:32.387 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:32.392 > [HTTP] Request failed with code: 400
18:35:32.394 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:35:32.400 > [RETRY] Consecutive failures: 2
18:35:32.403 > ✗ Auto-recovery failed - restarting key exchange
18:35:34.505 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123927388,"threatLevel":0,"type":"heuristics_update"}
18:35:34.530 > [WebSocket] Processing message type: heuristics_update
18:35:34.536 > [246.6] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:34.545 > ✓ Public key loaded from NVS
18:35:34.642 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":239662,"type":"health_data_error"}
18:35:34.656 > [WebSocket] Processing message type: health_data_error
18:35:34.662 > [246.7] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:34.765 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":239998,"type":"health_data_error"}
18:35:34.779 > [WebSocket] Processing message type: health_data_error
18:35:34.784 > [246.8] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:34.793 > Generating fresh master key from entropy...
18:35:34.802 > Generated master key (32): E850A915BE6A178018F6E157EC706928 8C7D0F1B521BAEE19C2D3849C81CC5B3 
18:35:34.807 > Using reduced master key (byte % 3) for NTRU encryption only
18:35:34.818 > NTRU encrypted master key (502): 0063005B00400065001600450008006D 00360003001E000C006D006F0021000D ...
18:35:34.826 > POST http://10.249.92.115:8081/master-key
18:35:35.153 > ✓ Master key exchange completed
18:35:35.254 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":240423,"type":"health_data_error"}
18:35:35.267 > [WebSocket] Processing message type: health_data_error
18:35:35.274 > [247.3] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:35.281 > Loading master key from NVS and deriving symmetric keys...
18:35:35.286 > Loaded master key from NVS (32): E850A915BE6A178018F6E157EC706928 8C7D0F1B521BAEE19C2D3849C81CC5B3 
18:35:35.296 > Derived HMAC key (32): C250F7B2F067CAA1EA9D5E8395F77910 6C5A18BC69D130ED00EEEC7196085A64 
18:35:35.304 > Derived Tinkerbell key (16): 16DB187AFF3669272BC1B4898DC4AB80 
18:35:35.309 > Derived Transposition key (16): 81CB284F7B73F9EF88236384D266F743 
18:35:35.315 > ✓ Symmetric keys derived successfully
18:35:35.318 > Nonce tracker reset - new session started
18:35:35.814 > Waiting for server to process master key...
18:35:35.817 > ✓ Symmetric keys ready - starting health data transmission
18:35:35.921 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123928397,"threatLevel":0,"type":"heuristics_update"}
18:35:35.945 > [WebSocket] Processing message type: heuristics_update
18:35:35.951 > [248.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:36.054 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":240942,"type":"health_data_error"}
18:35:36.068 > [WebSocket] Processing message type: health_data_error
18:35:36.073 > [248.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:36.175 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":241179,"type":"health_data_error"}
18:35:36.189 > [WebSocket] Processing message type: health_data_error
18:35:36.194 > [248.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:36.296 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123929406,"threatLevel":0,"type":"heuristics_update"}
18:35:36.323 > [WebSocket] Processing message type: heuristics_update
18:35:36.328 > [248.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:36.430 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":241683,"type":"health_data_error"}
18:35:36.444 > [WebSocket] Processing message type: health_data_error
18:35:36.450 > [248.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:36.553 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":241887,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:36.588 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:36.594 > [WebSocket] ========================================
18:35:36.600 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:36.605 > [WebSocket] ========================================
18:35:36.611 > [ZTM] Settings saved successfully
18:35:36.614 > [WebSocket] ✓ ZTM activated successfully
18:35:36.616 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:36.621 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:36.625 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:36.628 > [WebSocket] ========================================
18:35:36.633 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":248696,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:36.671 > [248.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:36.780 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":241923,"type":"ztm_activated"}
18:35:36.796 > [WebSocket] Processing message type: ztm_activated
18:35:36.798 > [248.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:36.902 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":242436,"type":"health_data_error"}
18:35:36.915 > [WebSocket] Processing message type: health_data_error
18:35:36.921 > [249.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:37.024 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123930419,"threatLevel":0,"type":"heuristics_update"}
18:35:37.050 > [WebSocket] Processing message type: heuristics_update
18:35:37.055 > [249.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:37.157 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":242686,"type":"health_data_error"}
18:35:37.172 > [WebSocket] Processing message type: health_data_error
18:35:37.177 > [249.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:37.279 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":7,"success":false,"timestamp":243191,"type":"health_data_error"}
18:35:37.293 > [WebSocket] Processing message type: health_data_error
18:35:37.298 > [249.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:37.401 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123931419,"threatLevel":0,"type":"heuristics_update"}
18:35:37.426 > [WebSocket] Processing message type: heuristics_update
18:35:37.432 > [249.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:37.534 > [249.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:37.635 > [249.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:37.736 > [249.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:37.837 > [249.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:37.938 > [250.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:38.039 > [250.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:38.139 > [250.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:38.241 > [250.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:38.342 > [250.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:38.443 > [250.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:38.544 > [250.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:38.645 > [250.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:38.746 > [250.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:38.849 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":8,"success":false,"timestamp":243697,"type":"health_data_error"}
18:35:38.864 > [WebSocket] Processing message type: health_data_error
18:35:38.870 > [250.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:38.972 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":8,"success":false,"timestamp":243952,"type":"health_data_error"}
18:35:38.987 > [WebSocket] Processing message type: health_data_error
18:35:38.992 > [251.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:39.094 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Failed to send health data","state":8,"success":false,"timestamp":244457,"type":"health_data_error"}
18:35:39.108 > [WebSocket] Processing message type: health_data_error
18:35:39.113 > [251.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:39.217 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123932420,"threatLevel":0,"type":"heuristics_update"}
18:35:39.241 > [WebSocket] Processing message type: heuristics_update
18:35:39.246 > [251.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:39.349 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123933424,"threatLevel":0,"type":"heuristics_update"}
18:35:39.375 > [WebSocket] Processing message type: heuristics_update
18:35:39.379 > [251.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:39.482 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123934439,"threatLevel":0,"type":"heuristics_update"}
18:35:39.507 > [WebSocket] Processing message type: heuristics_update
18:35:39.513 > [251.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:39.616 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770123934919,"type":"master_key_received"}
18:35:39.629 > [WebSocket] Processing message type: master_key_received
18:35:39.632 > [251.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:39.736 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":247215,"type":"master_key_exchanged"}
18:35:39.754 > [WebSocket] Processing message type: master_key_exchanged
18:35:39.760 > [251.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:39.861 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123935450,"threatLevel":0,"type":"heuristics_update"}
18:35:39.885 > [WebSocket] Processing message type: heuristics_update
18:35:39.891 > [252.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:39.993 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":247884,"type":"symmetric_keys_derived"}
18:35:40.010 > [WebSocket] Processing message type: symmetric_keys_derived
18:35:40.015 > [252.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:40.115 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123936466,"threatLevel":0,"type":"heuristics_update"}
18:35:40.140 > [WebSocket] Processing message type: heuristics_update
18:35:40.146 > [252.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:40.249 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":248696,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:40.284 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:40.290 > [WebSocket] ========================================
18:35:40.296 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:40.300 > [WebSocket] ========================================
18:35:40.306 > [ZTM] Settings saved successfully
18:35:40.309 > [WebSocket] ✓ ZTM activated successfully
18:35:40.312 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:40.318 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:40.321 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:40.323 > [WebSocket] ========================================
18:35:40.329 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":252392,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:40.368 > [252.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:40.473 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":248732,"type":"ztm_activated"}
18:35:40.490 > [WebSocket] Processing message type: ztm_activated
18:35:40.493 > [252.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:40.597 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123937474,"threatLevel":0,"type":"heuristics_update"}
18:35:40.622 > [WebSocket] Processing message type: heuristics_update
18:35:40.627 > [252.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:40.729 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123938477,"threatLevel":0,"type":"heuristics_update"}
18:35:40.754 > [WebSocket] Processing message type: heuristics_update
18:35:40.760 > [252.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:40.862 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123939492,"threatLevel":0,"type":"heuristics_update"}
18:35:40.886 > [WebSocket] Processing message type: heuristics_update
18:35:40.893 > [253.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:40.995 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":252392,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:41.031 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:41.036 > [WebSocket] ========================================
18:35:41.043 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:41.048 > [WebSocket] ========================================
18:35:41.054 > [ZTM] Settings saved successfully
18:35:41.056 > [WebSocket] ✓ ZTM activated successfully
18:35:41.059 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:41.064 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:41.067 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:41.070 > [WebSocket] ========================================
18:35:41.076 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":253139,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:41.114 > [253.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:41.221 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":252428,"type":"ztm_activated"}
18:35:41.238 > [WebSocket] Processing message type: ztm_activated
18:35:41.241 > [253.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:41.345 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123940502,"threatLevel":0,"type":"heuristics_update"}
18:35:41.370 > [WebSocket] Processing message type: heuristics_update
18:35:41.375 > [253.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:41.477 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":253139,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:41.514 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:41.519 > [WebSocket] ========================================
18:35:41.526 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:41.531 > [WebSocket] ========================================
18:35:41.537 > [ZTM] Settings saved successfully
18:35:41.540 > [WebSocket] ✓ ZTM activated successfully
18:35:41.542 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:41.548 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:41.550 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:41.553 > [WebSocket] ========================================
18:35:41.558 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":253622,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:41.597 > [253.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:41.704 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":253175,"type":"ztm_activated"}
18:35:41.721 > [WebSocket] Processing message type: ztm_activated
18:35:41.723 > [253.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:41.830 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123941514,"threatLevel":0,"type":"heuristics_update"}
18:35:41.855 > [WebSocket] Processing message type: heuristics_update
18:35:41.860 > [253.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:41.964 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":253622,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:41.999 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:42.005 > [WebSocket] ========================================
18:35:42.011 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:42.016 > [WebSocket] ========================================
18:35:42.022 > [ZTM] Settings saved successfully
18:35:42.025 > [WebSocket] ✓ ZTM activated successfully
18:35:42.027 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:42.033 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:42.035 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:42.038 > [WebSocket] ========================================
18:35:42.044 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":254107,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:42.083 > [254.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:42.189 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":253658,"type":"ztm_activated"}
18:35:42.206 > [WebSocket] Processing message type: ztm_activated
18:35:42.209 > [254.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:42.312 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":254107,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:42.348 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:42.354 > [WebSocket] ========================================
18:35:42.360 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:42.366 > [WebSocket] ========================================
18:35:42.371 > [ZTM] Settings saved successfully
18:35:42.374 > [WebSocket] ✓ ZTM activated successfully
18:35:42.377 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:42.381 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:42.385 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:42.388 > [WebSocket] ========================================
18:35:42.393 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":254457,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:42.433 > [254.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:42.538 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":254143,"type":"ztm_activated"}
18:35:42.555 > [WebSocket] Processing message type: ztm_activated
18:35:42.558 > [254.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:42.662 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":254457,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:42.698 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:42.703 > [WebSocket] ========================================
18:35:42.709 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:42.715 > [WebSocket] ========================================
18:35:42.720 > [ZTM] Settings saved successfully
18:35:42.723 > [WebSocket] ✓ ZTM activated successfully
18:35:42.725 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:42.731 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:42.734 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:42.736 > [WebSocket] ========================================
18:35:42.742 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":254806,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:42.781 > [254.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:42.886 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":254492,"type":"ztm_activated"}
18:35:42.904 > [WebSocket] Processing message type: ztm_activated
18:35:42.907 > [255.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:43.009 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123942527,"threatLevel":0,"type":"heuristics_update"}
18:35:43.035 > [WebSocket] Processing message type: heuristics_update
18:35:43.040 > [255.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:43.146 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":254806,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:43.182 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:43.188 > [WebSocket] ========================================
18:35:43.193 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:43.198 > [WebSocket] ========================================
18:35:43.204 > [ZTM] Settings saved successfully
18:35:43.207 > [WebSocket] ✓ ZTM activated successfully
18:35:43.210 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:43.216 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:43.218 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:43.221 > [WebSocket] ========================================
18:35:43.227 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":255290,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:43.265 > [255.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:43.371 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":254841,"type":"ztm_activated"}
18:35:43.388 > [WebSocket] Processing message type: ztm_activated
18:35:43.391 > [255.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:43.495 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":255290,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:43.531 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:43.537 > [WebSocket] ========================================
18:35:43.542 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:43.548 > [WebSocket] ========================================
18:35:43.553 > [ZTM] Settings saved successfully
18:35:43.556 > [WebSocket] ✓ ZTM activated successfully
18:35:43.559 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:43.564 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:43.567 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:43.570 > [WebSocket] ========================================
18:35:43.575 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":255639,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:43.615 > [255.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:43.721 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":255326,"type":"ztm_activated"}
18:35:43.738 > [WebSocket] Processing message type: ztm_activated
18:35:43.741 > [255.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:43.845 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123943536,"threatLevel":0,"type":"heuristics_update"}
18:35:43.870 > [WebSocket] Processing message type: heuristics_update
18:35:43.876 > [255.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:43.978 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":255639,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:44.013 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:44.019 > [WebSocket] ========================================
18:35:44.025 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:44.030 > [WebSocket] ========================================
18:35:44.036 > [ZTM] Settings saved successfully
18:35:44.038 > [WebSocket] ✓ ZTM activated successfully
18:35:44.041 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:44.047 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:44.050 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:44.052 > [WebSocket] ========================================
18:35:44.058 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":256121,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:44.097 > [256.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:44.203 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":255674,"type":"ztm_activated"}
18:35:44.220 > [WebSocket] Processing message type: ztm_activated
18:35:44.223 > [256.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:44.329 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":256121,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:44.365 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:44.370 > [WebSocket] ========================================
18:35:44.376 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:44.382 > [WebSocket] ========================================
18:35:44.388 > [ZTM] Settings saved successfully
18:35:44.390 > [WebSocket] ✓ ZTM activated successfully
18:35:44.393 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:44.398 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:44.401 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:44.404 > [WebSocket] ========================================
18:35:44.409 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":256473,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:44.453 > [256.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:44.554 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":256157,"type":"ztm_activated"}
18:35:44.571 > [WebSocket] Processing message type: ztm_activated
18:35:44.573 > [256.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:44.677 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":256473,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:44.714 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:44.719 > [WebSocket] ========================================
18:35:44.724 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:44.730 > [WebSocket] ========================================
18:35:44.736 > [ZTM] Settings saved successfully
18:35:44.739 > [WebSocket] ✓ ZTM activated successfully
18:35:44.741 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:44.746 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:44.750 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:44.753 > [WebSocket] ========================================
18:35:44.758 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":256822,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:44.797 > [256.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:44.903 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":256518,"type":"ztm_activated"}
18:35:44.920 > [WebSocket] Processing message type: ztm_activated
18:35:44.923 > [257.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:45.026 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123944546,"threatLevel":0,"type":"heuristics_update"}
18:35:45.051 > [WebSocket] Processing message type: heuristics_update
18:35:45.056 > [257.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:45.159 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":256822,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:45.196 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:45.201 > [WebSocket] ========================================
18:35:45.206 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:45.212 > [WebSocket] ========================================
18:35:45.217 > [ZTM] Settings saved successfully
18:35:45.221 > [WebSocket] ✓ ZTM activated successfully
18:35:45.223 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:45.229 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:45.232 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:45.234 > [WebSocket] ========================================
18:35:45.240 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":257304,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:45.279 > [257.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:45.385 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":256857,"type":"ztm_activated"}
18:35:45.402 > [WebSocket] Processing message type: ztm_activated
18:35:45.404 > [257.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:45.511 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":257304,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:45.547 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:45.552 > [WebSocket] ========================================
18:35:45.558 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:45.563 > [WebSocket] ========================================
18:35:45.569 > [ZTM] Settings saved successfully
18:35:45.571 > [WebSocket] ✓ ZTM activated successfully
18:35:45.574 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:45.580 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:45.582 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:45.586 > [WebSocket] ========================================
18:35:45.591 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":257655,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:45.630 > [257.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:45.735 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":257340,"type":"ztm_activated"}
18:35:45.753 > [WebSocket] Processing message type: ztm_activated
18:35:45.756 > [257.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:45.859 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123945556,"threatLevel":0,"type":"heuristics_update"}
18:35:45.884 > [WebSocket] Processing message type: heuristics_update
18:35:45.891 > [258.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 8 | WS: CONNECTED
18:35:45.896 > [RETRY] Attempting to send health data (Max retries: 3)
18:35:45.901 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:35:45.906 > Generated health data: HR-64 SPO2-95 STEPS-1295
18:35:45.909 > [ESP32] ========================================
18:35:45.915 > [ESP32] ENCRYPTION PIPELINE START
18:35:45.917 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:35:45.924 > [ESP32] Active Algorithms for this packet:
18:35:45.927 > [ESP32]   + LFSR
18:35:45.929 > [ESP32]   + Tinkerbell
18:35:45.932 > [ESP32]   + Transposition
18:35:45.932 > [ESP32]   - ChaCha20
18:35:45.934 > [ESP32]   - Salsa20
18:35:45.938 > [ESP32] ========================================
18:35:45.940 > [ESP32] MsgKeys: lfsrSeed=0xF8381C82 tnk[0..3]=1B74295D trn[0..3]=A31EEECA
18:35:45.949 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313239354D50
18:35:45.954 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313239354D50000000000000 
18:35:45.963 > [ESP32][LFSR] Initializing - Seed: 0xF8381C82 SeedBe: 0x821C38F8 ChaosKey[0..3]: 1B74295D InitialTap: 0x0029 State: 0xF8381C82
18:35:45.973 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
18:35:45.981 > 3_After_LFSR (32): CA4E15CED2E7141FD3E4BF550D5E520E 8E12EF81598BC2C4600D68CAE24D19BA 
18:35:45.986 > [ESP32][LFSR] Keystream (first 16 bytes): 821C38F8E6C7474F9CD6926C387E015A
18:35:45.996 > [ESP32][4D] LFSR keystream (first 32 bytes): 821C38F8E6C7474F9CD6926C387E015ACB42BCAC68B9FBF12D5D68CAE24D19BA
18:35:46.004 > [ESP32][TINKERBELL] Input (first 16 bytes): CA4E15CED2E7141FD3E4BF550D5E520E Nonce: 0x00000001 Buffer size: 32 bytes
18:35:46.015 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 1B74295D
18:35:46.023 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 47CD2C9CBE431F6906B611977FD052A5
18:35:46.032 > 4_After_Tinkerbell (32): 8D8339526CA40B76D552AEC2728E00AB E32A64326627FDC4DD17F2EF0606D1F7 
18:35:46.040 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 47CD2C9CBE431F6906B611977FD052A5
18:35:46.049 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 47CD2C9CBE431F6906B611977FD052A56D388BB33FAC3F00BD1A9A25E44BC84D
18:35:46.059 > 5_After_Transposition (32): 526CA483398D760BC2728E52AED5AB00 3266272A64E3C4FDEF060617F2DDF7D1 
18:35:46.068 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:35:46.071 > [ESP32] === HMAC DEBUG INFO ===
18:35:46.073 > [ESP32] HMAC Key being used: C250F7B2F067CAA1EA9D5E8395F779106C5A18BC69D130ED00EEEC7196085A64
18:35:46.082 > [ESP32] HMAC Input length: 45 bytes
18:35:46.084 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001526CA483398D760BC2728E52AED5AB00326627
18:35:46.096 > [ESP32] Nonce: 0x00000001
18:35:46.096 > [ESP32] Packet size before HMAC: 61
18:35:46.101 > [ESP32] Computed HMAC Tag: 4519986970FDDE78C7AF4240F43090C7
18:35:46.104 > [ESP32] === END HMAC DEBUG ===
18:35:46.106 > 6_Final_Packet (61): 82021800180004080400000001526CA4 83398D760BC2728E52AED5AB00326627 ...
18:35:46.115 > [RETRY] Attempt 1/3 (nonce: 1)
18:35:46.118 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:46.123 > Sending pipeline data to server (659 bytes)
18:35:46.423 > [HTTP] Response code: 200
18:35:46.423 > [HTTP] Response: {"status":"OK:DECRYPTED"}
18:35:46.433 > [RETRY] Health data sent successfully!
18:35:46.436 > ✓ Health data #9 sent successfully
18:35:46.536 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":257655,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:46.571 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:46.576 > [WebSocket] ========================================
18:35:46.582 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:46.588 > [WebSocket] ========================================
18:35:46.594 > [ZTM] Settings saved successfully
18:35:46.595 > [WebSocket] ✓ ZTM activated successfully
18:35:46.599 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:46.604 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:46.607 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:46.610 > [WebSocket] ========================================
18:35:46.615 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":258680,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:46.654 > [258.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:46.761 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":257691,"type":"ztm_activated"}
18:35:46.777 > [WebSocket] Processing message type: ztm_activated
18:35:46.781 > [258.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:46.886 > [WebSocket] Received (182 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":1,"serverTime":1770123946229,"type":"security_update"}
18:35:46.903 > [WebSocket] Processing message type: security_update
18:35:46.909 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
18:35:46.915 > [259.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:47.020 > [WebSocket] Received (686 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","encData":"ENC_DATA:82021800180004080400000001526CA483398D760BC2728E52AED5AB003266272A64E3C4FDEF060617F2DDF7D14519986970FDDE78C7AF4240F43090C7","pipeline":{"afterLFSR":"CA4E15CED2E7141FD3E4BF550D5E520E8E12EF81598BC2C4600D68CAE24D19BA","afterSalt":"48522D36342053504F322D39352053544550532D313239354D50","afterTinkerbell":"8D8339526CA40B76D552AEC2728E00ABE32A64326627FDC4DD17F2EF0606D1F7","afterTransposition":"526CA483398D760BC2728E52AED5AB003266272A64E3C4FDEF060617F2DDF7D1"},"plaintext":"HR-64 SPO2-95 STEPS-1295","serverTime":1770123946229,"timestamp":258189,"type":"encryption_update","ztmEnabled":true}
18:35:47.081 > [WebSocket] Processing message type: encryption_update
18:35:47.086 > [259.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:47.194 > [WebSocket] Received (88 bytes): {"heartRate":64,"spo2":95,"steps":1295,"time":1770123946229,"type":"health_data_update"}
18:35:47.203 > [WebSocket] Processing message type: health_data_update
18:35:47.208 > [259.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:47.316 > [WebSocket] Received (226 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.2768,"encryptionTime":0.0,"finalPlaintext":"HR-64 SPO2-95 STEPS-1295","handshakeSuccess":true,"totalTime":0.2768},"type":"session_summary_update"}
18:35:47.338 > [WebSocket] Processing message type: session_summary_update
18:35:47.344 > [259.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:47.450 > [WebSocket] Received (660 bytes): {"decryptionTime":0.2768,"encryptedPacket":"82021800180004080400000001526CA483398D760BC2728E52AED5AB003266272A64E3C4FDEF060617F2DDF7D14519986970FDDE78C7AF4240F43090C7","finalPlaintext":"HR-64 SPO2-95 STEPS-1295","healthData":{"heartRate":64,"spo2":95,"steps":1295},"pipeline":{"afterDepad":"48522D36342053504F322D39352053544550532D31323935000000000000","afterLFSR":"48522D36342053504F322D39352053544550532D313239354D50000000000000","afterTinkerbell":"CA4E15CED2E7141FD3E4BF550D5E520E8E12EF81598BC2C4600D68CAE24D19BA","afterTransposition":"8D8339526CA40B76D552AEC2728E00ABE32A64326627FDC4DD17F2EF0606D1F7"},"serverTime":1770123946230,"type":"decryption_update"}
18:35:47.508 > [WebSocket] Processing message type: decryption_update
18:35:47.514 > [WebSocket] Server decryption completed
18:35:47.516 > [WebSocket] Health data - HR: 64, SPO2: 95, Steps: 1295
18:35:47.522 > [259.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:47.623 > [WebSocket] Received (698 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","healthSendCount":8,"pipeline":{"afterLFSR":"CA4E15CED2E7141FD3E4BF550D5E520E8E12EF81598BC2C4600D68CAE24D19BA","afterSalt":"48522D36342053504F322D39352053544550532D313239354D50","afterTinkerbell":"8D8339526CA40B76D552AEC2728E00ABE32A64326627FDC4DD17F2EF0606D1F7","afterTransposition":"526CA483398D760BC2728E52AED5AB003266272A64E3C4FDEF060617F2DDF7D1","finalPacket":"82021800180004080400000001526CA483398D760BC2728E52AED5AB003266272A64E3C4FDEF060617F2DDF7D14519986970FDDE78C7AF4240F43090C7"},"plaintext":"HR-64 SPO2-95 STEPS-1295","timestamp":258494,"type":"encryption_pipeline","ztmEnabled":true}
18:35:47.684 > [WebSocket] Processing message type: encryption_pipeline
18:35:47.689 > [259.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:47.797 > [WebSocket] Received (158 bytes): {"deviceId":"f9641d44","healthSendCount":8,"message":"Health data #9 sent successfully","state":7,"success":true,"timestamp":258499,"type":"health_data_sent"}
18:35:47.813 > [WebSocket] Processing message type: health_data_sent
18:35:47.816 > [259.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:47.920 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123946571,"threatLevel":0,"type":"heuristics_update"}
18:35:47.945 > [WebSocket] Processing message type: heuristics_update
18:35:47.949 > [260.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:48.052 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":258680,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:48.088 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:48.094 > [WebSocket] ========================================
18:35:48.100 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:48.105 > [WebSocket] ========================================
18:35:48.111 > [ZTM] Settings saved successfully
18:35:48.113 > [WebSocket] ✓ ZTM activated successfully
18:35:48.116 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:48.121 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:48.124 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:48.127 > [WebSocket] ========================================
18:35:48.132 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":260196,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:48.172 > [260.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:48.277 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":258715,"type":"ztm_activated"}
18:35:48.293 > [WebSocket] Processing message type: ztm_activated
18:35:48.297 > [260.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:48.400 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123947585,"threatLevel":0,"type":"heuristics_update"}
18:35:48.425 > [WebSocket] Processing message type: heuristics_update
18:35:48.431 > [260.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:48.536 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":260196,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:48.571 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:48.577 > [WebSocket] ========================================
18:35:48.583 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:48.588 > [WebSocket] ========================================
18:35:48.594 > [ZTM] Settings saved successfully
18:35:48.597 > [WebSocket] ✓ ZTM activated successfully
18:35:48.599 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:48.605 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:48.608 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:48.611 > [WebSocket] ========================================
18:35:48.616 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":260680,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:48.655 > [260.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:48.761 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":260232,"type":"ztm_activated"}
18:35:48.778 > [WebSocket] Processing message type: ztm_activated
18:35:48.780 > [260.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:48.884 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123948596,"threatLevel":0,"type":"heuristics_update"}
18:35:48.909 > [WebSocket] Processing message type: heuristics_update
18:35:48.916 > [261.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:49.017 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":260680,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:49.053 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:49.060 > [WebSocket] ========================================
18:35:49.065 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:49.069 > [WebSocket] ========================================
18:35:49.076 > [ZTM] Settings saved successfully
18:35:49.078 > [WebSocket] ✓ ZTM activated successfully
18:35:49.081 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:49.087 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:49.089 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:49.092 > [WebSocket] ========================================
18:35:49.098 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":261161,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:49.136 > [261.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:49.242 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":260715,"type":"ztm_activated"}
18:35:49.260 > [WebSocket] Processing message type: ztm_activated
18:35:49.263 > [261.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:49.367 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":261161,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:49.402 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:49.408 > [WebSocket] ========================================
18:35:49.413 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:49.419 > [WebSocket] ========================================
18:35:49.425 > [ZTM] Settings saved successfully
18:35:49.427 > [WebSocket] ✓ ZTM activated successfully
18:35:49.431 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:49.436 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:49.439 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:49.442 > [WebSocket] ========================================
18:35:49.447 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":261511,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:49.486 > [261.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:49.592 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":261197,"type":"ztm_activated"}
18:35:49.609 > [WebSocket] Processing message type: ztm_activated
18:35:49.611 > [261.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:49.718 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":261511,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:49.753 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:49.759 > [WebSocket] ========================================
18:35:49.764 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:49.770 > [WebSocket] ========================================
18:35:49.775 > [ZTM] Settings saved successfully
18:35:49.779 > [WebSocket] ✓ ZTM activated successfully
18:35:49.781 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:49.787 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:49.790 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:49.792 > [WebSocket] ========================================
18:35:49.798 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":261862,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:49.836 > [261.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:49.943 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":261546,"type":"ztm_activated"}
18:35:49.959 > [WebSocket] Processing message type: ztm_activated
18:35:49.962 > [262.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:50.066 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123949610,"threatLevel":0,"type":"heuristics_update"}
18:35:50.091 > [WebSocket] Processing message type: heuristics_update
18:35:50.097 > [262.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:50.199 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":261862,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:50.235 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:50.241 > [WebSocket] ========================================
18:35:50.247 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:50.252 > [WebSocket] ========================================
18:35:50.258 > [ZTM] Settings saved successfully
18:35:50.261 > [WebSocket] ✓ ZTM activated successfully
18:35:50.263 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:50.268 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:50.271 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:50.274 > [WebSocket] ========================================
18:35:50.280 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":262344,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:50.319 > [262.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:50.424 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":261897,"type":"ztm_activated"}
18:35:50.441 > [WebSocket] Processing message type: ztm_activated
18:35:50.445 > [262.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:50.548 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":262344,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:50.584 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:50.590 > [WebSocket] ========================================
18:35:50.596 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:50.601 > [WebSocket] ========================================
18:35:50.607 > [ZTM] Settings saved successfully
18:35:50.609 > [WebSocket] ✓ ZTM activated successfully
18:35:50.612 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:50.617 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:50.620 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:50.623 > [WebSocket] ========================================
18:35:50.629 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":262693,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:50.667 > [262.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:50.777 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":262379,"type":"ztm_activated"}
18:35:50.794 > [WebSocket] Processing message type: ztm_activated
18:35:50.797 > [262.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:50.903 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123950618,"threatLevel":0,"type":"heuristics_update"}
18:35:50.928 > [WebSocket] Processing message type: heuristics_update
18:35:50.933 > [263.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:51.037 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":262693,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:51.072 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:51.077 > [WebSocket] ========================================
18:35:51.084 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:51.089 > [WebSocket] ========================================
18:35:51.094 > [ZTM] Settings saved successfully
18:35:51.097 > [WebSocket] ✓ ZTM activated successfully
18:35:51.100 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:51.105 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:51.108 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:51.110 > [WebSocket] ========================================
18:35:51.116 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":263180,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:51.155 > [263.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:51.260 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":262729,"type":"ztm_activated"}
18:35:51.277 > [WebSocket] Processing message type: ztm_activated
18:35:51.281 > [263.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:51.385 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":263180,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:51.421 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:51.426 > [WebSocket] ========================================
18:35:51.432 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:51.437 > [WebSocket] ========================================
18:35:51.443 > [ZTM] Settings saved successfully
18:35:51.446 > [WebSocket] ✓ ZTM activated successfully
18:35:51.448 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:51.454 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:51.456 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:51.459 > [WebSocket] ========================================
18:35:51.464 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":263529,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:51.504 > [263.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:51.610 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":263216,"type":"ztm_activated"}
18:35:51.627 > [WebSocket] Processing message type: ztm_activated
18:35:51.630 > [263.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:51.733 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":263529,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:51.769 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:51.775 > [WebSocket] ========================================
18:35:51.780 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:51.786 > [WebSocket] ========================================
18:35:51.792 > [ZTM] Settings saved successfully
18:35:51.794 > [WebSocket] ✓ ZTM activated successfully
18:35:51.796 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:51.802 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:51.805 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:51.808 > [WebSocket] ========================================
18:35:51.814 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":263877,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:51.853 > [263.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:51.959 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":263564,"type":"ztm_activated"}
18:35:51.976 > [WebSocket] Processing message type: ztm_activated
18:35:51.978 > [264.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:52.084 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123951630,"threatLevel":0,"type":"heuristics_update"}
18:35:52.110 > [WebSocket] Processing message type: heuristics_update
18:35:52.116 > [264.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:52.218 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":263877,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:52.254 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:52.260 > [WebSocket] ========================================
18:35:52.265 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:52.270 > [WebSocket] ========================================
18:35:52.276 > [ZTM] Settings saved successfully
18:35:52.279 > [WebSocket] ✓ ZTM activated successfully
18:35:52.282 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:52.288 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:52.290 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:52.293 > [WebSocket] ========================================
18:35:52.298 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":264362,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:52.336 > [264.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:52.444 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":263913,"type":"ztm_activated"}
18:35:52.460 > [WebSocket] Processing message type: ztm_activated
18:35:52.463 > [264.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:52.567 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":264362,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:52.604 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:52.609 > [WebSocket] ========================================
18:35:52.615 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:52.620 > [WebSocket] ========================================
18:35:52.625 > [ZTM] Settings saved successfully
18:35:52.628 > [WebSocket] ✓ ZTM activated successfully
18:35:52.632 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:52.636 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:52.640 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:52.642 > [WebSocket] ========================================
18:35:52.648 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":264712,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:52.687 > [264.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:52.793 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":264399,"type":"ztm_activated"}
18:35:52.810 > [WebSocket] Processing message type: ztm_activated
18:35:52.813 > [264.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:52.917 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123952637,"threatLevel":0,"type":"heuristics_update"}
18:35:52.942 > [WebSocket] Processing message type: heuristics_update
18:35:52.948 > [265.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:53.050 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":264712,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:53.086 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:53.092 > [WebSocket] ========================================
18:35:53.097 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:53.102 > [WebSocket] ========================================
18:35:53.108 > [ZTM] Settings saved successfully
18:35:53.111 > [WebSocket] ✓ ZTM activated successfully
18:35:53.114 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:53.120 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:53.123 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:53.125 > [WebSocket] ========================================
18:35:53.130 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":265194,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:53.169 > [265.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:53.276 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":264748,"type":"ztm_activated"}
18:35:53.293 > [WebSocket] Processing message type: ztm_activated
18:35:53.295 > [265.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:53.402 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":265194,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:53.438 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:53.442 > [WebSocket] ========================================
18:35:53.448 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:53.454 > [WebSocket] ========================================
18:35:53.460 > [ZTM] Settings saved successfully
18:35:53.462 > [WebSocket] ✓ ZTM activated successfully
18:35:53.466 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:53.470 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:53.473 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:53.477 > [WebSocket] ========================================
18:35:53.482 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":265546,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:53.521 > [265.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:53.627 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":265230,"type":"ztm_activated"}
18:35:53.644 > [WebSocket] Processing message type: ztm_activated
18:35:53.647 > [265.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:53.750 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":265546,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:53.786 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:53.792 > [WebSocket] ========================================
18:35:53.798 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:53.803 > [WebSocket] ========================================
18:35:53.809 > [ZTM] Settings saved successfully
18:35:53.812 > [WebSocket] ✓ ZTM activated successfully
18:35:53.815 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:53.820 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:53.823 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:53.826 > [WebSocket] ========================================
18:35:53.831 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":265895,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:53.870 > [265.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:53.975 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":265581,"type":"ztm_activated"}
18:35:53.993 > [WebSocket] Processing message type: ztm_activated
18:35:53.995 > [266.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:54.098 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123953647,"threatLevel":0,"type":"heuristics_update"}
18:35:54.124 > [WebSocket] Processing message type: heuristics_update
18:35:54.129 > [266.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:54.233 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":265895,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:54.268 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:54.274 > [WebSocket] ========================================
18:35:54.279 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:54.285 > [WebSocket] ========================================
18:35:54.291 > [ZTM] Settings saved successfully
18:35:54.294 > [WebSocket] ✓ ZTM activated successfully
18:35:54.295 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:54.302 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:54.305 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:54.307 > [WebSocket] ========================================
18:35:54.313 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":266377,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:54.352 > [266.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:54.458 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":265930,"type":"ztm_activated"}
18:35:54.475 > [WebSocket] Processing message type: ztm_activated
18:35:54.478 > [266.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:54.584 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":266377,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:54.620 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:54.625 > [WebSocket] ========================================
18:35:54.631 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:54.637 > [WebSocket] ========================================
18:35:54.642 > [ZTM] Settings saved successfully
18:35:54.645 > [WebSocket] ✓ ZTM activated successfully
18:35:54.648 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:54.653 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:54.656 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:54.659 > [WebSocket] ========================================
18:35:54.664 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":266728,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:54.703 > [266.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:54.809 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":266412,"type":"ztm_activated"}
18:35:54.825 > [WebSocket] Processing message type: ztm_activated
18:35:54.828 > [266.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:54.933 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123954660,"threatLevel":0,"type":"heuristics_update"}
18:35:54.957 > [WebSocket] Processing message type: heuristics_update
18:35:54.962 > [267.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:55.065 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":266728,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:55.100 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:55.106 > [WebSocket] ========================================
18:35:55.112 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:55.117 > [WebSocket] ========================================
18:35:55.123 > [ZTM] Settings saved successfully
18:35:55.126 > [WebSocket] ✓ ZTM activated successfully
18:35:55.129 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:55.134 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:55.137 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:55.140 > [WebSocket] ========================================
18:35:55.145 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":267209,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:55.184 > [267.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:55.292 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":266763,"type":"ztm_activated"}
18:35:55.309 > [WebSocket] Processing message type: ztm_activated
18:35:55.311 > [267.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:55.414 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":267209,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:55.450 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:55.455 > [WebSocket] ========================================
18:35:55.460 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:55.467 > [WebSocket] ========================================
18:35:55.473 > [ZTM] Settings saved successfully
18:35:55.475 > [WebSocket] ✓ ZTM activated successfully
18:35:55.478 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:55.483 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:55.486 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:55.489 > [WebSocket] ========================================
18:35:55.495 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":267558,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:55.555 > [267.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:55.639 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":267245,"type":"ztm_activated"}
18:35:55.656 > [WebSocket] Processing message type: ztm_activated
18:35:55.658 > [267.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:55.764 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":267558,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:55.800 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:55.805 > [WebSocket] ========================================
18:35:55.811 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:55.816 > [WebSocket] ========================================
18:35:55.822 > [ZTM] Settings saved successfully
18:35:55.825 > [WebSocket] ✓ ZTM activated successfully
18:35:55.828 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:55.832 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:55.836 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:55.838 > [WebSocket] ========================================
18:35:55.844 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":267908,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:55.883 > [267.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:55.990 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":267594,"type":"ztm_activated"}
18:35:56.006 > [WebSocket] Processing message type: ztm_activated
18:35:56.009 > [268.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:56.111 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123955669,"threatLevel":0,"type":"heuristics_update"}
18:35:56.136 > [WebSocket] Processing message type: heuristics_update
18:35:56.142 > [268.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:56.245 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":267908,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:56.280 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:56.286 > [WebSocket] ========================================
18:35:56.292 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:56.297 > [WebSocket] ========================================
18:35:56.302 > [ZTM] Settings saved successfully
18:35:56.306 > [WebSocket] ✓ ZTM activated successfully
18:35:56.309 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:56.314 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:56.317 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:56.320 > [WebSocket] ========================================
18:35:56.325 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":268389,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:56.364 > [268.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:56.470 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":267944,"type":"ztm_activated"}
18:35:56.487 > [WebSocket] Processing message type: ztm_activated
18:35:56.490 > [268.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:56.498 > [RETRY] Attempting to send health data (Max retries: 3)
18:35:56.503 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:35:56.509 > Generated health data: HR-64 SPO2-95 STEPS-1365
18:35:56.512 > [ESP32] ========================================
18:35:56.518 > [ESP32] ENCRYPTION PIPELINE START
18:35:56.520 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:35:56.526 > [ESP32] Active Algorithms for this packet:
18:35:56.529 > [ESP32]   + LFSR
18:35:56.531 > [ESP32]   + Tinkerbell
18:35:56.531 > [ESP32]   + Transposition
18:35:56.534 > [ESP32]   - ChaCha20
18:35:56.536 > [ESP32]   - Salsa20
18:35:56.536 > [ESP32] ========================================
18:35:56.542 > [ESP32] MsgKeys: lfsrSeed=0x9E6F2B4D tnk[0..3]=36EDB0D0 trn[0..3]=79C714B6
18:35:56.548 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313336354D50
18:35:56.557 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313336354D50000000000000 
18:35:56.562 > [ESP32][LFSR] Initializing - Seed: 0x9E6F2B4D SeedBe: 0x4D2B6F9E ChaosKey[0..3]: 36EDB0D0 InitialTap: 0x0029 State: 0x9E6F2B4D
18:35:56.573 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
18:35:56.582 > 3_After_LFSR (32): 057942A87DA3EDC89303E72B82B0014F 11C4B7FD3A410D42E77DF5120C09E37D 
18:35:56.589 > [ESP32][LFSR] Keystream (first 16 bytes): 4D2B6F9E4983BE98DC31CA12B790521B
18:35:56.595 > [ESP32][4D] LFSR keystream (first 32 bytes): 4D2B6F9E4983BE98DC31CA12B790521B5494E4D00B723B77AA2DF5120C09E37D
18:35:56.606 > [ESP32][TINKERBELL] Input (first 16 bytes): 057942A87DA3EDC89303E72B82B0014F Nonce: 0x00000002 Buffer size: 32 bytes
18:35:56.615 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 36EDB0D0
18:35:56.626 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 848026D486D68DE6B9568823ED721C72
18:35:56.634 > 4_After_Tinkerbell (32): 81F9647CFB75602E2A556F086FC21D3D 371402F863339C96B4A5FA1878859963 
18:35:56.643 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 848026D486D68DE6B9568823ED721C72
18:35:56.651 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 848026D486D68DE6B9568823ED721C7226D0B505597291D453D80F0A748C7A1E
18:35:56.659 > 5_After_Transposition (32): 81F9647C96339C632A556F0863859978 3D6FC21D371402F82EFB7560B4A5FA18 
18:35:56.668 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
18:35:56.673 > [ESP32] === HMAC DEBUG INFO ===
18:35:56.676 > [ESP32] HMAC Key being used: C250F7B2F067CAA1EA9D5E8395F779106C5A18BC69D130ED00EEEC7196085A64
18:35:56.684 > [ESP32] HMAC Input length: 45 bytes
18:35:56.686 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000281F9647C96339C632A556F08638599783D6FC2
18:35:56.695 > [ESP32] Nonce: 0x00000002
18:35:56.698 > [ESP32] Packet size before HMAC: 61
18:35:56.700 > [ESP32] Computed HMAC Tag: FE2AF467FB0D4806FA0E9A4377AE3E2C
18:35:56.707 > [ESP32] === END HMAC DEBUG ===
18:35:56.709 > 6_Final_Packet (61): 8202180018000408040000000281F964 7C96339C632A556F08638599783D6FC2 ...
18:35:56.717 > [RETRY] Attempt 1/3 (nonce: 2)
18:35:56.720 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:56.726 > Sending pipeline data to server (659 bytes)
18:35:57.021 > [HTTP] Response code: 400
18:35:57.021 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:57.028 > [HTTP] Request failed with code: 400
18:35:57.030 > [RETRY] Send failed, waiting 100 ms before retry
18:35:57.130 > [RETRY] Attempt 2/3 (nonce: 2)
18:35:57.130 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:57.136 > Sending pipeline data to server (659 bytes)
18:35:57.460 > [HTTP] Response code: 400
18:35:57.460 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:57.465 > [HTTP] Request failed with code: 400
18:35:57.469 > [RETRY] Send failed, waiting 200 ms before retry
18:35:57.667 > [RETRY] Attempt 3/3 (nonce: 2)
18:35:57.667 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:57.673 > Sending pipeline data to server (659 bytes)
18:35:57.978 > [HTTP] Response code: 400
18:35:57.978 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:57.983 > [HTTP] Request failed with code: 400
18:35:57.986 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:35:57.992 > [RETRY] Consecutive failures: 1
18:35:57.995 > Health data send failed (retry count: 1/3)
18:35:58.101 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":268389,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:35:58.136 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:35:58.142 > [WebSocket] ========================================
18:35:58.148 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:35:58.154 > [WebSocket] ========================================
18:35:58.159 > [ZTM] Settings saved successfully
18:35:58.162 > [WebSocket] ✓ ZTM activated successfully
18:35:58.164 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:35:58.169 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:35:58.172 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:35:58.176 > [WebSocket] ========================================
18:35:58.182 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":270246,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:35:58.220 > [270.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:58.228 > [RETRY] Attempting to send health data (Max retries: 3)
18:35:58.231 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:35:58.236 > Generated health data: HR-64 SPO2-95 STEPS-1383
18:35:58.242 > [ESP32] ========================================
18:35:58.245 > [ESP32] ENCRYPTION PIPELINE START
18:35:58.248 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:35:58.254 > [ESP32] Active Algorithms for this packet:
18:35:58.258 > [ESP32]   + LFSR
18:35:58.258 > [ESP32]   + Tinkerbell
18:35:58.261 > [ESP32]   + Transposition
18:35:58.264 > [ESP32]   - ChaCha20
18:35:58.264 > [ESP32]   - Salsa20
18:35:58.267 > [ESP32] ========================================
18:35:58.270 > [ESP32] MsgKeys: lfsrSeed=0x9E6F2B4D tnk[0..3]=36EDB0D0 trn[0..3]=79C714B6
18:35:58.279 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313338334D50
18:35:58.284 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313338334D50000000000000 
18:35:58.293 > [ESP32][LFSR] Initializing - Seed: 0x9E6F2B4D SeedBe: 0x4D2B6F9E ChaosKey[0..3]: 36EDB0D0 InitialTap: 0x0029 State: 0x9E6F2B4D
18:35:58.303 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
18:35:58.312 > 3_After_LFSR (32): 057942A87DA3EDC89303E72B82B0014F 11C4B7FD3A410344E77DF5120C09E37D 
18:35:58.320 > [ESP32][LFSR] Keystream (first 16 bytes): 4D2B6F9E4983BE98DC31CA12B790521B
18:35:58.326 > [ESP32][4D] LFSR keystream (first 32 bytes): 4D2B6F9E4983BE98DC31CA12B790521B5494E4D00B723B77AA2DF5120C09E37D
18:35:58.334 > [ESP32][TINKERBELL] Input (first 16 bytes): 057942A87DA3EDC89303E72B82B0014F Nonce: 0x00000002 Buffer size: 32 bytes
18:35:58.345 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 36EDB0D0
18:35:58.356 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 848026D486D68DE6B9568823ED721C72
18:35:58.364 > 4_After_Tinkerbell (32): 81F9647CFB75602E2A556F086FC21D3D 371402F863339290B4A5FA1878859963 
18:35:58.370 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 848026D486D68DE6B9568823ED721C72
18:35:58.379 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 848026D486D68DE6B9568823ED721C7226D0B505597291D453D80F0A748C7A1E
18:35:58.389 > 5_After_Transposition (32): 81F9647C903392632A556F0863859978 3D6FC21D371402F82EFB7560B4A5FA18 
18:35:58.398 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
18:35:58.403 > [ESP32] === HMAC DEBUG INFO ===
18:35:58.406 > [ESP32] HMAC Key being used: C250F7B2F067CAA1EA9D5E8395F779106C5A18BC69D130ED00EEEC7196085A64
18:35:58.415 > [ESP32] HMAC Input length: 45 bytes
18:35:58.418 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000281F9647C903392632A556F08638599783D6FC2
18:35:58.426 > [ESP32] Nonce: 0x00000002
18:35:58.428 > [ESP32] Packet size before HMAC: 61
18:35:58.430 > [ESP32] Computed HMAC Tag: A17165B3A108E9B3D498F07ED85868C9
18:35:58.436 > [ESP32] === END HMAC DEBUG ===
18:35:58.440 > 6_Final_Packet (61): 8202180018000408040000000281F964 7C903392632A556F08638599783D6FC2 ...
18:35:58.448 > [RETRY] Attempt 1/3 (nonce: 2)
18:35:58.451 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:58.454 > Sending pipeline data to server (659 bytes)
18:35:58.767 > [HTTP] Response code: 400
18:35:58.767 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:58.773 > [HTTP] Request failed with code: 400
18:35:58.776 > [RETRY] Send failed, waiting 100 ms before retry
18:35:58.876 > [RETRY] Attempt 2/3 (nonce: 2)
18:35:58.877 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:58.882 > Sending pipeline data to server (659 bytes)
18:35:59.233 > [HTTP] Response code: 400
18:35:59.233 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:59.239 > [HTTP] Request failed with code: 400
18:35:59.245 > [RETRY] Send failed, waiting 200 ms before retry
18:35:59.445 > [RETRY] Attempt 3/3 (nonce: 2)
18:35:59.445 > POST http://10.249.92.115:8081/health-data with pipeline data
18:35:59.450 > Sending pipeline data to server (659 bytes)
18:35:59.742 > [HTTP] Response code: 400
18:35:59.742 > [HTTP] Error response: {"error":"Decryption failed"}
18:35:59.748 > [HTTP] Request failed with code: 400
18:35:59.751 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:35:59.756 > [RETRY] Consecutive failures: 2
18:35:59.759 > Health data send failed (retry count: 2/3)
18:35:59.862 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":268425,"type":"ztm_activated"}
18:35:59.878 > [WebSocket] Processing message type: ztm_activated
18:35:59.881 > [271.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:35:59.890 > [RETRY] Attempting to send health data (Max retries: 3)
18:35:59.895 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:35:59.900 > Generated health data: HR-64 SPO2-95 STEPS-1366
18:35:59.903 > [ESP32] ========================================
18:35:59.908 > [ESP32] ENCRYPTION PIPELINE START
18:35:59.911 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:35:59.917 > [ESP32] Active Algorithms for this packet:
18:35:59.920 > [ESP32]   + LFSR
18:35:59.923 > [ESP32]   + Tinkerbell
18:35:59.923 > [ESP32]   + Transposition
18:35:59.926 > [ESP32]   - ChaCha20
18:35:59.928 > [ESP32]   - Salsa20
18:35:59.928 > [ESP32] ========================================
18:35:59.934 > [ESP32] MsgKeys: lfsrSeed=0x9E6F2B4D tnk[0..3]=36EDB0D0 trn[0..3]=79C714B6
18:35:59.939 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313336364D50
18:35:59.948 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313336364D50000000000000 
18:35:59.953 > [ESP32][LFSR] Initializing - Seed: 0x9E6F2B4D SeedBe: 0x4D2B6F9E ChaosKey[0..3]: 36EDB0D0 InitialTap: 0x0029 State: 0x9E6F2B4D
18:35:59.965 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
18:35:59.973 > 3_After_LFSR (32): 057942A87DA3EDC89303E72B82B0014F 11C4B7FD3A410D41E77DF5120C09E37D 
18:35:59.981 > [ESP32][LFSR] Keystream (first 16 bytes): 4D2B6F9E4983BE98DC31CA12B790521B
18:35:59.987 > [ESP32][4D] LFSR keystream (first 32 bytes): 4D2B6F9E4983BE98DC31CA12B790521B5494E4D00B723B77AA2DF5120C09E37D
18:35:59.998 > [ESP32][TINKERBELL] Input (first 16 bytes): 057942A87DA3EDC89303E72B82B0014F Nonce: 0x00000002 Buffer size: 32 bytes
18:36:00.006 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 36EDB0D0
18:36:00.017 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 848026D486D68DE6B9568823ED721C72
18:36:00.025 > 4_After_Tinkerbell (32): 81F9647CFB75602E2A556F086FC21D3D 371402F863339C95B4A5FA1878859963 
18:36:00.034 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 848026D486D68DE6B9568823ED721C72
18:36:00.042 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 848026D486D68DE6B9568823ED721C7226D0B505597291D453D80F0A748C7A1E
18:36:00.050 > 5_After_Transposition (32): 81F9647C95339C632A556F0863859978 3D6FC21D371402F82EFB7560B4A5FA18 
18:36:00.059 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
18:36:00.064 > [ESP32] === HMAC DEBUG INFO ===
18:36:00.067 > [ESP32] HMAC Key being used: C250F7B2F067CAA1EA9D5E8395F779106C5A18BC69D130ED00EEEC7196085A64
18:36:00.076 > [ESP32] HMAC Input length: 45 bytes
18:36:00.078 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000281F9647C95339C632A556F08638599783D6FC2
18:36:00.086 > [ESP32] Nonce: 0x00000002
18:36:00.090 > [ESP32] Packet size before HMAC: 61
18:36:00.093 > [ESP32] Computed HMAC Tag: F15D63D324F4C7507CC2978D2613C196
18:36:00.098 > [ESP32] === END HMAC DEBUG ===
18:36:00.100 > 6_Final_Packet (61): 8202180018000408040000000281F964 7C95339C632A556F08638599783D6FC2 ...
18:36:00.109 > [RETRY] Attempt 1/3 (nonce: 2)
18:36:00.112 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:00.117 > Sending pipeline data to server (659 bytes)
18:36:00.250 > [HTTP] Response code: 400
18:36:00.250 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:00.255 > [HTTP] Request failed with code: 400
18:36:00.258 > [RETRY] Send failed, waiting 100 ms before retry
18:36:00.358 > [RETRY] Attempt 2/3 (nonce: 2)
18:36:00.358 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:00.363 > Sending pipeline data to server (659 bytes)
18:36:00.542 > [HTTP] Response code: 400
18:36:00.542 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:00.547 > [HTTP] Request failed with code: 400
18:36:00.550 > [RETRY] Send failed, waiting 200 ms before retry
18:36:00.750 > [RETRY] Attempt 3/3 (nonce: 2)
18:36:00.751 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:00.757 > Sending pipeline data to server (659 bytes)
18:36:01.002 > [HTTP] Response code: 400
18:36:01.002 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:01.008 > [HTTP] Request failed with code: 400
18:36:01.011 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:36:01.016 > [RETRY] Consecutive failures: 3
18:36:01.018 > Health data send failed (retry count: 3/3)
18:36:01.022 > Health data transmission failed after max retries
18:36:01.123 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123956679,"threatLevel":0,"type":"heuristics_update"}
18:36:01.148 > [WebSocket] Processing message type: heuristics_update
18:36:01.154 > [273.2] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:01.160 > ERROR state - attempting recovery
18:36:01.163 > [RETRY] Attempting to send health data (Max retries: 3)
18:36:01.167 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:36:01.174 > Generated health data: HR-64 SPO2-95 STEPS-1373
18:36:01.177 > [ESP32] ========================================
18:36:01.182 > [ESP32] ENCRYPTION PIPELINE START
18:36:01.185 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:36:01.191 > [ESP32] Active Algorithms for this packet:
18:36:01.193 > [ESP32]   + LFSR
18:36:01.196 > [ESP32]   + Tinkerbell
18:36:01.196 > [ESP32]   + Transposition
18:36:01.198 > [ESP32]   - ChaCha20
18:36:01.202 > [ESP32]   - Salsa20
18:36:01.202 > [ESP32] ========================================
18:36:01.207 > [ESP32] MsgKeys: lfsrSeed=0x9E6F2B4D tnk[0..3]=36EDB0D0 trn[0..3]=79C714B6
18:36:01.213 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313337334D50
18:36:01.221 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313337334D50000000000000 
18:36:01.226 > [ESP32][LFSR] Initializing - Seed: 0x9E6F2B4D SeedBe: 0x4D2B6F9E ChaosKey[0..3]: 36EDB0D0 InitialTap: 0x0029 State: 0x9E6F2B4D
18:36:01.237 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
18:36:01.246 > 3_After_LFSR (32): 057942A87DA3EDC89303E72B82B0014F 11C4B7FD3A410C44E77DF5120C09E37D 
18:36:01.254 > [ESP32][LFSR] Keystream (first 16 bytes): 4D2B6F9E4983BE98DC31CA12B790521B
18:36:01.260 > [ESP32][4D] LFSR keystream (first 32 bytes): 4D2B6F9E4983BE98DC31CA12B790521B5494E4D00B723B77AA2DF5120C09E37D
18:36:01.271 > [ESP32][TINKERBELL] Input (first 16 bytes): 057942A87DA3EDC89303E72B82B0014F Nonce: 0x00000002 Buffer size: 32 bytes
18:36:01.282 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 36EDB0D0
18:36:01.290 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 848026D486D68DE6B9568823ED721C72
18:36:01.298 > 4_After_Tinkerbell (32): 81F9647CFB75602E2A556F086FC21D3D 371402F863339D90B4A5FA1878859963 
18:36:01.307 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 848026D486D68DE6B9568823ED721C72
18:36:01.315 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 848026D486D68DE6B9568823ED721C7226D0B505597291D453D80F0A748C7A1E
18:36:01.323 > 5_After_Transposition (32): 81F9647C90339D632A556F0863859978 3D6FC21D371402F82EFB7560B4A5FA18 
18:36:01.332 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
18:36:01.338 > [ESP32] === HMAC DEBUG INFO ===
18:36:01.340 > [ESP32] HMAC Key being used: C250F7B2F067CAA1EA9D5E8395F779106C5A18BC69D130ED00EEEC7196085A64
18:36:01.348 > [ESP32] HMAC Input length: 45 bytes
18:36:01.351 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000281F9647C90339D632A556F08638599783D6FC2
18:36:01.360 > [ESP32] Nonce: 0x00000002
18:36:01.363 > [ESP32] Packet size before HMAC: 61
18:36:01.365 > [ESP32] Computed HMAC Tag: 236F58C9E0A9333756DE84F4C5EDD53A
18:36:01.371 > [ESP32] === END HMAC DEBUG ===
18:36:01.373 > 6_Final_Packet (61): 8202180018000408040000000281F964 7C90339D632A556F08638599783D6FC2 ...
18:36:01.382 > [RETRY] Attempt 1/3 (nonce: 2)
18:36:01.385 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:01.391 > Sending pipeline data to server (659 bytes)
18:36:01.731 > [HTTP] Response code: 400
18:36:01.731 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:01.736 > [HTTP] Request failed with code: 400
18:36:01.740 > [RETRY] Send failed, waiting 100 ms before retry
18:36:01.839 > [RETRY] Attempt 2/3 (nonce: 2)
18:36:01.839 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:01.845 > Sending pipeline data to server (659 bytes)
18:36:02.005 > [HTTP] Response code: 400
18:36:02.005 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:02.010 > [HTTP] Request failed with code: 400
18:36:02.013 > [RETRY] Send failed, waiting 200 ms before retry
18:36:02.213 > [RETRY] Attempt 3/3 (nonce: 2)
18:36:02.213 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:02.219 > Sending pipeline data to server (659 bytes)
18:36:02.513 > [HTTP] Response code: 400
18:36:02.513 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:02.519 > [HTTP] Request failed with code: 400
18:36:02.522 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:36:02.527 > [RETRY] Consecutive failures: 4
18:36:02.530 > ✗ Auto-recovery failed - restarting key exchange
18:36:04.633 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":269093,"type":"health_data_error"}
18:36:04.647 > [WebSocket] Processing message type: health_data_error
18:36:04.652 > [276.7] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:04.661 > ✓ Public key loaded from NVS
18:36:04.758 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":269531,"type":"health_data_error"}
18:36:04.772 > [WebSocket] Processing message type: health_data_error
18:36:04.778 > [276.8] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:04.882 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123957690,"threatLevel":0,"type":"heuristics_update"}
18:36:04.906 > [WebSocket] Processing message type: heuristics_update
18:36:04.912 > [277.0] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:04.920 > Generating fresh master key from entropy...
18:36:04.923 > Generated master key (32): 860BCDDF8A232AADDC481F8016045BE7 30C6D621360117E26E7ED60DB19992AF 
18:36:04.936 > Using reduced master key (byte % 3) for NTRU encryption only
18:36:04.944 > NTRU encrypted master key (502): 0064005B00400066001500460006006D 00370003001F000E006C006F0022000C ...
18:36:04.952 > POST http://10.249.92.115:8081/master-key
18:36:05.274 > ✓ Master key exchange completed
18:36:05.377 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":270050,"type":"health_data_error"}
18:36:05.390 > [WebSocket] Processing message type: health_data_error
18:36:05.396 > [277.5] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:05.404 > Loading master key from NVS and deriving symmetric keys...
18:36:05.409 > Loaded master key from NVS (32): 860BCDDF8A232AADDC481F8016045BE7 30C6D621360117E26E7ED60DB19992AF 
18:36:05.417 > Derived HMAC key (32): ACA2EB299CD014CD8956895E30DD2A17 24A98E15BED86A79E516EE505FB5A798 
18:36:05.426 > Derived Tinkerbell key (16): 17356DAA3E968D27AF08E67320A80400 
18:36:05.432 > Derived Transposition key (16): 8FB2903C098FCC8211D689A062759D1F 
18:36:05.436 > ✓ Symmetric keys derived successfully
18:36:05.440 > Nonce tracker reset - new session started
18:36:05.936 > Waiting for server to process master key...
18:36:05.940 > ✓ Symmetric keys ready - starting health data transmission
18:36:06.042 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":270246,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:06.078 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:06.083 > [WebSocket] ========================================
18:36:06.089 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:06.094 > [WebSocket] ========================================
18:36:06.100 > [ZTM] Settings saved successfully
18:36:06.103 > [WebSocket] ✓ ZTM activated successfully
18:36:06.106 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:06.111 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:06.114 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:06.117 > [WebSocket] ========================================
18:36:06.122 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":278187,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:06.161 > [278.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:06.269 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":270281,"type":"ztm_activated"}
18:36:06.285 > [WebSocket] Processing message type: ztm_activated
18:36:06.288 > [278.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:06.391 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123958699,"threatLevel":0,"type":"heuristics_update"}
18:36:06.416 > [WebSocket] Processing message type: heuristics_update
18:36:06.422 > [278.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:06.525 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":270839,"type":"health_data_error"}
18:36:06.538 > [WebSocket] Processing message type: health_data_error
18:36:06.544 > [278.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:06.647 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":271305,"type":"health_data_error"}
18:36:06.661 > [WebSocket] Processing message type: health_data_error
18:36:06.667 > [278.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:06.770 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123959710,"threatLevel":0,"type":"heuristics_update"}
18:36:06.795 > [WebSocket] Processing message type: heuristics_update
18:36:06.801 > [278.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:06.902 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":271814,"type":"health_data_error"}
18:36:06.917 > [WebSocket] Processing message type: health_data_error
18:36:06.921 > [279.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:07.024 > [279.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:07.126 > [279.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:07.226 > [279.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:07.327 > [279.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:07.428 > [279.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:07.529 > [279.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:07.630 > [279.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:07.730 > [279.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:07.832 > [279.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:07.933 > [280.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:08.034 > [280.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:08.136 > [280.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:08.236 > [280.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:08.337 > [280.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:08.438 > [280.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:08.539 > [280.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:08.640 > [280.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:08.741 > [280.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:08.842 > [280.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:08.943 > [281.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:09.044 > [281.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:09.147 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":272321,"type":"health_data_error"}
18:36:09.162 > [WebSocket] Processing message type: health_data_error
18:36:09.167 > [281.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:09.270 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":272614,"type":"health_data_error"}
18:36:09.284 > [WebSocket] Processing message type: health_data_error
18:36:09.289 > [281.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:09.392 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123960719,"threatLevel":0,"type":"heuristics_update"}
18:36:09.417 > [WebSocket] Processing message type: heuristics_update
18:36:09.423 > [281.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:09.526 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":273074,"type":"health_data_error"}
18:36:09.539 > [WebSocket] Processing message type: health_data_error
18:36:09.545 > [281.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:09.648 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123961720,"threatLevel":0,"type":"heuristics_update"}
18:36:09.672 > [WebSocket] Processing message type: heuristics_update
18:36:09.678 > [281.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:09.781 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":273803,"type":"health_data_error"}
18:36:09.794 > [WebSocket] Processing message type: health_data_error
18:36:09.799 > [281.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:09.903 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":274077,"type":"health_data_error"}
18:36:09.916 > [WebSocket] Processing message type: health_data_error
18:36:09.921 > [282.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:10.024 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":274585,"type":"health_data_error"}
18:36:10.038 > [WebSocket] Processing message type: health_data_error
18:36:10.044 > [282.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:10.148 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123962730,"threatLevel":0,"type":"heuristics_update"}
18:36:10.172 > [WebSocket] Processing message type: heuristics_update
18:36:10.178 > [282.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:10.281 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123963743,"threatLevel":0,"type":"heuristics_update"}
18:36:10.305 > [WebSocket] Processing message type: heuristics_update
18:36:10.311 > [282.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:10.413 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123964752,"threatLevel":0,"type":"heuristics_update"}
18:36:10.438 > [WebSocket] Processing message type: heuristics_update
18:36:10.444 > [282.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:10.546 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770123965037,"type":"master_key_received"}
18:36:10.560 > [WebSocket] Processing message type: master_key_received
18:36:10.563 > [282.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:10.667 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":277338,"type":"master_key_exchanged"}
18:36:10.684 > [WebSocket] Processing message type: master_key_exchanged
18:36:10.691 > [282.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:10.790 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123965760,"threatLevel":0,"type":"heuristics_update"}
18:36:10.815 > [WebSocket] Processing message type: heuristics_update
18:36:10.821 > [282.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:10.926 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":278007,"type":"symmetric_keys_derived"}
18:36:10.943 > [WebSocket] Processing message type: symmetric_keys_derived
18:36:10.949 > [283.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:11.049 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":278187,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:11.084 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:11.090 > [WebSocket] ========================================
18:36:11.095 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:11.101 > [WebSocket] ========================================
18:36:11.107 > [ZTM] Settings saved successfully
18:36:11.110 > [WebSocket] ✓ ZTM activated successfully
18:36:11.112 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:11.117 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:11.121 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:11.123 > [WebSocket] ========================================
18:36:11.129 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":283193,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:11.168 > [283.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:11.273 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":278223,"type":"ztm_activated"}
18:36:11.290 > [WebSocket] Processing message type: ztm_activated
18:36:11.293 > [283.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:11.396 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123966769,"threatLevel":0,"type":"heuristics_update"}
18:36:11.421 > [WebSocket] Processing message type: heuristics_update
18:36:11.427 > [283.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:11.529 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123967781,"threatLevel":0,"type":"heuristics_update"}
18:36:11.554 > [WebSocket] Processing message type: heuristics_update
18:36:11.560 > [283.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:11.663 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123968796,"threatLevel":0,"type":"heuristics_update"}
18:36:11.688 > [WebSocket] Processing message type: heuristics_update
18:36:11.693 > [283.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:11.796 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123969808,"threatLevel":0,"type":"heuristics_update"}
18:36:11.821 > [WebSocket] Processing message type: heuristics_update
18:36:11.826 > [283.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:11.928 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123970821,"threatLevel":0,"type":"heuristics_update"}
18:36:11.953 > [WebSocket] Processing message type: heuristics_update
18:36:11.959 > [284.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:12.062 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":283193,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:12.097 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:12.102 > [WebSocket] ========================================
18:36:12.108 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:12.114 > [WebSocket] ========================================
18:36:12.119 > [ZTM] Settings saved successfully
18:36:12.122 > [WebSocket] ✓ ZTM activated successfully
18:36:12.126 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:12.131 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:12.133 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:12.136 > [WebSocket] ========================================
18:36:12.142 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":284206,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:12.180 > [284.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:12.287 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":283229,"type":"ztm_activated"}
18:36:12.304 > [WebSocket] Processing message type: ztm_activated
18:36:12.307 > [284.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:12.414 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123971832,"threatLevel":0,"type":"heuristics_update"}
18:36:12.439 > [WebSocket] Processing message type: heuristics_update
18:36:12.444 > [284.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:12.547 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":284206,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:12.582 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:12.588 > [WebSocket] ========================================
18:36:12.593 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:12.599 > [WebSocket] ========================================
18:36:12.604 > [ZTM] Settings saved successfully
18:36:12.608 > [WebSocket] ✓ ZTM activated successfully
18:36:12.610 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:12.616 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:12.618 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:12.621 > [WebSocket] ========================================
18:36:12.626 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":284691,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:12.666 > [284.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:12.771 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":284242,"type":"ztm_activated"}
18:36:12.788 > [WebSocket] Processing message type: ztm_activated
18:36:12.791 > [284.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:12.895 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":284691,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:12.931 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:12.936 > [WebSocket] ========================================
18:36:12.942 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:12.959 > [WebSocket] ========================================
18:36:12.959 > [ZTM] Settings saved successfully
18:36:12.959 > [WebSocket] ✓ ZTM activated successfully
18:36:12.959 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:12.978 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:12.978 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:12.978 > [WebSocket] ========================================
18:36:12.978 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":285040,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:13.020 > [285.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:13.122 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":284727,"type":"ztm_activated"}
18:36:13.138 > [WebSocket] Processing message type: ztm_activated
18:36:13.141 > [285.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:13.244 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123972848,"threatLevel":0,"type":"heuristics_update"}
18:36:13.269 > [WebSocket] Processing message type: heuristics_update
18:36:13.275 > [285.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:13.378 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":285040,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:13.414 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:13.419 > [WebSocket] ========================================
18:36:13.425 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:13.430 > [WebSocket] ========================================
18:36:13.436 > [ZTM] Settings saved successfully
18:36:13.439 > [WebSocket] ✓ ZTM activated successfully
18:36:13.441 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:13.447 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:13.449 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:13.453 > [WebSocket] ========================================
18:36:13.458 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":285523,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:13.497 > [285.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:13.603 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":285075,"type":"ztm_activated"}
18:36:13.619 > [WebSocket] Processing message type: ztm_activated
18:36:13.622 > [285.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:13.729 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":285523,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:13.765 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:13.771 > [WebSocket] ========================================
18:36:13.776 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:13.782 > [WebSocket] ========================================
18:36:13.786 > [ZTM] Settings saved successfully
18:36:13.790 > [WebSocket] ✓ ZTM activated successfully
18:36:13.793 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:13.798 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:13.801 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:13.804 > [WebSocket] ========================================
18:36:13.810 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":285874,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:13.849 > [285.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:13.955 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":285558,"type":"ztm_activated"}
18:36:13.972 > [WebSocket] Processing message type: ztm_activated
18:36:13.974 > [286.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:14.079 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":285874,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:14.114 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:14.121 > [WebSocket] ========================================
18:36:14.125 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:14.131 > [WebSocket] ========================================
18:36:14.137 > [ZTM] Settings saved successfully
18:36:14.140 > [WebSocket] ✓ ZTM activated successfully
18:36:14.142 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:14.148 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:14.151 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:14.154 > [WebSocket] ========================================
18:36:14.160 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":286224,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:14.198 > [286.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:14.304 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123973858,"threatLevel":0,"type":"heuristics_update"}
18:36:14.329 > [WebSocket] Processing message type: heuristics_update
18:36:14.334 > [286.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:14.436 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":285911,"type":"ztm_activated"}
18:36:14.454 > [WebSocket] Processing message type: ztm_activated
18:36:14.457 > [286.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:14.560 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":286224,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:14.596 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:14.601 > [WebSocket] ========================================
18:36:14.607 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:14.612 > [WebSocket] ========================================
18:36:14.618 > [ZTM] Settings saved successfully
18:36:14.621 > [WebSocket] ✓ ZTM activated successfully
18:36:14.623 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:14.629 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:14.632 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:14.635 > [WebSocket] ========================================
18:36:14.640 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":286705,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:14.679 > [286.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:14.785 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":286259,"type":"ztm_activated"}
18:36:14.802 > [WebSocket] Processing message type: ztm_activated
18:36:14.805 > [286.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:14.911 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":286705,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:14.946 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:14.952 > [WebSocket] ========================================
18:36:14.958 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:14.964 > [WebSocket] ========================================
18:36:14.969 > [ZTM] Settings saved successfully
18:36:14.971 > [WebSocket] ✓ ZTM activated successfully
18:36:14.975 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:14.980 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:14.983 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:14.986 > [WebSocket] ========================================
18:36:14.991 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":287056,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:15.030 > [287.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:15.137 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":286740,"type":"ztm_activated"}
18:36:15.153 > [WebSocket] Processing message type: ztm_activated
18:36:15.156 > [287.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:15.259 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123974872,"threatLevel":0,"type":"heuristics_update"}
18:36:15.284 > [WebSocket] Processing message type: heuristics_update
18:36:15.290 > [287.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:15.392 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":287056,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:15.429 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:15.435 > [WebSocket] ========================================
18:36:15.440 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:15.445 > [WebSocket] ========================================
18:36:15.451 > [ZTM] Settings saved successfully
18:36:15.454 > [WebSocket] ✓ ZTM activated successfully
18:36:15.457 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:15.462 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:15.465 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:15.468 > [WebSocket] ========================================
18:36:15.473 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":287538,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:15.512 > [287.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:15.619 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":287091,"type":"ztm_activated"}
18:36:15.635 > [WebSocket] Processing message type: ztm_activated
18:36:15.638 > [287.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:15.742 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":287538,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:15.778 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:15.784 > [WebSocket] ========================================
18:36:15.789 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:15.794 > [WebSocket] ========================================
18:36:15.800 > [ZTM] Settings saved successfully
18:36:15.803 > [WebSocket] ✓ ZTM activated successfully
18:36:15.806 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:15.811 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:15.814 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:15.817 > [WebSocket] ========================================
18:36:15.822 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":287887,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:15.866 > [287.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:15.967 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":287573,"type":"ztm_activated"}
18:36:15.984 > [WebSocket] Processing message type: ztm_activated
18:36:15.986 > [288.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:15.995 > [RETRY] Attempting to send health data (Max retries: 3)
18:36:16.001 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:36:16.006 > Generated health data: HR-64 SPO2-95 STEPS-1442
18:36:16.009 > [ESP32] ========================================
18:36:16.015 > [ESP32] ENCRYPTION PIPELINE START
18:36:16.017 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:36:16.023 > [ESP32] Active Algorithms for this packet:
18:36:16.026 > [ESP32]   + LFSR
18:36:16.029 > [ESP32]   + Tinkerbell
18:36:16.029 > [ESP32]   + Transposition
18:36:16.032 > [ESP32]   - ChaCha20
18:36:16.035 > [ESP32]   - Salsa20
18:36:16.035 > [ESP32] ========================================
18:36:16.040 > [ESP32] MsgKeys: lfsrSeed=0xD4B26FB7 tnk[0..3]=DBC58980 trn[0..3]=0151B682
18:36:16.046 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313434324D50
18:36:16.054 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313434324D50000000000000 
18:36:16.059 > [ESP32][LFSR] Initializing - Seed: 0xD4B26FB7 SeedBe: 0xB76FB2D4 ChaosKey[0..3]: DBC58980 InitialTap: 0x0029 State: 0xD4B26FB7
18:36:16.070 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
18:36:16.079 > 3_After_LFSR (32): FF3D9FE22761620E849810A5201EC419 22EB444FEEF415AD4A167A37A8747F83 
18:36:16.087 > [ESP32][LFSR] Keystream (first 16 bytes): B76FB2D41341315ECBAA3D9C153E974D
18:36:16.092 > [ESP32][4D] LFSR keystream (first 32 bytes): B76FB2D41341315ECBAA3D9C153E974D67BB1762DFC0219F07467A37A8747F83
18:36:16.104 > [ESP32][TINKERBELL] Input (first 16 bytes): FF3D9FE22761620E849810A5201EC419 Nonce: 0x00000001 Buffer size: 32 bytes
18:36:16.112 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: DBC58980
18:36:16.123 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FD4387DF134BF1CBA0D35E7DF22907B8
18:36:16.131 > 4_After_Tinkerbell (32): 027E183D342A93C5244B4ED8D237C3A1 18A0C5DC8734EDE4135136D09544108B 
18:36:16.140 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FD4387DF134BF1CBA0D35E7DF22907B8
18:36:16.148 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FD4387DF134BF1CBA0D35E7DF22907B83A4B819369C0F84959474CE73D306F08
18:36:16.157 > 5_After_Transposition (32): 4ED8D03637D2244B183DDCC52A34027E 8734EDE418A093C59544108B1351C3A1 
18:36:16.165 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:36:16.171 > [ESP32] === HMAC DEBUG INFO ===
18:36:16.173 > [ESP32] HMAC Key being used: ACA2EB299CD014CD8956895E30DD2A1724A98E15BED86A79E516EE505FB5A798
18:36:16.181 > [ESP32] HMAC Input length: 45 bytes
18:36:16.184 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000014ED8D03637D2244B183DDCC52A34027E8734ED
18:36:16.192 > [ESP32] Nonce: 0x00000001
18:36:16.195 > [ESP32] Packet size before HMAC: 61
18:36:16.198 > [ESP32] Computed HMAC Tag: C259068EF2D834F7037BE3202FEAF833
18:36:16.204 > [ESP32] === END HMAC DEBUG ===
18:36:16.206 > 6_Final_Packet (61): 820218001800040804000000014ED8D0 3637D2244B183DDCC52A34027E8734ED ...
18:36:16.215 > [RETRY] Attempt 1/3 (nonce: 1)
18:36:16.218 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:16.223 > Sending pipeline data to server (659 bytes)
18:36:16.534 > [HTTP] Response code: 400
18:36:16.534 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:16.540 > [HTTP] Request failed with code: 400
18:36:16.543 > [RETRY] Send failed, waiting 100 ms before retry
18:36:16.642 > [RETRY] Attempt 2/3 (nonce: 1)
18:36:16.642 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:16.647 > Sending pipeline data to server (659 bytes)
18:36:16.795 > [HTTP] Response code: 400
18:36:16.795 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:16.801 > [HTTP] Request failed with code: 400
18:36:16.803 > [RETRY] Send failed, waiting 200 ms before retry
18:36:17.002 > [RETRY] Attempt 3/3 (nonce: 1)
18:36:17.002 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:17.009 > Sending pipeline data to server (659 bytes)
18:36:17.306 > [HTTP] Response code: 400
18:36:17.306 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:17.311 > [HTTP] Request failed with code: 400
18:36:17.314 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:36:17.320 > [RETRY] Consecutive failures: 5
18:36:17.323 > [EMERGENCY] Triggering emergency reset!
18:36:17.325 > [CRYPTO] Resetting cryptographic state
18:36:17.331 > [CRYPTO] Crypto state reset complete
18:36:17.334 > [CRYPTO] Packet counter: 5
18:36:17.337 > [EMERGENCY] Emergency reset complete
18:36:17.339 > Health data send failed (retry count: 1/3)
18:36:17.439 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":287887,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:17.475 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:17.481 > [WebSocket] ========================================
18:36:17.487 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:17.492 > [WebSocket] ========================================
18:36:17.498 > [ZTM] Settings saved successfully
18:36:17.500 > [WebSocket] ✓ ZTM activated successfully
18:36:17.503 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:17.509 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:17.511 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:17.514 > [WebSocket] ========================================
18:36:17.519 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":289585,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:17.558 > [289.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:17.567 > [RETRY] Attempting to send health data (Max retries: 3)
18:36:17.569 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:36:17.575 > Generated health data: HR-64 SPO2-95 STEPS-1445
18:36:17.581 > [ESP32] ========================================
18:36:17.584 > [ESP32] ENCRYPTION PIPELINE START
18:36:17.585 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:36:17.592 > [ESP32] Active Algorithms for this packet:
18:36:17.597 > [ESP32]   + LFSR
18:36:17.597 > [ESP32]   + Tinkerbell
18:36:17.600 > [ESP32]   + Transposition
18:36:17.603 > [ESP32]   - ChaCha20
18:36:17.603 > [ESP32]   - Salsa20
18:36:17.606 > [ESP32] ========================================
18:36:17.609 > [ESP32] MsgKeys: lfsrSeed=0xD4B26FB7 tnk[0..3]=DBC58980 trn[0..3]=0151B682
18:36:17.617 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313434354D50
18:36:17.622 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313434354D50000000000000 
18:36:17.631 > [ESP32][LFSR] Initializing - Seed: 0xD4B26FB7 SeedBe: 0xB76FB2D4 ChaosKey[0..3]: DBC58980 InitialTap: 0x0029 State: 0xD4B26FB7
18:36:17.642 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
18:36:17.650 > 3_After_LFSR (32): FF3D9FE22761620E849810A5201EC419 22EB444FEEF415AA4A167A37A8747F83 
18:36:17.659 > [ESP32][LFSR] Keystream (first 16 bytes): B76FB2D41341315ECBAA3D9C153E974D
18:36:17.665 > [ESP32][4D] LFSR keystream (first 32 bytes): B76FB2D41341315ECBAA3D9C153E974D67BB1762DFC0219F07467A37A8747F83
18:36:17.673 > [ESP32][TINKERBELL] Input (first 16 bytes): FF3D9FE22761620E849810A5201EC419 Nonce: 0x00000001 Buffer size: 32 bytes
18:36:17.684 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: DBC58980
18:36:17.695 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FD4387DF134BF1CBA0D35E7DF22907B8
18:36:17.703 > 4_After_Tinkerbell (32): 027E183D342A93C5244B4ED8D237C3A1 18A0C5DC8734EDE3135136D09544108B 
18:36:17.709 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FD4387DF134BF1CBA0D35E7DF22907B8
18:36:17.717 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FD4387DF134BF1CBA0D35E7DF22907B83A4B819369C0F84959474CE73D306F08
18:36:17.727 > 5_After_Transposition (32): 4ED8D03637D2244B183DDCC52A34027E 8734EDE318A093C59544108B1351C3A1 
18:36:17.736 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:36:17.742 > [ESP32] === HMAC DEBUG INFO ===
18:36:17.745 > [ESP32] HMAC Key being used: ACA2EB299CD014CD8956895E30DD2A1724A98E15BED86A79E516EE505FB5A798
18:36:17.752 > [ESP32] HMAC Input length: 45 bytes
18:36:17.756 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000014ED8D03637D2244B183DDCC52A34027E8734ED
18:36:17.764 > [ESP32] Nonce: 0x00000001
18:36:17.766 > [ESP32] Packet size before HMAC: 61
18:36:17.770 > [ESP32] Computed HMAC Tag: EF8872F31563EBD1370E780414EB3BFA
18:36:17.775 > [ESP32] === END HMAC DEBUG ===
18:36:17.778 > 6_Final_Packet (61): 820218001800040804000000014ED8D0 3637D2244B183DDCC52A34027E8734ED ...
18:36:17.787 > [RETRY] Attempt 1/3 (nonce: 1)
18:36:17.789 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:17.792 > Sending pipeline data to server (659 bytes)
18:36:18.060 > [HTTP] Response code: 400
18:36:18.060 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:18.065 > [HTTP] Request failed with code: 400
18:36:18.069 > [RETRY] Send failed, waiting 100 ms before retry
18:36:18.168 > [RETRY] Attempt 2/3 (nonce: 1)
18:36:18.168 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:18.173 > Sending pipeline data to server (659 bytes)
18:36:18.309 > [HTTP] Response code: 400
18:36:18.309 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:18.314 > [HTTP] Request failed with code: 400
18:36:18.317 > [RETRY] Send failed, waiting 200 ms before retry
18:36:18.518 > [RETRY] Attempt 3/3 (nonce: 1)
18:36:18.518 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:18.523 > Sending pipeline data to server (659 bytes)
18:36:18.842 > [HTTP] Response code: 400
18:36:18.842 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:18.847 > [HTTP] Request failed with code: 400
18:36:18.850 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:36:18.855 > [RETRY] Consecutive failures: 1
18:36:18.859 > Health data send failed (retry count: 2/3)
18:36:18.961 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":287932,"type":"ztm_activated"}
18:36:18.978 > [WebSocket] Processing message type: ztm_activated
18:36:18.980 > [291.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:18.989 > [RETRY] Attempting to send health data (Max retries: 3)
18:36:18.994 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:36:19.000 > Generated health data: HR-64 SPO2-95 STEPS-1471
18:36:19.002 > [ESP32] ========================================
18:36:19.009 > [ESP32] ENCRYPTION PIPELINE START
18:36:19.011 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:36:19.017 > [ESP32] Active Algorithms for this packet:
18:36:19.019 > [ESP32]   + LFSR
18:36:19.022 > [ESP32]   + Tinkerbell
18:36:19.022 > [ESP32]   + Transposition
18:36:19.025 > [ESP32]   - ChaCha20
18:36:19.027 > [ESP32]   - Salsa20
18:36:19.027 > [ESP32] ========================================
18:36:19.033 > [ESP32] MsgKeys: lfsrSeed=0xD4B26FB7 tnk[0..3]=DBC58980 trn[0..3]=0151B682
18:36:19.039 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313437314D50
18:36:19.047 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313437314D50000000000000 
18:36:19.053 > [ESP32][LFSR] Initializing - Seed: 0xD4B26FB7 SeedBe: 0xB76FB2D4 ChaosKey[0..3]: DBC58980 InitialTap: 0x0029 State: 0xD4B26FB7
18:36:19.064 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
18:36:19.072 > 3_After_LFSR (32): FF3D9FE22761620E849810A5201EC419 22EB444FEEF416AE4A167A37A8747F83 
18:36:19.081 > [ESP32][LFSR] Keystream (first 16 bytes): B76FB2D41341315ECBAA3D9C153E974D
18:36:19.086 > [ESP32][4D] LFSR keystream (first 32 bytes): B76FB2D41341315ECBAA3D9C153E974D67BB1762DFC0219F07467A37A8747F83
18:36:19.097 > [ESP32][TINKERBELL] Input (first 16 bytes): FF3D9FE22761620E849810A5201EC419 Nonce: 0x00000001 Buffer size: 32 bytes
18:36:19.106 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: DBC58980
18:36:19.117 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FD4387DF134BF1CBA0D35E7DF22907B8
18:36:19.125 > 4_After_Tinkerbell (32): 027E183D342A93C5244B4ED8D237C3A1 18A0C5DC8734EEE7135136D09544108B 
18:36:19.133 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FD4387DF134BF1CBA0D35E7DF22907B8
18:36:19.142 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FD4387DF134BF1CBA0D35E7DF22907B83A4B819369C0F84959474CE73D306F08
18:36:19.150 > 5_After_Transposition (32): 4ED8D03637D2244B183DDCC52A34027E 8734EEE718A093C59544108B1351C3A1 
18:36:19.158 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:36:19.164 > [ESP32] === HMAC DEBUG INFO ===
18:36:19.167 > [ESP32] HMAC Key being used: ACA2EB299CD014CD8956895E30DD2A1724A98E15BED86A79E516EE505FB5A798
18:36:19.175 > [ESP32] HMAC Input length: 45 bytes
18:36:19.178 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000014ED8D03637D2244B183DDCC52A34027E8734EE
18:36:19.186 > [ESP32] Nonce: 0x00000001
18:36:19.189 > [ESP32] Packet size before HMAC: 61
18:36:19.192 > [ESP32] Computed HMAC Tag: BCADEF6DE1F7FC6FDA96ABDC8E5920AB
18:36:19.198 > [ESP32] === END HMAC DEBUG ===
18:36:19.200 > 6_Final_Packet (61): 820218001800040804000000014ED8D0 3637D2244B183DDCC52A34027E8734EE ...
18:36:19.208 > [RETRY] Attempt 1/3 (nonce: 1)
18:36:19.211 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:19.217 > Sending pipeline data to server (659 bytes)
18:36:19.551 > [HTTP] Response code: 400
18:36:19.551 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:19.556 > [HTTP] Request failed with code: 400
18:36:19.559 > [RETRY] Send failed, waiting 100 ms before retry
18:36:19.658 > [RETRY] Attempt 2/3 (nonce: 1)
18:36:19.658 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:19.664 > Sending pipeline data to server (659 bytes)
18:36:19.825 > [HTTP] Response code: 400
18:36:19.826 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:19.831 > [HTTP] Request failed with code: 400
18:36:19.833 > [RETRY] Send failed, waiting 200 ms before retry
18:36:20.033 > [RETRY] Attempt 3/3 (nonce: 1)
18:36:20.033 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:20.038 > Sending pipeline data to server (659 bytes)
18:36:20.328 > [HTTP] Response code: 400
18:36:20.328 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:20.334 > [HTTP] Request failed with code: 400
18:36:20.337 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:36:20.342 > [RETRY] Consecutive failures: 2
18:36:20.345 > Health data send failed (retry count: 3/3)
18:36:20.348 > Health data transmission failed after max retries
18:36:20.448 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123975884,"threatLevel":0,"type":"heuristics_update"}
18:36:20.473 > [WebSocket] Processing message type: heuristics_update
18:36:20.478 > [292.5] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:20.484 > ERROR state - attempting recovery
18:36:20.486 > [RETRY] Attempting to send health data (Max retries: 3)
18:36:20.493 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:36:20.498 > Generated health data: HR-64 SPO2-95 STEPS-1475
18:36:20.501 > [ESP32] ========================================
18:36:20.507 > [ESP32] ENCRYPTION PIPELINE START
18:36:20.509 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:36:20.515 > [ESP32] Active Algorithms for this packet:
18:36:20.517 > [ESP32]   + LFSR
18:36:20.520 > [ESP32]   + Tinkerbell
18:36:20.520 > [ESP32]   + Transposition
18:36:20.523 > [ESP32]   - ChaCha20
18:36:20.525 > [ESP32]   - Salsa20
18:36:20.525 > [ESP32] ========================================
18:36:20.531 > [ESP32] MsgKeys: lfsrSeed=0xD4B26FB7 tnk[0..3]=DBC58980 trn[0..3]=0151B682
18:36:20.537 > 1_After_Salt (26): 48522D36342053504F322D3935205354 4550532D313437354D50
18:36:20.545 > 2_After_Padding (32): 48522D36342053504F322D3935205354 4550532D313437354D50000000000000 
18:36:20.550 > [ESP32][LFSR] Initializing - Seed: 0xD4B26FB7 SeedBe: 0xB76FB2D4 ChaosKey[0..3]: DBC58980 InitialTap: 0x0029 State: 0xD4B26FB7
18:36:20.561 > [ESP32][LFSR] Input (first 16 bytes): 48522D36342053504F322D3935205354 Buffer size: 32 bytes
18:36:20.571 > 3_After_LFSR (32): FF3D9FE22761620E849810A5201EC419 22EB444FEEF416AA4A167A37A8747F83 
18:36:20.579 > [ESP32][LFSR] Keystream (first 16 bytes): B76FB2D41341315ECBAA3D9C153E974D
18:36:20.583 > [ESP32][4D] LFSR keystream (first 32 bytes): B76FB2D41341315ECBAA3D9C153E974D67BB1762DFC0219F07467A37A8747F83
18:36:20.595 > [ESP32][TINKERBELL] Input (first 16 bytes): FF3D9FE22761620E849810A5201EC419 Nonce: 0x00000001 Buffer size: 32 bytes
18:36:20.606 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: DBC58980
18:36:20.614 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): FD4387DF134BF1CBA0D35E7DF22907B8
18:36:20.623 > 4_After_Tinkerbell (32): 027E183D342A93C5244B4ED8D237C3A1 18A0C5DC8734EEE3135136D09544108B 
18:36:20.632 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): FD4387DF134BF1CBA0D35E7DF22907B8
18:36:20.640 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): FD4387DF134BF1CBA0D35E7DF22907B83A4B819369C0F84959474CE73D306F08
18:36:20.648 > 5_After_Transposition (32): 4ED8D03637D2244B183DDCC52A34027E 8734EEE318A093C59544108B1351C3A1 
18:36:20.657 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:36:20.662 > [ESP32] === HMAC DEBUG INFO ===
18:36:20.665 > [ESP32] HMAC Key being used: ACA2EB299CD014CD8956895E30DD2A1724A98E15BED86A79E516EE505FB5A798
18:36:20.673 > [ESP32] HMAC Input length: 45 bytes
18:36:20.676 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000014ED8D03637D2244B183DDCC52A34027E8734EE
18:36:20.683 > [ESP32] Nonce: 0x00000001
18:36:20.687 > [ESP32] Packet size before HMAC: 61
18:36:20.689 > [ESP32] Computed HMAC Tag: 38330DAAA7D5FCC20B762718EE225593
18:36:20.696 > [ESP32] === END HMAC DEBUG ===
18:36:20.698 > 6_Final_Packet (61): 820218001800040804000000014ED8D0 3637D2244B183DDCC52A34027E8734EE ...
18:36:20.706 > [RETRY] Attempt 1/3 (nonce: 1)
18:36:20.709 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:20.715 > Sending pipeline data to server (659 bytes)
18:36:20.849 > [HTTP] Response code: 400
18:36:20.849 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:20.855 > [HTTP] Request failed with code: 400
18:36:20.857 > [RETRY] Send failed, waiting 100 ms before retry
18:36:20.958 > [RETRY] Attempt 2/3 (nonce: 1)
18:36:20.958 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:20.964 > Sending pipeline data to server (659 bytes)
18:36:21.202 > [HTTP] Response code: 400
18:36:21.202 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:21.208 > [HTTP] Request failed with code: 400
18:36:21.211 > [RETRY] Send failed, waiting 200 ms before retry
18:36:21.409 > [RETRY] Attempt 3/3 (nonce: 1)
18:36:21.410 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:21.415 > Sending pipeline data to server (659 bytes)
18:36:21.581 > [HTTP] Response code: 400
18:36:21.581 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:21.586 > [HTTP] Request failed with code: 400
18:36:21.589 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:36:21.594 > [RETRY] Consecutive failures: 3
18:36:21.597 > ✗ Auto-recovery failed - restarting key exchange
18:36:23.700 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":288606,"type":"health_data_error"}
18:36:23.715 > [WebSocket] Processing message type: health_data_error
18:36:23.720 > [295.8] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:23.729 > ✓ Public key loaded from NVS
18:36:23.827 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":288867,"type":"health_data_error"}
18:36:23.841 > [WebSocket] Processing message type: health_data_error
18:36:23.846 > [295.9] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:23.950 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123976898,"threatLevel":0,"type":"heuristics_update"}
18:36:23.975 > [WebSocket] Processing message type: heuristics_update
18:36:23.980 > [296.0] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:23.988 > Generating fresh master key from entropy...
18:36:23.992 > Generated master key (32): A0B6DF4A1FAECF9258B38D0DC9F5D4B3 88B98705B290D614D52B7D285C980634 
18:36:24.004 > Using reduced master key (byte % 3) for NTRU encryption only
18:36:24.012 > NTRU encrypted master key (502): 0063005B00400067001600440006006D 00370005001E000D006B00700023000E ...
18:36:24.021 > POST http://10.249.92.115:8081/master-key
18:36:24.340 > ✓ Master key exchange completed
18:36:24.443 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":289378,"type":"health_data_error"}
18:36:24.457 > [WebSocket] Processing message type: health_data_error
18:36:24.463 > [296.5] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:24.471 > Loading master key from NVS and deriving symmetric keys...
18:36:24.476 > Loaded master key from NVS (32): A0B6DF4A1FAECF9258B38D0DC9F5D4B3 88B98705B290D614D52B7D285C980634 
18:36:24.485 > Derived HMAC key (32): 7ED41B8A5B3B93E6DF9D75F462B3581B 3C6D73DE63AB9458F109A4955B4E2988 
18:36:24.493 > Derived Tinkerbell key (16): 465EFDE090F579EB368E36181B10D019 
18:36:24.498 > Derived Transposition key (16): D5401457C34C1726365D7B74E93D52B2 
18:36:24.504 > ✓ Symmetric keys derived successfully
18:36:24.507 > Nonce tracker reset - new session started
18:36:25.002 > Waiting for server to process master key...
18:36:25.007 > ✓ Symmetric keys ready - starting health data transmission
18:36:25.108 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":289585,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:25.145 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:25.150 > [WebSocket] ========================================
18:36:25.157 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:25.162 > [WebSocket] ========================================
18:36:25.167 > [ZTM] Settings saved successfully
18:36:25.170 > [WebSocket] ✓ ZTM activated successfully
18:36:25.173 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:25.179 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:25.181 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:25.184 > [WebSocket] ========================================
18:36:25.189 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":297255,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:25.229 > [297.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:25.334 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":289621,"type":"ztm_activated"}
18:36:25.350 > [WebSocket] Processing message type: ztm_activated
18:36:25.353 > [297.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:25.456 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123977910,"threatLevel":0,"type":"heuristics_update"}
18:36:25.481 > [WebSocket] Processing message type: heuristics_update
18:36:25.486 > [297.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:25.589 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":290132,"type":"health_data_error"}
18:36:25.603 > [WebSocket] Processing message type: health_data_error
18:36:25.608 > [297.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:25.711 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":290380,"type":"health_data_error"}
18:36:25.725 > [WebSocket] Processing message type: health_data_error
18:36:25.730 > [297.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:25.834 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":290914,"type":"health_data_error"}
18:36:25.847 > [WebSocket] Processing message type: health_data_error
18:36:25.853 > [297.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:25.956 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123978910,"threatLevel":0,"type":"heuristics_update"}
18:36:25.981 > [WebSocket] Processing message type: heuristics_update
18:36:25.986 > [298.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:26.089 > [298.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:26.189 > [298.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:26.291 > [298.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:26.392 > [298.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:26.493 > [298.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:26.594 > [298.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:26.694 > [298.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:26.795 > [298.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:26.896 > [299.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:26.997 > [299.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:27.100 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":291623,"type":"health_data_error"}
18:36:27.115 > [WebSocket] Processing message type: health_data_error
18:36:27.120 > [299.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:27.223 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":291897,"type":"health_data_error"}
18:36:27.238 > [WebSocket] Processing message type: health_data_error
18:36:27.243 > [299.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:27.346 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123979922,"threatLevel":0,"type":"heuristics_update"}
18:36:27.371 > [WebSocket] Processing message type: heuristics_update
18:36:27.377 > [299.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:27.479 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":292400,"type":"health_data_error"}
18:36:27.492 > [WebSocket] Processing message type: health_data_error
18:36:27.498 > [299.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:27.601 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":292922,"type":"health_data_error"}
18:36:27.615 > [WebSocket] Processing message type: health_data_error
18:36:27.620 > [299.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:27.723 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123980932,"threatLevel":0,"type":"heuristics_update"}
18:36:27.748 > [WebSocket] Processing message type: heuristics_update
18:36:27.754 > [299.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:27.856 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":293274,"type":"health_data_error"}
18:36:27.870 > [WebSocket] Processing message type: health_data_error
18:36:27.875 > [299.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:27.978 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":293653,"type":"health_data_error"}
18:36:27.992 > [WebSocket] Processing message type: health_data_error
18:36:27.997 > [300.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:28.101 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123981939,"threatLevel":0,"type":"heuristics_update"}
18:36:28.126 > [WebSocket] Processing message type: heuristics_update
18:36:28.132 > [300.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:28.234 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123982952,"threatLevel":0,"type":"heuristics_update"}
18:36:28.258 > [WebSocket] Processing message type: heuristics_update
18:36:28.265 > [300.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:28.367 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123983964,"threatLevel":0,"type":"heuristics_update"}
18:36:28.392 > [WebSocket] Processing message type: heuristics_update
18:36:28.398 > [300.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:28.499 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770123984098,"type":"master_key_received"}
18:36:28.513 > [WebSocket] Processing message type: master_key_received
18:36:28.516 > [300.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:28.622 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":296405,"type":"master_key_exchanged"}
18:36:28.638 > [WebSocket] Processing message type: master_key_exchanged
18:36:28.645 > [300.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:28.744 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123984976,"threatLevel":0,"type":"heuristics_update"}
18:36:28.769 > [WebSocket] Processing message type: heuristics_update
18:36:28.775 > [300.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:28.877 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":297075,"type":"symmetric_keys_derived"}
18:36:28.894 > [WebSocket] Processing message type: symmetric_keys_derived
18:36:28.900 > [301.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:29.000 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":297255,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:29.036 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:29.041 > [WebSocket] ========================================
18:36:29.047 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:29.052 > [WebSocket] ========================================
18:36:29.057 > [ZTM] Settings saved successfully
18:36:29.061 > [WebSocket] ✓ ZTM activated successfully
18:36:29.064 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:29.069 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:29.072 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:29.075 > [WebSocket] ========================================
18:36:29.081 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":301145,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:29.119 > [301.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:29.225 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":297290,"type":"ztm_activated"}
18:36:29.242 > [WebSocket] Processing message type: ztm_activated
18:36:29.245 > [301.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:29.347 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123985988,"threatLevel":0,"type":"heuristics_update"}
18:36:29.373 > [WebSocket] Processing message type: heuristics_update
18:36:29.378 > [301.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:29.481 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123986996,"threatLevel":0,"type":"heuristics_update"}
18:36:29.506 > [WebSocket] Processing message type: heuristics_update
18:36:29.511 > [301.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:29.615 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123988004,"threatLevel":0,"type":"heuristics_update"}
18:36:29.640 > [WebSocket] Processing message type: heuristics_update
18:36:29.645 > [301.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:29.746 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123989019,"threatLevel":0,"type":"heuristics_update"}
18:36:29.772 > [WebSocket] Processing message type: heuristics_update
18:36:29.777 > [301.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:29.879 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":301145,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:29.916 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:29.921 > [WebSocket] ========================================
18:36:29.928 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:29.933 > [WebSocket] ========================================
18:36:29.938 > [ZTM] Settings saved successfully
18:36:29.941 > [WebSocket] ✓ ZTM activated successfully
18:36:29.944 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:29.949 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:29.952 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:29.955 > [WebSocket] ========================================
18:36:29.961 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":302025,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:30.000 > [302.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:30.106 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":301181,"type":"ztm_activated"}
18:36:30.123 > [WebSocket] Processing message type: ztm_activated
18:36:30.125 > [302.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:30.232 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":302025,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:30.267 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:30.273 > [WebSocket] ========================================
18:36:30.279 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:30.285 > [WebSocket] ========================================
18:36:30.290 > [ZTM] Settings saved successfully
18:36:30.293 > [WebSocket] ✓ ZTM activated successfully
18:36:30.295 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:30.301 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:30.304 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:30.307 > [WebSocket] ========================================
18:36:30.312 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":302377,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:30.351 > [302.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:30.456 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":302061,"type":"ztm_activated"}
18:36:30.473 > [WebSocket] Processing message type: ztm_activated
18:36:30.476 > [302.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:30.579 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123990026,"threatLevel":0,"type":"heuristics_update"}
18:36:30.604 > [WebSocket] Processing message type: heuristics_update
18:36:30.610 > [302.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:30.713 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":302377,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:30.750 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:30.755 > [WebSocket] ========================================
18:36:30.760 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:30.766 > [WebSocket] ========================================
18:36:30.772 > [ZTM] Settings saved successfully
18:36:30.774 > [WebSocket] ✓ ZTM activated successfully
18:36:30.778 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:30.782 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:30.786 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:30.788 > [WebSocket] ========================================
18:36:30.794 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":302859,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:30.833 > [302.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:30.940 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":302412,"type":"ztm_activated"}
18:36:30.957 > [WebSocket] Processing message type: ztm_activated
18:36:30.990 > [303.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:31.064 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":302859,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:31.100 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:31.105 > [WebSocket] ========================================
18:36:31.110 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:31.116 > [WebSocket] ========================================
18:36:31.122 > [ZTM] Settings saved successfully
18:36:31.125 > [WebSocket] ✓ ZTM activated successfully
18:36:31.127 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:31.133 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:31.135 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:31.139 > [WebSocket] ========================================
18:36:31.144 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":303209,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:31.183 > [303.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:31.289 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":302894,"type":"ztm_activated"}
18:36:31.306 > [WebSocket] Processing message type: ztm_activated
18:36:31.308 > [303.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:31.412 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123991041,"threatLevel":0,"type":"heuristics_update"}
18:36:31.436 > [WebSocket] Processing message type: heuristics_update
18:36:31.443 > [303.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:31.547 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":303209,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:31.584 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:31.589 > [WebSocket] ========================================
18:36:31.595 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:31.601 > [WebSocket] ========================================
18:36:31.606 > [ZTM] Settings saved successfully
18:36:31.608 > [WebSocket] ✓ ZTM activated successfully
18:36:31.612 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:31.617 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:31.620 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:31.623 > [WebSocket] ========================================
18:36:31.628 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":303693,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:31.666 > [303.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:31.773 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":303244,"type":"ztm_activated"}
18:36:31.789 > [WebSocket] Processing message type: ztm_activated
18:36:31.793 > [303.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:31.897 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":303693,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:31.932 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:31.938 > [WebSocket] ========================================
18:36:31.944 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:31.949 > [WebSocket] ========================================
18:36:31.954 > [ZTM] Settings saved successfully
18:36:31.957 > [WebSocket] ✓ ZTM activated successfully
18:36:31.960 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:31.966 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:31.969 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:31.971 > [WebSocket] ========================================
18:36:31.977 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":304042,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:32.016 > [304.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:32.122 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":303729,"type":"ztm_activated"}
18:36:32.139 > [WebSocket] Processing message type: ztm_activated
18:36:32.142 > [304.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:32.244 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":304042,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:32.281 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:32.286 > [WebSocket] ========================================
18:36:32.292 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:32.298 > [WebSocket] ========================================
18:36:32.303 > [ZTM] Settings saved successfully
18:36:32.306 > [WebSocket] ✓ ZTM activated successfully
18:36:32.309 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:32.314 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:32.317 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:32.319 > [WebSocket] ========================================
18:36:32.326 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":304390,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:32.364 > [304.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:32.470 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":304077,"type":"ztm_activated"}
18:36:32.486 > [WebSocket] Processing message type: ztm_activated
18:36:32.489 > [304.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:32.593 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123992053,"threatLevel":0,"type":"heuristics_update"}
18:36:32.618 > [WebSocket] Processing message type: heuristics_update
18:36:32.623 > [304.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:32.728 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":304390,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:32.765 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:32.770 > [WebSocket] ========================================
18:36:32.776 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:32.781 > [WebSocket] ========================================
18:36:32.786 > [ZTM] Settings saved successfully
18:36:32.790 > [WebSocket] ✓ ZTM activated successfully
18:36:32.792 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:32.797 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:32.800 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:32.803 > [WebSocket] ========================================
18:36:32.808 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":304874,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:32.848 > [304.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:32.954 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":304426,"type":"ztm_activated"}
18:36:32.971 > [WebSocket] Processing message type: ztm_activated
18:36:32.973 > [305.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:33.077 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":304874,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:33.113 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:33.119 > [WebSocket] ========================================
18:36:33.124 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:33.130 > [WebSocket] ========================================
18:36:33.135 > [ZTM] Settings saved successfully
18:36:33.139 > [WebSocket] ✓ ZTM activated successfully
18:36:33.141 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:33.147 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:33.150 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:33.152 > [WebSocket] ========================================
18:36:33.157 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":305223,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:33.197 > [305.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:33.303 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":304909,"type":"ztm_activated"}
18:36:33.319 > [WebSocket] Processing message type: ztm_activated
18:36:33.322 > [305.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:33.426 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123993062,"threatLevel":0,"type":"heuristics_update"}
18:36:33.452 > [WebSocket] Processing message type: heuristics_update
18:36:33.457 > [305.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:33.558 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":305223,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:33.595 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:33.600 > [WebSocket] ========================================
18:36:33.606 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:33.612 > [WebSocket] ========================================
18:36:33.617 > [ZTM] Settings saved successfully
18:36:33.620 > [WebSocket] ✓ ZTM activated successfully
18:36:33.623 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:33.628 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:33.631 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:33.633 > [WebSocket] ========================================
18:36:33.639 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":305704,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:33.678 > [305.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:33.785 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":305258,"type":"ztm_activated"}
18:36:33.802 > [WebSocket] Processing message type: ztm_activated
18:36:33.805 > [305.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:33.912 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":305704,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:33.947 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:33.953 > [WebSocket] ========================================
18:36:33.958 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:33.964 > [WebSocket] ========================================
18:36:33.969 > [ZTM] Settings saved successfully
18:36:33.972 > [WebSocket] ✓ ZTM activated successfully
18:36:33.975 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:33.980 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:33.983 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:33.986 > [WebSocket] ========================================
18:36:33.992 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":306057,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:34.031 > [306.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:34.137 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":305740,"type":"ztm_activated"}
18:36:34.154 > [WebSocket] Processing message type: ztm_activated
18:36:34.156 > [306.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:34.261 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":306057,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:34.296 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:34.302 > [WebSocket] ========================================
18:36:34.308 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:34.313 > [WebSocket] ========================================
18:36:34.319 > [ZTM] Settings saved successfully
18:36:34.322 > [WebSocket] ✓ ZTM activated successfully
18:36:34.325 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:34.329 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:34.333 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:34.335 > [WebSocket] ========================================
18:36:34.340 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":306406,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:34.379 > [306.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:34.484 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":306092,"type":"ztm_activated"}
18:36:34.502 > [WebSocket] Processing message type: ztm_activated
18:36:34.504 > [306.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:34.608 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123994072,"threatLevel":0,"type":"heuristics_update"}
18:36:34.633 > [WebSocket] Processing message type: heuristics_update
18:36:34.638 > [306.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:34.741 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":306406,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:34.777 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:34.783 > [WebSocket] ========================================
18:36:34.789 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:34.794 > [WebSocket] ========================================
18:36:34.799 > [ZTM] Settings saved successfully
18:36:34.802 > [WebSocket] ✓ ZTM activated successfully
18:36:34.805 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:34.810 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:34.814 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:34.816 > [WebSocket] ========================================
18:36:34.821 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":306887,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:34.861 > [306.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:34.967 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":306441,"type":"ztm_activated"}
18:36:34.983 > [WebSocket] Processing message type: ztm_activated
18:36:34.986 > [307.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:35.093 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":306887,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:35.129 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:35.134 > [WebSocket] ========================================
18:36:35.140 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:35.145 > [WebSocket] ========================================
18:36:35.152 > [ZTM] Settings saved successfully
18:36:35.154 > [WebSocket] ✓ ZTM activated successfully
18:36:35.157 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:35.162 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:35.165 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:35.167 > [WebSocket] ========================================
18:36:35.173 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":307238,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:35.212 > [307.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:35.220 > [RETRY] Attempting to send health data (Max retries: 3)
18:36:35.223 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:36:35.229 > Generated health data: HR-65 SPO2-96 STEPS-1552
18:36:35.234 > [ESP32] ========================================
18:36:35.238 > [ESP32] ENCRYPTION PIPELINE START
18:36:35.240 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:36:35.245 > [ESP32] Active Algorithms for this packet:
18:36:35.251 > [ESP32]   + LFSR
18:36:35.251 > [ESP32]   + Tinkerbell
18:36:35.254 > [ESP32]   + Transposition
18:36:35.257 > [ESP32]   - ChaCha20
18:36:35.257 > [ESP32]   - Salsa20
18:36:35.260 > [ESP32] ========================================
18:36:35.262 > [ESP32] MsgKeys: lfsrSeed=0x16D101D9 tnk[0..3]=6FE050BE trn[0..3]=7D37AEAB
18:36:35.271 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313535324D50
18:36:35.276 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313535324D50000000000000 
18:36:35.284 > [ESP32][LFSR] Initializing - Seed: 0x16D101D9 SeedBe: 0xD901D116 ChaosKey[0..3]: 6FE050BE InitialTap: 0x0029 State: 0x16D101D9
18:36:35.296 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:36:35.304 > 3_After_LFSR (32): 9153FC2056D465F7509BAA139AFA6994 209EA448B83C55298970F824D90C13C9 
18:36:35.312 > [ESP32][LFSR] Keystream (first 16 bytes): D901D11663F436A71FA9872AACDA3AC0
18:36:35.318 > [ESP32][4D] LFSR keystream (first 32 bytes): D901D11663F436A71FA9872AACDA3AC065CEF7658909601BC420F824D90C13C9
18:36:35.326 > [ESP32][TINKERBELL] Input (first 16 bytes): 9153FC2056D465F7509BAA139AFA6994 Nonce: 0x00000001 Buffer size: 32 bytes
18:36:35.337 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 6FE050BE
18:36:35.348 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 2BAF702B6B34ED741C1051689C56F0DF
18:36:35.357 > 4_After_Tinkerbell (32): BAFC8C0B3DE088834C8BFB7B06AC994B DC8E56989BB438E0692A2460421F9064 
18:36:35.363 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 2BAF702B6B34ED741C1051689C56F0DF
18:36:35.370 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 2BAF702B6B34ED741C1051689C56F0DFFC10F2D023886DC9E05ADC449B1383AD
18:36:35.382 > 5_After_Transposition (32): DC8E5698FB7B4C8B692A24608C0BBAFC E09BB4384BAC990664421F9083E0883D 
18:36:35.390 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:36:35.396 > [ESP32] === HMAC DEBUG INFO ===
18:36:35.398 > [ESP32] HMAC Key being used: 7ED41B8A5B3B93E6DF9D75F462B3581B3C6D73DE63AB9458F109A4955B4E2988
18:36:35.407 > [ESP32] HMAC Input length: 45 bytes
18:36:35.409 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001DC8E5698FB7B4C8B692A24608C0BBAFCE09BB4
18:36:35.417 > [ESP32] Nonce: 0x00000001
18:36:35.421 > [ESP32] Packet size before HMAC: 61
18:36:35.423 > [ESP32] Computed HMAC Tag: 7885D734AC842D4B4684AC292670DB7C
18:36:35.429 > [ESP32] === END HMAC DEBUG ===
18:36:35.432 > 6_Final_Packet (61): 82021800180004080400000001DC8E56 98FB7B4C8B692A24608C0BBAFCE09BB4 ...
18:36:35.440 > [RETRY] Attempt 1/3 (nonce: 1)
18:36:35.442 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:35.446 > Sending pipeline data to server (659 bytes)
18:36:35.630 > [HTTP] Response code: 400
18:36:35.630 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:35.636 > [HTTP] Request failed with code: 400
18:36:35.638 > [RETRY] Send failed, waiting 100 ms before retry
18:36:35.738 > [RETRY] Attempt 2/3 (nonce: 1)
18:36:35.738 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:35.743 > Sending pipeline data to server (659 bytes)
18:36:35.878 > [HTTP] Response code: 400
18:36:35.878 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:35.884 > [HTTP] Request failed with code: 400
18:36:35.886 > [RETRY] Send failed, waiting 200 ms before retry
18:36:36.086 > [RETRY] Attempt 3/3 (nonce: 1)
18:36:36.086 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:36.091 > Sending pipeline data to server (659 bytes)
18:36:36.383 > [HTTP] Response code: 400
18:36:36.383 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:36.388 > [HTTP] Request failed with code: 400
18:36:36.391 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:36:36.397 > [RETRY] Consecutive failures: 4
18:36:36.399 > Health data send failed (retry count: 1/3)
18:36:36.502 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":306922,"type":"ztm_activated"}
18:36:36.520 > [WebSocket] Processing message type: ztm_activated
18:36:36.522 > [308.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:36.530 > [RETRY] Attempting to send health data (Max retries: 3)
18:36:36.536 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:36:36.542 > Generated health data: HR-65 SPO2-96 STEPS-1581
18:36:36.545 > [ESP32] ========================================
18:36:36.550 > [ESP32] ENCRYPTION PIPELINE START
18:36:36.553 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:36:36.558 > [ESP32] Active Algorithms for this packet:
18:36:36.560 > [ESP32]   + LFSR
18:36:36.563 > [ESP32]   + Tinkerbell
18:36:36.563 > [ESP32]   + Transposition
18:36:36.566 > [ESP32]   - ChaCha20
18:36:36.569 > [ESP32]   - Salsa20
18:36:36.569 > [ESP32] ========================================
18:36:36.575 > [ESP32] MsgKeys: lfsrSeed=0x16D101D9 tnk[0..3]=6FE050BE trn[0..3]=7D37AEAB
18:36:36.580 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313538314D50
18:36:36.589 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313538314D50000000000000 
18:36:36.594 > [ESP32][LFSR] Initializing - Seed: 0x16D101D9 SeedBe: 0xD901D116 ChaosKey[0..3]: 6FE050BE InitialTap: 0x0029 State: 0x16D101D9
18:36:36.606 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:36:36.614 > 3_After_LFSR (32): 9153FC2056D465F7509BAA139AFA6994 209EA448B83C582A8970F824D90C13C9 
18:36:36.622 > [ESP32][LFSR] Keystream (first 16 bytes): D901D11663F436A71FA9872AACDA3AC0
18:36:36.628 > [ESP32][4D] LFSR keystream (first 32 bytes): D901D11663F436A71FA9872AACDA3AC065CEF7658909601BC420F824D90C13C9
18:36:36.638 > [ESP32][TINKERBELL] Input (first 16 bytes): 9153FC2056D465F7509BAA139AFA6994 Nonce: 0x00000001 Buffer size: 32 bytes
18:36:36.647 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 6FE050BE
18:36:36.658 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 2BAF702B6B34ED741C1051689C56F0DF
18:36:36.666 > 4_After_Tinkerbell (32): BAFC8C0B3DE088834C8BFB7B06AC994B DC8E56989BB435E3692A2460421F9064 
18:36:36.675 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 2BAF702B6B34ED741C1051689C56F0DF
18:36:36.683 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 2BAF702B6B34ED741C1051689C56F0DFFC10F2D023886DC9E05ADC449B1383AD
18:36:36.692 > 5_After_Transposition (32): DC8E5698FB7B4C8B692A24608C0BBAFC E39BB4354BAC990664421F9083E0883D 
18:36:36.700 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:36:36.705 > [ESP32] === HMAC DEBUG INFO ===
18:36:36.708 > [ESP32] HMAC Key being used: 7ED41B8A5B3B93E6DF9D75F462B3581B3C6D73DE63AB9458F109A4955B4E2988
18:36:36.716 > [ESP32] HMAC Input length: 45 bytes
18:36:36.719 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001DC8E5698FB7B4C8B692A24608C0BBAFCE39BB4
18:36:36.728 > [ESP32] Nonce: 0x00000001
18:36:36.731 > [ESP32] Packet size before HMAC: 61
18:36:36.733 > [ESP32] Computed HMAC Tag: 1B3328F34CA09BECF9CEF516B8CF2EEE
18:36:36.739 > [ESP32] === END HMAC DEBUG ===
18:36:36.742 > 6_Final_Packet (61): 82021800180004080400000001DC8E56 98FB7B4C8B692A24608C0BBAFCE39BB4 ...
18:36:36.750 > [RETRY] Attempt 1/3 (nonce: 1)
18:36:36.753 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:36.758 > Sending pipeline data to server (659 bytes)
18:36:36.914 > [HTTP] Response code: 400
18:36:36.914 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:36.920 > [HTTP] Request failed with code: 400
18:36:36.923 > [RETRY] Send failed, waiting 100 ms before retry
18:36:37.023 > [RETRY] Attempt 2/3 (nonce: 1)
18:36:37.023 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:37.028 > Sending pipeline data to server (659 bytes)
18:36:37.150 > [HTTP] Response code: 400
18:36:37.150 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:37.155 > [HTTP] Request failed with code: 400
18:36:37.158 > [RETRY] Send failed, waiting 200 ms before retry
18:36:37.360 > [RETRY] Attempt 3/3 (nonce: 1)
18:36:37.360 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:37.365 > Sending pipeline data to server (659 bytes)
18:36:37.646 > [HTTP] Response code: 400
18:36:37.646 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:37.652 > [HTTP] Request failed with code: 400
18:36:37.655 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:36:37.660 > [RETRY] Consecutive failures: 5
18:36:37.663 > [EMERGENCY] Triggering emergency reset!
18:36:37.665 > [CRYPTO] Resetting cryptographic state
18:36:37.671 > [CRYPTO] Crypto state reset complete
18:36:37.673 > [CRYPTO] Packet counter: 6
18:36:37.676 > [EMERGENCY] Emergency reset complete
18:36:37.679 > Health data send failed (retry count: 2/3)
18:36:37.776 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123995081,"threatLevel":0,"type":"heuristics_update"}
18:36:37.801 > [WebSocket] Processing message type: heuristics_update
18:36:37.807 > [309.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:37.811 > [RETRY] Attempting to send health data (Max retries: 3)
18:36:37.817 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:36:37.823 > Generated health data: HR-65 SPO2-96 STEPS-1559
18:36:37.825 > [ESP32] ========================================
18:36:37.832 > [ESP32] ENCRYPTION PIPELINE START
18:36:37.834 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:36:37.839 > [ESP32] Active Algorithms for this packet:
18:36:37.842 > [ESP32]   + LFSR
18:36:37.845 > [ESP32]   + Tinkerbell
18:36:37.848 > [ESP32]   + Transposition
18:36:37.848 > [ESP32]   - ChaCha20
18:36:37.851 > [ESP32]   - Salsa20
18:36:37.853 > [ESP32] ========================================
18:36:37.856 > [ESP32] MsgKeys: lfsrSeed=0x16D101D9 tnk[0..3]=6FE050BE trn[0..3]=7D37AEAB
18:36:37.864 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313535394D50
18:36:37.870 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313535394D50000000000000 
18:36:37.879 > [ESP32][LFSR] Initializing - Seed: 0x16D101D9 SeedBe: 0xD901D116 ChaosKey[0..3]: 6FE050BE InitialTap: 0x0029 State: 0x16D101D9
18:36:37.888 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:36:37.898 > 3_After_LFSR (32): 9153FC2056D465F7509BAA139AFA6994 209EA448B83C55228970F824D90C13C9 
18:36:37.903 > [ESP32][LFSR] Keystream (first 16 bytes): D901D11663F436A71FA9872AACDA3AC0
18:36:37.912 > [ESP32][4D] LFSR keystream (first 32 bytes): D901D11663F436A71FA9872AACDA3AC065CEF7658909601BC420F824D90C13C9
18:36:37.920 > [ESP32][TINKERBELL] Input (first 16 bytes): 9153FC2056D465F7509BAA139AFA6994 Nonce: 0x00000001 Buffer size: 32 bytes
18:36:37.931 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 6FE050BE
18:36:37.939 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 2BAF702B6B34ED741C1051689C56F0DF
18:36:37.948 > 4_After_Tinkerbell (32): BAFC8C0B3DE088834C8BFB7B06AC994B DC8E56989BB438EB692A2460421F9064 
18:36:37.956 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 2BAF702B6B34ED741C1051689C56F0DF
18:36:37.965 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 2BAF702B6B34ED741C1051689C56F0DFFC10F2D023886DC9E05ADC449B1383AD
18:36:37.976 > 5_After_Transposition (32): DC8E5698FB7B4C8B692A24608C0BBAFC EB9BB4384BAC990664421F9083E0883D 
18:36:37.984 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:36:37.986 > [ESP32] === HMAC DEBUG INFO ===
18:36:37.990 > [ESP32] HMAC Key being used: 7ED41B8A5B3B93E6DF9D75F462B3581B3C6D73DE63AB9458F109A4955B4E2988
18:36:37.998 > [ESP32] HMAC Input length: 45 bytes
18:36:38.001 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001DC8E5698FB7B4C8B692A24608C0BBAFCEB9BB4
18:36:38.012 > [ESP32] Nonce: 0x00000001
18:36:38.012 > [ESP32] Packet size before HMAC: 61
18:36:38.017 > [ESP32] Computed HMAC Tag: F362D7108DC99097DD6E7964E7E67FEA
18:36:38.020 > [ESP32] === END HMAC DEBUG ===
18:36:38.023 > 6_Final_Packet (61): 82021800180004080400000001DC8E56 98FB7B4C8B692A24608C0BBAFCEB9BB4 ...
18:36:38.031 > [RETRY] Attempt 1/3 (nonce: 1)
18:36:38.034 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:38.040 > Sending pipeline data to server (659 bytes)
18:36:38.400 > [HTTP] Response code: 400
18:36:38.400 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:38.405 > [HTTP] Request failed with code: 400
18:36:38.407 > [RETRY] Send failed, waiting 100 ms before retry
18:36:38.508 > [RETRY] Attempt 2/3 (nonce: 1)
18:36:38.508 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:38.513 > Sending pipeline data to server (659 bytes)
18:36:38.654 > [HTTP] Response code: 400
18:36:38.654 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:38.659 > [HTTP] Request failed with code: 400
18:36:38.662 > [RETRY] Send failed, waiting 200 ms before retry
18:36:38.862 > [RETRY] Attempt 3/3 (nonce: 1)
18:36:38.862 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:38.867 > Sending pipeline data to server (659 bytes)
18:36:39.158 > [HTTP] Response code: 400
18:36:39.158 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:39.164 > [HTTP] Request failed with code: 400
18:36:39.167 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:36:39.173 > [RETRY] Consecutive failures: 1
18:36:39.175 > Health data send failed (retry count: 3/3)
18:36:39.178 > Health data transmission failed after max retries
18:36:39.279 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":307238,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:39.315 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:39.320 > [WebSocket] ========================================
18:36:39.326 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:39.332 > [WebSocket] ========================================
18:36:39.338 > [ZTM] Settings saved successfully
18:36:39.341 > [WebSocket] ✓ ZTM activated successfully
18:36:39.343 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:39.348 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:39.352 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:39.354 > [WebSocket] ========================================
18:36:39.359 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":311425,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:39.398 > [311.5] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:39.404 > ERROR state - attempting recovery
18:36:39.407 > [RETRY] Attempting to send health data (Max retries: 3)
18:36:39.413 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:36:39.418 > Generated health data: HR-65 SPO2-96 STEPS-1584
18:36:39.420 > [ESP32] ========================================
18:36:39.427 > [ESP32] ENCRYPTION PIPELINE START
18:36:39.429 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:36:39.435 > [ESP32] Active Algorithms for this packet:
18:36:39.438 > [ESP32]   + LFSR
18:36:39.440 > [ESP32]   + Tinkerbell
18:36:39.443 > [ESP32]   + Transposition
18:36:39.443 > [ESP32]   - ChaCha20
18:36:39.446 > [ESP32]   - Salsa20
18:36:39.448 > [ESP32] ========================================
18:36:39.452 > [ESP32] MsgKeys: lfsrSeed=0x16D101D9 tnk[0..3]=6FE050BE trn[0..3]=7D37AEAB
18:36:39.460 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313538344D50
18:36:39.465 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313538344D50000000000000 
18:36:39.473 > [ESP32][LFSR] Initializing - Seed: 0x16D101D9 SeedBe: 0xD901D116 ChaosKey[0..3]: 6FE050BE InitialTap: 0x0029 State: 0x16D101D9
18:36:39.485 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:36:39.493 > 3_After_LFSR (32): 9153FC2056D465F7509BAA139AFA6994 209EA448B83C582F8970F824D90C13C9 
18:36:39.498 > [ESP32][LFSR] Keystream (first 16 bytes): D901D11663F436A71FA9872AACDA3AC0
18:36:39.507 > [ESP32][4D] LFSR keystream (first 32 bytes): D901D11663F436A71FA9872AACDA3AC065CEF7658909601BC420F824D90C13C9
18:36:39.517 > [ESP32][TINKERBELL] Input (first 16 bytes): 9153FC2056D465F7509BAA139AFA6994 Nonce: 0x00000001 Buffer size: 32 bytes
18:36:39.527 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 6FE050BE
18:36:39.534 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 2BAF702B6B34ED741C1051689C56F0DF
18:36:39.543 > 4_After_Tinkerbell (32): BAFC8C0B3DE088834C8BFB7B06AC994B DC8E56989BB435E6692A2460421F9064 
18:36:39.552 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 2BAF702B6B34ED741C1051689C56F0DF
18:36:39.559 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 2BAF702B6B34ED741C1051689C56F0DFFC10F2D023886DC9E05ADC449B1383AD
18:36:39.571 > 5_After_Transposition (32): DC8E5698FB7B4C8B692A24608C0BBAFC E69BB4354BAC990664421F9083E0883D 
18:36:39.579 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:36:39.582 > [ESP32] === HMAC DEBUG INFO ===
18:36:39.585 > [ESP32] HMAC Key being used: 7ED41B8A5B3B93E6DF9D75F462B3581B3C6D73DE63AB9458F109A4955B4E2988
18:36:39.593 > [ESP32] HMAC Input length: 45 bytes
18:36:39.596 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001DC8E5698FB7B4C8B692A24608C0BBAFCE69BB4
18:36:39.607 > [ESP32] Nonce: 0x00000001
18:36:39.607 > [ESP32] Packet size before HMAC: 61
18:36:39.613 > [ESP32] Computed HMAC Tag: 9EF6D17EC19EBA6A6C13CECC1464FEBC
18:36:39.616 > [ESP32] === END HMAC DEBUG ===
18:36:39.618 > 6_Final_Packet (61): 82021800180004080400000001DC8E56 98FB7B4C8B692A24608C0BBAFCE69BB4 ...
18:36:39.627 > [RETRY] Attempt 1/3 (nonce: 1)
18:36:39.629 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:39.635 > Sending pipeline data to server (659 bytes)
18:36:39.925 > [HTTP] Response code: 400
18:36:39.925 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:39.930 > [HTTP] Request failed with code: 400
18:36:39.933 > [RETRY] Send failed, waiting 100 ms before retry
18:36:40.034 > [RETRY] Attempt 2/3 (nonce: 1)
18:36:40.034 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:40.040 > Sending pipeline data to server (659 bytes)
18:36:40.164 > [HTTP] Response code: 400
18:36:40.164 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:40.171 > [HTTP] Request failed with code: 400
18:36:40.173 > [RETRY] Send failed, waiting 200 ms before retry
18:36:40.373 > [RETRY] Attempt 3/3 (nonce: 1)
18:36:40.373 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:40.378 > Sending pipeline data to server (659 bytes)
18:36:40.696 > [HTTP] Response code: 400
18:36:40.696 > [HTTP] Error response: {"error":"Decryption failed"}
18:36:40.701 > [HTTP] Request failed with code: 400
18:36:40.704 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:36:40.710 > [RETRY] Consecutive failures: 2
18:36:40.712 > ✗ Auto-recovery failed - restarting key exchange
18:36:42.815 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":307274,"type":"ztm_activated"}
18:36:42.831 > [WebSocket] Processing message type: ztm_activated
18:36:42.834 > [314.9] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:42.842 > ✓ Public key loaded from NVS
18:36:42.941 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":307702,"type":"health_data_error"}
18:36:42.955 > [WebSocket] Processing message type: health_data_error
18:36:42.960 > [315.0] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:43.063 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":307951,"type":"health_data_error"}
18:36:43.077 > [WebSocket] Processing message type: health_data_error
18:36:43.083 > [315.1] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:43.091 > Generating fresh master key from entropy...
18:36:43.100 > Generated master key (32): 6BEE0047AF8308E2B423AB4D03537F4B 00184094898CFD4809AC25E46F1B4C5D 
18:36:43.105 > Using reduced master key (byte % 3) for NTRU encryption only
18:36:43.115 > NTRU encrypted master key (502): 0064005A003F0067001600460008006C 00360005001E000E006B00700022000C ...
18:36:43.124 > POST http://10.249.92.115:8081/master-key
18:36:43.428 > ✓ Master key exchange completed
18:36:43.529 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123996091,"threatLevel":0,"type":"heuristics_update"}
18:36:43.555 > [WebSocket] Processing message type: heuristics_update
18:36:43.560 > [315.6] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:43.566 > Loading master key from NVS and deriving symmetric keys...
18:36:43.572 > Loaded master key from NVS (32): 6BEE0047AF8308E2B423AB4D03537F4B 00184094898CFD4809AC25E46F1B4C5D 
18:36:43.582 > Derived HMAC key (32): 61898C000C113108D39ECEB4ED4B23B9 71AD22F4054BB82DB3207670B191DB81 
18:36:43.588 > Derived Tinkerbell key (16): 97C03EA192153AE6911E4407667291AE 
18:36:43.594 > Derived Transposition key (16): E7ABD4D8FE2291355E67F229DFD24F99 
18:36:43.602 > ✓ Symmetric keys derived successfully
18:36:43.604 > Nonce tracker reset - new session started
18:36:44.100 > Waiting for server to process master key...
18:36:44.103 > ✓ Symmetric keys ready - starting health data transmission
18:36:44.205 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":308456,"type":"health_data_error"}
18:36:44.220 > [WebSocket] Processing message type: health_data_error
18:36:44.225 > [316.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:44.329 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":308987,"type":"health_data_error"}
18:36:44.342 > [WebSocket] Processing message type: health_data_error
18:36:44.348 > [316.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:44.451 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123997102,"threatLevel":0,"type":"heuristics_update"}
18:36:44.476 > [WebSocket] Processing message type: heuristics_update
18:36:44.482 > [316.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:44.584 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":309222,"type":"health_data_error"}
18:36:44.598 > [WebSocket] Processing message type: health_data_error
18:36:44.604 > [316.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:44.707 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":309718,"type":"health_data_error"}
18:36:44.720 > [WebSocket] Processing message type: health_data_error
18:36:44.726 > [316.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:44.828 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123998113,"threatLevel":0,"type":"heuristics_update"}
18:36:44.853 > [WebSocket] Processing message type: heuristics_update
18:36:44.859 > [316.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:44.962 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":310472,"type":"health_data_error"}
18:36:44.977 > [WebSocket] Processing message type: health_data_error
18:36:44.981 > [317.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:45.083 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":310727,"type":"health_data_error"}
18:36:45.097 > [WebSocket] Processing message type: health_data_error
18:36:45.103 > [317.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:45.207 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770123999125,"threatLevel":0,"type":"heuristics_update"}
18:36:45.233 > [WebSocket] Processing message type: heuristics_update
18:36:45.239 > [317.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:45.340 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":7,"success":false,"timestamp":311231,"type":"health_data_error"}
18:36:45.354 > [WebSocket] Processing message type: health_data_error
18:36:45.359 > [317.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:45.463 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":311425,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:45.498 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:45.504 > [WebSocket] ========================================
18:36:45.510 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:45.515 > [WebSocket] ========================================
18:36:45.520 > [ZTM] Settings saved successfully
18:36:45.524 > [WebSocket] ✓ ZTM activated successfully
18:36:45.526 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:45.532 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:45.534 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:45.537 > [WebSocket] ========================================
18:36:45.543 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":317608,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:45.582 > [317.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:45.688 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":8,"success":true,"timestamp":311461,"type":"ztm_activated"}
18:36:45.705 > [WebSocket] Processing message type: ztm_activated
18:36:45.708 > [317.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:45.810 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":311998,"type":"health_data_error"}
18:36:45.825 > [WebSocket] Processing message type: health_data_error
18:36:45.830 > [317.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:45.933 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124000137,"threatLevel":0,"type":"heuristics_update"}
18:36:45.958 > [WebSocket] Processing message type: heuristics_update
18:36:45.964 > [318.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:46.066 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":312237,"type":"health_data_error"}
18:36:46.080 > [WebSocket] Processing message type: health_data_error
18:36:46.086 > [318.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:46.189 > [WebSocket] Received (154 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Failed to send health data","state":8,"success":false,"timestamp":312768,"type":"health_data_error"}
18:36:46.203 > [WebSocket] Processing message type: health_data_error
18:36:46.208 > [318.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:46.312 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124001146,"threatLevel":0,"type":"heuristics_update"}
18:36:46.336 > [WebSocket] Processing message type: heuristics_update
18:36:46.342 > [318.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:46.444 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124002162,"threatLevel":0,"type":"heuristics_update"}
18:36:46.469 > [WebSocket] Processing message type: heuristics_update
18:36:46.475 > [318.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:46.577 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124003173,"threatLevel":0,"type":"heuristics_update"}
18:36:46.602 > [WebSocket] Processing message type: heuristics_update
18:36:46.608 > [318.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:46.711 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770124003229,"type":"master_key_received"}
18:36:46.725 > [WebSocket] Processing message type: master_key_received
18:36:46.727 > [318.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:46.833 > [WebSocket] Received (175 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":315493,"type":"master_key_exchanged"}
18:36:46.849 > [WebSocket] Processing message type: master_key_exchanged
18:36:46.854 > [318.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:46.954 > [WebSocket] Received (167 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":316172,"type":"symmetric_keys_derived"}
18:36:46.970 > [WebSocket] Processing message type: symmetric_keys_derived
18:36:46.976 > [319.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:47.076 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124004185,"threatLevel":0,"type":"heuristics_update"}
18:36:47.102 > [WebSocket] Processing message type: heuristics_update
18:36:47.107 > [319.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:47.209 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124005195,"threatLevel":0,"type":"heuristics_update"}
18:36:47.234 > [WebSocket] Processing message type: heuristics_update
18:36:47.240 > [319.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:47.342 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":317608,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:47.379 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:47.384 > [WebSocket] ========================================
18:36:47.389 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:47.395 > [WebSocket] ========================================
18:36:47.401 > [ZTM] Settings saved successfully
18:36:47.403 > [WebSocket] ✓ ZTM activated successfully
18:36:47.406 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:47.412 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:47.415 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:47.417 > [WebSocket] ========================================
18:36:47.423 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":319488,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:47.462 > [319.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:47.567 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":317644,"type":"ztm_activated"}
18:36:47.584 > [WebSocket] Processing message type: ztm_activated
18:36:47.587 > [319.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:47.690 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124006205,"threatLevel":0,"type":"heuristics_update"}
18:36:47.720 > [WebSocket] Processing message type: heuristics_update
18:36:47.721 > [319.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:47.825 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124007218,"threatLevel":0,"type":"heuristics_update"}
18:36:47.850 > [WebSocket] Processing message type: heuristics_update
18:36:47.857 > [319.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:47.960 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":319488,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:47.995 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:48.000 > [WebSocket] ========================================
18:36:48.006 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:48.011 > [WebSocket] ========================================
18:36:48.017 > [ZTM] Settings saved successfully
18:36:48.020 > [WebSocket] ✓ ZTM activated successfully
18:36:48.023 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:48.029 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:48.031 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:48.034 > [WebSocket] ========================================
18:36:48.040 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":320105,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:48.078 > [320.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:48.186 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":319524,"type":"ztm_activated"}
18:36:48.202 > [WebSocket] Processing message type: ztm_activated
18:36:48.205 > [320.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:48.309 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":320105,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:48.345 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:48.351 > [WebSocket] ========================================
18:36:48.356 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:48.362 > [WebSocket] ========================================
18:36:48.367 > [ZTM] Settings saved successfully
18:36:48.370 > [WebSocket] ✓ ZTM activated successfully
18:36:48.372 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:48.379 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:48.381 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:48.383 > [WebSocket] ========================================
18:36:48.389 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":320455,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:48.427 > [320.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:48.535 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":320141,"type":"ztm_activated"}
18:36:48.552 > [WebSocket] Processing message type: ztm_activated
18:36:48.555 > [320.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:48.658 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124008233,"threatLevel":0,"type":"heuristics_update"}
18:36:48.683 > [WebSocket] Processing message type: heuristics_update
18:36:48.689 > [320.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:48.792 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":320455,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:48.828 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:48.834 > [WebSocket] ========================================
18:36:48.839 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:48.845 > [WebSocket] ========================================
18:36:48.850 > [ZTM] Settings saved successfully
18:36:48.853 > [WebSocket] ✓ ZTM activated successfully
18:36:48.855 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:48.861 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:48.864 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:48.867 > [WebSocket] ========================================
18:36:48.872 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":320938,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:48.911 > [321.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:49.017 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":320491,"type":"ztm_activated"}
18:36:49.034 > [WebSocket] Processing message type: ztm_activated
18:36:49.037 > [321.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:49.143 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":320938,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:49.179 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:49.185 > [WebSocket] ========================================
18:36:49.191 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:49.195 > [WebSocket] ========================================
18:36:49.201 > [ZTM] Settings saved successfully
18:36:49.204 > [WebSocket] ✓ ZTM activated successfully
18:36:49.207 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:49.212 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:49.215 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:49.218 > [WebSocket] ========================================
18:36:49.223 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":321289,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:49.267 > [321.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:49.368 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":320973,"type":"ztm_activated"}
18:36:49.384 > [WebSocket] Processing message type: ztm_activated
18:36:49.388 > [321.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:49.492 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":321289,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:49.528 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:49.533 > [WebSocket] ========================================
18:36:49.539 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:49.544 > [WebSocket] ========================================
18:36:49.550 > [ZTM] Settings saved successfully
18:36:49.553 > [WebSocket] ✓ ZTM activated successfully
18:36:49.556 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:49.561 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:49.563 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:49.566 > [WebSocket] ========================================
18:36:49.572 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":321638,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:49.611 > [321.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:49.717 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124009241,"threatLevel":0,"type":"heuristics_update"}
18:36:49.742 > [WebSocket] Processing message type: heuristics_update
18:36:49.747 > [321.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:49.851 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":321334,"type":"ztm_activated"}
18:36:49.867 > [WebSocket] Processing message type: ztm_activated
18:36:49.870 > [321.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:49.973 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":321638,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:50.009 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:50.014 > [WebSocket] ========================================
18:36:50.020 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:50.026 > [WebSocket] ========================================
18:36:50.031 > [ZTM] Settings saved successfully
18:36:50.034 > [WebSocket] ✓ ZTM activated successfully
18:36:50.037 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:50.041 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:50.045 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:50.047 > [WebSocket] ========================================
18:36:50.053 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":322119,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:50.092 > [322.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:50.198 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":321673,"type":"ztm_activated"}
18:36:50.215 > [WebSocket] Processing message type: ztm_activated
18:36:50.217 > [322.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:50.324 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":322119,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:50.360 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:50.366 > [WebSocket] ========================================
18:36:50.371 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:50.377 > [WebSocket] ========================================
18:36:50.382 > [ZTM] Settings saved successfully
18:36:50.385 > [WebSocket] ✓ ZTM activated successfully
18:36:50.388 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:50.392 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:50.396 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:50.399 > [WebSocket] ========================================
18:36:50.404 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":322470,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:50.443 > [322.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:50.550 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":322154,"type":"ztm_activated"}
18:36:50.567 > [WebSocket] Processing message type: ztm_activated
18:36:50.569 > [322.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:50.673 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124010254,"threatLevel":0,"type":"heuristics_update"}
18:36:50.698 > [WebSocket] Processing message type: heuristics_update
18:36:50.705 > [322.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:50.807 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":322470,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:50.842 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:50.848 > [WebSocket] ========================================
18:36:50.854 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:50.859 > [WebSocket] ========================================
18:36:50.865 > [ZTM] Settings saved successfully
18:36:50.867 > [WebSocket] ✓ ZTM activated successfully
18:36:50.871 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:50.876 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:50.879 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:50.882 > [WebSocket] ========================================
18:36:50.888 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":322953,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:50.926 > [323.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:51.032 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":322506,"type":"ztm_activated"}
18:36:51.048 > [WebSocket] Processing message type: ztm_activated
18:36:51.052 > [323.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:51.155 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":322953,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:51.192 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:51.198 > [WebSocket] ========================================
18:36:51.203 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:51.209 > [WebSocket] ========================================
18:36:51.214 > [ZTM] Settings saved successfully
18:36:51.217 > [WebSocket] ✓ ZTM activated successfully
18:36:51.219 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:51.225 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:51.228 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:51.231 > [WebSocket] ========================================
18:36:51.236 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":323302,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:51.275 > [323.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:51.381 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":322988,"type":"ztm_activated"}
18:36:51.398 > [WebSocket] Processing message type: ztm_activated
18:36:51.400 > [323.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:51.507 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":323302,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:51.543 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:51.549 > [WebSocket] ========================================
18:36:51.554 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:51.559 > [WebSocket] ========================================
18:36:51.565 > [ZTM] Settings saved successfully
18:36:51.568 > [WebSocket] ✓ ZTM activated successfully
18:36:51.570 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:51.577 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:51.579 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:51.582 > [WebSocket] ========================================
18:36:51.588 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":323653,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:51.626 > [323.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:51.734 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124011267,"threatLevel":0,"type":"heuristics_update"}
18:36:51.758 > [WebSocket] Processing message type: heuristics_update
18:36:51.764 > [323.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:51.867 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":323337,"type":"ztm_activated"}
18:36:51.883 > [WebSocket] Processing message type: ztm_activated
18:36:51.885 > [323.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:51.989 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":323653,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:52.025 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:52.030 > [WebSocket] ========================================
18:36:52.036 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:52.041 > [WebSocket] ========================================
18:36:52.047 > [ZTM] Settings saved successfully
18:36:52.049 > [WebSocket] ✓ ZTM activated successfully
18:36:52.053 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:52.058 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:52.060 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:52.064 > [WebSocket] ========================================
18:36:52.069 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":324135,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:52.108 > [324.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:52.214 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":323689,"type":"ztm_activated"}
18:36:52.231 > [WebSocket] Processing message type: ztm_activated
18:36:52.233 > [324.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:52.338 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":324135,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:52.374 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:52.380 > [WebSocket] ========================================
18:36:52.385 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:52.391 > [WebSocket] ========================================
18:36:52.396 > [ZTM] Settings saved successfully
18:36:52.398 > [WebSocket] ✓ ZTM activated successfully
18:36:52.402 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:52.407 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:52.410 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:52.413 > [WebSocket] ========================================
18:36:52.417 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":324484,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:52.457 > [324.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:52.566 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":324170,"type":"ztm_activated"}
18:36:52.582 > [WebSocket] Processing message type: ztm_activated
18:36:52.584 > [324.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:52.688 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124012279,"threatLevel":0,"type":"heuristics_update"}
18:36:52.713 > [WebSocket] Processing message type: heuristics_update
18:36:52.719 > [324.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:52.824 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":324484,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:52.859 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:52.864 > [WebSocket] ========================================
18:36:52.870 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:52.877 > [WebSocket] ========================================
18:36:52.882 > [ZTM] Settings saved successfully
18:36:52.884 > [WebSocket] ✓ ZTM activated successfully
18:36:52.888 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:52.893 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:52.895 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:52.898 > [WebSocket] ========================================
18:36:52.904 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":324970,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:52.948 > [325.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:53.047 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":324519,"type":"ztm_activated"}
18:36:53.065 > [WebSocket] Processing message type: ztm_activated
18:36:53.068 > [325.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:53.172 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":324970,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:53.208 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:53.213 > [WebSocket] ========================================
18:36:53.219 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:53.225 > [WebSocket] ========================================
18:36:53.230 > [ZTM] Settings saved successfully
18:36:53.233 > [WebSocket] ✓ ZTM activated successfully
18:36:53.235 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:53.241 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:53.244 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:53.247 > [WebSocket] ========================================
18:36:53.252 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":325318,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:53.291 > [325.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:53.397 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":325015,"type":"ztm_activated"}
18:36:53.414 > [WebSocket] Processing message type: ztm_activated
18:36:53.417 > [325.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:53.521 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":325318,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:53.557 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:53.563 > [WebSocket] ========================================
18:36:53.567 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:53.573 > [WebSocket] ========================================
18:36:53.579 > [ZTM] Settings saved successfully
18:36:53.581 > [WebSocket] ✓ ZTM activated successfully
18:36:53.584 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:53.590 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:53.593 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:53.596 > [WebSocket] ========================================
18:36:53.601 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":325667,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:53.640 > [325.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:53.747 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":325353,"type":"ztm_activated"}
18:36:53.764 > [WebSocket] Processing message type: ztm_activated
18:36:53.767 > [325.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:53.871 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124013295,"threatLevel":0,"type":"heuristics_update"}
18:36:53.895 > [WebSocket] Processing message type: heuristics_update
18:36:53.900 > [326.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:54.006 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":325667,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:54.042 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:54.048 > [WebSocket] ========================================
18:36:54.053 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:54.058 > [WebSocket] ========================================
18:36:54.064 > [ZTM] Settings saved successfully
18:36:54.067 > [WebSocket] ✓ ZTM activated successfully
18:36:54.069 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:54.075 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:54.077 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:54.081 > [WebSocket] ========================================
18:36:54.086 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":326152,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:54.126 > [326.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 9 | WS: CONNECTED
18:36:54.134 > [RETRY] Attempting to send health data (Max retries: 3)
18:36:54.136 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:36:54.142 > Generated health data: HR-65 SPO2-96 STEPS-1658
18:36:54.148 > [ESP32] ========================================
18:36:54.150 > [ESP32] ENCRYPTION PIPELINE START
18:36:54.153 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:36:54.158 > [ESP32] Active Algorithms for this packet:
18:36:54.164 > [ESP32]   + LFSR
18:36:54.164 > [ESP32]   + Tinkerbell
18:36:54.167 > [ESP32]   + Transposition
18:36:54.169 > [ESP32]   - ChaCha20
18:36:54.169 > [ESP32]   - Salsa20
18:36:54.172 > [ESP32] ========================================
18:36:54.175 > [ESP32] MsgKeys: lfsrSeed=0x40DD8333 tnk[0..3]=657133F0 trn[0..3]=1269D00E
18:36:54.184 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313635384D50
18:36:54.189 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313635384D50000000000000 
18:36:54.197 > [ESP32][LFSR] Initializing - Seed: 0x40DD8333 SeedBe: 0x3383DD40 ChaosKey[0..3]: 657133F0 InitialTap: 0x0029 State: 0x40DD8333
18:36:54.208 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:36:54.217 > 3_After_LFSR (32): 7BD1F0763A4009046E22A4941DFF1400 D06CD466C2C2509EA60E34AE38FB7C94 
18:36:54.225 > [ESP32][LFSR] Keystream (first 16 bytes): 3383DD400F605A54211089AD2BDF4754
18:36:54.230 > [ESP32][4D] LFSR keystream (first 32 bytes): 3383DD400F605A54211089AD2BDF4754953C874BF3F465A6EB5E34AE38FB7C94
18:36:54.239 > [ESP32][TINKERBELL] Input (first 16 bytes): 7BD1F0763A4009046E22A4941DFF1400 Nonce: 0x00000001 Buffer size: 32 bytes
18:36:54.250 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 657133F0
18:36:54.261 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): CE35156F7D4EC60D61C2968D5AD490F2
18:36:54.269 > 4_After_Tinkerbell (32): B5E4E519470ECF090FE03219472B84F2 2CDE40A6799A9E022BBDCD328C2A4309 
18:36:54.275 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): CE35156F7D4EC60D61C2968D5AD490F2
18:36:54.283 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): CE35156F7D4EC60D61C2968D5AD490F2FCB294C0BB58CE9C8DB3F99CB4D13F9D
18:36:54.295 > 5_After_Transposition (32): B5E4E5199E029A792CDE40A684F20E47 0FE03219CF092B478C2A2BBDCD320943 
18:36:54.303 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:36:54.309 > [ESP32] === HMAC DEBUG INFO ===
18:36:54.311 > [ESP32] HMAC Key being used: 61898C000C113108D39ECEB4ED4B23B971AD22F4054BB82DB3207670B191DB81
18:36:54.319 > [ESP32] HMAC Input length: 45 bytes
18:36:54.322 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001B5E4E5199E029A792CDE40A684F20E470FE032
18:36:54.331 > [ESP32] Nonce: 0x00000001
18:36:54.334 > [ESP32] Packet size before HMAC: 61
18:36:54.336 > [ESP32] Computed HMAC Tag: 08648A726B2ED3DDCD6C1F4C38919737
18:36:54.342 > [ESP32] === END HMAC DEBUG ===
18:36:54.344 > 6_Final_Packet (61): 82021800180004080400000001B5E4E5 199E029A792CDE40A684F20E470FE032 ...
18:36:54.353 > [RETRY] Attempt 1/3 (nonce: 1)
18:36:54.356 > POST http://10.249.92.115:8081/health-data with pipeline data
18:36:54.358 > Sending pipeline data to server (659 bytes)
18:36:54.694 > [HTTP] Response code: 200
18:36:54.694 > [HTTP] Response: {"status":"OK:DECRYPTED"}
18:36:54.706 > [RETRY] Health data sent successfully!
18:36:54.709 > ✓ Health data #10 sent successfully
18:36:54.808 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":325702,"type":"ztm_activated"}
18:36:54.825 > [WebSocket] Processing message type: ztm_activated
18:36:54.828 > [326.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:54.932 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":326152,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:54.967 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:54.973 > [WebSocket] ========================================
18:36:54.979 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:54.984 > [WebSocket] ========================================
18:36:54.990 > [ZTM] Settings saved successfully
18:36:54.992 > [WebSocket] ✓ ZTM activated successfully
18:36:54.995 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:55.000 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:55.004 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:55.006 > [WebSocket] ========================================
18:36:55.012 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":327078,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:55.051 > [327.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:55.157 > [WebSocket] Received (161 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":326187,"type":"ztm_activated"}
18:36:55.173 > [WebSocket] Processing message type: ztm_activated
18:36:55.177 > [327.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:55.280 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124014307,"threatLevel":0,"type":"heuristics_update"}
18:36:55.305 > [WebSocket] Processing message type: heuristics_update
18:36:55.311 > [327.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:55.414 > [WebSocket] Received (183 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":13,"serverTime":1770124014461,"type":"security_update"}
18:36:55.430 > [WebSocket] Processing message type: security_update
18:36:55.435 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
18:36:55.441 > [327.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:55.547 > [WebSocket] Received (686 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","encData":"ENC_DATA:82021800180004080400000001B5E4E5199E029A792CDE40A684F20E470FE03219CF092B478C2A2BBDCD32094308648A726B2ED3DDCD6C1F4C38919737","pipeline":{"afterLFSR":"7BD1F0763A4009046E22A4941DFF1400D06CD466C2C2509EA60E34AE38FB7C94","afterSalt":"48522D36352053504F322D39362053544550532D313635384D50","afterTinkerbell":"B5E4E519470ECF090FE03219472B84F22CDE40A6799A9E022BBDCD328C2A4309","afterTransposition":"B5E4E5199E029A792CDE40A684F20E470FE03219CF092B478C2A2BBDCD320943"},"plaintext":"HR-65 SPO2-96 STEPS-1658","serverTime":1770124014461,"timestamp":326429,"type":"encryption_update","ztmEnabled":true}
18:36:55.608 > [WebSocket] Processing message type: encryption_update
18:36:55.613 > [327.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:55.720 > [WebSocket] Received (88 bytes): {"heartRate":65,"spo2":96,"steps":1658,"time":1770124014461,"type":"health_data_update"}
18:36:55.727 > [WebSocket] Processing message type: health_data_update
18:36:55.734 > [327.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:55.842 > [WebSocket] Received (226 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3259,"encryptionTime":0.0,"finalPlaintext":"HR-65 SPO2-96 STEPS-1658","handshakeSuccess":true,"totalTime":0.3259},"type":"session_summary_update"}
18:36:55.864 > [WebSocket] Processing message type: session_summary_update
18:36:55.870 > [327.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:55.974 > [WebSocket] Received (660 bytes): {"decryptionTime":0.3259,"encryptedPacket":"82021800180004080400000001B5E4E5199E029A792CDE40A684F20E470FE03219CF092B478C2A2BBDCD32094308648A726B2ED3DDCD6C1F4C38919737","finalPlaintext":"HR-65 SPO2-96 STEPS-1658","healthData":{"heartRate":65,"spo2":96,"steps":1658},"pipeline":{"afterDepad":"48522D36352053504F322D39362053544550532D313635384118A7970000","afterLFSR":"48522D36352053504F322D39362053544550532D31363538ABDF4118A7970000","afterTinkerbell":"7BD1F0763A4009046E22A4941DFF1400D06CD466C2C2509E408175B69F6C7C94","afterTransposition":"B5E4E519470ECF090FE03219472B84F22CDE40A6799A9E02CD328C2A2BBD4309"},"serverTime":1770124014462,"type":"decryption_update"}
18:36:56.033 > [WebSocket] Processing message type: decryption_update
18:36:56.039 > [WebSocket] Server decryption completed
18:36:56.042 > [WebSocket] Health data - HR: 65, SPO2: 96, Steps: 1658
18:36:56.047 > [328.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:56.152 > [WebSocket] Received (698 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","healthSendCount":9,"pipeline":{"afterLFSR":"7BD1F0763A4009046E22A4941DFF1400D06CD466C2C2509EA60E34AE38FB7C94","afterSalt":"48522D36352053504F322D39362053544550532D313635384D50","afterTinkerbell":"B5E4E519470ECF090FE03219472B84F22CDE40A6799A9E022BBDCD328C2A4309","afterTransposition":"B5E4E5199E029A792CDE40A684F20E470FE03219CF092B478C2A2BBDCD320943","finalPacket":"82021800180004080400000001B5E4E5199E029A792CDE40A684F20E470FE03219CF092B478C2A2BBDCD32094308648A726B2ED3DDCD6C1F4C38919737"},"plaintext":"HR-65 SPO2-96 STEPS-1658","timestamp":326767,"type":"encryption_pipeline","ztmEnabled":true}
18:36:56.213 > [WebSocket] Processing message type: encryption_pipeline
18:36:56.219 > [328.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:56.326 > [WebSocket] Received (159 bytes): {"deviceId":"f9641d44","healthSendCount":9,"message":"Health data #10 sent successfully","state":7,"success":true,"timestamp":326772,"type":"health_data_sent"}
18:36:56.343 > [WebSocket] Processing message type: health_data_sent
18:36:56.346 > [328.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:56.448 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":327078,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:56.517 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:56.517 > [WebSocket] ========================================
18:36:56.517 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:56.517 > [WebSocket] ========================================
18:36:56.517 > [ZTM] Settings saved successfully
18:36:56.517 > [WebSocket] ✓ ZTM activated successfully
18:36:56.517 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:56.518 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:56.522 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:56.534 > [WebSocket] ========================================
18:36:56.534 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":328594,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:56.568 > [328.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:56.673 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":327114,"type":"ztm_activated"}
18:36:56.689 > [WebSocket] Processing message type: ztm_activated
18:36:56.692 > [328.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:56.796 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124015322,"threatLevel":0,"type":"heuristics_update"}
18:36:56.822 > [WebSocket] Processing message type: heuristics_update
18:36:56.827 > [328.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:56.929 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124016335,"threatLevel":0,"type":"heuristics_update"}
18:36:56.954 > [WebSocket] Processing message type: heuristics_update
18:36:56.959 > [329.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:57.062 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":328594,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:57.098 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:57.104 > [WebSocket] ========================================
18:36:57.109 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:57.114 > [WebSocket] ========================================
18:36:57.121 > [ZTM] Settings saved successfully
18:36:57.123 > [WebSocket] ✓ ZTM activated successfully
18:36:57.125 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:57.131 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:57.133 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:57.137 > [WebSocket] ========================================
18:36:57.142 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":329208,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:57.181 > [329.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:57.288 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":328630,"type":"ztm_activated"}
18:36:57.304 > [WebSocket] Processing message type: ztm_activated
18:36:57.307 > [329.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:57.413 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":329208,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:57.450 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:57.455 > [WebSocket] ========================================
18:36:57.461 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:57.466 > [WebSocket] ========================================
18:36:57.472 > [ZTM] Settings saved successfully
18:36:57.474 > [WebSocket] ✓ ZTM activated successfully
18:36:57.478 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:57.482 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:57.486 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:57.489 > [WebSocket] ========================================
18:36:57.494 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":329560,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:57.533 > [329.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:57.639 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":329244,"type":"ztm_activated"}
18:36:57.655 > [WebSocket] Processing message type: ztm_activated
18:36:57.659 > [329.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:57.762 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124017350,"threatLevel":0,"type":"heuristics_update"}
18:36:57.786 > [WebSocket] Processing message type: heuristics_update
18:36:57.793 > [329.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:57.896 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":329560,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:57.932 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:57.938 > [WebSocket] ========================================
18:36:57.943 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:57.948 > [WebSocket] ========================================
18:36:57.954 > [ZTM] Settings saved successfully
18:36:57.957 > [WebSocket] ✓ ZTM activated successfully
18:36:57.959 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:57.964 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:57.967 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:57.970 > [WebSocket] ========================================
18:36:57.975 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":330042,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:58.015 > [330.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:58.121 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":329595,"type":"ztm_activated"}
18:36:58.138 > [WebSocket] Processing message type: ztm_activated
18:36:58.141 > [330.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:58.244 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":330042,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:58.280 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:58.286 > [WebSocket] ========================================
18:36:58.292 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:58.297 > [WebSocket] ========================================
18:36:58.303 > [ZTM] Settings saved successfully
18:36:58.305 > [WebSocket] ✓ ZTM activated successfully
18:36:58.308 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:58.313 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:58.317 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:58.319 > [WebSocket] ========================================
18:36:58.325 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":330391,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:58.364 > [330.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:58.470 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":330077,"type":"ztm_activated"}
18:36:58.486 > [WebSocket] Processing message type: ztm_activated
18:36:58.489 > [330.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:58.595 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":330391,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:58.632 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:58.638 > [WebSocket] ========================================
18:36:58.643 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:58.649 > [WebSocket] ========================================
18:36:58.654 > [ZTM] Settings saved successfully
18:36:58.657 > [WebSocket] ✓ ZTM activated successfully
18:36:58.659 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:58.665 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:58.667 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:58.671 > [WebSocket] ========================================
18:36:58.676 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":330742,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:58.715 > [330.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:58.821 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":330426,"type":"ztm_activated"}
18:36:58.838 > [WebSocket] Processing message type: ztm_activated
18:36:58.840 > [330.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:58.944 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124018365,"threatLevel":0,"type":"heuristics_update"}
18:36:58.968 > [WebSocket] Processing message type: heuristics_update
18:36:58.974 > [331.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:59.078 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":330742,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:59.114 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:59.119 > [WebSocket] ========================================
18:36:59.125 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:59.130 > [WebSocket] ========================================
18:36:59.136 > [ZTM] Settings saved successfully
18:36:59.139 > [WebSocket] ✓ ZTM activated successfully
18:36:59.142 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:59.146 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:59.150 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:59.153 > [WebSocket] ========================================
18:36:59.157 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":331224,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:59.197 > [331.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:59.304 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":330777,"type":"ztm_activated"}
18:36:59.321 > [WebSocket] Processing message type: ztm_activated
18:36:59.323 > [331.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:59.427 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":331224,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:59.464 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:59.469 > [WebSocket] ========================================
18:36:59.474 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:59.481 > [WebSocket] ========================================
18:36:59.485 > [ZTM] Settings saved successfully
18:36:59.489 > [WebSocket] ✓ ZTM activated successfully
18:36:59.491 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:59.497 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:59.500 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:59.503 > [WebSocket] ========================================
18:36:59.508 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":331574,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:36:59.550 > [331.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:59.652 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":331259,"type":"ztm_activated"}
18:36:59.669 > [WebSocket] Processing message type: ztm_activated
18:36:59.672 > [331.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:59.774 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124019377,"threatLevel":0,"type":"heuristics_update"}
18:36:59.800 > [WebSocket] Processing message type: heuristics_update
18:36:59.806 > [331.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:36:59.910 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":331574,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:36:59.947 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:36:59.952 > [WebSocket] ========================================
18:36:59.958 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:36:59.964 > [WebSocket] ========================================
18:36:59.969 > [ZTM] Settings saved successfully
18:36:59.972 > [WebSocket] ✓ ZTM activated successfully
18:36:59.975 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:36:59.980 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:36:59.983 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:36:59.986 > [WebSocket] ========================================
18:36:59.991 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":332057,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:00.030 > [332.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:00.138 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":331619,"type":"ztm_activated"}
18:37:00.155 > [WebSocket] Processing message type: ztm_activated
18:37:00.157 > [332.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:00.261 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":332057,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:00.297 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:00.303 > [WebSocket] ========================================
18:37:00.309 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:00.314 > [WebSocket] ========================================
18:37:00.320 > [ZTM] Settings saved successfully
18:37:00.323 > [WebSocket] ✓ ZTM activated successfully
18:37:00.325 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:00.331 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:00.334 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:00.336 > [WebSocket] ========================================
18:37:00.342 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":332408,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:00.380 > [332.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:00.486 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":332094,"type":"ztm_activated"}
18:37:00.503 > [WebSocket] Processing message type: ztm_activated
18:37:00.507 > [332.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:00.611 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":332408,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:00.647 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:00.652 > [WebSocket] ========================================
18:37:00.658 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:00.663 > [WebSocket] ========================================
18:37:00.669 > [ZTM] Settings saved successfully
18:37:00.671 > [WebSocket] ✓ ZTM activated successfully
18:37:00.675 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:00.680 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:00.683 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:00.685 > [WebSocket] ========================================
18:37:00.691 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":332757,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:00.729 > [332.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:00.836 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":332443,"type":"ztm_activated"}
18:37:00.854 > [WebSocket] Processing message type: ztm_activated
18:37:00.857 > [332.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:00.959 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124020377,"threatLevel":0,"type":"heuristics_update"}
18:37:00.984 > [WebSocket] Processing message type: heuristics_update
18:37:00.991 > [333.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:01.095 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":332757,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:01.132 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:01.136 > [WebSocket] ========================================
18:37:01.143 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:01.148 > [WebSocket] ========================================
18:37:01.154 > [ZTM] Settings saved successfully
18:37:01.157 > [WebSocket] ✓ ZTM activated successfully
18:37:01.159 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:01.165 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:01.167 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:01.171 > [WebSocket] ========================================
18:37:01.176 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":333242,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:01.214 > [333.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:01.321 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":332792,"type":"ztm_activated"}
18:37:01.336 > [WebSocket] Processing message type: ztm_activated
18:37:01.340 > [333.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:01.445 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":333242,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:01.480 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:01.486 > [WebSocket] ========================================
18:37:01.492 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:01.497 > [WebSocket] ========================================
18:37:01.503 > [ZTM] Settings saved successfully
18:37:01.505 > [WebSocket] ✓ ZTM activated successfully
18:37:01.508 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:01.514 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:01.516 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:01.519 > [WebSocket] ========================================
18:37:01.525 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":333591,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:01.569 > [333.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:01.670 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":333277,"type":"ztm_activated"}
18:37:01.686 > [WebSocket] Processing message type: ztm_activated
18:37:01.690 > [333.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:01.793 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124021385,"threatLevel":0,"type":"heuristics_update"}
18:37:01.817 > [WebSocket] Processing message type: heuristics_update
18:37:01.823 > [333.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:01.927 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":333591,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:01.963 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:01.968 > [WebSocket] ========================================
18:37:01.973 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:01.979 > [WebSocket] ========================================
18:37:01.984 > [ZTM] Settings saved successfully
18:37:01.986 > [WebSocket] ✓ ZTM activated successfully
18:37:01.990 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:01.996 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:01.998 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:02.002 > [WebSocket] ========================================
18:37:02.007 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":334073,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:02.046 > [334.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:02.152 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":333636,"type":"ztm_activated"}
18:37:02.169 > [WebSocket] Processing message type: ztm_activated
18:37:02.172 > [334.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:02.278 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":334073,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:02.314 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:02.320 > [WebSocket] ========================================
18:37:02.325 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:02.330 > [WebSocket] ========================================
18:37:02.336 > [ZTM] Settings saved successfully
18:37:02.339 > [WebSocket] ✓ ZTM activated successfully
18:37:02.342 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:02.347 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:02.350 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:02.352 > [WebSocket] ========================================
18:37:02.358 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":334424,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:02.398 > [334.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:02.503 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":334108,"type":"ztm_activated"}
18:37:02.519 > [WebSocket] Processing message type: ztm_activated
18:37:02.522 > [334.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:02.627 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":334424,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:02.663 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:02.668 > [WebSocket] ========================================
18:37:02.673 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:02.680 > [WebSocket] ========================================
18:37:02.685 > [ZTM] Settings saved successfully
18:37:02.687 > [WebSocket] ✓ ZTM activated successfully
18:37:02.690 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:02.696 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:02.698 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:02.702 > [WebSocket] ========================================
18:37:02.707 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":334773,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:02.745 > [334.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:02.852 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":334460,"type":"ztm_activated"}
18:37:02.869 > [WebSocket] Processing message type: ztm_activated
18:37:02.872 > [334.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:02.975 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124022398,"threatLevel":0,"type":"heuristics_update"}
18:37:03.000 > [WebSocket] Processing message type: heuristics_update
18:37:03.005 > [335.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:03.109 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":334773,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:03.144 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:03.150 > [WebSocket] ========================================
18:37:03.156 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:03.161 > [WebSocket] ========================================
18:37:03.167 > [ZTM] Settings saved successfully
18:37:03.169 > [WebSocket] ✓ ZTM activated successfully
18:37:03.172 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:03.177 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:03.181 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:03.184 > [WebSocket] ========================================
18:37:03.189 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":335255,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:03.228 > [335.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:03.334 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":334808,"type":"ztm_activated"}
18:37:03.351 > [WebSocket] Processing message type: ztm_activated
18:37:03.352 > [335.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:03.459 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":335255,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:03.496 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:03.502 > [WebSocket] ========================================
18:37:03.507 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:03.513 > [WebSocket] ========================================
18:37:03.518 > [ZTM] Settings saved successfully
18:37:03.521 > [WebSocket] ✓ ZTM activated successfully
18:37:03.524 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:03.529 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:03.532 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:03.534 > [WebSocket] ========================================
18:37:03.540 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":335606,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:03.579 > [335.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:03.686 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":335290,"type":"ztm_activated"}
18:37:03.704 > [WebSocket] Processing message type: ztm_activated
18:37:03.707 > [335.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:03.810 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124023412,"threatLevel":0,"type":"heuristics_update"}
18:37:03.834 > [WebSocket] Processing message type: heuristics_update
18:37:03.841 > [335.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:03.943 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":335606,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:03.980 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:03.986 > [WebSocket] ========================================
18:37:03.991 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:03.996 > [WebSocket] ========================================
18:37:04.002 > [ZTM] Settings saved successfully
18:37:04.005 > [WebSocket] ✓ ZTM activated successfully
18:37:04.008 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:04.013 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:04.016 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:04.018 > [WebSocket] ========================================
18:37:04.023 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":336090,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:04.062 > [336.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:04.169 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":335642,"type":"ztm_activated"}
18:37:04.185 > [WebSocket] Processing message type: ztm_activated
18:37:04.188 > [336.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:04.293 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":336090,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:04.328 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:04.334 > [WebSocket] ========================================
18:37:04.340 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:04.345 > [WebSocket] ========================================
18:37:04.350 > [ZTM] Settings saved successfully
18:37:04.353 > [WebSocket] ✓ ZTM activated successfully
18:37:04.357 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:04.362 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:04.364 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:04.367 > [WebSocket] ========================================
18:37:04.373 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":336439,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:04.412 > [336.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:04.519 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":336125,"type":"ztm_activated"}
18:37:04.536 > [WebSocket] Processing message type: ztm_activated
18:37:04.538 > [336.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:04.645 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":336439,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:04.681 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:04.686 > [WebSocket] ========================================
18:37:04.692 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:04.697 > [WebSocket] ========================================
18:37:04.703 > [ZTM] Settings saved successfully
18:37:04.705 > [WebSocket] ✓ ZTM activated successfully
18:37:04.708 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:04.713 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:04.716 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:04.720 > [WebSocket] ========================================
18:37:04.724 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":336791,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:04.763 > [336.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:04.772 > [RETRY] Attempting to send health data (Max retries: 3)
18:37:04.777 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:37:04.781 > Generated health data: HR-65 SPO2-96 STEPS-1698
18:37:04.786 > [ESP32] ========================================
18:37:04.789 > [ESP32] ENCRYPTION PIPELINE START
18:37:04.792 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:37:04.797 > [ESP32] Active Algorithms for this packet:
18:37:04.803 > [ESP32]   + LFSR
18:37:04.803 > [ESP32]   + Tinkerbell
18:37:04.805 > [ESP32]   + Transposition
18:37:04.808 > [ESP32]   - ChaCha20
18:37:04.808 > [ESP32]   - Salsa20
18:37:04.811 > [ESP32] ========================================
18:37:04.817 > [ESP32] MsgKeys: lfsrSeed=0x9EF9E091 tnk[0..3]=0978BA12 trn[0..3]=4D0BED53
18:37:04.822 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313639384D50
18:37:04.828 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313639384D50000000000000 
18:37:04.836 > [ESP32][LFSR] Initializing - Seed: 0x9EF9E091 SeedBe: 0x91E0F99E ChaosKey[0..3]: 0978BA12 InitialTap: 0x0029 State: 0x9EF9E091
18:37:04.847 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:37:04.856 > 3_After_LFSR (32): D9B2D4A8E53E11A885B1A6496A3E5976 428644820FDDA433471BD60D8D03EF22 
18:37:04.864 > [ESP32][LFSR] Keystream (first 16 bytes): 91E0F99ED01E42F8CA838B705C1E0A22
18:37:04.870 > [ESP32][4D] LFSR keystream (first 32 bytes): 91E0F99ED01E42F8CA838B705C1E0A2207D617AF3EEB9D0B0A4BD60D8D03EF22
18:37:04.878 > [ESP32][TINKERBELL] Input (first 16 bytes): D9B2D4A8E53E11A885B1A6496A3E5976 Nonce: 0x00000002 Buffer size: 32 bytes
18:37:04.889 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 0978BA12
18:37:04.900 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 8257DDDADCA8BD0A07779D4E3B2CF8D7
18:37:04.908 > 4_After_Tinkerbell (32): 5BE509723996ACA282C63B075112A1A1 81ADF0701B7A3415F39802D9C6C2A95F 
18:37:04.914 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 8257DDDADCA8BD0A07779D4E3B2CF8D7
18:37:04.922 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 8257DDDADCA8BD0A07779D4E3B2CF8D7C32BB4F214A79026B483D4D44BC1467D
18:37:04.933 > 5_After_Transposition (32): 81F0AD70A2AC9639F30298D9A1A11251 C6C2A95F5BE509721B7A341582C63B07 
18:37:04.942 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
18:37:04.947 > [ESP32] === HMAC DEBUG INFO ===
18:37:04.951 > [ESP32] HMAC Key being used: 61898C000C113108D39ECEB4ED4B23B971AD22F4054BB82DB3207670B191DB81
18:37:04.959 > [ESP32] HMAC Input length: 45 bytes
18:37:04.961 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000281F0AD70A2AC9639F30298D9A1A11251C6C2A9
18:37:04.970 > [ESP32] Nonce: 0x00000002
18:37:04.972 > [ESP32] Packet size before HMAC: 61
18:37:04.975 > [ESP32] Computed HMAC Tag: 6300CE7AD8A5B6C736A468518E789604
18:37:04.980 > [ESP32] === END HMAC DEBUG ===
18:37:04.983 > 6_Final_Packet (61): 8202180018000408040000000281F0AD 70A2AC9639F30298D9A1A11251C6C2A9 ...
18:37:04.991 > [RETRY] Attempt 1/3 (nonce: 2)
18:37:04.994 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:05.000 > Sending pipeline data to server (659 bytes)
18:37:05.279 > [HTTP] Response code: 400
18:37:05.279 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:05.284 > [HTTP] Request failed with code: 400
18:37:05.287 > [RETRY] Send failed, waiting 100 ms before retry
18:37:05.387 > [RETRY] Attempt 2/3 (nonce: 2)
18:37:05.387 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:05.393 > Sending pipeline data to server (659 bytes)
18:37:05.531 > [HTTP] Response code: 400
18:37:05.531 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:05.536 > [HTTP] Request failed with code: 400
18:37:05.539 > [RETRY] Send failed, waiting 200 ms before retry
18:37:05.739 > [RETRY] Attempt 3/3 (nonce: 2)
18:37:05.748 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:05.748 > Sending pipeline data to server (659 bytes)
18:37:06.040 > [HTTP] Response code: 400
18:37:06.040 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:06.045 > [HTTP] Request failed with code: 400
18:37:06.048 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:37:06.053 > [RETRY] Consecutive failures: 1
18:37:06.056 > Health data send failed (retry count: 1/3)
18:37:06.158 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124024422,"threatLevel":0,"type":"heuristics_update"}
18:37:06.184 > [WebSocket] Processing message type: heuristics_update
18:37:06.190 > [338.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:06.197 > [RETRY] Attempting to send health data (Max retries: 3)
18:37:06.201 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:37:06.205 > Generated health data: HR-65 SPO2-96 STEPS-1699
18:37:06.212 > [ESP32] ========================================
18:37:06.215 > [ESP32] ENCRYPTION PIPELINE START
18:37:06.216 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:37:06.222 > [ESP32] Active Algorithms for this packet:
18:37:06.226 > [ESP32]   + LFSR
18:37:06.228 > [ESP32]   + Tinkerbell
18:37:06.231 > [ESP32]   + Transposition
18:37:06.231 > [ESP32]   - ChaCha20
18:37:06.233 > [ESP32]   - Salsa20
18:37:06.237 > [ESP32] ========================================
18:37:06.239 > [ESP32] MsgKeys: lfsrSeed=0x9EF9E091 tnk[0..3]=0978BA12 trn[0..3]=4D0BED53
18:37:06.248 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313639394D50
18:37:06.253 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313639394D50000000000000 
18:37:06.262 > [ESP32][LFSR] Initializing - Seed: 0x9EF9E091 SeedBe: 0x91E0F99E ChaosKey[0..3]: 0978BA12 InitialTap: 0x0029 State: 0x9EF9E091
18:37:06.273 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:37:06.281 > 3_After_LFSR (32): D9B2D4A8E53E11A885B1A6496A3E5976 428644820FDDA432471BD60D8D03EF22 
18:37:06.286 > [ESP32][LFSR] Keystream (first 16 bytes): 91E0F99ED01E42F8CA838B705C1E0A22
18:37:06.295 > [ESP32][4D] LFSR keystream (first 32 bytes): 91E0F99ED01E42F8CA838B705C1E0A2207D617AF3EEB9D0B0A4BD60D8D03EF22
18:37:06.303 > [ESP32][TINKERBELL] Input (first 16 bytes): D9B2D4A8E53E11A885B1A6496A3E5976 Nonce: 0x00000002 Buffer size: 32 bytes
18:37:06.315 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 0978BA12
18:37:06.322 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 8257DDDADCA8BD0A07779D4E3B2CF8D7
18:37:06.331 > 4_After_Tinkerbell (32): 5BE509723996ACA282C63B075112A1A1 81ADF0701B7A3414F39802D9C6C2A95F 
18:37:06.339 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 8257DDDADCA8BD0A07779D4E3B2CF8D7
18:37:06.348 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 8257DDDADCA8BD0A07779D4E3B2CF8D7C32BB4F214A79026B483D4D44BC1467D
18:37:06.359 > 5_After_Transposition (32): 81F0AD70A2AC9639F30298D9A1A11251 C6C2A95F5BE509721B7A341482C63B07 
18:37:06.367 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
18:37:06.370 > [ESP32] === HMAC DEBUG INFO ===
18:37:06.373 > [ESP32] HMAC Key being used: 61898C000C113108D39ECEB4ED4B23B971AD22F4054BB82DB3207670B191DB81
18:37:06.380 > [ESP32] HMAC Input length: 45 bytes
18:37:06.383 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000281F0AD70A2AC9639F30298D9A1A11251C6C2A9
18:37:06.395 > [ESP32] Nonce: 0x00000002
18:37:06.395 > [ESP32] Packet size before HMAC: 61
18:37:06.401 > [ESP32] Computed HMAC Tag: CDB0FCD10096C29B8CFB5EEC9D222087
18:37:06.406 > [ESP32] === END HMAC DEBUG ===
18:37:06.406 > 6_Final_Packet (61): 8202180018000408040000000281F0AD 70A2AC9639F30298D9A1A11251C6C2A9 ...
18:37:06.414 > [RETRY] Attempt 1/3 (nonce: 2)
18:37:06.417 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:06.423 > Sending pipeline data to server (659 bytes)
18:37:06.804 > [HTTP] Response code: 400
18:37:06.804 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:06.807 > [HTTP] Request failed with code: 400
18:37:06.810 > [RETRY] Send failed, waiting 100 ms before retry
18:37:06.910 > [RETRY] Attempt 2/3 (nonce: 2)
18:37:06.910 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:06.916 > Sending pipeline data to server (659 bytes)
18:37:07.045 > [HTTP] Response code: 400
18:37:07.045 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:07.051 > [HTTP] Request failed with code: 400
18:37:07.053 > [RETRY] Send failed, waiting 200 ms before retry
18:37:07.256 > [RETRY] Attempt 3/3 (nonce: 2)
18:37:07.256 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:07.261 > Sending pipeline data to server (659 bytes)
18:37:07.548 > [HTTP] Response code: 400
18:37:07.550 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:07.555 > [HTTP] Request failed with code: 400
18:37:07.557 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:37:07.563 > [RETRY] Consecutive failures: 2
18:37:07.565 > Health data send failed (retry count: 2/3)
18:37:07.669 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":336474,"type":"ztm_activated"}
18:37:07.685 > [WebSocket] Processing message type: ztm_activated
18:37:07.688 > [339.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:07.697 > [RETRY] Attempting to send health data (Max retries: 3)
18:37:07.702 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:37:07.715 > Generated health data: HR-65 SPO2-96 STEPS-1728
18:37:07.715 > [ESP32] ========================================
18:37:07.718 > [ESP32] ENCRYPTION PIPELINE START
18:37:07.720 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:37:07.725 > [ESP32] Active Algorithms for this packet:
18:37:07.727 > [ESP32]   + LFSR
18:37:07.729 > [ESP32]   + Tinkerbell
18:37:07.729 > [ESP32]   + Transposition
18:37:07.732 > [ESP32]   - ChaCha20
18:37:07.735 > [ESP32]   - Salsa20
18:37:07.735 > [ESP32] ========================================
18:37:07.740 > [ESP32] MsgKeys: lfsrSeed=0x9EF9E091 tnk[0..3]=0978BA12 trn[0..3]=4D0BED53
18:37:07.747 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313732384D50
18:37:07.755 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313732384D50000000000000 
18:37:07.760 > [ESP32][LFSR] Initializing - Seed: 0x9EF9E091 SeedBe: 0x91E0F99E ChaosKey[0..3]: 0978BA12 InitialTap: 0x0029 State: 0x9EF9E091
18:37:07.772 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:37:07.780 > 3_After_LFSR (32): D9B2D4A8E53E11A885B1A6496A3E5976 428644820FDCAF33471BD60D8D03EF22 
18:37:07.788 > [ESP32][LFSR] Keystream (first 16 bytes): 91E0F99ED01E42F8CA838B705C1E0A22
18:37:07.794 > [ESP32][4D] LFSR keystream (first 32 bytes): 91E0F99ED01E42F8CA838B705C1E0A2207D617AF3EEB9D0B0A4BD60D8D03EF22
18:37:07.805 > [ESP32][TINKERBELL] Input (first 16 bytes): D9B2D4A8E53E11A885B1A6496A3E5976 Nonce: 0x00000002 Buffer size: 32 bytes
18:37:07.816 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 0978BA12
18:37:07.824 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 8257DDDADCA8BD0A07779D4E3B2CF8D7
18:37:07.833 > 4_After_Tinkerbell (32): 5BE509723996ACA282C63B075112A1A1 81ADF0701B7B3F15F39802D9C6C2A95F 
18:37:07.841 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 8257DDDADCA8BD0A07779D4E3B2CF8D7
18:37:07.849 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 8257DDDADCA8BD0A07779D4E3B2CF8D7C32BB4F214A79026B483D4D44BC1467D
18:37:07.857 > 5_After_Transposition (32): 81F0AD70A2AC9639F30298D9A1A11251 C6C2A95F5BE509721B7B3F1582C63B07 
18:37:07.866 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
18:37:07.871 > [ESP32] === HMAC DEBUG INFO ===
18:37:07.874 > [ESP32] HMAC Key being used: 61898C000C113108D39ECEB4ED4B23B971AD22F4054BB82DB3207670B191DB81
18:37:07.883 > [ESP32] HMAC Input length: 45 bytes
18:37:07.885 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000281F0AD70A2AC9639F30298D9A1A11251C6C2A9
18:37:07.893 > [ESP32] Nonce: 0x00000002
18:37:07.896 > [ESP32] Packet size before HMAC: 61
18:37:07.900 > [ESP32] Computed HMAC Tag: 155558F1C774F4D3B941EFFDBA426FEC
18:37:07.905 > [ESP32] === END HMAC DEBUG ===
18:37:07.907 > 6_Final_Packet (61): 8202180018000408040000000281F0AD 70A2AC9639F30298D9A1A11251C6C2A9 ...
18:37:07.916 > [RETRY] Attempt 1/3 (nonce: 2)
18:37:07.919 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:07.924 > Sending pipeline data to server (659 bytes)
18:37:08.054 > [HTTP] Response code: 400
18:37:08.054 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:08.059 > [HTTP] Request failed with code: 400
18:37:08.062 > [RETRY] Send failed, waiting 100 ms before retry
18:37:08.162 > [RETRY] Attempt 2/3 (nonce: 2)
18:37:08.162 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:08.168 > Sending pipeline data to server (659 bytes)
18:37:08.303 > [HTTP] Response code: 400
18:37:08.304 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:08.309 > [HTTP] Request failed with code: 400
18:37:08.312 > [RETRY] Send failed, waiting 200 ms before retry
18:37:08.511 > [RETRY] Attempt 3/3 (nonce: 2)
18:37:08.512 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:08.517 > Sending pipeline data to server (659 bytes)
18:37:08.807 > [HTTP] Response code: 400
18:37:08.807 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:08.813 > [HTTP] Request failed with code: 400
18:37:08.815 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:37:08.821 > [RETRY] Consecutive failures: 3
18:37:08.823 > Health data send failed (retry count: 3/3)
18:37:08.826 > Health data transmission failed after max retries
18:37:08.927 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":336791,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:08.964 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:08.969 > [WebSocket] ========================================
18:37:08.975 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:08.980 > [WebSocket] ========================================
18:37:08.985 > [ZTM] Settings saved successfully
18:37:08.988 > [WebSocket] ✓ ZTM activated successfully
18:37:08.991 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:08.997 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:08.999 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:09.003 > [WebSocket] ========================================
18:37:09.008 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":341074,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:09.047 > [341.1] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:09.052 > ERROR state - attempting recovery
18:37:09.058 > [RETRY] Attempting to send health data (Max retries: 3)
18:37:09.061 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:37:09.066 > Generated health data: HR-65 SPO2-96 STEPS-1742
18:37:09.071 > [ESP32] ========================================
18:37:09.074 > [ESP32] ENCRYPTION PIPELINE START
18:37:09.078 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:37:09.083 > [ESP32] Active Algorithms for this packet:
18:37:09.086 > [ESP32]   + LFSR
18:37:09.089 > [ESP32]   + Tinkerbell
18:37:09.092 > [ESP32]   + Transposition
18:37:09.092 > [ESP32]   - ChaCha20
18:37:09.094 > [ESP32]   - Salsa20
18:37:09.096 > [ESP32] ========================================
18:37:09.100 > [ESP32] MsgKeys: lfsrSeed=0x9EF9E091 tnk[0..3]=0978BA12 trn[0..3]=4D0BED53
18:37:09.108 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313734324D50
18:37:09.113 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313734324D50000000000000 
18:37:09.122 > [ESP32][LFSR] Initializing - Seed: 0x9EF9E091 SeedBe: 0x91E0F99E ChaosKey[0..3]: 0978BA12 InitialTap: 0x0029 State: 0x9EF9E091
18:37:09.133 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:37:09.142 > 3_After_LFSR (32): D9B2D4A8E53E11A885B1A6496A3E5976 428644820FDCA939471BD60D8D03EF22 
18:37:09.147 > [ESP32][LFSR] Keystream (first 16 bytes): 91E0F99ED01E42F8CA838B705C1E0A22
18:37:09.155 > [ESP32][4D] LFSR keystream (first 32 bytes): 91E0F99ED01E42F8CA838B705C1E0A2207D617AF3EEB9D0B0A4BD60D8D03EF22
18:37:09.164 > [ESP32][TINKERBELL] Input (first 16 bytes): D9B2D4A8E53E11A885B1A6496A3E5976 Nonce: 0x00000002 Buffer size: 32 bytes
18:37:09.175 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 0978BA12
18:37:09.183 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 8257DDDADCA8BD0A07779D4E3B2CF8D7
18:37:09.192 > 4_After_Tinkerbell (32): 5BE509723996ACA282C63B075112A1A1 81ADF0701B7B391FF39802D9C6C2A95F 
18:37:09.200 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 8257DDDADCA8BD0A07779D4E3B2CF8D7
18:37:09.208 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 8257DDDADCA8BD0A07779D4E3B2CF8D7C32BB4F214A79026B483D4D44BC1467D
18:37:09.219 > 5_After_Transposition (32): 81F0AD70A2AC9639F30298D9A1A11251 C6C2A95F5BE509721B7B391F82C63B07 
18:37:09.228 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
18:37:09.230 > [ESP32] === HMAC DEBUG INFO ===
18:37:09.233 > [ESP32] HMAC Key being used: 61898C000C113108D39ECEB4ED4B23B971AD22F4054BB82DB3207670B191DB81
18:37:09.242 > [ESP32] HMAC Input length: 45 bytes
18:37:09.244 > [ESP32] HMAC Input (first 32 bytes): 8202180018000408040000000281F0AD70A2AC9639F30298D9A1A11251C6C2A9
18:37:09.255 > [ESP32] Nonce: 0x00000002
18:37:09.255 > [ESP32] Packet size before HMAC: 61
18:37:09.261 > [ESP32] Computed HMAC Tag: D48AB3ADF3C1193295A6596874D2585B
18:37:09.266 > [ESP32] === END HMAC DEBUG ===
18:37:09.266 > 6_Final_Packet (61): 8202180018000408040000000281F0AD 70A2AC9639F30298D9A1A11251C6C2A9 ...
18:37:09.274 > [RETRY] Attempt 1/3 (nonce: 2)
18:37:09.277 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:09.283 > Sending pipeline data to server (659 bytes)
18:37:09.562 > [HTTP] Response code: 400
18:37:09.562 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:09.567 > [HTTP] Request failed with code: 400
18:37:09.570 > [RETRY] Send failed, waiting 100 ms before retry
18:37:09.669 > [RETRY] Attempt 2/3 (nonce: 2)
18:37:09.669 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:09.675 > Sending pipeline data to server (659 bytes)
18:37:09.816 > [HTTP] Response code: 400
18:37:09.817 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:09.822 > [HTTP] Request failed with code: 400
18:37:09.825 > [RETRY] Send failed, waiting 200 ms before retry
18:37:10.026 > [RETRY] Attempt 3/3 (nonce: 2)
18:37:10.026 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:10.031 > Sending pipeline data to server (659 bytes)
18:37:10.345 > [HTTP] Response code: 400
18:37:10.347 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:10.352 > [HTTP] Request failed with code: 400
18:37:10.354 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:37:10.360 > [RETRY] Consecutive failures: 4
18:37:10.363 > ✗ Auto-recovery failed - restarting key exchange
18:37:12.466 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":336826,"type":"ztm_activated"}
18:37:12.482 > [WebSocket] Processing message type: ztm_activated
18:37:12.485 > [344.5] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:12.493 > ✓ Public key loaded from NVS
18:37:12.591 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":337352,"type":"health_data_error"}
18:37:12.605 > [WebSocket] Processing message type: health_data_error
18:37:12.611 > [344.7] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:12.714 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124025426,"threatLevel":0,"type":"heuristics_update"}
18:37:12.739 > [WebSocket] Processing message type: heuristics_update
18:37:12.745 > [344.8] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:12.753 > Generating fresh master key from entropy...
18:37:12.757 > Generated master key (32): D7BD3F52BA3A36F3A324337E374DC0B3 F8199CD9C5BDBEFAE1C1512F67C5FA1F 
18:37:12.769 > Using reduced master key (byte % 3) for NTRU encryption only
18:37:12.777 > NTRU encrypted master key (502): 00640059003F0066001500450006006B 00370003001E000C006C00700021000E ...
18:37:12.785 > POST http://10.249.92.115:8081/master-key
18:37:13.080 > ✓ Master key exchange completed
18:37:13.182 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":337604,"type":"health_data_error"}
18:37:13.195 > [WebSocket] Processing message type: health_data_error
18:37:13.202 > [345.3] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:13.209 > Loading master key from NVS and deriving symmetric keys...
18:37:13.216 > Loaded master key from NVS (32): D7BD3F52BA3A36F3A324337E374DC0B3 F8199CD9C5BDBEFAE1C1512F67C5FA1F 
18:37:13.223 > Derived HMAC key (32): 03CA86A2656E35D98D1EAE0A06FDDBE3 5B36C33128C1E2D9D55549CE5ECBEFA6 
18:37:13.258 > Derived Tinkerbell key (16): 2D3ED0E890082001DC55FDA902825BA8 
18:37:13.258 > Derived Transposition key (16): C8250C3C2435270BEFD34666369905A5 
18:37:13.258 > ✓ Symmetric keys derived successfully
18:37:13.258 > Nonce tracker reset - new session started
18:37:13.741 > Waiting for server to process master key...
18:37:13.745 > ✓ Symmetric keys ready - starting health data transmission
18:37:13.848 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":338113,"type":"health_data_error"}
18:37:13.861 > [WebSocket] Processing message type: health_data_error
18:37:13.866 > [345.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:13.971 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124026439,"threatLevel":0,"type":"heuristics_update"}
18:37:13.996 > [WebSocket] Processing message type: heuristics_update
18:37:14.002 > [346.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:14.103 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":338875,"type":"health_data_error"}
18:37:14.117 > [WebSocket] Processing message type: health_data_error
18:37:14.122 > [346.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:14.226 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":339119,"type":"health_data_error"}
18:37:14.240 > [WebSocket] Processing message type: health_data_error
18:37:14.245 > [346.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:14.347 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124027455,"threatLevel":0,"type":"heuristics_update"}
18:37:14.372 > [WebSocket] Processing message type: heuristics_update
18:37:14.378 > [346.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:14.480 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":339623,"type":"health_data_error"}
18:37:14.494 > [WebSocket] Processing message type: health_data_error
18:37:14.500 > [346.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:14.602 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":340127,"type":"health_data_error"}
18:37:14.617 > [WebSocket] Processing message type: health_data_error
18:37:14.622 > [346.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:14.724 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":340377,"type":"health_data_error"}
18:37:14.738 > [WebSocket] Processing message type: health_data_error
18:37:14.744 > [346.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:14.851 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124028464,"threatLevel":0,"type":"heuristics_update"}
18:37:14.876 > [WebSocket] Processing message type: heuristics_update
18:37:14.881 > [346.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:14.983 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":340880,"type":"health_data_error"}
18:37:14.997 > [WebSocket] Processing message type: health_data_error
18:37:15.003 > [347.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:15.105 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":341074,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:15.142 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:15.146 > [WebSocket] ========================================
18:37:15.153 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:15.159 > [WebSocket] ========================================
18:37:15.164 > [ZTM] Settings saved successfully
18:37:15.166 > [WebSocket] ✓ ZTM activated successfully
18:37:15.168 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:15.174 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:15.177 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:15.180 > [WebSocket] ========================================
18:37:15.186 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":347253,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:15.224 > [347.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:15.332 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":8,"success":true,"timestamp":341110,"type":"ztm_activated"}
18:37:15.348 > [WebSocket] Processing message type: ztm_activated
18:37:15.350 > [347.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:15.455 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124029471,"threatLevel":0,"type":"heuristics_update"}
18:37:15.479 > [WebSocket] Processing message type: heuristics_update
18:37:15.485 > [347.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:15.588 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":341635,"type":"health_data_error"}
18:37:15.602 > [WebSocket] Processing message type: health_data_error
18:37:15.607 > [347.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:15.710 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":341890,"type":"health_data_error"}
18:37:15.723 > [WebSocket] Processing message type: health_data_error
18:37:15.729 > [347.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:15.832 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":342420,"type":"health_data_error"}
18:37:15.846 > [WebSocket] Processing message type: health_data_error
18:37:15.851 > [347.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:15.954 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124030483,"threatLevel":0,"type":"heuristics_update"}
18:37:15.979 > [WebSocket] Processing message type: heuristics_update
18:37:15.985 > [348.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:16.088 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124031491,"threatLevel":0,"type":"heuristics_update"}
18:37:16.113 > [WebSocket] Processing message type: heuristics_update
18:37:16.117 > [348.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:16.221 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124032501,"threatLevel":0,"type":"heuristics_update"}
18:37:16.245 > [WebSocket] Processing message type: heuristics_update
18:37:16.251 > [348.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:16.353 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770124032902,"type":"master_key_received"}
18:37:16.368 > [WebSocket] Processing message type: master_key_received
18:37:16.370 > [348.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:16.476 > [WebSocket] Received (176 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":345146,"type":"master_key_exchanged"}
18:37:16.492 > [WebSocket] Processing message type: master_key_exchanged
18:37:16.498 > [348.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:16.598 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124033502,"threatLevel":0,"type":"heuristics_update"}
18:37:16.623 > [WebSocket] Processing message type: heuristics_update
18:37:16.629 > [348.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:16.731 > [WebSocket] Received (168 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":345815,"type":"symmetric_keys_derived"}
18:37:16.748 > [WebSocket] Processing message type: symmetric_keys_derived
18:37:16.752 > [348.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:16.853 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124034513,"threatLevel":0,"type":"heuristics_update"}
18:37:16.877 > [WebSocket] Processing message type: heuristics_update
18:37:16.883 > [348.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:16.986 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":347253,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:17.022 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:17.027 > [WebSocket] ========================================
18:37:17.032 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:17.038 > [WebSocket] ========================================
18:37:17.043 > [ZTM] Settings saved successfully
18:37:17.046 > [WebSocket] ✓ ZTM activated successfully
18:37:17.049 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:17.055 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:17.058 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:17.061 > [WebSocket] ========================================
18:37:17.066 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":349132,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:17.105 > [349.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:17.212 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":347288,"type":"ztm_activated"}
18:37:17.228 > [WebSocket] Processing message type: ztm_activated
18:37:17.231 > [349.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:17.334 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124035513,"threatLevel":0,"type":"heuristics_update"}
18:37:17.359 > [WebSocket] Processing message type: heuristics_update
18:37:17.365 > [349.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:17.467 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124036527,"threatLevel":0,"type":"heuristics_update"}
18:37:17.493 > [WebSocket] Processing message type: heuristics_update
18:37:17.498 > [349.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:17.601 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":349132,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:17.637 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:17.642 > [WebSocket] ========================================
18:37:17.647 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:17.653 > [WebSocket] ========================================
18:37:17.659 > [ZTM] Settings saved successfully
18:37:17.662 > [WebSocket] ✓ ZTM activated successfully
18:37:17.664 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:17.670 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:17.672 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:17.676 > [WebSocket] ========================================
18:37:17.681 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":349747,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:17.720 > [349.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:17.826 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":349168,"type":"ztm_activated"}
18:37:17.843 > [WebSocket] Processing message type: ztm_activated
18:37:17.846 > [349.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:17.952 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124037530,"threatLevel":0,"type":"heuristics_update"}
18:37:17.978 > [WebSocket] Processing message type: heuristics_update
18:37:17.983 > [350.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:18.085 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":349747,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:18.122 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:18.127 > [WebSocket] ========================================
18:37:18.133 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:18.138 > [WebSocket] ========================================
18:37:18.144 > [ZTM] Settings saved successfully
18:37:18.147 > [WebSocket] ✓ ZTM activated successfully
18:37:18.148 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:18.155 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:18.158 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:18.161 > [WebSocket] ========================================
18:37:18.165 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":350232,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:18.205 > [350.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:18.312 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":349783,"type":"ztm_activated"}
18:37:18.328 > [WebSocket] Processing message type: ztm_activated
18:37:18.331 > [350.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:18.434 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":350232,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:18.471 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:18.476 > [WebSocket] ========================================
18:37:18.482 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:18.488 > [WebSocket] ========================================
18:37:18.493 > [ZTM] Settings saved successfully
18:37:18.496 > [WebSocket] ✓ ZTM activated successfully
18:37:18.498 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:18.505 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:18.508 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:18.510 > [WebSocket] ========================================
18:37:18.515 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":350582,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:18.554 > [350.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:18.660 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":350268,"type":"ztm_activated"}
18:37:18.677 > [WebSocket] Processing message type: ztm_activated
18:37:18.680 > [350.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:18.784 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":350582,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:18.820 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:18.826 > [WebSocket] ========================================
18:37:18.831 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:18.836 > [WebSocket] ========================================
18:37:18.842 > [ZTM] Settings saved successfully
18:37:18.845 > [WebSocket] ✓ ZTM activated successfully
18:37:18.848 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:18.853 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:18.856 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:18.859 > [WebSocket] ========================================
18:37:18.865 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":350931,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:18.903 > [351.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:19.009 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124038544,"threatLevel":0,"type":"heuristics_update"}
18:37:19.034 > [WebSocket] Processing message type: heuristics_update
18:37:19.040 > [351.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:19.143 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":350617,"type":"ztm_activated"}
18:37:19.159 > [WebSocket] Processing message type: ztm_activated
18:37:19.162 > [351.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:19.267 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":350931,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:19.303 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:19.308 > [WebSocket] ========================================
18:37:19.314 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:19.320 > [WebSocket] ========================================
18:37:19.325 > [ZTM] Settings saved successfully
18:37:19.327 > [WebSocket] ✓ ZTM activated successfully
18:37:19.331 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:19.336 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:19.339 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:19.342 > [WebSocket] ========================================
18:37:19.347 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":351414,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:19.387 > [351.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:19.494 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":350966,"type":"ztm_activated"}
18:37:19.511 > [WebSocket] Processing message type: ztm_activated
18:37:19.514 > [351.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:19.618 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":351414,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:19.654 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:19.660 > [WebSocket] ========================================
18:37:19.665 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:19.670 > [WebSocket] ========================================
18:37:19.676 > [ZTM] Settings saved successfully
18:37:19.679 > [WebSocket] ✓ ZTM activated successfully
18:37:19.682 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:19.688 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:19.690 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:19.692 > [WebSocket] ========================================
18:37:19.698 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":351765,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:19.737 > [351.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:19.843 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":351451,"type":"ztm_activated"}
18:37:19.860 > [WebSocket] Processing message type: ztm_activated
18:37:19.863 > [351.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:19.967 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124039554,"threatLevel":0,"type":"heuristics_update"}
18:37:19.991 > [WebSocket] Processing message type: heuristics_update
18:37:19.997 > [352.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:20.100 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":351765,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:20.136 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:20.141 > [WebSocket] ========================================
18:37:20.146 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:20.153 > [WebSocket] ========================================
18:37:20.158 > [ZTM] Settings saved successfully
18:37:20.161 > [WebSocket] ✓ ZTM activated successfully
18:37:20.163 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:20.170 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:20.172 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:20.175 > [WebSocket] ========================================
18:37:20.181 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":352247,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:20.219 > [352.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:20.325 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":351800,"type":"ztm_activated"}
18:37:20.342 > [WebSocket] Processing message type: ztm_activated
18:37:20.345 > [352.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:20.452 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":352247,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:20.488 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:20.493 > [WebSocket] ========================================
18:37:20.498 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:20.504 > [WebSocket] ========================================
18:37:20.510 > [ZTM] Settings saved successfully
18:37:20.513 > [WebSocket] ✓ ZTM activated successfully
18:37:20.515 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:20.521 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:20.524 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:20.526 > [WebSocket] ========================================
18:37:20.531 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":352598,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:20.571 > [352.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:20.677 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":352282,"type":"ztm_activated"}
18:37:20.694 > [WebSocket] Processing message type: ztm_activated
18:37:20.697 > [352.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:20.801 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":352598,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:20.837 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:20.843 > [WebSocket] ========================================
18:37:20.848 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:20.854 > [WebSocket] ========================================
18:37:20.859 > [ZTM] Settings saved successfully
18:37:20.862 > [WebSocket] ✓ ZTM activated successfully
18:37:20.865 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:20.870 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:20.872 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:20.876 > [WebSocket] ========================================
18:37:20.881 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":352948,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:20.920 > [353.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:21.026 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124040566,"threatLevel":0,"type":"heuristics_update"}
18:37:21.051 > [WebSocket] Processing message type: heuristics_update
18:37:21.057 > [353.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:21.159 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":352634,"type":"ztm_activated"}
18:37:21.176 > [WebSocket] Processing message type: ztm_activated
18:37:21.178 > [353.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:21.281 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":352948,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:21.318 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:21.323 > [WebSocket] ========================================
18:37:21.329 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:21.335 > [WebSocket] ========================================
18:37:21.340 > [ZTM] Settings saved successfully
18:37:21.342 > [WebSocket] ✓ ZTM activated successfully
18:37:21.346 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:21.350 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:21.354 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:21.356 > [WebSocket] ========================================
18:37:21.362 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":353429,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:21.401 > [353.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:21.508 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":352983,"type":"ztm_activated"}
18:37:21.525 > [WebSocket] Processing message type: ztm_activated
18:37:21.528 > [353.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:21.634 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":353429,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:21.670 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:21.675 > [WebSocket] ========================================
18:37:21.681 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:21.686 > [WebSocket] ========================================
18:37:21.692 > [ZTM] Settings saved successfully
18:37:21.695 > [WebSocket] ✓ ZTM activated successfully
18:37:21.698 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:21.703 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:21.706 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:21.709 > [WebSocket] ========================================
18:37:21.714 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":353781,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:21.753 > [353.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:21.859 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":353464,"type":"ztm_activated"}
18:37:21.876 > [WebSocket] Processing message type: ztm_activated
18:37:21.879 > [353.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:21.982 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124041580,"threatLevel":0,"type":"heuristics_update"}
18:37:22.007 > [WebSocket] Processing message type: heuristics_update
18:37:22.013 > [354.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:22.115 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":353781,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:22.152 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:22.157 > [WebSocket] ========================================
18:37:22.163 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:22.169 > [WebSocket] ========================================
18:37:22.174 > [ZTM] Settings saved successfully
18:37:22.177 > [WebSocket] ✓ ZTM activated successfully
18:37:22.179 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:22.185 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:22.188 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:22.191 > [WebSocket] ========================================
18:37:22.196 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":354263,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:22.235 > [354.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:22.343 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":353816,"type":"ztm_activated"}
18:37:22.359 > [WebSocket] Processing message type: ztm_activated
18:37:22.362 > [354.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:22.466 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":354263,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:22.502 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:22.508 > [WebSocket] ========================================
18:37:22.513 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:22.519 > [WebSocket] ========================================
18:37:22.524 > [ZTM] Settings saved successfully
18:37:22.527 > [WebSocket] ✓ ZTM activated successfully
18:37:22.529 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:22.535 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:22.538 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:22.541 > [WebSocket] ========================================
18:37:22.546 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":354613,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:22.585 > [354.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:22.691 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":354298,"type":"ztm_activated"}
18:37:22.707 > [WebSocket] Processing message type: ztm_activated
18:37:22.710 > [354.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:22.818 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":354613,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:22.854 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:22.860 > [WebSocket] ========================================
18:37:22.865 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:22.871 > [WebSocket] ========================================
18:37:22.876 > [ZTM] Settings saved successfully
18:37:22.879 > [WebSocket] ✓ ZTM activated successfully
18:37:22.881 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:22.886 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:22.890 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:22.892 > [WebSocket] ========================================
18:37:22.898 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":354965,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:22.936 > [355.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:23.044 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":354648,"type":"ztm_activated"}
18:37:23.061 > [WebSocket] Processing message type: ztm_activated
18:37:23.064 > [355.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:23.167 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124042593,"threatLevel":0,"type":"heuristics_update"}
18:37:23.193 > [WebSocket] Processing message type: heuristics_update
18:37:23.198 > [355.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:23.300 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":354965,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:23.336 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:23.342 > [WebSocket] ========================================
18:37:23.348 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:23.353 > [WebSocket] ========================================
18:37:23.359 > [ZTM] Settings saved successfully
18:37:23.361 > [WebSocket] ✓ ZTM activated successfully
18:37:23.364 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:23.370 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:23.372 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:23.376 > [WebSocket] ========================================
18:37:23.382 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":355448,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:23.420 > [355.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:23.526 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":355000,"type":"ztm_activated"}
18:37:23.543 > [WebSocket] Processing message type: ztm_activated
18:37:23.546 > [355.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:23.650 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":355448,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:23.686 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:23.692 > [WebSocket] ========================================
18:37:23.697 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:23.702 > [WebSocket] ========================================
18:37:23.708 > [ZTM] Settings saved successfully
18:37:23.711 > [WebSocket] ✓ ZTM activated successfully
18:37:23.714 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:23.719 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:23.722 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:23.725 > [WebSocket] ========================================
18:37:23.730 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":355797,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:23.769 > [355.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:23.777 > [RETRY] Attempting to send health data (Max retries: 3)
18:37:23.783 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:37:23.786 > Generated health data: HR-65 SPO2-96 STEPS-1809
18:37:23.791 > [ESP32] ========================================
18:37:23.794 > [ESP32] ENCRYPTION PIPELINE START
18:37:23.797 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:37:23.803 > [ESP32] Active Algorithms for this packet:
18:37:23.808 > [ESP32]   + LFSR
18:37:23.808 > [ESP32]   + Tinkerbell
18:37:23.811 > [ESP32]   + Transposition
18:37:23.813 > [ESP32]   - ChaCha20
18:37:23.813 > [ESP32]   - Salsa20
18:37:23.817 > [ESP32] ========================================
18:37:23.822 > [ESP32] MsgKeys: lfsrSeed=0x598FD91D tnk[0..3]=5975E6F1 trn[0..3]=10141B9C
18:37:23.827 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313830394D50
18:37:23.833 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313830394D50000000000000 
18:37:23.841 > [ESP32][LFSR] Initializing - Seed: 0x598FD91D SeedBe: 0x1DD98F59 ChaosKey[0..3]: 5975E6F1 InitialTap: 0x0029 State: 0x598FD91D
18:37:23.853 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:37:23.861 > 3_After_LFSR (32): 558BA26FDB1FFF5E1D18F2DC8E96161B 7225AF537B37C8A3E04101896E4F7532 
18:37:23.869 > [ESP32][LFSR] Keystream (first 16 bytes): 1DD98F59EE3FAC0E522ADFE5B8B6454F
18:37:23.874 > [ESP32][4D] LFSR keystream (first 32 bytes): 1DD98F59EE3FAC0E522ADFE5B8B6454F3775FC7E4A0FF89AAD1101896E4F7532
18:37:23.883 > [ESP32][TINKERBELL] Input (first 16 bytes): 558BA26FDB1FFF5E1D18F2DC8E96161B Nonce: 0x00000001 Buffer size: 32 bytes
18:37:23.894 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5975E6F1
18:37:23.906 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 3689D282E42FA4DF163E248DCBFD4F96
18:37:23.913 > 4_After_Tinkerbell (32): 630270ED3F305B810B26D651456B598D 98700CDDB65E492DDE33DFC2E5F2E43A 
18:37:23.920 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 3689D282E42FA4DF163E248DCBFD4F96
18:37:23.928 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 3689D282E42FA4DF163E248DCBFD4F96EA55A38ECD69818E3E72DE4B8BBD9108
18:37:23.939 > 5_After_Transposition (32): 3F45C2D65B268D81DE0C70DFDD0BE563 ED515E3AB6334970596B3098E402F22D 
18:37:23.946 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:37:23.952 > [ESP32] === HMAC DEBUG INFO ===
18:37:23.956 > [ESP32] HMAC Key being used: 03CA86A2656E35D98D1EAE0A06FDDBE35B36C33128C1E2D9D55549CE5ECBEFA6
18:37:23.963 > [ESP32] HMAC Input length: 45 bytes
18:37:23.967 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000013F45C2D65B268D81DE0C70DFDD0BE563ED515E
18:37:23.975 > [ESP32] Nonce: 0x00000001
18:37:23.978 > [ESP32] Packet size before HMAC: 61
18:37:23.980 > [ESP32] Computed HMAC Tag: E0D10992E4BE90FF2F69CFAEB1D2A5F0
18:37:23.986 > [ESP32] === END HMAC DEBUG ===
18:37:23.988 > 6_Final_Packet (61): 820218001800040804000000013F45C2 D65B268D81DE0C70DFDD0BE563ED515E ...
18:37:23.997 > [RETRY] Attempt 1/3 (nonce: 1)
18:37:24.000 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:24.005 > Sending pipeline data to server (659 bytes)
18:37:24.124 > [HTTP] Response code: 400
18:37:24.124 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:24.130 > [HTTP] Request failed with code: 400
18:37:24.133 > [RETRY] Send failed, waiting 100 ms before retry
18:37:24.232 > [RETRY] Attempt 2/3 (nonce: 1)
18:37:24.232 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:24.238 > Sending pipeline data to server (659 bytes)
18:37:24.399 > [HTTP] Response code: 400
18:37:24.400 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:24.405 > [HTTP] Request failed with code: 400
18:37:24.408 > [RETRY] Send failed, waiting 200 ms before retry
18:37:24.607 > [RETRY] Attempt 3/3 (nonce: 1)
18:37:24.608 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:24.613 > Sending pipeline data to server (659 bytes)
18:37:24.884 > [HTTP] Response code: 400
18:37:24.886 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:24.890 > [HTTP] Request failed with code: 400
18:37:24.893 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:37:24.898 > [RETRY] Consecutive failures: 5
18:37:24.902 > [EMERGENCY] Triggering emergency reset!
18:37:24.904 > [CRYPTO] Resetting cryptographic state
18:37:24.910 > [CRYPTO] Crypto state reset complete
18:37:24.913 > [CRYPTO] Packet counter: 7
18:37:24.915 > [EMERGENCY] Emergency reset complete
18:37:24.918 > Health data send failed (retry count: 1/3)
18:37:25.014 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":355483,"type":"ztm_activated"}
18:37:25.030 > [WebSocket] Processing message type: ztm_activated
18:37:25.034 > [357.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:25.042 > [RETRY] Attempting to send health data (Max retries: 3)
18:37:25.047 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:37:25.053 > Generated health data: HR-65 SPO2-96 STEPS-1793
18:37:25.056 > [ESP32] ========================================
18:37:25.061 > [ESP32] ENCRYPTION PIPELINE START
18:37:25.063 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:37:25.069 > [ESP32] Active Algorithms for this packet:
18:37:25.073 > [ESP32]   + LFSR
18:37:25.075 > [ESP32]   + Tinkerbell
18:37:25.075 > [ESP32]   + Transposition
18:37:25.078 > [ESP32]   - ChaCha20
18:37:25.081 > [ESP32]   - Salsa20
18:37:25.081 > [ESP32] ========================================
18:37:25.087 > [ESP32] MsgKeys: lfsrSeed=0x598FD91D tnk[0..3]=5975E6F1 trn[0..3]=10141B9C
18:37:25.092 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313739334D50
18:37:25.100 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313739334D50000000000000 
18:37:25.106 > [ESP32][LFSR] Initializing - Seed: 0x598FD91D SeedBe: 0x1DD98F59 ChaosKey[0..3]: 5975E6F1 InitialTap: 0x0029 State: 0x598FD91D
18:37:25.117 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:37:25.125 > 3_After_LFSR (32): 558BA26FDB1FFF5E1D18F2DC8E96161B 7225AF537B38C1A9E04101896E4F7532 
18:37:25.134 > [ESP32][LFSR] Keystream (first 16 bytes): 1DD98F59EE3FAC0E522ADFE5B8B6454F
18:37:25.139 > [ESP32][4D] LFSR keystream (first 32 bytes): 1DD98F59EE3FAC0E522ADFE5B8B6454F3775FC7E4A0FF89AAD1101896E4F7532
18:37:25.150 > [ESP32][TINKERBELL] Input (first 16 bytes): 558BA26FDB1FFF5E1D18F2DC8E96161B Nonce: 0x00000001 Buffer size: 32 bytes
18:37:25.161 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5975E6F1
18:37:25.170 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 3689D282E42FA4DF163E248DCBFD4F96
18:37:25.178 > 4_After_Tinkerbell (32): 630270ED3F305B810B26D651456B598D 98700CDDB6514027DE33DFC2E5F2E43A 
18:37:25.187 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 3689D282E42FA4DF163E248DCBFD4F96
18:37:25.195 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 3689D282E42FA4DF163E248DCBFD4F96EA55A38ECD69818E3E72DE4B8BBD9108
18:37:25.203 > 5_After_Transposition (32): 3F45C2D65B268D81DE0C70DFDD0BE563 ED51513AB6334070596B3098E402F227 
18:37:25.212 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:37:25.217 > [ESP32] === HMAC DEBUG INFO ===
18:37:25.219 > [ESP32] HMAC Key being used: 03CA86A2656E35D98D1EAE0A06FDDBE35B36C33128C1E2D9D55549CE5ECBEFA6
18:37:25.228 > [ESP32] HMAC Input length: 45 bytes
18:37:25.231 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000013F45C2D65B268D81DE0C70DFDD0BE563ED5151
18:37:25.239 > [ESP32] Nonce: 0x00000001
18:37:25.242 > [ESP32] Packet size before HMAC: 61
18:37:25.245 > [ESP32] Computed HMAC Tag: A07195B96EAFA046B41E648F5BC3334C
18:37:25.250 > [ESP32] === END HMAC DEBUG ===
18:37:25.253 > 6_Final_Packet (61): 820218001800040804000000013F45C2 D65B268D81DE0C70DFDD0BE563ED5151 ...
18:37:25.262 > [RETRY] Attempt 1/3 (nonce: 1)
18:37:25.264 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:25.270 > Sending pipeline data to server (659 bytes)
18:37:25.391 > [HTTP] Response code: 400
18:37:25.391 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:25.397 > [HTTP] Request failed with code: 400
18:37:25.399 > [RETRY] Send failed, waiting 100 ms before retry
18:37:25.499 > [RETRY] Attempt 2/3 (nonce: 1)
18:37:25.499 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:25.505 > Sending pipeline data to server (659 bytes)
18:37:25.642 > [HTTP] Response code: 400
18:37:25.643 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:25.649 > [HTTP] Request failed with code: 400
18:37:25.650 > [RETRY] Send failed, waiting 200 ms before retry
18:37:25.851 > [RETRY] Attempt 3/3 (nonce: 1)
18:37:25.851 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:25.856 > Sending pipeline data to server (659 bytes)
18:37:26.146 > [HTTP] Response code: 400
18:37:26.146 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:26.151 > [HTTP] Request failed with code: 400
18:37:26.154 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:37:26.160 > [RETRY] Consecutive failures: 1
18:37:26.162 > Health data send failed (retry count: 2/3)
18:37:26.265 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124043604,"threatLevel":0,"type":"heuristics_update"}
18:37:26.291 > [WebSocket] Processing message type: heuristics_update
18:37:26.296 > [358.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:26.304 > [RETRY] Attempting to send health data (Max retries: 3)
18:37:26.307 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:37:26.313 > Generated health data: HR-65 SPO2-96 STEPS-1805
18:37:26.318 > [ESP32] ========================================
18:37:26.321 > [ESP32] ENCRYPTION PIPELINE START
18:37:26.324 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:37:26.329 > [ESP32] Active Algorithms for this packet:
18:37:26.331 > [ESP32]   + LFSR
18:37:26.335 > [ESP32]   + Tinkerbell
18:37:26.338 > [ESP32]   + Transposition
18:37:26.338 > [ESP32]   - ChaCha20
18:37:26.340 > [ESP32]   - Salsa20
18:37:26.343 > [ESP32] ========================================
18:37:26.345 > [ESP32] MsgKeys: lfsrSeed=0x598FD91D tnk[0..3]=5975E6F1 trn[0..3]=10141B9C
18:37:26.370 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313830354D50
18:37:26.370 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313830354D50000000000000 
18:37:26.370 > [ESP32][LFSR] Initializing - Seed: 0x598FD91D SeedBe: 0x1DD98F59 ChaosKey[0..3]: 5975E6F1 InitialTap: 0x0029 State: 0x598FD91D
18:37:26.383 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:37:26.399 > 3_After_LFSR (32): 558BA26FDB1FFF5E1D18F2DC8E96161B 7225AF537B37C8AFE04101896E4F7532 
18:37:26.399 > [ESP32][LFSR] Keystream (first 16 bytes): 1DD98F59EE3FAC0E522ADFE5B8B6454F
18:37:26.401 > [ESP32][4D] LFSR keystream (first 32 bytes): 1DD98F59EE3FAC0E522ADFE5B8B6454F3775FC7E4A0FF89AAD1101896E4F7532
18:37:26.410 > [ESP32][TINKERBELL] Input (first 16 bytes): 558BA26FDB1FFF5E1D18F2DC8E96161B Nonce: 0x00000001 Buffer size: 32 bytes
18:37:26.421 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5975E6F1
18:37:26.429 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 3689D282E42FA4DF163E248DCBFD4F96
18:37:26.438 > 4_After_Tinkerbell (32): 630270ED3F305B810B26D651456B598D 98700CDDB65E4921DE33DFC2E5F2E43A 
18:37:26.446 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 3689D282E42FA4DF163E248DCBFD4F96
18:37:26.454 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 3689D282E42FA4DF163E248DCBFD4F96EA55A38ECD69818E3E72DE4B8BBD9108
18:37:26.465 > 5_After_Transposition (32): 3F45C2D65B268D81DE0C70DFDD0BE563 ED515E3AB6334970596B3098E402F221 
18:37:26.473 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:37:26.476 > [ESP32] === HMAC DEBUG INFO ===
18:37:26.479 > [ESP32] HMAC Key being used: 03CA86A2656E35D98D1EAE0A06FDDBE35B36C33128C1E2D9D55549CE5ECBEFA6
18:37:26.488 > [ESP32] HMAC Input length: 45 bytes
18:37:26.490 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000013F45C2D65B268D81DE0C70DFDD0BE563ED515E
18:37:26.501 > [ESP32] Nonce: 0x00000001
18:37:26.501 > [ESP32] Packet size before HMAC: 61
18:37:26.507 > [ESP32] Computed HMAC Tag: 8E4C1A410FABD3682678968DA61DDE8F
18:37:26.512 > [ESP32] === END HMAC DEBUG ===
18:37:26.512 > 6_Final_Packet (61): 820218001800040804000000013F45C2 D65B268D81DE0C70DFDD0BE563ED515E ...
18:37:26.521 > [RETRY] Attempt 1/3 (nonce: 1)
18:37:26.523 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:26.529 > Sending pipeline data to server (659 bytes)
18:37:26.646 > [HTTP] Response code: 400
18:37:26.647 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:26.652 > [HTTP] Request failed with code: 400
18:37:26.654 > [RETRY] Send failed, waiting 100 ms before retry
18:37:26.754 > [RETRY] Attempt 2/3 (nonce: 1)
18:37:26.755 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:26.760 > Sending pipeline data to server (659 bytes)
18:37:26.900 > [HTTP] Response code: 400
18:37:26.900 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:26.905 > [HTTP] Request failed with code: 400
18:37:26.909 > [RETRY] Send failed, waiting 200 ms before retry
18:37:27.108 > [RETRY] Attempt 3/3 (nonce: 1)
18:37:27.108 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:27.114 > Sending pipeline data to server (659 bytes)
18:37:27.405 > [HTTP] Response code: 400
18:37:27.405 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:27.409 > [HTTP] Request failed with code: 400
18:37:27.412 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:37:27.418 > [RETRY] Consecutive failures: 2
18:37:27.420 > Health data send failed (retry count: 3/3)
18:37:27.423 > Health data transmission failed after max retries
18:37:27.527 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":355797,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:27.563 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:27.569 > [WebSocket] ========================================
18:37:27.574 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:27.580 > [WebSocket] ========================================
18:37:27.586 > [ZTM] Settings saved successfully
18:37:27.589 > [WebSocket] ✓ ZTM activated successfully
18:37:27.591 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:27.596 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:27.599 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:27.602 > [WebSocket] ========================================
18:37:27.607 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":359675,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:27.646 > [359.7] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:27.652 > ERROR state - attempting recovery
18:37:27.657 > [RETRY] Attempting to send health data (Max retries: 3)
18:37:27.660 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:37:27.666 > Generated health data: HR-65 SPO2-96 STEPS-1842
18:37:27.671 > [ESP32] ========================================
18:37:27.675 > [ESP32] ENCRYPTION PIPELINE START
18:37:27.677 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:37:27.683 > [ESP32] Active Algorithms for this packet:
18:37:27.685 > [ESP32]   + LFSR
18:37:27.688 > [ESP32]   + Tinkerbell
18:37:27.691 > [ESP32]   + Transposition
18:37:27.691 > [ESP32]   - ChaCha20
18:37:27.694 > [ESP32]   - Salsa20
18:37:27.697 > [ESP32] ========================================
18:37:27.699 > [ESP32] MsgKeys: lfsrSeed=0x598FD91D tnk[0..3]=5975E6F1 trn[0..3]=10141B9C
18:37:27.707 > 1_After_Salt (26): 48522D36352053504F322D3936205354 4550532D313834324D50
18:37:27.712 > 2_After_Padding (32): 48522D36352053504F322D3936205354 4550532D313834324D50000000000000 
18:37:27.721 > [ESP32][LFSR] Initializing - Seed: 0x598FD91D SeedBe: 0x1DD98F59 ChaosKey[0..3]: 5975E6F1 InitialTap: 0x0029 State: 0x598FD91D
18:37:27.733 > [ESP32][LFSR] Input (first 16 bytes): 48522D36352053504F322D3936205354 Buffer size: 32 bytes
18:37:27.741 > 3_After_LFSR (32): 558BA26FDB1FFF5E1D18F2DC8E96161B 7225AF537B37CCA8E04101896E4F7532 
18:37:27.746 > [ESP32][LFSR] Keystream (first 16 bytes): 1DD98F59EE3FAC0E522ADFE5B8B6454F
18:37:27.755 > [ESP32][4D] LFSR keystream (first 32 bytes): 1DD98F59EE3FAC0E522ADFE5B8B6454F3775FC7E4A0FF89AAD1101896E4F7532
18:37:27.763 > [ESP32][TINKERBELL] Input (first 16 bytes): 558BA26FDB1FFF5E1D18F2DC8E96161B Nonce: 0x00000001 Buffer size: 32 bytes
18:37:27.774 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 5975E6F1
18:37:27.783 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 3689D282E42FA4DF163E248DCBFD4F96
18:37:27.791 > 4_After_Tinkerbell (32): 630270ED3F305B810B26D651456B598D 98700CDDB65E4D26DE33DFC2E5F2E43A 
18:37:27.800 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 3689D282E42FA4DF163E248DCBFD4F96
18:37:27.808 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 3689D282E42FA4DF163E248DCBFD4F96EA55A38ECD69818E3E72DE4B8BBD9108
18:37:27.819 > 5_After_Transposition (32): 3F45C2D65B268D81DE0C70DFDD0BE563 ED515E3AB6334D70596B3098E402F226 
18:37:27.827 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:37:27.830 > [ESP32] === HMAC DEBUG INFO ===
18:37:27.833 > [ESP32] HMAC Key being used: 03CA86A2656E35D98D1EAE0A06FDDBE35B36C33128C1E2D9D55549CE5ECBEFA6
18:37:27.840 > [ESP32] HMAC Input length: 45 bytes
18:37:27.844 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000013F45C2D65B268D81DE0C70DFDD0BE563ED515E
18:37:27.854 > [ESP32] Nonce: 0x00000001
18:37:27.854 > [ESP32] Packet size before HMAC: 61
18:37:27.860 > [ESP32] Computed HMAC Tag: 32E3B5144E5E7B064F746A59E30F648C
18:37:27.866 > [ESP32] === END HMAC DEBUG ===
18:37:27.866 > 6_Final_Packet (61): 820218001800040804000000013F45C2 D65B268D81DE0C70DFDD0BE563ED515E ...
18:37:27.874 > [RETRY] Attempt 1/3 (nonce: 1)
18:37:27.877 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:27.882 > Sending pipeline data to server (659 bytes)
18:37:28.180 > [HTTP] Response code: 400
18:37:28.180 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:28.186 > [HTTP] Request failed with code: 400
18:37:28.188 > [RETRY] Send failed, waiting 100 ms before retry
18:37:28.288 > [RETRY] Attempt 2/3 (nonce: 1)
18:37:28.288 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:28.294 > Sending pipeline data to server (659 bytes)
18:37:28.420 > [HTTP] Response code: 400
18:37:28.420 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:28.426 > [HTTP] Request failed with code: 400
18:37:28.428 > [RETRY] Send failed, waiting 200 ms before retry
18:37:28.628 > [RETRY] Attempt 3/3 (nonce: 1)
18:37:28.629 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:28.633 > Sending pipeline data to server (659 bytes)
18:37:28.921 > [HTTP] Response code: 400
18:37:28.921 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:28.926 > [HTTP] Request failed with code: 400
18:37:28.929 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:37:28.934 > [RETRY] Consecutive failures: 3
18:37:28.936 > ✗ Auto-recovery failed - restarting key exchange
18:37:31.040 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":355832,"type":"ztm_activated"}
18:37:31.057 > [WebSocket] Processing message type: ztm_activated
18:37:31.059 > [363.1] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:31.067 > ✓ Public key loaded from NVS
18:37:31.166 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":356198,"type":"health_data_error"}
18:37:31.179 > [WebSocket] Processing message type: health_data_error
18:37:31.186 > [363.2] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:31.289 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":356474,"type":"health_data_error"}
18:37:31.303 > [WebSocket] Processing message type: health_data_error
18:37:31.308 > [363.4] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:31.317 > Generating fresh master key from entropy...
18:37:31.325 > Generated master key (32): 2CFD2B8FAF8787D694B4A55DB3A221D1 CC3D7508964E246F343DF27A7EF326C7 
18:37:31.331 > Using reduced master key (byte % 3) for NTRU encryption only
18:37:31.341 > NTRU encrypted master key (502): 0064005A00400067001600440006006C 00370003001E000C006D006E0021000E ...
18:37:31.349 > POST http://10.249.92.115:8081/master-key
18:37:31.673 > ✓ Master key exchange completed
18:37:31.776 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124044620,"threatLevel":0,"type":"heuristics_update"}
18:37:31.800 > [WebSocket] Processing message type: heuristics_update
18:37:31.806 > [363.9] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:31.814 > Loading master key from NVS and deriving symmetric keys...
18:37:31.818 > Loaded master key from NVS (32): 2CFD2B8FAF8787D694B4A55DB3A221D1 CC3D7508964E246F343DF27A7EF326C7 
18:37:31.828 > Derived HMAC key (32): 79A93D7ADEE2EC2AB631C4B92775471E 3E6F57C7B6EAC167C9F51B4D5A4A8E1C 
18:37:31.834 > Derived Tinkerbell key (16): 1CF72440C6EEE30E21CB98A324A453F2 
18:37:31.839 > Derived Transposition key (16): 7FF6EC180087C6F8C0E060D0FFE02AD8 
18:37:31.848 > ✓ Symmetric keys derived successfully
18:37:31.850 > Nonce tracker reset - new session started
18:37:32.345 > Waiting for server to process master key...
18:37:32.350 > ✓ Symmetric keys ready - starting health data transmission
18:37:32.452 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":356959,"type":"health_data_error"}
18:37:32.466 > [WebSocket] Processing message type: health_data_error
18:37:32.472 > [364.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:32.575 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":357465,"type":"health_data_error"}
18:37:32.589 > [WebSocket] Processing message type: health_data_error
18:37:32.595 > [364.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:32.698 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124045621,"threatLevel":0,"type":"heuristics_update"}
18:37:32.723 > [WebSocket] Processing message type: heuristics_update
18:37:32.728 > [364.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:32.830 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":357717,"type":"health_data_error"}
18:37:32.845 > [WebSocket] Processing message type: health_data_error
18:37:32.851 > [364.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:32.953 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":358219,"type":"health_data_error"}
18:37:32.967 > [WebSocket] Processing message type: health_data_error
18:37:32.972 > [365.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:33.075 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124046632,"threatLevel":0,"type":"heuristics_update"}
18:37:33.100 > [WebSocket] Processing message type: heuristics_update
18:37:33.105 > [365.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:33.208 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":358720,"type":"health_data_error"}
18:37:33.222 > [WebSocket] Processing message type: health_data_error
18:37:33.228 > [365.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:33.330 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":358974,"type":"health_data_error"}
18:37:33.344 > [WebSocket] Processing message type: health_data_error
18:37:33.349 > [365.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:33.452 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":359478,"type":"health_data_error"}
18:37:33.466 > [WebSocket] Processing message type: health_data_error
18:37:33.471 > [365.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:33.577 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":359675,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:33.613 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:33.618 > [WebSocket] ========================================
18:37:33.623 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:33.629 > [WebSocket] ========================================
18:37:33.635 > [ZTM] Settings saved successfully
18:37:33.638 > [WebSocket] ✓ ZTM activated successfully
18:37:33.641 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:33.646 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:33.649 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:33.652 > [WebSocket] ========================================
18:37:33.657 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":365724,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:33.696 > [365.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:33.802 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":8,"success":true,"timestamp":359709,"type":"ztm_activated"}
18:37:33.819 > [WebSocket] Processing message type: ztm_activated
18:37:33.821 > [365.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:33.925 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124047644,"threatLevel":0,"type":"heuristics_update"}
18:37:33.949 > [WebSocket] Processing message type: heuristics_update
18:37:33.956 > [366.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:34.058 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":360254,"type":"health_data_error"}
18:37:34.072 > [WebSocket] Processing message type: health_data_error
18:37:34.077 > [366.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:34.180 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":360494,"type":"health_data_error"}
18:37:34.194 > [WebSocket] Processing message type: health_data_error
18:37:34.200 > [366.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:34.302 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124048652,"threatLevel":0,"type":"heuristics_update"}
18:37:34.327 > [WebSocket] Processing message type: heuristics_update
18:37:34.333 > [366.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:34.437 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":360995,"type":"health_data_error"}
18:37:34.451 > [WebSocket] Processing message type: health_data_error
18:37:34.456 > [366.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:34.559 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124049665,"threatLevel":0,"type":"heuristics_update"}
18:37:34.584 > [WebSocket] Processing message type: heuristics_update
18:37:34.590 > [366.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:34.692 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124050676,"threatLevel":0,"type":"heuristics_update"}
18:37:34.716 > [WebSocket] Processing message type: heuristics_update
18:37:34.723 > [366.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:34.825 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770124051435,"type":"master_key_received"}
18:37:34.839 > [WebSocket] Processing message type: master_key_received
18:37:34.842 > [366.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:34.947 > [WebSocket] Received (176 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":363740,"type":"master_key_exchanged"}
18:37:34.963 > [WebSocket] Processing message type: master_key_exchanged
18:37:34.969 > [367.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:35.069 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124051686,"threatLevel":0,"type":"heuristics_update"}
18:37:35.093 > [WebSocket] Processing message type: heuristics_update
18:37:35.100 > [367.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:35.202 > [WebSocket] Received (168 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":364419,"type":"symmetric_keys_derived"}
18:37:35.219 > [WebSocket] Processing message type: symmetric_keys_derived
18:37:35.224 > [367.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:35.324 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124052702,"threatLevel":0,"type":"heuristics_update"}
18:37:35.350 > [WebSocket] Processing message type: heuristics_update
18:37:35.355 > [367.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:35.457 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":365724,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:35.492 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:35.498 > [WebSocket] ========================================
18:37:35.504 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:35.510 > [WebSocket] ========================================
18:37:35.514 > [ZTM] Settings saved successfully
18:37:35.518 > [WebSocket] ✓ ZTM activated successfully
18:37:35.520 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:35.527 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:35.529 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:35.532 > [WebSocket] ========================================
18:37:35.536 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":367604,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:35.576 > [367.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:35.682 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":365759,"type":"ztm_activated"}
18:37:35.699 > [WebSocket] Processing message type: ztm_activated
18:37:35.702 > [367.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:35.806 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124053712,"threatLevel":0,"type":"heuristics_update"}
18:37:35.830 > [WebSocket] Processing message type: heuristics_update
18:37:35.837 > [367.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:35.939 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124054724,"threatLevel":0,"type":"heuristics_update"}
18:37:35.964 > [WebSocket] Processing message type: heuristics_update
18:37:35.969 > [368.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:36.075 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":367604,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:36.110 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:36.116 > [WebSocket] ========================================
18:37:36.122 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:36.128 > [WebSocket] ========================================
18:37:36.133 > [ZTM] Settings saved successfully
18:37:36.135 > [WebSocket] ✓ ZTM activated successfully
18:37:36.138 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:36.144 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:36.146 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:36.149 > [WebSocket] ========================================
18:37:36.155 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":368222,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:36.194 > [368.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:36.300 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":367640,"type":"ztm_activated"}
18:37:36.316 > [WebSocket] Processing message type: ztm_activated
18:37:36.319 > [368.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:36.423 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124055726,"threatLevel":0,"type":"heuristics_update"}
18:37:36.448 > [WebSocket] Processing message type: heuristics_update
18:37:36.453 > [368.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:36.557 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":368222,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:36.592 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:36.598 > [WebSocket] ========================================
18:37:36.604 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:36.609 > [WebSocket] ========================================
18:37:36.615 > [ZTM] Settings saved successfully
18:37:36.617 > [WebSocket] ✓ ZTM activated successfully
18:37:36.621 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:36.626 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:36.628 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:36.631 > [WebSocket] ========================================
18:37:36.636 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":368704,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:36.675 > [368.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:36.781 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":368258,"type":"ztm_activated"}
18:37:36.798 > [WebSocket] Processing message type: ztm_activated
18:37:36.802 > [368.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:36.905 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":368704,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:36.942 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:36.947 > [WebSocket] ========================================
18:37:36.953 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:36.958 > [WebSocket] ========================================
18:37:36.964 > [ZTM] Settings saved successfully
18:37:36.967 > [WebSocket] ✓ ZTM activated successfully
18:37:36.969 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:36.975 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:36.978 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:36.981 > [WebSocket] ========================================
18:37:36.986 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":369053,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:37.025 > [369.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:37.131 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124056738,"threatLevel":0,"type":"heuristics_update"}
18:37:37.156 > [WebSocket] Processing message type: heuristics_update
18:37:37.162 > [369.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:37.267 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":368739,"type":"ztm_activated"}
18:37:37.283 > [WebSocket] Processing message type: ztm_activated
18:37:37.286 > [369.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:37.390 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":369053,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:37.425 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:37.432 > [WebSocket] ========================================
18:37:37.436 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:37.442 > [WebSocket] ========================================
18:37:37.448 > [ZTM] Settings saved successfully
18:37:37.451 > [WebSocket] ✓ ZTM activated successfully
18:37:37.454 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:37.459 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:37.462 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:37.465 > [WebSocket] ========================================
18:37:37.470 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":369537,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:37.509 > [369.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:37.617 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":369088,"type":"ztm_activated"}
18:37:37.634 > [WebSocket] Processing message type: ztm_activated
18:37:37.636 > [369.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:37.742 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":369537,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:37.778 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:37.783 > [WebSocket] ========================================
18:37:37.788 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:37.794 > [WebSocket] ========================================
18:37:37.799 > [ZTM] Settings saved successfully
18:37:37.803 > [WebSocket] ✓ ZTM activated successfully
18:37:37.805 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:37.810 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:37.813 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:37.816 > [WebSocket] ========================================
18:37:37.821 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":369889,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:37.861 > [369.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:37.966 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":369575,"type":"ztm_activated"}
18:37:37.983 > [WebSocket] Processing message type: ztm_activated
18:37:37.986 > [370.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:38.091 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124057752,"threatLevel":0,"type":"heuristics_update"}
18:37:38.115 > [WebSocket] Processing message type: heuristics_update
18:37:38.121 > [370.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:38.223 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":369889,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:38.259 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:38.265 > [WebSocket] ========================================
18:37:38.270 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:38.275 > [WebSocket] ========================================
18:37:38.281 > [ZTM] Settings saved successfully
18:37:38.284 > [WebSocket] ✓ ZTM activated successfully
18:37:38.287 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:38.292 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:38.295 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:38.298 > [WebSocket] ========================================
18:37:38.303 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":370370,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:38.342 > [370.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:38.448 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":369924,"type":"ztm_activated"}
18:37:38.464 > [WebSocket] Processing message type: ztm_activated
18:37:38.467 > [370.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:38.573 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":370370,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:38.609 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:38.614 > [WebSocket] ========================================
18:37:38.621 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:38.627 > [WebSocket] ========================================
18:37:38.632 > [ZTM] Settings saved successfully
18:37:38.635 > [WebSocket] ✓ ZTM activated successfully
18:37:38.638 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:38.643 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:38.645 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:38.648 > [WebSocket] ========================================
18:37:38.654 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":370721,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:38.693 > [370.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:38.798 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":370406,"type":"ztm_activated"}
18:37:38.815 > [WebSocket] Processing message type: ztm_activated
18:37:38.818 > [370.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:38.922 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":370721,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:38.958 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:38.964 > [WebSocket] ========================================
18:37:38.969 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:38.975 > [WebSocket] ========================================
18:37:38.981 > [ZTM] Settings saved successfully
18:37:38.983 > [WebSocket] ✓ ZTM activated successfully
18:37:38.986 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:38.992 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:38.995 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:38.997 > [WebSocket] ========================================
18:37:39.003 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":371070,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:39.042 > [371.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:39.147 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":370756,"type":"ztm_activated"}
18:37:39.164 > [WebSocket] Processing message type: ztm_activated
18:37:39.167 > [371.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:39.271 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124058760,"threatLevel":0,"type":"heuristics_update"}
18:37:39.297 > [WebSocket] Processing message type: heuristics_update
18:37:39.302 > [371.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:39.404 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":371070,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:39.440 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:39.445 > [WebSocket] ========================================
18:37:39.450 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:39.457 > [WebSocket] ========================================
18:37:39.462 > [ZTM] Settings saved successfully
18:37:39.464 > [WebSocket] ✓ ZTM activated successfully
18:37:39.467 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:39.472 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:39.476 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:39.478 > [WebSocket] ========================================
18:37:39.484 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":371551,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:39.523 > [371.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:39.632 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":371105,"type":"ztm_activated"}
18:37:39.648 > [WebSocket] Processing message type: ztm_activated
18:37:39.651 > [371.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:39.758 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":371551,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:39.794 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:39.798 > [WebSocket] ========================================
18:37:39.804 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:39.810 > [WebSocket] ========================================
18:37:39.816 > [ZTM] Settings saved successfully
18:37:39.818 > [WebSocket] ✓ ZTM activated successfully
18:37:39.822 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:39.826 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:39.830 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:39.833 > [WebSocket] ========================================
18:37:39.838 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":371905,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:39.877 > [371.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:39.982 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":371587,"type":"ztm_activated"}
18:37:40.000 > [WebSocket] Processing message type: ztm_activated
18:37:40.002 > [372.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:40.106 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124059769,"threatLevel":0,"type":"heuristics_update"}
18:37:40.131 > [WebSocket] Processing message type: heuristics_update
18:37:40.137 > [372.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:40.239 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":371905,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:40.275 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:40.281 > [WebSocket] ========================================
18:37:40.286 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:40.292 > [WebSocket] ========================================
18:37:40.297 > [ZTM] Settings saved successfully
18:37:40.300 > [WebSocket] ✓ ZTM activated successfully
18:37:40.302 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:40.308 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:40.310 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:40.314 > [WebSocket] ========================================
18:37:40.319 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":372386,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:40.359 > [372.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:40.464 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":371940,"type":"ztm_activated"}
18:37:40.481 > [WebSocket] Processing message type: ztm_activated
18:37:40.484 > [372.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:40.588 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":372386,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:40.625 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:40.629 > [WebSocket] ========================================
18:37:40.636 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:40.641 > [WebSocket] ========================================
18:37:40.646 > [ZTM] Settings saved successfully
18:37:40.650 > [WebSocket] ✓ ZTM activated successfully
18:37:40.652 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:40.658 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:40.660 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:40.663 > [WebSocket] ========================================
18:37:40.668 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":372736,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:40.707 > [372.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:40.815 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":372422,"type":"ztm_activated"}
18:37:40.831 > [WebSocket] Processing message type: ztm_activated
18:37:40.834 > [372.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:40.941 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":372736,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:40.977 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:40.982 > [WebSocket] ========================================
18:37:40.988 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:40.992 > [WebSocket] ========================================
18:37:40.998 > [ZTM] Settings saved successfully
18:37:41.002 > [WebSocket] ✓ ZTM activated successfully
18:37:41.004 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:41.009 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:41.013 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:41.015 > [WebSocket] ========================================
18:37:41.020 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":373088,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:41.060 > [373.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:41.167 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":372771,"type":"ztm_activated"}
18:37:41.184 > [WebSocket] Processing message type: ztm_activated
18:37:41.188 > [373.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:41.290 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124060777,"threatLevel":0,"type":"heuristics_update"}
18:37:41.315 > [WebSocket] Processing message type: heuristics_update
18:37:41.321 > [373.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:41.423 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":373088,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:41.460 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:41.465 > [WebSocket] ========================================
18:37:41.471 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:41.477 > [WebSocket] ========================================
18:37:41.482 > [ZTM] Settings saved successfully
18:37:41.484 > [WebSocket] ✓ ZTM activated successfully
18:37:41.488 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:41.493 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:41.496 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:41.499 > [WebSocket] ========================================
18:37:41.504 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":373571,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:41.543 > [373.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:41.652 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":373123,"type":"ztm_activated"}
18:37:41.668 > [WebSocket] Processing message type: ztm_activated
18:37:41.671 > [373.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:41.774 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":373571,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:41.811 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:41.817 > [WebSocket] ========================================
18:37:41.822 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:41.828 > [WebSocket] ========================================
18:37:41.833 > [ZTM] Settings saved successfully
18:37:41.836 > [WebSocket] ✓ ZTM activated successfully
18:37:41.838 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:41.844 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:41.847 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:41.849 > [WebSocket] ========================================
18:37:41.855 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":373922,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:41.894 > [374.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:42.001 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":373607,"type":"ztm_activated"}
18:37:42.017 > [WebSocket] Processing message type: ztm_activated
18:37:42.021 > [374.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:42.124 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124061783,"threatLevel":0,"type":"heuristics_update"}
18:37:42.148 > [WebSocket] Processing message type: heuristics_update
18:37:42.154 > [374.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:42.257 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":373922,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:42.293 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:42.298 > [WebSocket] ========================================
18:37:42.304 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:42.309 > [WebSocket] ========================================
18:37:42.315 > [ZTM] Settings saved successfully
18:37:42.317 > [WebSocket] ✓ ZTM activated successfully
18:37:42.321 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:42.326 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:42.329 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:42.331 > [WebSocket] ========================================
18:37:42.336 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":374404,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:42.376 > [374.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:42.384 > [RETRY] Attempting to send health data (Max retries: 3)
18:37:42.390 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:37:42.393 > Generated health data: HR-66 SPO2-96 STEPS-1905
18:37:42.398 > [ESP32] ========================================
18:37:42.401 > [ESP32] ENCRYPTION PIPELINE START
18:37:42.404 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:37:42.409 > [ESP32] Active Algorithms for this packet:
18:37:42.415 > [ESP32]   + LFSR
18:37:42.415 > [ESP32]   + Tinkerbell
18:37:42.417 > [ESP32]   + Transposition
18:37:42.420 > [ESP32]   - ChaCha20
18:37:42.420 > [ESP32]   - Salsa20
18:37:42.423 > [ESP32] ========================================
18:37:42.429 > [ESP32] MsgKeys: lfsrSeed=0xB64960B5 tnk[0..3]=BF06CB20 trn[0..3]=52CD1C6B
18:37:42.434 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313930354D50
18:37:42.440 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313930354D50000000000000 
18:37:42.448 > [ESP32][LFSR] Initializing - Seed: 0xB64960B5 SeedBe: 0xB56049B6 ChaosKey[0..3]: BF06CB20 InitialTap: 0x0029 State: 0xB64960B5
18:37:42.459 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
18:37:42.468 > 3_After_LFSR (32): FD326480A55C73B9070633DCFF61CE51 CA4032C967291F720CDA969EB48F5305 
18:37:42.476 > [ESP32][LFSR] Keystream (first 16 bytes): B56049B6937C20E948341EE5C9419D05
18:37:42.482 > [ESP32][4D] LFSR keystream (first 32 bytes): B56049B6937C20E948341EE5C9419D058F1061E456102F47418A969EB48F5305
18:37:42.490 > [ESP32][TINKERBELL] Input (first 16 bytes): FD326480A55C73B9070633DCFF61CE51 Nonce: 0x00000001 Buffer size: 32 bytes
18:37:42.501 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: BF06CB20
18:37:42.513 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 205B84382FAA5D27EC372FA6AE175ABA
18:37:42.521 > 4_After_Tinkerbell (32): DD69E0B88AF62E9EEB311C7A517694EB 64D0D6156946EB00B73019CBD774A992 
18:37:42.527 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 205B84382FAA5D27EC372FA6AE175ABA
18:37:42.534 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 205B84382FAA5D27EC372FA6AE175ABAAE90E4DC0E6FF472BBEA8F5563FBFA97
18:37:42.546 > 5_After_Transposition (32): B8E09E2EF68AEB317A1CEB94765164D0 15D600EB4669DD69A992CB19D774B730 
18:37:42.554 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:37:42.560 > [ESP32] === HMAC DEBUG INFO ===
18:37:42.562 > [ESP32] HMAC Key being used: 79A93D7ADEE2EC2AB631C4B92775471E3E6F57C7B6EAC167C9F51B4D5A4A8E1C
18:37:42.571 > [ESP32] HMAC Input length: 45 bytes
18:37:42.574 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001B8E09E2EF68AEB317A1CEB94765164D015D600
18:37:42.582 > [ESP32] Nonce: 0x00000001
18:37:42.584 > [ESP32] Packet size before HMAC: 61
18:37:42.586 > [ESP32] Computed HMAC Tag: F773ACA3DD299D195A4919CD01BB5562
18:37:42.593 > [ESP32] === END HMAC DEBUG ===
18:37:42.596 > 6_Final_Packet (61): 82021800180004080400000001B8E09E 2EF68AEB317A1CEB94765164D015D600 ...
18:37:42.604 > [RETRY] Attempt 1/3 (nonce: 1)
18:37:42.606 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:42.612 > Sending pipeline data to server (659 bytes)
18:37:42.974 > [HTTP] Response code: 400
18:37:42.974 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:42.979 > [HTTP] Request failed with code: 400
18:37:42.982 > [RETRY] Send failed, waiting 100 ms before retry
18:37:43.081 > [RETRY] Attempt 2/3 (nonce: 1)
18:37:43.082 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:43.087 > Sending pipeline data to server (659 bytes)
18:37:43.222 > [HTTP] Response code: 400
18:37:43.222 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:43.228 > [HTTP] Request failed with code: 400
18:37:43.230 > [RETRY] Send failed, waiting 200 ms before retry
18:37:43.430 > [RETRY] Attempt 3/3 (nonce: 1)
18:37:43.430 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:43.435 > Sending pipeline data to server (659 bytes)
18:37:43.728 > [HTTP] Response code: 400
18:37:43.728 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:43.732 > [HTTP] Request failed with code: 400
18:37:43.735 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:37:43.741 > [RETRY] Consecutive failures: 4
18:37:43.743 > Health data send failed (retry count: 1/3)
18:37:43.846 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":373958,"type":"ztm_activated"}
18:37:43.863 > [WebSocket] Processing message type: ztm_activated
18:37:43.866 > [375.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:43.875 > [RETRY] Attempting to send health data (Max retries: 3)
18:37:43.880 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:37:43.886 > Generated health data: HR-66 SPO2-96 STEPS-1876
18:37:43.888 > [ESP32] ========================================
18:37:43.894 > [ESP32] ENCRYPTION PIPELINE START
18:37:43.897 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:37:43.905 > [ESP32] Active Algorithms for this packet:
18:37:43.905 > [ESP32]   + LFSR
18:37:43.930 > [ESP32]   + Tinkerbell
18:37:43.930 > [ESP32]   + Transposition
18:37:43.930 > [ESP32]   - ChaCha20
18:37:43.930 > [ESP32]   - Salsa20
18:37:43.930 > [ESP32] ========================================
18:37:43.930 > [ESP32] MsgKeys: lfsrSeed=0xB64960B5 tnk[0..3]=BF06CB20 trn[0..3]=52CD1C6B
18:37:43.930 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313837364D50
18:37:43.935 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313837364D50000000000000 
18:37:43.938 > [ESP32][LFSR] Initializing - Seed: 0xB64960B5 SeedBe: 0xB56049B6 ChaosKey[0..3]: BF06CB20 InitialTap: 0x0029 State: 0xB64960B5
18:37:43.950 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
18:37:43.958 > 3_After_LFSR (32): FD326480A55C73B9070633DCFF61CE51 CA4032C9672818710CDA969EB48F5305 
18:37:43.966 > [ESP32][LFSR] Keystream (first 16 bytes): B56049B6937C20E948341EE5C9419D05
18:37:43.971 > [ESP32][4D] LFSR keystream (first 32 bytes): B56049B6937C20E948341EE5C9419D058F1061E456102F47418A969EB48F5305
18:37:43.982 > [ESP32][TINKERBELL] Input (first 16 bytes): FD326480A55C73B9070633DCFF61CE51 Nonce: 0x00000001 Buffer size: 32 bytes
18:37:43.994 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: BF06CB20
18:37:44.002 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 205B84382FAA5D27EC372FA6AE175ABA
18:37:44.011 > 4_After_Tinkerbell (32): DD69E0B88AF62E9EEB311C7A517694EB 64D0D6156947EC03B73019CBD774A992 
18:37:44.019 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 205B84382FAA5D27EC372FA6AE175ABA
18:37:44.027 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 205B84382FAA5D27EC372FA6AE175ABAAE90E4DC0E6FF472BBEA8F5563FBFA97
18:37:44.035 > 5_After_Transposition (32): B8E09E2EF68AEB317A1CEB94765164D0 15D603EC4769DD69A992CB19D774B730 
18:37:44.044 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:37:44.049 > [ESP32] === HMAC DEBUG INFO ===
18:37:44.052 > [ESP32] HMAC Key being used: 79A93D7ADEE2EC2AB631C4B92775471E3E6F57C7B6EAC167C9F51B4D5A4A8E1C
18:37:44.060 > [ESP32] HMAC Input length: 45 bytes
18:37:44.063 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001B8E09E2EF68AEB317A1CEB94765164D015D603
18:37:44.072 > [ESP32] Nonce: 0x00000001
18:37:44.074 > [ESP32] Packet size before HMAC: 61
18:37:44.077 > [ESP32] Computed HMAC Tag: 11DDBD246E760C9A32F56230E1808AF0
18:37:44.083 > [ESP32] === END HMAC DEBUG ===
18:37:44.085 > 6_Final_Packet (61): 82021800180004080400000001B8E09E 2EF68AEB317A1CEB94765164D015D603 ...
18:37:44.094 > [RETRY] Attempt 1/3 (nonce: 1)
18:37:44.096 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:44.102 > Sending pipeline data to server (659 bytes)
18:37:44.261 > [HTTP] Response code: 400
18:37:44.261 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:44.266 > [HTTP] Request failed with code: 400
18:37:44.269 > [RETRY] Send failed, waiting 100 ms before retry
18:37:44.369 > [RETRY] Attempt 2/3 (nonce: 1)
18:37:44.370 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:44.375 > Sending pipeline data to server (659 bytes)
18:37:44.481 > [HTTP] Response code: 400
18:37:44.482 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:44.487 > [HTTP] Request failed with code: 400
18:37:44.490 > [RETRY] Send failed, waiting 200 ms before retry
18:37:44.688 > [RETRY] Attempt 3/3 (nonce: 1)
18:37:44.689 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:44.695 > Sending pipeline data to server (659 bytes)
18:37:44.986 > [HTTP] Response code: 400
18:37:44.986 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:44.991 > [HTTP] Request failed with code: 400
18:37:44.994 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:37:44.999 > [RETRY] Consecutive failures: 5
18:37:45.002 > [EMERGENCY] Triggering emergency reset!
18:37:45.005 > [CRYPTO] Resetting cryptographic state
18:37:45.011 > [CRYPTO] Crypto state reset complete
18:37:45.014 > [CRYPTO] Packet counter: 8
18:37:45.016 > [EMERGENCY] Emergency reset complete
18:37:45.019 > Health data send failed (retry count: 2/3)
18:37:45.119 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":374404,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:45.155 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:45.161 > [WebSocket] ========================================
18:37:45.166 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:45.172 > [WebSocket] ========================================
18:37:45.177 > [ZTM] Settings saved successfully
18:37:45.180 > [WebSocket] ✓ ZTM activated successfully
18:37:45.183 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:45.188 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:45.191 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:45.194 > [WebSocket] ========================================
18:37:45.199 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":377267,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:45.238 > [377.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:45.246 > [RETRY] Attempting to send health data (Max retries: 3)
18:37:45.252 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:37:45.255 > Generated health data: HR-66 SPO2-96 STEPS-1933
18:37:45.260 > [ESP32] ========================================
18:37:45.262 > [ESP32] ENCRYPTION PIPELINE START
18:37:45.265 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:37:45.271 > [ESP32] Active Algorithms for this packet:
18:37:45.276 > [ESP32]   + LFSR
18:37:45.276 > [ESP32]   + Tinkerbell
18:37:45.280 > [ESP32]   + Transposition
18:37:45.282 > [ESP32]   - ChaCha20
18:37:45.282 > [ESP32]   - Salsa20
18:37:45.285 > [ESP32] ========================================
18:37:45.291 > [ESP32] MsgKeys: lfsrSeed=0xB64960B5 tnk[0..3]=BF06CB20 trn[0..3]=52CD1C6B
18:37:45.297 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313933334D50
18:37:45.302 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313933334D50000000000000 
18:37:45.310 > [ESP32][LFSR] Initializing - Seed: 0xB64960B5 SeedBe: 0xB56049B6 ChaosKey[0..3]: BF06CB20 InitialTap: 0x0029 State: 0xB64960B5
18:37:45.321 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
18:37:45.330 > 3_After_LFSR (32): FD326480A55C73B9070633DCFF61CE51 CA4032C967291C740CDA969EB48F5305 
18:37:45.338 > [ESP32][LFSR] Keystream (first 16 bytes): B56049B6937C20E948341EE5C9419D05
18:37:45.343 > [ESP32][4D] LFSR keystream (first 32 bytes): B56049B6937C20E948341EE5C9419D058F1061E456102F47418A969EB48F5305
18:37:45.352 > [ESP32][TINKERBELL] Input (first 16 bytes): FD326480A55C73B9070633DCFF61CE51 Nonce: 0x00000001 Buffer size: 32 bytes
18:37:45.363 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: BF06CB20
18:37:45.374 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 205B84382FAA5D27EC372FA6AE175ABA
18:37:45.382 > 4_After_Tinkerbell (32): DD69E0B88AF62E9EEB311C7A517694EB 64D0D6156946E806B73019CBD774A992 
18:37:45.388 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 205B84382FAA5D27EC372FA6AE175ABA
18:37:45.396 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 205B84382FAA5D27EC372FA6AE175ABAAE90E4DC0E6FF472BBEA8F5563FBFA97
18:37:45.408 > 5_After_Transposition (32): B8E09E2EF68AEB317A1CEB94765164D0 15D606E84669DD69A992CB19D774B730 
18:37:45.415 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:37:45.422 > [ESP32] === HMAC DEBUG INFO ===
18:37:45.424 > [ESP32] HMAC Key being used: 79A93D7ADEE2EC2AB631C4B92775471E3E6F57C7B6EAC167C9F51B4D5A4A8E1C
18:37:45.432 > [ESP32] HMAC Input length: 45 bytes
18:37:45.435 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001B8E09E2EF68AEB317A1CEB94765164D015D606
18:37:45.443 > [ESP32] Nonce: 0x00000001
18:37:45.447 > [ESP32] Packet size before HMAC: 61
18:37:45.449 > [ESP32] Computed HMAC Tag: 5B94DB340421854A9816F8B3F11CA858
18:37:45.455 > [ESP32] === END HMAC DEBUG ===
18:37:45.458 > 6_Final_Packet (61): 82021800180004080400000001B8E09E 2EF68AEB317A1CEB94765164D015D606 ...
18:37:45.466 > [RETRY] Attempt 1/3 (nonce: 1)
18:37:45.469 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:45.474 > Sending pipeline data to server (659 bytes)
18:37:45.741 > [HTTP] Response code: 400
18:37:45.742 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:45.747 > [HTTP] Request failed with code: 400
18:37:45.749 > [RETRY] Send failed, waiting 100 ms before retry
18:37:45.848 > [RETRY] Attempt 2/3 (nonce: 1)
18:37:45.849 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:45.854 > Sending pipeline data to server (659 bytes)
18:37:45.991 > [HTTP] Response code: 400
18:37:45.991 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:45.996 > [HTTP] Request failed with code: 400
18:37:45.998 > [RETRY] Send failed, waiting 200 ms before retry
18:37:46.199 > [RETRY] Attempt 3/3 (nonce: 1)
18:37:46.199 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:46.204 > Sending pipeline data to server (659 bytes)
18:37:46.497 > [HTTP] Response code: 400
18:37:46.497 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:46.502 > [HTTP] Request failed with code: 400
18:37:46.505 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:37:46.511 > [RETRY] Consecutive failures: 1
18:37:46.513 > Health data send failed (retry count: 3/3)
18:37:46.516 > Health data transmission failed after max retries
18:37:46.617 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":374440,"type":"ztm_activated"}
18:37:46.634 > [WebSocket] Processing message type: ztm_activated
18:37:46.636 > [378.7] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:46.644 > ERROR state - attempting recovery
18:37:46.647 > [RETRY] Attempting to send health data (Max retries: 3)
18:37:46.653 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:37:46.656 > Generated health data: HR-66 SPO2-96 STEPS-1923
18:37:46.661 > [ESP32] ========================================
18:37:46.667 > [ESP32] ENCRYPTION PIPELINE START
18:37:46.669 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:37:46.672 > [ESP32] Active Algorithms for this packet:
18:37:46.678 > [ESP32]   + LFSR
18:37:46.678 > [ESP32]   + Tinkerbell
18:37:46.681 > [ESP32]   + Transposition
18:37:46.684 > [ESP32]   - ChaCha20
18:37:46.686 > [ESP32]   - Salsa20
18:37:46.686 > [ESP32] ========================================
18:37:46.692 > [ESP32] MsgKeys: lfsrSeed=0xB64960B5 tnk[0..3]=BF06CB20 trn[0..3]=52CD1C6B
18:37:46.697 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313932334D50
18:37:46.703 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313932334D50000000000000 
18:37:46.711 > [ESP32][LFSR] Initializing - Seed: 0xB64960B5 SeedBe: 0xB56049B6 ChaosKey[0..3]: BF06CB20 InitialTap: 0x0029 State: 0xB64960B5
18:37:46.723 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
18:37:46.731 > 3_After_LFSR (32): FD326480A55C73B9070633DCFF61CE51 CA4032C967291D740CDA969EB48F5305 
18:37:46.739 > [ESP32][LFSR] Keystream (first 16 bytes): B56049B6937C20E948341EE5C9419D05
18:37:46.745 > [ESP32][4D] LFSR keystream (first 32 bytes): B56049B6937C20E948341EE5C9419D058F1061E456102F47418A969EB48F5305
18:37:46.755 > [ESP32][TINKERBELL] Input (first 16 bytes): FD326480A55C73B9070633DCFF61CE51 Nonce: 0x00000001 Buffer size: 32 bytes
18:37:46.763 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: BF06CB20
18:37:46.775 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 205B84382FAA5D27EC372FA6AE175ABA
18:37:46.783 > 4_After_Tinkerbell (32): DD69E0B88AF62E9EEB311C7A517694EB 64D0D6156946E906B73019CBD774A992 
18:37:46.792 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 205B84382FAA5D27EC372FA6AE175ABA
18:37:46.800 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 205B84382FAA5D27EC372FA6AE175ABAAE90E4DC0E6FF472BBEA8F5563FBFA97
18:37:46.808 > 5_After_Transposition (32): B8E09E2EF68AEB317A1CEB94765164D0 15D606E94669DD69A992CB19D774B730 
18:37:46.817 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:37:46.822 > [ESP32] === HMAC DEBUG INFO ===
18:37:46.825 > [ESP32] HMAC Key being used: 79A93D7ADEE2EC2AB631C4B92775471E3E6F57C7B6EAC167C9F51B4D5A4A8E1C
18:37:46.833 > [ESP32] HMAC Input length: 45 bytes
18:37:46.836 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000001B8E09E2EF68AEB317A1CEB94765164D015D606
18:37:46.844 > [ESP32] Nonce: 0x00000001
18:37:46.847 > [ESP32] Packet size before HMAC: 61
18:37:46.850 > [ESP32] Computed HMAC Tag: 179471CD99D06AC87F76E7F98D104CAB
18:37:46.855 > [ESP32] === END HMAC DEBUG ===
18:37:46.858 > 6_Final_Packet (61): 82021800180004080400000001B8E09E 2EF68AEB317A1CEB94765164D015D606 ...
18:37:46.866 > [RETRY] Attempt 1/3 (nonce: 1)
18:37:46.870 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:46.874 > Sending pipeline data to server (659 bytes)
18:37:47.005 > [HTTP] Response code: 400
18:37:47.005 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:47.011 > [HTTP] Request failed with code: 400
18:37:47.014 > [RETRY] Send failed, waiting 100 ms before retry
18:37:47.114 > [RETRY] Attempt 2/3 (nonce: 1)
18:37:47.114 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:47.120 > Sending pipeline data to server (659 bytes)
18:37:47.259 > [HTTP] Response code: 400
18:37:47.259 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:47.264 > [HTTP] Request failed with code: 400
18:37:47.267 > [RETRY] Send failed, waiting 200 ms before retry
18:37:47.466 > [RETRY] Attempt 3/3 (nonce: 1)
18:37:47.468 > POST http://10.249.92.115:8081/health-data with pipeline data
18:37:47.473 > Sending pipeline data to server (659 bytes)
18:37:47.760 > [HTTP] Response code: 400
18:37:47.760 > [HTTP] Error response: {"error":"Decryption failed"}
18:37:47.766 > [HTTP] Request failed with code: 400
18:37:47.769 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:37:47.774 > [RETRY] Consecutive failures: 2
18:37:47.777 > ✗ Auto-recovery failed - restarting key exchange
18:37:49.880 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124062785,"threatLevel":0,"type":"heuristics_update"}
18:37:49.904 > [WebSocket] Processing message type: heuristics_update
18:37:49.910 > [382.0] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:49.918 > ✓ Public key loaded from NVS
18:37:50.017 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":375048,"type":"health_data_error"}
18:37:50.030 > [WebSocket] Processing message type: health_data_error
18:37:50.036 > [382.1] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:50.139 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":375297,"type":"health_data_error"}
18:37:50.153 > [WebSocket] Processing message type: health_data_error
18:37:50.159 > [382.2] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:50.167 > Generating fresh master key from entropy...
18:37:50.176 > Generated master key (32): EBA2F90CFCE06563EBC3A9A32704AA57 AA9903C2230F664D9F6BE97E1A26D01B 
18:37:50.181 > Using reduced master key (byte % 3) for NTRU encryption only
18:37:50.192 > NTRU encrypted master key (502): 00630059003F0065001500460008006B 00370003001F000D006B006F0023000C ...
18:37:50.200 > POST http://10.249.92.115:8081/master-key
18:37:50.520 > ✓ Master key exchange completed
18:37:50.623 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":375801,"type":"health_data_error"}
18:37:50.636 > [WebSocket] Processing message type: health_data_error
18:37:50.642 > [382.7] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:50.650 > Loading master key from NVS and deriving symmetric keys...
18:37:50.655 > Loaded master key from NVS (32): EBA2F90CFCE06563EBC3A9A32704AA57 AA9903C2230F664D9F6BE97E1A26D01B 
18:37:50.664 > Derived HMAC key (32): E5172C685CEC28B6F36C34D3E1608FE8 66116DE9A66203124F5F0DFC21D4EE46 
18:37:50.672 > Derived Tinkerbell key (16): DDAC99972ECAB654DDE39E245FF66706 
18:37:50.678 > Derived Transposition key (16): 4C7FC3940969A5AEE7D97956A3C4623F 
18:37:50.683 > ✓ Symmetric keys derived successfully
18:37:50.686 > Nonce tracker reset - new session started
18:37:51.181 > Waiting for server to process master key...
18:37:51.185 > ✓ Symmetric keys ready - starting health data transmission
18:37:51.288 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124063796,"threatLevel":0,"type":"heuristics_update"}
18:37:51.313 > [WebSocket] Processing message type: heuristics_update
18:37:51.318 > [383.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:51.422 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":376335,"type":"health_data_error"}
18:37:51.435 > [WebSocket] Processing message type: health_data_error
18:37:51.441 > [383.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:51.543 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":376556,"type":"health_data_error"}
18:37:51.558 > [WebSocket] Processing message type: health_data_error
18:37:51.563 > [383.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:51.666 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124064796,"threatLevel":0,"type":"heuristics_update"}
18:37:51.691 > [WebSocket] Processing message type: heuristics_update
18:37:51.696 > [383.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:51.798 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":377060,"type":"health_data_error"}
18:37:51.812 > [WebSocket] Processing message type: health_data_error
18:37:51.817 > [383.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:51.920 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":377267,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:51.957 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:51.962 > [WebSocket] ========================================
18:37:51.967 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:51.973 > [WebSocket] ========================================
18:37:51.979 > [ZTM] Settings saved successfully
18:37:51.982 > [WebSocket] ✓ ZTM activated successfully
18:37:51.984 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:51.989 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:51.993 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:51.995 > [WebSocket] ========================================
18:37:52.000 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":384068,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:52.039 > [384.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:52.147 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":377302,"type":"ztm_activated"}
18:37:52.163 > [WebSocket] Processing message type: ztm_activated
18:37:52.167 > [384.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:52.270 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":377816,"type":"health_data_error"}
18:37:52.283 > [WebSocket] Processing message type: health_data_error
18:37:52.289 > [384.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:52.392 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124065810,"threatLevel":0,"type":"heuristics_update"}
18:37:52.416 > [WebSocket] Processing message type: heuristics_update
18:37:52.422 > [384.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:52.525 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":378065,"type":"health_data_error"}
18:37:52.538 > [WebSocket] Processing message type: health_data_error
18:37:52.544 > [384.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:52.647 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":378572,"type":"health_data_error"}
18:37:52.661 > [WebSocket] Processing message type: health_data_error
18:37:52.666 > [384.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:52.769 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124066820,"threatLevel":0,"type":"heuristics_update"}
18:37:52.794 > [WebSocket] Processing message type: heuristics_update
18:37:52.799 > [384.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:52.901 > [385.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:53.002 > [385.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:53.102 > [385.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:53.204 > [385.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:53.304 > [385.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:53.405 > [385.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:53.507 > [385.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:53.608 > [385.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:53.709 > [385.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:53.809 > [385.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:53.911 > [386.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:54.012 > [386.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:54.116 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":379080,"type":"health_data_error"}
18:37:54.129 > [WebSocket] Processing message type: health_data_error
18:37:54.136 > [386.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:54.238 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":379334,"type":"health_data_error"}
18:37:54.252 > [WebSocket] Processing message type: health_data_error
18:37:54.257 > [386.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:54.360 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":379835,"type":"health_data_error"}
18:37:54.374 > [WebSocket] Processing message type: health_data_error
18:37:54.380 > [386.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:54.482 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124067833,"threatLevel":0,"type":"heuristics_update"}
18:37:54.507 > [WebSocket] Processing message type: heuristics_update
18:37:54.512 > [386.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:54.616 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124068846,"threatLevel":0,"type":"heuristics_update"}
18:37:54.640 > [WebSocket] Processing message type: heuristics_update
18:37:54.645 > [386.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:54.748 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124069860,"threatLevel":0,"type":"heuristics_update"}
18:37:54.773 > [WebSocket] Processing message type: heuristics_update
18:37:54.779 > [386.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:54.881 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770124070326,"type":"master_key_received"}
18:37:54.895 > [WebSocket] Processing message type: master_key_received
18:37:54.897 > [387.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:55.003 > [WebSocket] Received (176 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":382587,"type":"master_key_exchanged"}
18:37:55.020 > [WebSocket] Processing message type: master_key_exchanged
18:37:55.026 > [387.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:55.127 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124070864,"threatLevel":0,"type":"heuristics_update"}
18:37:55.151 > [WebSocket] Processing message type: heuristics_update
18:37:55.157 > [387.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:55.260 > [WebSocket] Received (168 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":383256,"type":"symmetric_keys_derived"}
18:37:55.275 > [WebSocket] Processing message type: symmetric_keys_derived
18:37:55.281 > [387.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:55.381 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124071868,"threatLevel":0,"type":"heuristics_update"}
18:37:55.406 > [WebSocket] Processing message type: heuristics_update
18:37:55.412 > [387.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:55.514 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":384068,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:55.550 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:55.556 > [WebSocket] ========================================
18:37:55.562 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:55.567 > [WebSocket] ========================================
18:37:55.573 > [ZTM] Settings saved successfully
18:37:55.576 > [WebSocket] ✓ ZTM activated successfully
18:37:55.578 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:55.584 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:55.586 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:55.589 > [WebSocket] ========================================
18:37:55.595 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":387662,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:55.633 > [387.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:55.741 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":384104,"type":"ztm_activated"}
18:37:55.758 > [WebSocket] Processing message type: ztm_activated
18:37:55.760 > [387.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:55.865 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124072882,"threatLevel":0,"type":"heuristics_update"}
18:37:55.890 > [WebSocket] Processing message type: heuristics_update
18:37:55.896 > [388.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:55.997 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124073895,"threatLevel":0,"type":"heuristics_update"}
18:37:56.022 > [WebSocket] Processing message type: heuristics_update
18:37:56.028 > [388.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:56.130 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124074903,"threatLevel":0,"type":"heuristics_update"}
18:37:56.155 > [WebSocket] Processing message type: heuristics_update
18:37:56.160 > [388.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:56.263 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":387662,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:56.299 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:56.305 > [WebSocket] ========================================
18:37:56.311 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:56.316 > [WebSocket] ========================================
18:37:56.322 > [ZTM] Settings saved successfully
18:37:56.325 > [WebSocket] ✓ ZTM activated successfully
18:37:56.327 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:56.333 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:56.335 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:56.338 > [WebSocket] ========================================
18:37:56.343 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":388411,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:56.383 > [388.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:56.489 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":387700,"type":"ztm_activated"}
18:37:56.506 > [WebSocket] Processing message type: ztm_activated
18:37:56.508 > [388.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:56.615 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124075914,"threatLevel":0,"type":"heuristics_update"}
18:37:56.640 > [WebSocket] Processing message type: heuristics_update
18:37:56.645 > [388.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:56.747 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":388411,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:56.784 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:56.789 > [WebSocket] ========================================
18:37:56.795 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:56.800 > [WebSocket] ========================================
18:37:56.805 > [ZTM] Settings saved successfully
18:37:56.808 > [WebSocket] ✓ ZTM activated successfully
18:37:56.811 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:56.817 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:56.819 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:56.822 > [WebSocket] ========================================
18:37:56.828 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":388895,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:56.867 > [388.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:56.973 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":388447,"type":"ztm_activated"}
18:37:56.989 > [WebSocket] Processing message type: ztm_activated
18:37:56.992 > [389.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:57.096 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":388895,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:57.133 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:57.138 > [WebSocket] ========================================
18:37:57.144 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:57.150 > [WebSocket] ========================================
18:37:57.155 > [ZTM] Settings saved successfully
18:37:57.157 > [WebSocket] ✓ ZTM activated successfully
18:37:57.160 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:57.166 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:57.169 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:57.172 > [WebSocket] ========================================
18:37:57.178 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":389245,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:57.216 > [389.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:57.323 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":388931,"type":"ztm_activated"}
18:37:57.339 > [WebSocket] Processing message type: ztm_activated
18:37:57.342 > [389.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:57.445 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124076923,"threatLevel":0,"type":"heuristics_update"}
18:37:57.470 > [WebSocket] Processing message type: heuristics_update
18:37:57.476 > [389.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:57.579 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":389245,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:57.615 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:57.620 > [WebSocket] ========================================
18:37:57.625 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:57.631 > [WebSocket] ========================================
18:37:57.636 > [ZTM] Settings saved successfully
18:37:57.640 > [WebSocket] ✓ ZTM activated successfully
18:37:57.642 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:57.648 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:57.651 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:57.654 > [WebSocket] ========================================
18:37:57.659 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":389727,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:57.698 > [389.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:57.804 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":389280,"type":"ztm_activated"}
18:37:57.821 > [WebSocket] Processing message type: ztm_activated
18:37:57.823 > [389.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:57.929 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":389727,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:57.966 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:57.972 > [WebSocket] ========================================
18:37:57.977 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:57.983 > [WebSocket] ========================================
18:37:57.988 > [ZTM] Settings saved successfully
18:37:57.991 > [WebSocket] ✓ ZTM activated successfully
18:37:57.994 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:57.999 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:58.002 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:58.005 > [WebSocket] ========================================
18:37:58.010 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":390078,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:58.050 > [390.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:58.155 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":389762,"type":"ztm_activated"}
18:37:58.172 > [WebSocket] Processing message type: ztm_activated
18:37:58.174 > [390.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:58.279 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124077929,"threatLevel":0,"type":"heuristics_update"}
18:37:58.304 > [WebSocket] Processing message type: heuristics_update
18:37:58.309 > [390.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:58.412 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":390078,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:58.447 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:58.453 > [WebSocket] ========================================
18:37:58.458 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:58.464 > [WebSocket] ========================================
18:37:58.469 > [ZTM] Settings saved successfully
18:37:58.472 > [WebSocket] ✓ ZTM activated successfully
18:37:58.475 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:58.481 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:58.484 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:58.486 > [WebSocket] ========================================
18:37:58.491 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":390559,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:58.530 > [390.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:58.636 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":390113,"type":"ztm_activated"}
18:37:58.654 > [WebSocket] Processing message type: ztm_activated
18:37:58.657 > [390.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:58.761 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":390559,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:58.797 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:58.802 > [WebSocket] ========================================
18:37:58.807 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:58.813 > [WebSocket] ========================================
18:37:58.819 > [ZTM] Settings saved successfully
18:37:58.822 > [WebSocket] ✓ ZTM activated successfully
18:37:58.825 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:58.830 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:58.833 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:58.836 > [WebSocket] ========================================
18:37:58.841 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":390909,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:58.880 > [390.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:58.986 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":390595,"type":"ztm_activated"}
18:37:59.003 > [WebSocket] Processing message type: ztm_activated
18:37:59.006 > [391.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:59.112 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":390909,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:59.148 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:59.154 > [WebSocket] ========================================
18:37:59.159 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:59.164 > [WebSocket] ========================================
18:37:59.170 > [ZTM] Settings saved successfully
18:37:59.173 > [WebSocket] ✓ ZTM activated successfully
18:37:59.175 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:59.180 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:59.184 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:59.186 > [WebSocket] ========================================
18:37:59.193 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":391260,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:59.231 > [391.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:59.337 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":390944,"type":"ztm_activated"}
18:37:59.354 > [WebSocket] Processing message type: ztm_activated
18:37:59.356 > [391.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:59.460 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124078940,"threatLevel":0,"type":"heuristics_update"}
18:37:59.485 > [WebSocket] Processing message type: heuristics_update
18:37:59.490 > [391.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:59.594 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":391260,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:59.629 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:59.636 > [WebSocket] ========================================
18:37:59.641 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:59.647 > [WebSocket] ========================================
18:37:59.652 > [ZTM] Settings saved successfully
18:37:59.655 > [WebSocket] ✓ ZTM activated successfully
18:37:59.658 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:37:59.663 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:37:59.666 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:37:59.669 > [WebSocket] ========================================
18:37:59.674 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":391742,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:37:59.712 > [391.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:59.820 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":391296,"type":"ztm_activated"}
18:37:59.837 > [WebSocket] Processing message type: ztm_activated
18:37:59.840 > [391.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:37:59.943 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":391742,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:37:59.980 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:37:59.985 > [WebSocket] ========================================
18:37:59.991 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:37:59.997 > [WebSocket] ========================================
18:38:00.002 > [ZTM] Settings saved successfully
18:38:00.004 > [WebSocket] ✓ ZTM activated successfully
18:38:00.007 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:00.012 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:00.015 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:00.019 > [WebSocket] ========================================
18:38:00.024 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":392092,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:00.063 > [392.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:00.169 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":391777,"type":"ztm_activated"}
18:38:00.185 > [WebSocket] Processing message type: ztm_activated
18:38:00.189 > [392.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:00.294 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124079946,"threatLevel":0,"type":"heuristics_update"}
18:38:00.319 > [WebSocket] Processing message type: heuristics_update
18:38:00.325 > [392.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:00.427 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":392092,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:00.463 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:00.469 > [WebSocket] ========================================
18:38:00.475 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:00.480 > [WebSocket] ========================================
18:38:00.485 > [ZTM] Settings saved successfully
18:38:00.488 > [WebSocket] ✓ ZTM activated successfully
18:38:00.491 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:00.496 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:00.499 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:00.502 > [WebSocket] ========================================
18:38:00.507 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":392575,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:00.546 > [392.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:00.652 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":392127,"type":"ztm_activated"}
18:38:00.669 > [WebSocket] Processing message type: ztm_activated
18:38:00.672 > [392.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:00.776 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":392575,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:00.812 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:00.818 > [WebSocket] ========================================
18:38:00.823 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:00.829 > [WebSocket] ========================================
18:38:00.834 > [ZTM] Settings saved successfully
18:38:00.836 > [WebSocket] ✓ ZTM activated successfully
18:38:00.840 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:00.845 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:00.848 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:00.851 > [WebSocket] ========================================
18:38:00.856 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":392924,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:00.895 > [393.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:01.001 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":392611,"type":"ztm_activated"}
18:38:01.017 > [WebSocket] Processing message type: ztm_activated
18:38:01.021 > [393.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:01.124 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":392924,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:01.161 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:01.167 > [WebSocket] ========================================
18:38:01.172 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:01.177 > [WebSocket] ========================================
18:38:01.183 > [ZTM] Settings saved successfully
18:38:01.186 > [WebSocket] ✓ ZTM activated successfully
18:38:01.189 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:01.194 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:01.196 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:01.200 > [WebSocket] ========================================
18:38:01.205 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":393273,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:01.244 > [393.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:01.252 > [RETRY] Attempting to send health data (Max retries: 3)
18:38:01.258 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:38:01.261 > Generated health data: HR-66 SPO2-96 STEPS-2003
18:38:01.266 > [ESP32] ========================================
18:38:01.269 > [ESP32] ENCRYPTION PIPELINE START
18:38:01.272 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:38:01.277 > [ESP32] Active Algorithms for this packet:
18:38:01.283 > [ESP32]   + LFSR
18:38:01.283 > [ESP32]   + Tinkerbell
18:38:01.286 > [ESP32]   + Transposition
18:38:01.289 > [ESP32]   - ChaCha20
18:38:01.289 > [ESP32]   - Salsa20
18:38:01.291 > [ESP32] ========================================
18:38:01.297 > [ESP32] MsgKeys: lfsrSeed=0x010C14FA tnk[0..3]=A8D9C05F trn[0..3]=E3111BDF
18:38:01.346 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D323030334D50
18:38:01.346 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D323030334D50000000000000 
18:38:01.346 > [ESP32][LFSR] Initializing - Seed: 0x010C14FA SeedBe: 0xFA140C01 ChaosKey[0..3]: A8D9C05F InitialTap: 0x0029 State: 0x010C14FA
18:38:01.346 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
18:38:01.346 > 3_After_LFSR (32): B246213766D8AC97C0FE06C13FD58608 890552B241D63CF5E08D4DAC37731A1D 
18:38:01.346 > [ESP32][LFSR] Keystream (first 16 bytes): FA140C0150F8FFC78FCC2BF809F5D55C
18:38:01.352 > [ESP32][4D] LFSR keystream (first 32 bytes): FA140C0150F8FFC78FCC2BF809F5D55CCC55019F73E60CC6ADDD4DAC37731A1D
18:38:01.358 > [ESP32][TINKERBELL] Input (first 16 bytes): B246213766D8AC97C0FE06C13FD58608 Nonce: 0x00000001 Buffer size: 32 bytes
18:38:01.374 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: A8D9C05F
18:38:01.380 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 80DB76E272F98B9CBB9C14496CA26DDE
18:38:01.389 > 4_After_Tinkerbell (32): 329D57D51421270B7B6212885377EBD6 34AC2BD1B2DDA53EE8897918EAC6048F 
18:38:01.394 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 80DB76E272F98B9CBB9C14496CA26DDE
18:38:01.402 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 80DB76E272F98B9CBB9C14496CA26DDEBDA97963F30B99CB080434B4DDB51E92
18:38:01.413 > 5_After_Transposition (32): 9D32048FD5575377627BA53E88121421 AC34EBD6D12BB2DD89E8270B1879EAC6 
18:38:01.422 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:38:01.428 > [ESP32] === HMAC DEBUG INFO ===
18:38:01.430 > [ESP32] HMAC Key being used: E5172C685CEC28B6F36C34D3E1608FE866116DE9A66203124F5F0DFC21D4EE46
18:38:01.439 > [ESP32] HMAC Input length: 45 bytes
18:38:01.442 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000019D32048FD5575377627BA53E88121421AC34EB
18:38:01.449 > [ESP32] Nonce: 0x00000001
18:38:01.453 > [ESP32] Packet size before HMAC: 61
18:38:01.455 > [ESP32] Computed HMAC Tag: A096C46ECCCA802FB21C7F107CFB5C0D
18:38:01.461 > [ESP32] === END HMAC DEBUG ===
18:38:01.463 > 6_Final_Packet (61): 820218001800040804000000019D3204 8FD5575377627BA53E88121421AC34EB ...
18:38:01.472 > [RETRY] Attempt 1/3 (nonce: 1)
18:38:01.475 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:01.480 > Sending pipeline data to server (659 bytes)
18:38:01.796 > [HTTP] Response code: 400
18:38:01.796 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:01.801 > [HTTP] Request failed with code: 400
18:38:01.804 > [RETRY] Send failed, waiting 100 ms before retry
18:38:01.905 > [RETRY] Attempt 2/3 (nonce: 1)
18:38:01.905 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:01.911 > Sending pipeline data to server (659 bytes)
18:38:02.050 > [HTTP] Response code: 400
18:38:02.050 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:02.056 > [HTTP] Request failed with code: 400
18:38:02.059 > [RETRY] Send failed, waiting 200 ms before retry
18:38:02.259 > [RETRY] Attempt 3/3 (nonce: 1)
18:38:02.259 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:02.264 > Sending pipeline data to server (659 bytes)
18:38:02.562 > [HTTP] Response code: 400
18:38:02.562 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:02.567 > [HTTP] Request failed with code: 400
18:38:02.570 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:38:02.576 > [RETRY] Consecutive failures: 3
18:38:02.578 > Health data send failed (retry count: 1/3)
18:38:02.681 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":392959,"type":"ztm_activated"}
18:38:02.698 > [WebSocket] Processing message type: ztm_activated
18:38:02.701 > [394.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:02.709 > [RETRY] Attempting to send health data (Max retries: 3)
18:38:02.715 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:38:02.720 > Generated health data: HR-69 SPO2-96 STEPS-2006
18:38:02.723 > [ESP32] ========================================
18:38:02.729 > [ESP32] ENCRYPTION PIPELINE START
18:38:02.731 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:38:02.737 > [ESP32] Active Algorithms for this packet:
18:38:02.739 > [ESP32]   + LFSR
18:38:02.742 > [ESP32]   + Tinkerbell
18:38:02.742 > [ESP32]   + Transposition
18:38:02.745 > [ESP32]   - ChaCha20
18:38:02.748 > [ESP32]   - Salsa20
18:38:02.748 > [ESP32] ========================================
18:38:02.754 > [ESP32] MsgKeys: lfsrSeed=0x010C14FA tnk[0..3]=A8D9C05F trn[0..3]=E3111BDF
18:38:02.759 > 1_After_Salt (26): 48522D36392053504F322D3936205354 4550532D323030364D50
18:38:02.767 > 2_After_Padding (32): 48522D36392053504F322D3936205354 4550532D323030364D50000000000000 
18:38:02.772 > [ESP32][LFSR] Initializing - Seed: 0x010C14FA SeedBe: 0xFA140C01 ChaosKey[0..3]: A8D9C05F InitialTap: 0x0029 State: 0x010C14FA
18:38:02.784 > [ESP32][LFSR] Input (first 16 bytes): 48522D36392053504F322D3936205354 Buffer size: 32 bytes
18:38:02.792 > 3_After_LFSR (32): B246213769D8AC97C0FE06C13FD58608 890552B241D63CF0E08D4DAC37731A1D 
18:38:02.801 > [ESP32][LFSR] Keystream (first 16 bytes): FA140C0150F8FFC78FCC2BF809F5D55C
18:38:02.806 > [ESP32][4D] LFSR keystream (first 32 bytes): FA140C0150F8FFC78FCC2BF809F5D55CCC55019F73E60CC6ADDD4DAC37731A1D
18:38:02.817 > [ESP32][TINKERBELL] Input (first 16 bytes): B246213769D8AC97C0FE06C13FD58608 Nonce: 0x00000001 Buffer size: 32 bytes
18:38:02.828 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: A8D9C05F
18:38:02.836 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 80DB76E272F98B9CBB9C14496CA26DDE
18:38:02.844 > 4_After_Tinkerbell (32): 329D57D51B21270B7B6212885377EBD6 34AC2BD1B2DDA53BE8897918EAC6048F 
18:38:02.853 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 80DB76E272F98B9CBB9C14496CA26DDE
18:38:02.862 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 80DB76E272F98B9CBB9C14496CA26DDEBDA97963F30B99CB080434B4DDB51E92
18:38:02.870 > 5_After_Transposition (32): 9D32048FD5575377627BA53B88121B21 AC34EBD6D12BB2DD89E8270B1879EAC6 
18:38:02.879 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:38:02.884 > [ESP32] === HMAC DEBUG INFO ===
18:38:02.887 > [ESP32] HMAC Key being used: E5172C685CEC28B6F36C34D3E1608FE866116DE9A66203124F5F0DFC21D4EE46
18:38:02.895 > [ESP32] HMAC Input length: 45 bytes
18:38:02.898 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000019D32048FD5575377627BA53B88121B21AC34EB
18:38:02.906 > [ESP32] Nonce: 0x00000001
18:38:02.909 > [ESP32] Packet size before HMAC: 61
18:38:02.912 > [ESP32] Computed HMAC Tag: F63A2C040ED1FE95541AB45CBC1D0684
18:38:02.917 > [ESP32] === END HMAC DEBUG ===
18:38:02.919 > 6_Final_Packet (61): 820218001800040804000000019D3204 8FD5575377627BA53B88121B21AC34EB ...
18:38:02.928 > [RETRY] Attempt 1/3 (nonce: 1)
18:38:02.931 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:02.937 > Sending pipeline data to server (659 bytes)
18:38:03.062 > [HTTP] Response code: 400
18:38:03.062 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:03.067 > [HTTP] Request failed with code: 400
18:38:03.071 > [RETRY] Send failed, waiting 100 ms before retry
18:38:03.171 > [RETRY] Attempt 2/3 (nonce: 1)
18:38:03.173 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:03.177 > Sending pipeline data to server (659 bytes)
18:38:03.315 > [HTTP] Response code: 400
18:38:03.315 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:03.320 > [HTTP] Request failed with code: 400
18:38:03.324 > [RETRY] Send failed, waiting 200 ms before retry
18:38:03.523 > [RETRY] Attempt 3/3 (nonce: 1)
18:38:03.523 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:03.529 > Sending pipeline data to server (659 bytes)
18:38:03.817 > [HTTP] Response code: 400
18:38:03.818 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:03.823 > [HTTP] Request failed with code: 400
18:38:03.826 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:38:03.832 > [RETRY] Consecutive failures: 4
18:38:03.834 > Health data send failed (retry count: 2/3)
18:38:03.936 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124080961,"threatLevel":0,"type":"heuristics_update"}
18:38:03.962 > [WebSocket] Processing message type: heuristics_update
18:38:03.968 > [396.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:03.976 > [RETRY] Attempting to send health data (Max retries: 3)
18:38:03.979 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:38:03.984 > Generated health data: HR-66 SPO2-96 STEPS-1983
18:38:03.990 > [ESP32] ========================================
18:38:03.993 > [ESP32] ENCRYPTION PIPELINE START
18:38:03.995 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:38:04.001 > [ESP32] Active Algorithms for this packet:
18:38:04.004 > [ESP32]   + LFSR
18:38:04.007 > [ESP32]   + Tinkerbell
18:38:04.009 > [ESP32]   + Transposition
18:38:04.009 > [ESP32]   - ChaCha20
18:38:04.012 > [ESP32]   - Salsa20
18:38:04.015 > [ESP32] ========================================
18:38:04.017 > [ESP32] MsgKeys: lfsrSeed=0x010C14FA tnk[0..3]=A8D9C05F trn[0..3]=E3111BDF
18:38:04.025 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D313938334D50
18:38:04.031 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D313938334D50000000000000 
18:38:04.040 > [ESP32][LFSR] Initializing - Seed: 0x010C14FA SeedBe: 0xFA140C01 ChaosKey[0..3]: A8D9C05F InitialTap: 0x0029 State: 0x010C14FA
18:38:04.050 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
18:38:04.059 > 3_After_LFSR (32): B246213766D8AC97C0FE06C13FD58608 890552B242DF34F5E08D4DAC37731A1D 
18:38:04.065 > [ESP32][LFSR] Keystream (first 16 bytes): FA140C0150F8FFC78FCC2BF809F5D55C
18:38:04.073 > [ESP32][4D] LFSR keystream (first 32 bytes): FA140C0150F8FFC78FCC2BF809F5D55CCC55019F73E60CC6ADDD4DAC37731A1D
18:38:04.081 > [ESP32][TINKERBELL] Input (first 16 bytes): B246213766D8AC97C0FE06C13FD58608 Nonce: 0x00000001 Buffer size: 32 bytes
18:38:04.092 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: A8D9C05F
18:38:04.101 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 80DB76E272F98B9CBB9C14496CA26DDE
18:38:04.109 > 4_After_Tinkerbell (32): 329D57D51421270B7B6212885377EBD6 34AC2BD1B1D4AD3EE8897918EAC6048F 
18:38:04.117 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 80DB76E272F98B9CBB9C14496CA26DDE
18:38:04.125 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 80DB76E272F98B9CBB9C14496CA26DDEBDA97963F30B99CB080434B4DDB51E92
18:38:04.136 > 5_After_Transposition (32): 9D32048FD5575377627BAD3E88121421 AC34EBD6D12BB1D489E8270B1879EAC6 
18:38:04.145 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:38:04.148 > [ESP32] === HMAC DEBUG INFO ===
18:38:04.150 > [ESP32] HMAC Key being used: E5172C685CEC28B6F36C34D3E1608FE866116DE9A66203124F5F0DFC21D4EE46
18:38:04.159 > [ESP32] HMAC Input length: 45 bytes
18:38:04.161 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000019D32048FD5575377627BAD3E88121421AC34EB
18:38:04.173 > [ESP32] Nonce: 0x00000001
18:38:04.173 > [ESP32] Packet size before HMAC: 61
18:38:04.179 > [ESP32] Computed HMAC Tag: 2C2740C17612821161F19CC519FB6049
18:38:04.184 > [ESP32] === END HMAC DEBUG ===
18:38:04.184 > 6_Final_Packet (61): 820218001800040804000000019D3204 8FD5575377627BAD3E88121421AC34EB ...
18:38:04.192 > [RETRY] Attempt 1/3 (nonce: 1)
18:38:04.195 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:04.208 > Sending pipeline data to server (659 bytes)
18:38:04.328 > [HTTP] Response code: 400
18:38:04.328 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:04.333 > [HTTP] Request failed with code: 400
18:38:04.335 > [RETRY] Send failed, waiting 100 ms before retry
18:38:04.435 > [RETRY] Attempt 2/3 (nonce: 1)
18:38:04.435 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:04.441 > Sending pipeline data to server (659 bytes)
18:38:04.814 > [HTTP] Response code: 400
18:38:04.814 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:04.819 > [HTTP] Request failed with code: 400
18:38:04.822 > [RETRY] Send failed, waiting 200 ms before retry
18:38:05.022 > [RETRY] Attempt 3/3 (nonce: 1)
18:38:05.022 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:05.028 > Sending pipeline data to server (659 bytes)
18:38:05.326 > [HTTP] Response code: 400
18:38:05.326 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:05.332 > [HTTP] Request failed with code: 400
18:38:05.334 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:38:05.340 > [RETRY] Consecutive failures: 5
18:38:05.342 > [EMERGENCY] Triggering emergency reset!
18:38:05.346 > [CRYPTO] Resetting cryptographic state
18:38:05.351 > [CRYPTO] Crypto state reset complete
18:38:05.354 > [CRYPTO] Packet counter: 9
18:38:05.357 > [EMERGENCY] Emergency reset complete
18:38:05.360 > Health data send failed (retry count: 3/3)
18:38:05.363 > Health data transmission failed after max retries
18:38:05.469 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":393273,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:05.506 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:05.511 > [WebSocket] ========================================
18:38:05.517 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:05.522 > [WebSocket] ========================================
18:38:05.528 > [ZTM] Settings saved successfully
18:38:05.531 > [WebSocket] ✓ ZTM activated successfully
18:38:05.533 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:05.540 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:05.542 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:05.545 > [WebSocket] ========================================
18:38:05.550 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":397619,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:05.590 > [397.7] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:05.595 > ERROR state - attempting recovery
18:38:05.600 > [RETRY] Attempting to send health data (Max retries: 3)
18:38:05.603 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:38:05.609 > Generated health data: HR-66 SPO2-96 STEPS-2002
18:38:05.615 > [ESP32] ========================================
18:38:05.617 > [ESP32] ENCRYPTION PIPELINE START
18:38:05.620 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:38:05.626 > [ESP32] Active Algorithms for this packet:
18:38:05.628 > [ESP32]   + LFSR
18:38:05.631 > [ESP32]   + Tinkerbell
18:38:05.633 > [ESP32]   + Transposition
18:38:05.633 > [ESP32]   - ChaCha20
18:38:05.637 > [ESP32]   - Salsa20
18:38:05.639 > [ESP32] ========================================
18:38:05.642 > [ESP32] MsgKeys: lfsrSeed=0x010C14FA tnk[0..3]=A8D9C05F trn[0..3]=E3111BDF
18:38:05.650 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D323030324D50
18:38:05.655 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D323030324D50000000000000 
18:38:05.664 > [ESP32][LFSR] Initializing - Seed: 0x010C14FA SeedBe: 0xFA140C01 ChaosKey[0..3]: A8D9C05F InitialTap: 0x0029 State: 0x010C14FA
18:38:05.678 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
18:38:05.685 > 3_After_LFSR (32): B246213766D8AC97C0FE06C13FD58608 890552B241D63CF4E08D4DAC37731A1D 
18:38:05.689 > [ESP32][LFSR] Keystream (first 16 bytes): FA140C0150F8FFC78FCC2BF809F5D55C
18:38:05.698 > [ESP32][4D] LFSR keystream (first 32 bytes): FA140C0150F8FFC78FCC2BF809F5D55CCC55019F73E60CC6ADDD4DAC37731A1D
18:38:05.706 > [ESP32][TINKERBELL] Input (first 16 bytes): B246213766D8AC97C0FE06C13FD58608 Nonce: 0x00000001 Buffer size: 32 bytes
18:38:05.717 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: A8D9C05F
18:38:05.726 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 80DB76E272F98B9CBB9C14496CA26DDE
18:38:05.734 > 4_After_Tinkerbell (32): 329D57D51421270B7B6212885377EBD6 34AC2BD1B2DDA53FE8897918EAC6048F 
18:38:05.742 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 80DB76E272F98B9CBB9C14496CA26DDE
18:38:05.751 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 80DB76E272F98B9CBB9C14496CA26DDEBDA97963F30B99CB080434B4DDB51E92
18:38:05.762 > 5_After_Transposition (32): 9D32048FD5575377627BA53F88121421 AC34EBD6D12BB2DD89E8270B1879EAC6 
18:38:05.770 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:38:05.773 > [ESP32] === HMAC DEBUG INFO ===
18:38:05.775 > [ESP32] HMAC Key being used: E5172C685CEC28B6F36C34D3E1608FE866116DE9A66203124F5F0DFC21D4EE46
18:38:05.784 > [ESP32] HMAC Input length: 45 bytes
18:38:05.786 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000019D32048FD5575377627BA53F88121421AC34EB
18:38:05.797 > [ESP32] Nonce: 0x00000001
18:38:05.797 > [ESP32] Packet size before HMAC: 61
18:38:05.804 > [ESP32] Computed HMAC Tag: D6C74CAB5E5BDB67D043AEF0EFC56CAC
18:38:05.809 > [ESP32] === END HMAC DEBUG ===
18:38:05.809 > 6_Final_Packet (61): 820218001800040804000000019D3204 8FD5575377627BA53F88121421AC34EB ...
18:38:05.818 > [RETRY] Attempt 1/3 (nonce: 1)
18:38:05.820 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:05.826 > Sending pipeline data to server (659 bytes)
18:38:06.100 > [HTTP] Response code: 400
18:38:06.100 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:06.105 > [HTTP] Request failed with code: 400
18:38:06.108 > [RETRY] Send failed, waiting 100 ms before retry
18:38:06.207 > [RETRY] Attempt 2/3 (nonce: 1)
18:38:06.207 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:06.213 > Sending pipeline data to server (659 bytes)
18:38:06.336 > [HTTP] Response code: 400
18:38:06.336 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:06.341 > [HTTP] Request failed with code: 400
18:38:06.344 > [RETRY] Send failed, waiting 200 ms before retry
18:38:06.543 > [RETRY] Attempt 3/3 (nonce: 1)
18:38:06.544 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:06.548 > Sending pipeline data to server (659 bytes)
18:38:06.835 > [HTTP] Response code: 400
18:38:06.835 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:06.840 > [HTTP] Request failed with code: 400
18:38:06.844 > [RETRY] All retry attempts failed - rolled back nonce to 0
18:38:06.849 > [RETRY] Consecutive failures: 1
18:38:06.852 > ✗ Auto-recovery failed - restarting key exchange
18:38:08.955 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":393308,"type":"ztm_activated"}
18:38:08.971 > [WebSocket] Processing message type: ztm_activated
18:38:08.975 > [401.0] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:08.983 > ✓ Public key loaded from NVS
18:38:09.081 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":393871,"type":"health_data_error"}
18:38:09.095 > [WebSocket] Processing message type: health_data_error
18:38:09.101 > [401.2] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:09.204 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124081974,"threatLevel":0,"type":"heuristics_update"}
18:38:09.229 > [WebSocket] Processing message type: heuristics_update
18:38:09.234 > [401.3] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:09.242 > Generating fresh master key from entropy...
18:38:09.246 > Generated master key (32): D94318352783DA86D857B05210F73403 90186FF759FBFCB5FBC84990A1555013 
18:38:09.258 > Using reduced master key (byte % 3) for NTRU encryption only
18:38:09.266 > NTRU encrypted master key (502): 0063005A003F0067001500460008006D 003600030020000D006C006F0022000C ...
18:38:09.274 > POST http://10.249.92.115:8081/master-key
18:38:09.607 > ✓ Master key exchange completed
18:38:09.709 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":394125,"type":"health_data_error"}
18:38:09.723 > [WebSocket] Processing message type: health_data_error
18:38:09.729 > [401.8] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:09.736 > Loading master key from NVS and deriving symmetric keys...
18:38:09.743 > Loaded master key from NVS (32): D94318352783DA86D857B05210F73403 90186FF759FBFCB5FBC84990A1555013 
18:38:09.750 > Derived HMAC key (32): 61FF1ED643F491454CBC1C1BFF10AAA3 DBFA7E14EC40A6381ED35D30BEE608E9 
18:38:09.759 > Derived Tinkerbell key (16): 32879FBA39F54869F52629FE71AB32D3 
18:38:09.764 > Derived Transposition key (16): CB9F9FF04043D09FC41E235458FDD413 
18:38:09.770 > ✓ Symmetric keys derived successfully
18:38:09.773 > Nonce tracker reset - new session started
18:38:10.269 > Waiting for server to process master key...
18:38:10.273 > ✓ Symmetric keys ready - starting health data transmission
18:38:10.375 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":394637,"type":"health_data_error"}
18:38:10.389 > [WebSocket] Processing message type: health_data_error
18:38:10.394 > [402.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:10.498 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124082982,"threatLevel":0,"type":"heuristics_update"}
18:38:10.523 > [WebSocket] Processing message type: heuristics_update
18:38:10.529 > [402.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:10.631 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":395137,"type":"health_data_error"}
18:38:10.645 > [WebSocket] Processing message type: health_data_error
18:38:10.650 > [402.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:10.752 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":395391,"type":"health_data_error"}
18:38:10.766 > [WebSocket] Processing message type: health_data_error
18:38:10.772 > [402.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:10.875 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":395893,"type":"health_data_error"}
18:38:10.888 > [WebSocket] Processing message type: health_data_error
18:38:10.894 > [403.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:10.997 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124083993,"threatLevel":0,"type":"heuristics_update"}
18:38:11.022 > [WebSocket] Processing message type: heuristics_update
18:38:11.027 > [403.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:11.129 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":396403,"type":"health_data_error"}
18:38:11.144 > [WebSocket] Processing message type: health_data_error
18:38:11.149 > [403.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:11.252 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":396889,"type":"health_data_error"}
18:38:11.266 > [WebSocket] Processing message type: health_data_error
18:38:11.272 > [403.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:11.373 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124085001,"threatLevel":0,"type":"heuristics_update"}
18:38:11.398 > [WebSocket] Processing message type: heuristics_update
18:38:11.405 > [403.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:11.507 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":7,"success":false,"timestamp":397402,"type":"health_data_error"}
18:38:11.521 > [WebSocket] Processing message type: health_data_error
18:38:11.526 > [403.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:11.627 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":397619,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:11.665 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:11.670 > [WebSocket] ========================================
18:38:11.676 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:11.682 > [WebSocket] ========================================
18:38:11.686 > [ZTM] Settings saved successfully
18:38:11.690 > [WebSocket] ✓ ZTM activated successfully
18:38:11.693 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:11.697 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:11.700 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:11.704 > [WebSocket] ========================================
18:38:11.709 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":403777,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:11.748 > [403.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:11.854 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":8,"success":true,"timestamp":397654,"type":"ztm_activated"}
18:38:11.871 > [WebSocket] Processing message type: ztm_activated
18:38:11.874 > [403.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:11.978 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124086003,"threatLevel":0,"type":"heuristics_update"}
18:38:12.003 > [WebSocket] Processing message type: heuristics_update
18:38:12.008 > [404.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:12.111 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":398175,"type":"health_data_error"}
18:38:12.124 > [WebSocket] Processing message type: health_data_error
18:38:12.130 > [404.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:12.232 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":398411,"type":"health_data_error"}
18:38:12.247 > [WebSocket] Processing message type: health_data_error
18:38:12.252 > [404.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:12.355 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Failed to send health data","state":8,"success":false,"timestamp":398911,"type":"health_data_error"}
18:38:12.368 > [WebSocket] Processing message type: health_data_error
18:38:12.374 > [404.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:12.478 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124087013,"threatLevel":0,"type":"heuristics_update"}
18:38:12.503 > [WebSocket] Processing message type: heuristics_update
18:38:12.508 > [404.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:12.611 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124088023,"threatLevel":0,"type":"heuristics_update"}
18:38:12.636 > [WebSocket] Processing message type: heuristics_update
18:38:12.641 > [404.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:12.744 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124089029,"threatLevel":0,"type":"heuristics_update"}
18:38:12.769 > [WebSocket] Processing message type: heuristics_update
18:38:12.774 > [404.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:12.877 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770124089399,"type":"master_key_received"}
18:38:12.890 > [WebSocket] Processing message type: master_key_received
18:38:12.893 > [405.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:12.998 > [WebSocket] Received (176 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":401675,"type":"master_key_exchanged"}
18:38:13.015 > [WebSocket] Processing message type: master_key_exchanged
18:38:13.021 > [405.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:13.121 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124090045,"threatLevel":0,"type":"heuristics_update"}
18:38:13.146 > [WebSocket] Processing message type: heuristics_update
18:38:13.152 > [405.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:13.254 > [WebSocket] Received (168 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":402344,"type":"symmetric_keys_derived"}
18:38:13.270 > [WebSocket] Processing message type: symmetric_keys_derived
18:38:13.275 > [405.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:13.376 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124091052,"threatLevel":0,"type":"heuristics_update"}
18:38:13.400 > [WebSocket] Processing message type: heuristics_update
18:38:13.406 > [405.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:13.509 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":403777,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:13.545 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:13.550 > [WebSocket] ========================================
18:38:13.555 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:13.561 > [WebSocket] ========================================
18:38:13.567 > [ZTM] Settings saved successfully
18:38:13.569 > [WebSocket] ✓ ZTM activated successfully
18:38:13.572 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:13.577 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:13.581 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:13.583 > [WebSocket] ========================================
18:38:13.589 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":405657,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:13.627 > [405.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:13.735 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":403813,"type":"ztm_activated"}
18:38:13.751 > [WebSocket] Processing message type: ztm_activated
18:38:13.754 > [405.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:13.857 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124092064,"threatLevel":0,"type":"heuristics_update"}
18:38:13.883 > [WebSocket] Processing message type: heuristics_update
18:38:13.888 > [406.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:13.992 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124093077,"threatLevel":0,"type":"heuristics_update"}
18:38:14.016 > [WebSocket] Processing message type: heuristics_update
18:38:14.021 > [406.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:14.123 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":405657,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:14.160 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:14.165 > [WebSocket] ========================================
18:38:14.171 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:14.177 > [WebSocket] ========================================
18:38:14.182 > [ZTM] Settings saved successfully
18:38:14.185 > [WebSocket] ✓ ZTM activated successfully
18:38:14.188 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:14.193 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:14.196 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:14.198 > [WebSocket] ========================================
18:38:14.204 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":406272,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:14.243 > [406.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:14.348 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":405693,"type":"ztm_activated"}
18:38:14.365 > [WebSocket] Processing message type: ztm_activated
18:38:14.368 > [406.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:14.474 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124094088,"threatLevel":0,"type":"heuristics_update"}
18:38:14.500 > [WebSocket] Processing message type: heuristics_update
18:38:14.505 > [406.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:14.608 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":406272,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:14.644 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:14.649 > [WebSocket] ========================================
18:38:14.655 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:14.660 > [WebSocket] ========================================
18:38:14.666 > [ZTM] Settings saved successfully
18:38:14.668 > [WebSocket] ✓ ZTM activated successfully
18:38:14.672 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:14.677 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:14.680 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:14.683 > [WebSocket] ========================================
18:38:14.688 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":406756,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:14.727 > [406.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:14.834 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":406308,"type":"ztm_activated"}
18:38:14.850 > [WebSocket] Processing message type: ztm_activated
18:38:14.853 > [406.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:14.958 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":406756,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:14.993 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:14.999 > [WebSocket] ========================================
18:38:15.004 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:15.010 > [WebSocket] ========================================
18:38:15.015 > [ZTM] Settings saved successfully
18:38:15.018 > [WebSocket] ✓ ZTM activated successfully
18:38:15.021 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:15.026 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:15.029 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:15.032 > [WebSocket] ========================================
18:38:15.038 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":407106,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:15.077 > [407.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:15.182 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":406792,"type":"ztm_activated"}
18:38:15.199 > [WebSocket] Processing message type: ztm_activated
18:38:15.202 > [407.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:15.306 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":407106,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:15.342 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:15.348 > [WebSocket] ========================================
18:38:15.354 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:15.358 > [WebSocket] ========================================
18:38:15.364 > [ZTM] Settings saved successfully
18:38:15.367 > [WebSocket] ✓ ZTM activated successfully
18:38:15.369 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:15.376 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:15.378 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:15.381 > [WebSocket] ========================================
18:38:15.386 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":407455,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:15.425 > [407.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:15.532 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":407141,"type":"ztm_activated"}
18:38:15.548 > [WebSocket] Processing message type: ztm_activated
18:38:15.551 > [407.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:15.655 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124095097,"threatLevel":0,"type":"heuristics_update"}
18:38:15.679 > [WebSocket] Processing message type: heuristics_update
18:38:15.685 > [407.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:15.791 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":407455,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:15.827 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:15.832 > [WebSocket] ========================================
18:38:15.838 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:15.844 > [WebSocket] ========================================
18:38:15.849 > [ZTM] Settings saved successfully
18:38:15.852 > [WebSocket] ✓ ZTM activated successfully
18:38:15.855 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:15.860 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:15.863 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:15.866 > [WebSocket] ========================================
18:38:15.872 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":407940,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:15.910 > [408.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:16.018 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":407490,"type":"ztm_activated"}
18:38:16.035 > [WebSocket] Processing message type: ztm_activated
18:38:16.038 > [408.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:16.142 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":407940,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:16.178 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:16.183 > [WebSocket] ========================================
18:38:16.189 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:16.195 > [WebSocket] ========================================
18:38:16.200 > [ZTM] Settings saved successfully
18:38:16.203 > [WebSocket] ✓ ZTM activated successfully
18:38:16.206 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:16.211 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:16.215 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:16.217 > [WebSocket] ========================================
18:38:16.222 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":408291,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:16.261 > [408.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:16.367 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":407976,"type":"ztm_activated"}
18:38:16.387 > [WebSocket] Processing message type: ztm_activated
18:38:16.387 > [408.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:16.491 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124096109,"threatLevel":0,"type":"heuristics_update"}
18:38:16.515 > [WebSocket] Processing message type: heuristics_update
18:38:16.521 > [408.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:16.624 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":408291,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:16.660 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:16.666 > [WebSocket] ========================================
18:38:16.672 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:16.677 > [WebSocket] ========================================
18:38:16.682 > [ZTM] Settings saved successfully
18:38:16.685 > [WebSocket] ✓ ZTM activated successfully
18:38:16.688 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:16.693 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:16.696 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:16.699 > [WebSocket] ========================================
18:38:16.704 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":408773,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:16.742 > [408.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:16.850 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":408326,"type":"ztm_activated"}
18:38:16.866 > [WebSocket] Processing message type: ztm_activated
18:38:16.869 > [408.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:16.975 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":408773,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:17.011 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:17.017 > [WebSocket] ========================================
18:38:17.022 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:17.027 > [WebSocket] ========================================
18:38:17.034 > [ZTM] Settings saved successfully
18:38:17.036 > [WebSocket] ✓ ZTM activated successfully
18:38:17.039 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:17.045 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:17.048 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:17.050 > [WebSocket] ========================================
18:38:17.056 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":409124,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:17.095 > [409.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:17.201 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":408808,"type":"ztm_activated"}
18:38:17.218 > [WebSocket] Processing message type: ztm_activated
18:38:17.221 > [409.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:17.325 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":409124,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:17.361 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:17.367 > [WebSocket] ========================================
18:38:17.373 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:17.378 > [WebSocket] ========================================
18:38:17.383 > [ZTM] Settings saved successfully
18:38:17.386 > [WebSocket] ✓ ZTM activated successfully
18:38:17.389 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:17.394 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:17.398 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:17.400 > [WebSocket] ========================================
18:38:17.406 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":409474,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:17.444 > [409.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:17.552 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":409159,"type":"ztm_activated"}
18:38:17.569 > [WebSocket] Processing message type: ztm_activated
18:38:17.572 > [409.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:17.675 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124097120,"threatLevel":0,"type":"heuristics_update"}
18:38:17.700 > [WebSocket] Processing message type: heuristics_update
18:38:17.706 > [409.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:17.809 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":409474,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:17.845 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:17.851 > [WebSocket] ========================================
18:38:17.856 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:17.862 > [WebSocket] ========================================
18:38:17.867 > [ZTM] Settings saved successfully
18:38:17.870 > [WebSocket] ✓ ZTM activated successfully
18:38:17.872 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:17.878 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:17.882 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:17.884 > [WebSocket] ========================================
18:38:17.889 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":409958,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:17.929 > [410.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:18.034 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":409511,"type":"ztm_activated"}
18:38:18.051 > [WebSocket] Processing message type: ztm_activated
18:38:18.054 > [410.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:18.159 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":409958,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:18.196 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:18.202 > [WebSocket] ========================================
18:38:18.207 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:18.212 > [WebSocket] ========================================
18:38:18.218 > [ZTM] Settings saved successfully
18:38:18.220 > [WebSocket] ✓ ZTM activated successfully
18:38:18.224 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:18.229 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:18.232 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:18.235 > [WebSocket] ========================================
18:38:18.240 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":410309,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:18.282 > [410.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:18.385 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":409993,"type":"ztm_activated"}
18:38:18.414 > [WebSocket] Processing message type: ztm_activated
18:38:18.414 > [410.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:18.509 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124098129,"threatLevel":0,"type":"heuristics_update"}
18:38:18.533 > [WebSocket] Processing message type: heuristics_update
18:38:18.539 > [410.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:18.642 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":410309,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:18.677 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:18.684 > [WebSocket] ========================================
18:38:18.689 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:18.695 > [WebSocket] ========================================
18:38:18.701 > [ZTM] Settings saved successfully
18:38:18.703 > [WebSocket] ✓ ZTM activated successfully
18:38:18.706 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:18.711 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:18.714 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:18.717 > [WebSocket] ========================================
18:38:18.723 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":410791,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:18.761 > [410.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:18.867 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":410344,"type":"ztm_activated"}
18:38:18.884 > [WebSocket] Processing message type: ztm_activated
18:38:18.886 > [411.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:18.992 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":410791,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:19.027 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:19.033 > [WebSocket] ========================================
18:38:19.038 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:19.044 > [WebSocket] ========================================
18:38:19.049 > [ZTM] Settings saved successfully
18:38:19.052 > [WebSocket] ✓ ZTM activated successfully
18:38:19.055 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:19.060 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:19.063 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:19.066 > [WebSocket] ========================================
18:38:19.071 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":411140,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:19.110 > [411.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:19.217 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":410826,"type":"ztm_activated"}
18:38:19.234 > [WebSocket] Processing message type: ztm_activated
18:38:19.236 > [411.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:19.344 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":411140,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:19.380 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:19.385 > [WebSocket] ========================================
18:38:19.391 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:19.396 > [WebSocket] ========================================
18:38:19.402 > [ZTM] Settings saved successfully
18:38:19.405 > [WebSocket] ✓ ZTM activated successfully
18:38:19.407 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:19.412 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:19.415 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:19.418 > [WebSocket] ========================================
18:38:19.423 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":411492,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:19.463 > [411.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:19.568 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":411175,"type":"ztm_activated"}
18:38:19.585 > [WebSocket] Processing message type: ztm_activated
18:38:19.588 > [411.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:19.691 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124099142,"threatLevel":0,"type":"heuristics_update"}
18:38:19.716 > [WebSocket] Processing message type: heuristics_update
18:38:19.722 > [411.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:19.825 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":411492,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:19.861 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:19.867 > [WebSocket] ========================================
18:38:19.872 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:19.878 > [WebSocket] ========================================
18:38:19.884 > [ZTM] Settings saved successfully
18:38:19.886 > [WebSocket] ✓ ZTM activated successfully
18:38:19.889 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:19.894 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:19.898 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:19.900 > [WebSocket] ========================================
18:38:19.905 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":411974,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:19.944 > [412.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:20.050 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":411528,"type":"ztm_activated"}
18:38:20.067 > [WebSocket] Processing message type: ztm_activated
18:38:20.070 > [412.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:20.174 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":411974,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:20.210 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:20.216 > [WebSocket] ========================================
18:38:20.221 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:20.227 > [WebSocket] ========================================
18:38:20.233 > [ZTM] Settings saved successfully
18:38:20.235 > [WebSocket] ✓ ZTM activated successfully
18:38:20.238 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:20.244 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:20.245 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:20.249 > [WebSocket] ========================================
18:38:20.255 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":412323,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:20.293 > [412.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 10 | WS: CONNECTED
18:38:20.302 > [RETRY] Attempting to send health data (Max retries: 3)
18:38:20.307 > [RETRY] Using nonce 1 for all retry attempts (saved: 0)
18:38:20.310 > Generated health data: HR-66 SPO2-96 STEPS-2075
18:38:20.316 > [ESP32] ========================================
18:38:20.319 > [ESP32] ENCRYPTION PIPELINE START
18:38:20.322 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:38:20.326 > [ESP32] Active Algorithms for this packet:
18:38:20.332 > [ESP32]   + LFSR
18:38:20.332 > [ESP32]   + Tinkerbell
18:38:20.335 > [ESP32]   + Transposition
18:38:20.338 > [ESP32]   - ChaCha20
18:38:20.338 > [ESP32]   - Salsa20
18:38:20.341 > [ESP32] ========================================
18:38:20.346 > [ESP32] MsgKeys: lfsrSeed=0x33168CFA tnk[0..3]=1B6EEDC2 trn[0..3]=DB0ACAE0
18:38:20.352 > 1_After_Salt (26): 48522D36362053504F322D3936205354 4550532D323037354D50
18:38:20.358 > 2_After_Padding (32): 48522D36362053504F322D3936205354 4550532D323037354D50000000000000 
18:38:20.366 > [ESP32][LFSR] Initializing - Seed: 0x33168CFA SeedBe: 0xFA8C1633 ChaosKey[0..3]: 1B6EEDC2 InitialTap: 0x0029 State: 0x33168CFA
18:38:20.376 > [ESP32][LFSR] Input (first 16 bytes): 48522D36362053504F322D3936205354 Buffer size: 32 bytes
18:38:20.385 > 3_After_LFSR (32): B2DE3B050E4BCCBFBC5B44ECC6E0F0DC 028CA4EDDF0EDB9CC1111028E51516A2 
18:38:20.394 > [ESP32][LFSR] Keystream (first 16 bytes): FA8C1633386B9FEFF36969D5F0C0A388
18:38:20.399 > [ESP32][4D] LFSR keystream (first 32 bytes): FA8C1633386B9FEFF36969D5F0C0A38847DCF7C0ED3EECA98C411028E51516A2
18:38:20.407 > [ESP32][TINKERBELL] Input (first 16 bytes): B2DE3B050E4BCCBFBC5B44ECC6E0F0DC Nonce: 0x00000001 Buffer size: 32 bytes
18:38:20.418 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000001 Counter: 0 (must start at 0) Key[0..3]: 1B6EEDC2
18:38:20.430 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): 737D0D9053FE9A80AAA45BF0B9A72DBE
18:38:20.438 > 4_After_Tinkerbell (32): C1A336955DB5563F16FF1F1C7F47DD62 33114EB7CF71C8506802DACB6F2FF3EE 
18:38:20.444 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): 737D0D9053FE9A80AAA45BF0B9A72DBE
18:38:20.452 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): 737D0D9053FE9A80AAA45BF0B9A72DBE319DEA5A107F13CCA913CAE38A3AE54C
18:38:20.462 > 5_After_Transposition (32): 5DB595C136A3F3EE7F471C161FFFC850 CF71B7334E11563F6F2FCB68DA02DD62 
18:38:20.471 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000001
18:38:20.477 > [ESP32] === HMAC DEBUG INFO ===
18:38:20.479 > [ESP32] HMAC Key being used: 61FF1ED643F491454CBC1C1BFF10AAA3DBFA7E14EC40A6381ED35D30BEE608E9
18:38:20.488 > [ESP32] HMAC Input length: 45 bytes
18:38:20.491 > [ESP32] HMAC Input (first 32 bytes): 820218001800040804000000015DB595C136A3F3EE7F471C161FFFC850CF71B7
18:38:20.499 > [ESP32] Nonce: 0x00000001
18:38:20.502 > [ESP32] Packet size before HMAC: 61
18:38:20.505 > [ESP32] Computed HMAC Tag: 95A3EAEA8D848016571A6E3783B403FB
18:38:20.510 > [ESP32] === END HMAC DEBUG ===
18:38:20.512 > 6_Final_Packet (61): 820218001800040804000000015DB595 C136A3F3EE7F471C161FFFC850CF71B7 ...
18:38:20.521 > [RETRY] Attempt 1/3 (nonce: 1)
18:38:20.524 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:20.529 > Sending pipeline data to server (659 bytes)
18:38:20.648 > [HTTP] Response code: 200
18:38:20.648 > [HTTP] Response: {"status":"OK:DECRYPTED"}
18:38:20.659 > [RETRY] Health data sent successfully!
18:38:20.662 > ✓ Health data #11 sent successfully
18:38:20.761 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":412009,"type":"ztm_activated"}
18:38:20.777 > [WebSocket] Processing message type: ztm_activated
18:38:20.781 > [412.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:20.885 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124100142,"threatLevel":0,"type":"heuristics_update"}
18:38:20.909 > [WebSocket] Processing message type: heuristics_update
18:38:20.915 > [413.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:21.021 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":412323,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:21.056 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:21.062 > [WebSocket] ========================================
18:38:21.067 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:21.073 > [WebSocket] ========================================
18:38:21.079 > [ZTM] Settings saved successfully
18:38:21.082 > [WebSocket] ✓ ZTM activated successfully
18:38:21.084 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:21.090 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:21.093 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:21.095 > [WebSocket] ========================================
18:38:21.100 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":413169,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:21.139 > [413.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:21.247 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":412358,"type":"ztm_activated"}
18:38:21.263 > [WebSocket] Processing message type: ztm_activated
18:38:21.266 > [413.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:21.369 > [WebSocket] Received (183 bytes): {"currentMode":"normal","decrypt_failures":0,"esp32_connected":true,"hmac_failures":0,"replay_attempts":0,"requests_per_minute":25,"serverTime":1770124100621,"type":"security_update"}
18:38:21.386 > [WebSocket] Processing message type: security_update
18:38:21.392 > [WebSocket] Security update - Mode: normal, ESP32 Connected: true
18:38:21.397 > [413.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:21.502 > [WebSocket] Received (686 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","encData":"ENC_DATA:820218001800040804000000015DB595C136A3F3EE7F471C161FFFC850CF71B7334E11563F6F2FCB68DA02DD6295A3EAEA8D848016571A6E3783B403FB","pipeline":{"afterLFSR":"B2DE3B050E4BCCBFBC5B44ECC6E0F0DC028CA4EDDF0EDB9CC1111028E51516A2","afterSalt":"48522D36362053504F322D39362053544550532D323037354D50","afterTinkerbell":"C1A336955DB5563F16FF1F1C7F47DD6233114EB7CF71C8506802DACB6F2FF3EE","afterTransposition":"5DB595C136A3F3EE7F471C161FFFC850CF71B7334E11563F6F2FCB68DA02DD62"},"plaintext":"HR-66 SPO2-96 STEPS-2075","serverTime":1770124100621,"timestamp":412601,"type":"encryption_update","ztmEnabled":true}
18:38:21.564 > [WebSocket] Processing message type: encryption_update
18:38:21.570 > [413.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:21.677 > [WebSocket] Received (88 bytes): {"heartRate":66,"spo2":96,"steps":2075,"time":1770124100621,"type":"health_data_update"}
18:38:21.685 > [WebSocket] Processing message type: health_data_update
18:38:21.690 > [413.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:21.798 > [WebSocket] Received (226 bytes): {"sessionSummary":{"adaptiveMode":"normal","dataStored":true,"decryptionTime":0.3202,"encryptionTime":0.0,"finalPlaintext":"HR-66 SPO2-96 STEPS-2075","handshakeSuccess":true,"totalTime":0.3202},"type":"session_summary_update"}
18:38:21.821 > [WebSocket] Processing message type: session_summary_update
18:38:21.826 > [413.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:21.932 > [WebSocket] Received (660 bytes): {"decryptionTime":0.3202,"encryptedPacket":"820218001800040804000000015DB595C136A3F3EE7F471C161FFFC850CF71B7334E11563F6F2FCB68DA02DD6295A3EAEA8D848016571A6E3783B403FB","finalPlaintext":"HR-66 SPO2-96 STEPS-2075","healthData":{"heartRate":66,"spo2":96,"steps":2075},"pipeline":{"afterDepad":"48522D36362053504F322D39362053544550532D32303735000000000000","afterLFSR":"48522D36362053504F322D39362053544550532D323037354D50000000000000","afterTinkerbell":"B2DE3B050E4BCCBFBC5B44ECC6E0F0DC028CA4EDDF0EDB9CC1111028E51516A2","afterTransposition":"C1A336955DB5563F16FF1F1C7F47DD6233114EB7CF71C8506802DACB6F2FF3EE"},"serverTime":1770124100623,"type":"decryption_update"}
18:38:21.989 > [WebSocket] Processing message type: decryption_update
18:38:21.995 > [WebSocket] Server decryption completed
18:38:21.998 > [WebSocket] Health data - HR: 66, SPO2: 96, Steps: 2075
18:38:22.004 > [414.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:22.109 > [WebSocket] Received (699 bytes): {"currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","healthSendCount":10,"pipeline":{"afterLFSR":"B2DE3B050E4BCCBFBC5B44ECC6E0F0DC028CA4EDDF0EDB9CC1111028E51516A2","afterSalt":"48522D36362053504F322D39362053544550532D323037354D50","afterTinkerbell":"C1A336955DB5563F16FF1F1C7F47DD6233114EB7CF71C8506802DACB6F2FF3EE","afterTransposition":"5DB595C136A3F3EE7F471C161FFFC850CF71B7334E11563F6F2FCB68DA02DD62","finalPacket":"820218001800040804000000015DB595C136A3F3EE7F471C161FFFC850CF71B7334E11563F6F2FCB68DA02DD6295A3EAEA8D848016571A6E3783B403FB"},"plaintext":"HR-66 SPO2-96 STEPS-2075","timestamp":412724,"type":"encryption_pipeline","ztmEnabled":true}
18:38:22.169 > [WebSocket] Processing message type: encryption_pipeline
18:38:22.174 > [414.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:22.282 > [WebSocket] Received (160 bytes): {"deviceId":"f9641d44","healthSendCount":10,"message":"Health data #11 sent successfully","state":7,"success":true,"timestamp":412729,"type":"health_data_sent"}
18:38:22.298 > [WebSocket] Processing message type: health_data_sent
18:38:22.302 > [414.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:22.404 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":413169,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:22.441 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:22.446 > [WebSocket] ========================================
18:38:22.452 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:22.457 > [WebSocket] ========================================
18:38:22.462 > [ZTM] Settings saved successfully
18:38:22.466 > [WebSocket] ✓ ZTM activated successfully
18:38:22.469 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:22.473 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:22.476 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:22.479 > [WebSocket] ========================================
18:38:22.485 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":414553,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:22.523 > [414.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:22.630 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":413205,"type":"ztm_activated"}
18:38:22.647 > [WebSocket] Processing message type: ztm_activated
18:38:22.649 > [414.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:22.753 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124101155,"threatLevel":0,"type":"heuristics_update"}
18:38:22.778 > [WebSocket] Processing message type: heuristics_update
18:38:22.783 > [414.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:22.886 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124102164,"threatLevel":0,"type":"heuristics_update"}
18:38:22.912 > [WebSocket] Processing message type: heuristics_update
18:38:22.918 > [415.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:23.020 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":414553,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:23.055 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:23.061 > [WebSocket] ========================================
18:38:23.067 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:23.072 > [WebSocket] ========================================
18:38:23.078 > [ZTM] Settings saved successfully
18:38:23.081 > [WebSocket] ✓ ZTM activated successfully
18:38:23.084 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:23.089 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:23.092 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:23.094 > [WebSocket] ========================================
18:38:23.100 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":415168,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:23.139 > [415.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:23.244 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":414589,"type":"ztm_activated"}
18:38:23.260 > [WebSocket] Processing message type: ztm_activated
18:38:23.263 > [415.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:23.371 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":415168,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:23.406 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:23.412 > [WebSocket] ========================================
18:38:23.417 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:23.422 > [WebSocket] ========================================
18:38:23.427 > [ZTM] Settings saved successfully
18:38:23.431 > [WebSocket] ✓ ZTM activated successfully
18:38:23.434 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:23.439 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:23.442 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:23.444 > [WebSocket] ========================================
18:38:23.450 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":415519,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:23.490 > [415.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:23.595 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":415204,"type":"ztm_activated"}
18:38:23.611 > [WebSocket] Processing message type: ztm_activated
18:38:23.615 > [415.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:23.719 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124103178,"threatLevel":0,"type":"heuristics_update"}
18:38:23.744 > [WebSocket] Processing message type: heuristics_update
18:38:23.748 > [415.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:23.852 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":415519,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:23.888 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:23.894 > [WebSocket] ========================================
18:38:23.899 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:23.904 > [WebSocket] ========================================
18:38:23.910 > [ZTM] Settings saved successfully
18:38:23.913 > [WebSocket] ✓ ZTM activated successfully
18:38:23.916 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:23.921 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:23.924 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:23.926 > [WebSocket] ========================================
18:38:23.932 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":416001,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:23.971 > [416.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:24.077 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":415555,"type":"ztm_activated"}
18:38:24.095 > [WebSocket] Processing message type: ztm_activated
18:38:24.098 > [416.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:24.202 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":416001,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:24.238 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:24.244 > [WebSocket] ========================================
18:38:24.248 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:24.255 > [WebSocket] ========================================
18:38:24.260 > [ZTM] Settings saved successfully
18:38:24.263 > [WebSocket] ✓ ZTM activated successfully
18:38:24.266 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:24.271 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:24.274 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:24.277 > [WebSocket] ========================================
18:38:24.283 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":416351,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:24.321 > [416.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:24.427 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":416036,"type":"ztm_activated"}
18:38:24.444 > [WebSocket] Processing message type: ztm_activated
18:38:24.447 > [416.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:24.550 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124104187,"threatLevel":0,"type":"heuristics_update"}
18:38:24.575 > [WebSocket] Processing message type: heuristics_update
18:38:24.581 > [416.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:24.686 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":416351,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:24.722 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:24.727 > [WebSocket] ========================================
18:38:24.734 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:24.739 > [WebSocket] ========================================
18:38:24.744 > [ZTM] Settings saved successfully
18:38:24.747 > [WebSocket] ✓ ZTM activated successfully
18:38:24.750 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:24.756 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:24.759 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:24.761 > [WebSocket] ========================================
18:38:24.767 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":416835,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:24.810 > [416.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:24.912 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":416386,"type":"ztm_activated"}
18:38:24.927 > [WebSocket] Processing message type: ztm_activated
18:38:24.931 > [417.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:25.035 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":416835,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:25.071 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:25.076 > [WebSocket] ========================================
18:38:25.082 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:25.088 > [WebSocket] ========================================
18:38:25.093 > [ZTM] Settings saved successfully
18:38:25.096 > [WebSocket] ✓ ZTM activated successfully
18:38:25.098 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:25.104 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:25.107 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:25.109 > [WebSocket] ========================================
18:38:25.116 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":417184,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:25.154 > [417.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:25.260 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":416880,"type":"ztm_activated"}
18:38:25.277 > [WebSocket] Processing message type: ztm_activated
18:38:25.280 > [417.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:25.384 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":417184,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:25.420 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:25.425 > [WebSocket] ========================================
18:38:25.431 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:25.437 > [WebSocket] ========================================
18:38:25.441 > [ZTM] Settings saved successfully
18:38:25.445 > [WebSocket] ✓ ZTM activated successfully
18:38:25.448 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:25.454 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:25.456 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:25.459 > [WebSocket] ========================================
18:38:25.464 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":417533,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:25.503 > [417.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:25.609 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":417219,"type":"ztm_activated"}
18:38:25.626 > [WebSocket] Processing message type: ztm_activated
18:38:25.628 > [417.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:25.732 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124105200,"threatLevel":0,"type":"heuristics_update"}
18:38:25.757 > [WebSocket] Processing message type: heuristics_update
18:38:25.763 > [417.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:25.867 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":417533,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:25.904 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:25.910 > [WebSocket] ========================================
18:38:25.915 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:25.921 > [WebSocket] ========================================
18:38:25.926 > [ZTM] Settings saved successfully
18:38:25.929 > [WebSocket] ✓ ZTM activated successfully
18:38:25.932 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:25.937 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:25.940 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:25.943 > [WebSocket] ========================================
18:38:25.949 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":418017,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:25.987 > [418.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:26.093 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":417568,"type":"ztm_activated"}
18:38:26.109 > [WebSocket] Processing message type: ztm_activated
18:38:26.112 > [418.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:26.216 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":418017,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:26.253 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:26.258 > [WebSocket] ========================================
18:38:26.264 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:26.269 > [WebSocket] ========================================
18:38:26.276 > [ZTM] Settings saved successfully
18:38:26.278 > [WebSocket] ✓ ZTM activated successfully
18:38:26.280 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:26.286 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:26.289 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:26.292 > [WebSocket] ========================================
18:38:26.297 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":418366,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:26.336 > [418.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:26.442 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":418052,"type":"ztm_activated"}
18:38:26.459 > [WebSocket] Processing message type: ztm_activated
18:38:26.462 > [418.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:26.566 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124106211,"threatLevel":0,"type":"heuristics_update"}
18:38:26.591 > [WebSocket] Processing message type: heuristics_update
18:38:26.596 > [418.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:26.698 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":418366,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:26.733 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:26.739 > [WebSocket] ========================================
18:38:26.745 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:26.751 > [WebSocket] ========================================
18:38:26.756 > [ZTM] Settings saved successfully
18:38:26.759 > [WebSocket] ✓ ZTM activated successfully
18:38:26.762 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:26.768 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:26.770 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:26.773 > [WebSocket] ========================================
18:38:26.779 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":418847,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:26.818 > [418.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:26.924 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":418401,"type":"ztm_activated"}
18:38:26.941 > [WebSocket] Processing message type: ztm_activated
18:38:26.944 > [419.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:27.051 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":418847,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:27.086 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:27.092 > [WebSocket] ========================================
18:38:27.098 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:27.103 > [WebSocket] ========================================
18:38:27.108 > [ZTM] Settings saved successfully
18:38:27.112 > [WebSocket] ✓ ZTM activated successfully
18:38:27.114 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:27.120 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:27.123 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:27.125 > [WebSocket] ========================================
18:38:27.130 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":419199,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:27.170 > [419.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:27.275 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":418883,"type":"ztm_activated"}
18:38:27.291 > [WebSocket] Processing message type: ztm_activated
18:38:27.295 > [419.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:27.398 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":419199,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:27.435 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:27.440 > [WebSocket] ========================================
18:38:27.446 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:27.452 > [WebSocket] ========================================
18:38:27.457 > [ZTM] Settings saved successfully
18:38:27.459 > [WebSocket] ✓ ZTM activated successfully
18:38:27.462 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:27.467 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:27.471 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:27.474 > [WebSocket] ========================================
18:38:27.479 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":419548,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:27.519 > [419.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:27.624 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":419234,"type":"ztm_activated"}
18:38:27.640 > [WebSocket] Processing message type: ztm_activated
18:38:27.644 > [419.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:27.747 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124107223,"threatLevel":0,"type":"heuristics_update"}
18:38:27.772 > [WebSocket] Processing message type: heuristics_update
18:38:27.778 > [419.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:27.881 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":419548,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:27.917 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:27.922 > [WebSocket] ========================================
18:38:27.928 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:27.933 > [WebSocket] ========================================
18:38:27.939 > [ZTM] Settings saved successfully
18:38:27.942 > [WebSocket] ✓ ZTM activated successfully
18:38:27.944 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:27.950 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:27.953 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:27.956 > [WebSocket] ========================================
18:38:27.961 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":420030,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:28.000 > [420.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:28.106 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":419584,"type":"ztm_activated"}
18:38:28.122 > [WebSocket] Processing message type: ztm_activated
18:38:28.125 > [420.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:28.231 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":420030,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:28.268 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:28.273 > [WebSocket] ========================================
18:38:28.278 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:28.284 > [WebSocket] ========================================
18:38:28.290 > [ZTM] Settings saved successfully
18:38:28.292 > [WebSocket] ✓ ZTM activated successfully
18:38:28.295 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:28.300 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:28.303 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:28.306 > [WebSocket] ========================================
18:38:28.311 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":420380,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:28.350 > [420.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:28.457 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":420065,"type":"ztm_activated"}
18:38:28.474 > [WebSocket] Processing message type: ztm_activated
18:38:28.476 > [420.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:28.580 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124108230,"threatLevel":0,"type":"heuristics_update"}
18:38:28.606 > [WebSocket] Processing message type: heuristics_update
18:38:28.611 > [420.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:28.713 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":420380,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:28.750 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:28.755 > [WebSocket] ========================================
18:38:28.760 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:28.766 > [WebSocket] ========================================
18:38:28.772 > [ZTM] Settings saved successfully
18:38:28.775 > [WebSocket] ✓ ZTM activated successfully
18:38:28.777 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:28.782 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:28.785 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:28.789 > [WebSocket] ========================================
18:38:28.794 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":420862,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:28.832 > [420.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:28.940 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":420416,"type":"ztm_activated"}
18:38:28.956 > [WebSocket] Processing message type: ztm_activated
18:38:28.959 > [421.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:29.062 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":420862,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:29.098 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:29.105 > [WebSocket] ========================================
18:38:29.109 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:29.116 > [WebSocket] ========================================
18:38:29.121 > [ZTM] Settings saved successfully
18:38:29.124 > [WebSocket] ✓ ZTM activated successfully
18:38:29.126 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:29.132 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:29.135 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:29.138 > [WebSocket] ========================================
18:38:29.143 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":421212,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:29.182 > [421.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:29.288 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":420898,"type":"ztm_activated"}
18:38:29.305 > [WebSocket] Processing message type: ztm_activated
18:38:29.308 > [421.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:29.414 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":421212,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:29.450 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:29.456 > [WebSocket] ========================================
18:38:29.461 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:29.467 > [WebSocket] ========================================
18:38:29.472 > [ZTM] Settings saved successfully
18:38:29.475 > [WebSocket] ✓ ZTM activated successfully
18:38:29.477 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:29.483 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:29.486 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:29.489 > [WebSocket] ========================================
18:38:29.494 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":421563,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:29.534 > [421.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:29.639 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":421247,"type":"ztm_activated"}
18:38:29.656 > [WebSocket] Processing message type: ztm_activated
18:38:29.658 > [421.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:29.762 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124109244,"threatLevel":0,"type":"heuristics_update"}
18:38:29.787 > [WebSocket] Processing message type: heuristics_update
18:38:29.793 > [421.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:29.896 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":421563,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:29.932 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:29.938 > [WebSocket] ========================================
18:38:29.944 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:29.948 > [WebSocket] ========================================
18:38:29.954 > [ZTM] Settings saved successfully
18:38:29.956 > [WebSocket] ✓ ZTM activated successfully
18:38:29.960 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:29.966 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:29.969 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:29.971 > [WebSocket] ========================================
18:38:29.976 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":422045,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:30.021 > [422.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:30.121 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":421599,"type":"ztm_activated"}
18:38:30.138 > [WebSocket] Processing message type: ztm_activated
18:38:30.140 > [422.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:30.245 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":422045,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:30.280 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:30.286 > [WebSocket] ========================================
18:38:30.292 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:30.297 > [WebSocket] ========================================
18:38:30.303 > [ZTM] Settings saved successfully
18:38:30.305 > [WebSocket] ✓ ZTM activated successfully
18:38:30.308 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:30.314 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:30.317 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:30.320 > [WebSocket] ========================================
18:38:30.325 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":422394,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:30.364 > [422.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:30.469 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":422090,"type":"ztm_activated"}
18:38:30.486 > [WebSocket] Processing message type: ztm_activated
18:38:30.490 > [422.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:30.596 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124110258,"threatLevel":0,"type":"heuristics_update"}
18:38:30.621 > [WebSocket] Processing message type: heuristics_update
18:38:30.626 > [422.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:30.729 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":422394,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:30.765 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:30.771 > [WebSocket] ========================================
18:38:30.776 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:30.782 > [WebSocket] ========================================
18:38:30.788 > [ZTM] Settings saved successfully
18:38:30.790 > [WebSocket] ✓ ZTM activated successfully
18:38:30.792 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:30.798 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:30.801 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:30.804 > [WebSocket] ========================================
18:38:30.809 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":422878,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:30.848 > [422.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:30.856 > [RETRY] Attempting to send health data (Max retries: 3)
18:38:30.862 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:38:30.865 > Generated health data: HR-67 SPO2-96 STEPS-2123
18:38:30.870 > [ESP32] ========================================
18:38:30.872 > [ESP32] ENCRYPTION PIPELINE START
18:38:30.876 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:38:30.882 > [ESP32] Active Algorithms for this packet:
18:38:30.888 > [ESP32]   + LFSR
18:38:30.888 > [ESP32]   + Tinkerbell
18:38:30.890 > [ESP32]   + Transposition
18:38:30.893 > [ESP32]   - ChaCha20
18:38:30.893 > [ESP32]   - Salsa20
18:38:30.896 > [ESP32] ========================================
18:38:30.902 > [ESP32] MsgKeys: lfsrSeed=0x76846034 tnk[0..3]=45FAC0E1 trn[0..3]=80FE722F
18:38:30.907 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D323132334D50
18:38:30.912 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D323132334D50000000000000 
18:38:30.920 > [ESP32][LFSR] Initializing - Seed: 0x76846034 SeedBe: 0x34608476 ChaosKey[0..3]: 45FAC0E1 InitialTap: 0x0029 State: 0x76846034
18:38:30.931 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
18:38:30.940 > 3_After_LFSR (32): 7C32A940F5A80EA99AD34E217297E1B6 09133734A9FCD4219EFC753DB81CC79A 
18:38:30.948 > [ESP32][LFSR] Keystream (first 16 bytes): 34608476C2885DF9D5E1631844B7B2E2
18:38:30.954 > [ESP32][4D] LFSR keystream (first 32 bytes): 34608476C2885DF9D5E1631844B7B2E24C4364199BCDE612D3AC753DB81CC79A
18:38:30.962 > [ESP32][TINKERBELL] Input (first 16 bytes): 7C32A940F5A80EA99AD34E217297E1B6 Nonce: 0x00000002 Buffer size: 32 bytes
18:38:30.973 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 45FAC0E1
18:38:30.985 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): BC16DC7000ABA613ED0EE7A983FAAEE1
18:38:30.993 > 4_After_Tinkerbell (32): C0247530F503A8BA77DDA988F16D4F57 AFB07FD1C2EB33F4A83210AF6B24D0F2 
18:38:30.998 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): BC16DC7000ABA613ED0EE7A983FAAEE1
18:38:31.007 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): BC16DC7000ABA613ED0EE7A983FAAEE1A6A348E56B17E7D536CE6592D3381768
18:38:31.018 > 5_After_Transposition (32): EBD1C2B07FAF4F57A9DD77C02475F433 0330F5AF6B24BAA81032A8F16D88D0F2 
18:38:31.027 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
18:38:31.032 > [ESP32] === HMAC DEBUG INFO ===
18:38:31.035 > [ESP32] HMAC Key being used: 61FF1ED643F491454CBC1C1BFF10AAA3DBFA7E14EC40A6381ED35D30BEE608E9
18:38:31.042 > [ESP32] HMAC Input length: 45 bytes
18:38:31.046 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002EBD1C2B07FAF4F57A9DD77C02475F4330330F5
18:38:31.054 > [ESP32] Nonce: 0x00000002
18:38:31.056 > [ESP32] Packet size before HMAC: 61
18:38:31.059 > [ESP32] Computed HMAC Tag: 7294CAD00D5B81B9C012899341244101
18:38:31.065 > [ESP32] === END HMAC DEBUG ===
18:38:31.067 > 6_Final_Packet (61): 82021800180004080400000002EBD1C2 B07FAF4F57A9DD77C02475F4330330F5 ...
18:38:31.076 > [RETRY] Attempt 1/3 (nonce: 2)
18:38:31.079 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:31.085 > Sending pipeline data to server (659 bytes)
18:38:31.215 > [HTTP] Response code: 400
18:38:31.215 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:31.220 > [HTTP] Request failed with code: 400
18:38:31.224 > [RETRY] Send failed, waiting 100 ms before retry
18:38:31.323 > [RETRY] Attempt 2/3 (nonce: 2)
18:38:31.323 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:31.329 > Sending pipeline data to server (659 bytes)
18:38:31.470 > [HTTP] Response code: 400
18:38:31.470 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:31.475 > [HTTP] Request failed with code: 400
18:38:31.478 > [RETRY] Send failed, waiting 200 ms before retry
18:38:31.677 > [RETRY] Attempt 3/3 (nonce: 2)
18:38:31.678 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:31.682 > Sending pipeline data to server (659 bytes)
18:38:31.975 > [HTTP] Response code: 400
18:38:31.975 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:31.980 > [HTTP] Request failed with code: 400
18:38:31.983 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:38:31.988 > [RETRY] Consecutive failures: 1
18:38:31.991 > Health data send failed (retry count: 1/3)
18:38:32.094 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":422430,"type":"ztm_activated"}
18:38:32.110 > [WebSocket] Processing message type: ztm_activated
18:38:32.113 > [424.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:32.122 > [RETRY] Attempting to send health data (Max retries: 3)
18:38:32.127 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:38:32.133 > Generated health data: HR-67 SPO2-96 STEPS-2136
18:38:32.135 > [ESP32] ========================================
18:38:32.142 > [ESP32] ENCRYPTION PIPELINE START
18:38:32.144 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:38:32.150 > [ESP32] Active Algorithms for this packet:
18:38:32.152 > [ESP32]   + LFSR
18:38:32.155 > [ESP32]   + Tinkerbell
18:38:32.155 > [ESP32]   + Transposition
18:38:32.158 > [ESP32]   - ChaCha20
18:38:32.161 > [ESP32]   - Salsa20
18:38:32.161 > [ESP32] ========================================
18:38:32.167 > [ESP32] MsgKeys: lfsrSeed=0x76846034 tnk[0..3]=45FAC0E1 trn[0..3]=80FE722F
18:38:32.172 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D323133364D50
18:38:32.180 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D323133364D50000000000000 
18:38:32.186 > [ESP32][LFSR] Initializing - Seed: 0x76846034 SeedBe: 0x34608476 ChaosKey[0..3]: 45FAC0E1 InitialTap: 0x0029 State: 0x76846034
18:38:32.196 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
18:38:32.205 > 3_After_LFSR (32): 7C32A940F5A80EA99AD34E217297E1B6 09133734A9FCD5249EFC753DB81CC79A 
18:38:32.214 > [ESP32][LFSR] Keystream (first 16 bytes): 34608476C2885DF9D5E1631844B7B2E2
18:38:32.218 > [ESP32][4D] LFSR keystream (first 32 bytes): 34608476C2885DF9D5E1631844B7B2E24C4364199BCDE612D3AC753DB81CC79A
18:38:32.230 > [ESP32][TINKERBELL] Input (first 16 bytes): 7C32A940F5A80EA99AD34E217297E1B6 Nonce: 0x00000002 Buffer size: 32 bytes
18:38:32.241 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 45FAC0E1
18:38:32.250 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): BC16DC7000ABA613ED0EE7A983FAAEE1
18:38:32.257 > 4_After_Tinkerbell (32): C0247530F503A8BA77DDA988F16D4F57 AFB07FD1C2EB32F1A83210AF6B24D0F2 
18:38:32.267 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): BC16DC7000ABA613ED0EE7A983FAAEE1
18:38:32.275 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): BC16DC7000ABA613ED0EE7A983FAAEE1A6A348E56B17E7D536CE6592D3381768
18:38:32.282 > 5_After_Transposition (32): EBD1C2B07FAF4F57A9DD77C02475F132 0330F5AF6B24BAA81032A8F16D88D0F2 
18:38:32.291 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
18:38:32.296 > [ESP32] === HMAC DEBUG INFO ===
18:38:32.300 > [ESP32] HMAC Key being used: 61FF1ED643F491454CBC1C1BFF10AAA3DBFA7E14EC40A6381ED35D30BEE608E9
18:38:32.307 > [ESP32] HMAC Input length: 45 bytes
18:38:32.311 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002EBD1C2B07FAF4F57A9DD77C02475F1320330F5
18:38:32.319 > [ESP32] Nonce: 0x00000002
18:38:32.322 > [ESP32] Packet size before HMAC: 61
18:38:32.324 > [ESP32] Computed HMAC Tag: E42FF7DCEBCDA6EC83D72499553F6CFD
18:38:32.330 > [ESP32] === END HMAC DEBUG ===
18:38:32.333 > 6_Final_Packet (61): 82021800180004080400000002EBD1C2 B07FAF4F57A9DD77C02475F1320330F5 ...
18:38:32.341 > [RETRY] Attempt 1/3 (nonce: 2)
18:38:32.344 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:32.349 > Sending pipeline data to server (659 bytes)
18:38:32.482 > [HTTP] Response code: 400
18:38:32.482 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:32.488 > [HTTP] Request failed with code: 400
18:38:32.491 > [RETRY] Send failed, waiting 100 ms before retry
18:38:32.590 > [RETRY] Attempt 2/3 (nonce: 2)
18:38:32.590 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:32.595 > Sending pipeline data to server (659 bytes)
18:38:32.730 > [HTTP] Response code: 400
18:38:32.730 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:32.735 > [HTTP] Request failed with code: 400
18:38:32.738 > [RETRY] Send failed, waiting 200 ms before retry
18:38:32.938 > [RETRY] Attempt 3/3 (nonce: 2)
18:38:32.938 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:32.943 > Sending pipeline data to server (659 bytes)
18:38:33.233 > [HTTP] Response code: 400
18:38:33.233 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:33.238 > [HTTP] Request failed with code: 400
18:38:33.241 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:38:33.246 > [RETRY] Consecutive failures: 2
18:38:33.249 > Health data send failed (retry count: 2/3)
18:38:33.353 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":422878,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:33.389 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:33.394 > [WebSocket] ========================================
18:38:33.400 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:33.405 > [WebSocket] ========================================
18:38:33.411 > [ZTM] Settings saved successfully
18:38:33.414 > [WebSocket] ✓ ZTM activated successfully
18:38:33.417 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:33.422 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:33.425 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:33.428 > [WebSocket] ========================================
18:38:33.434 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":425502,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:33.472 > [425.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:33.480 > [RETRY] Attempting to send health data (Max retries: 3)
18:38:33.486 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:38:33.489 > Generated health data: HR-67 SPO2-96 STEPS-2126
18:38:33.495 > [ESP32] ========================================
18:38:33.497 > [ESP32] ENCRYPTION PIPELINE START
18:38:33.500 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:38:33.505 > [ESP32] Active Algorithms for this packet:
18:38:33.511 > [ESP32]   + LFSR
18:38:33.511 > [ESP32]   + Tinkerbell
18:38:33.514 > [ESP32]   + Transposition
18:38:33.516 > [ESP32]   - ChaCha20
18:38:33.516 > [ESP32]   - Salsa20
18:38:33.520 > [ESP32] ========================================
18:38:33.525 > [ESP32] MsgKeys: lfsrSeed=0x76846034 tnk[0..3]=45FAC0E1 trn[0..3]=80FE722F
18:38:33.530 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D323132364D50
18:38:33.536 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D323132364D50000000000000 
18:38:33.544 > [ESP32][LFSR] Initializing - Seed: 0x76846034 SeedBe: 0x34608476 ChaosKey[0..3]: 45FAC0E1 InitialTap: 0x0029 State: 0x76846034
18:38:33.555 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
18:38:33.564 > 3_After_LFSR (32): 7C32A940F5A80EA99AD34E217297E1B6 09133734A9FCD4249EFC753DB81CC79A 
18:38:33.572 > [ESP32][LFSR] Keystream (first 16 bytes): 34608476C2885DF9D5E1631844B7B2E2
18:38:33.578 > [ESP32][4D] LFSR keystream (first 32 bytes): 34608476C2885DF9D5E1631844B7B2E24C4364199BCDE612D3AC753DB81CC79A
18:38:33.586 > [ESP32][TINKERBELL] Input (first 16 bytes): 7C32A940F5A80EA99AD34E217297E1B6 Nonce: 0x00000002 Buffer size: 32 bytes
18:38:33.597 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 45FAC0E1
18:38:33.608 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): BC16DC7000ABA613ED0EE7A983FAAEE1
18:38:33.617 > 4_After_Tinkerbell (32): C0247530F503A8BA77DDA988F16D4F57 AFB07FD1C2EB33F1A83210AF6B24D0F2 
18:38:33.622 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): BC16DC7000ABA613ED0EE7A983FAAEE1
18:38:33.630 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): BC16DC7000ABA613ED0EE7A983FAAEE1A6A348E56B17E7D536CE6592D3381768
18:38:33.642 > 5_After_Transposition (32): EBD1C2B07FAF4F57A9DD77C02475F133 0330F5AF6B24BAA81032A8F16D88D0F2 
18:38:33.649 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
18:38:33.655 > [ESP32] === HMAC DEBUG INFO ===
18:38:33.658 > [ESP32] HMAC Key being used: 61FF1ED643F491454CBC1C1BFF10AAA3DBFA7E14EC40A6381ED35D30BEE608E9
18:38:33.667 > [ESP32] HMAC Input length: 45 bytes
18:38:33.669 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002EBD1C2B07FAF4F57A9DD77C02475F1330330F5
18:38:33.677 > [ESP32] Nonce: 0x00000002
18:38:33.681 > [ESP32] Packet size before HMAC: 61
18:38:33.683 > [ESP32] Computed HMAC Tag: 10524531518AEE5ED613099F285FAECC
18:38:33.689 > [ESP32] === END HMAC DEBUG ===
18:38:33.692 > 6_Final_Packet (61): 82021800180004080400000002EBD1C2 B07FAF4F57A9DD77C02475F1330330F5 ...
18:38:33.699 > [RETRY] Attempt 1/3 (nonce: 2)
18:38:33.703 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:33.708 > Sending pipeline data to server (659 bytes)
18:38:33.982 > [HTTP] Response code: 400
18:38:33.983 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:33.988 > [HTTP] Request failed with code: 400
18:38:33.991 > [RETRY] Send failed, waiting 100 ms before retry
18:38:34.091 > [RETRY] Attempt 2/3 (nonce: 2)
18:38:34.091 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:34.097 > Sending pipeline data to server (659 bytes)
18:38:34.493 > [HTTP] Response code: 400
18:38:34.494 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:34.499 > [HTTP] Request failed with code: 400
18:38:34.502 > [RETRY] Send failed, waiting 200 ms before retry
18:38:34.702 > [RETRY] Attempt 3/3 (nonce: 2)
18:38:34.702 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:34.707 > Sending pipeline data to server (659 bytes)
18:38:35.008 > [HTTP] Response code: 400
18:38:35.008 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:35.014 > [HTTP] Request failed with code: 400
18:38:35.016 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:38:35.023 > [RETRY] Consecutive failures: 3
18:38:35.025 > Health data send failed (retry count: 3/3)
18:38:35.028 > Health data transmission failed after max retries
18:38:35.129 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":422914,"type":"ztm_activated"}
18:38:35.147 > [WebSocket] Processing message type: ztm_activated
18:38:35.150 > [427.2] STATE: ERROR | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:35.158 > ERROR state - attempting recovery
18:38:35.160 > [RETRY] Attempting to send health data (Max retries: 3)
18:38:35.166 > [RETRY] Using nonce 2 for all retry attempts (saved: 1)
18:38:35.169 > Generated health data: HR-67 SPO2-96 STEPS-2170
18:38:35.175 > [ESP32] ========================================
18:38:35.180 > [ESP32] ENCRYPTION PIPELINE START
18:38:35.183 > [ESP32] Mode: ZTM | ZTM Enabled: TRUE | Recipe: CHAOS_ONLY
18:38:35.185 > [ESP32] Active Algorithms for this packet:
18:38:35.191 > [ESP32]   + LFSR
18:38:35.191 > [ESP32]   + Tinkerbell
18:38:35.194 > [ESP32]   + Transposition
18:38:35.197 > [ESP32]   - ChaCha20
18:38:35.200 > [ESP32]   - Salsa20
18:38:35.200 > [ESP32] ========================================
18:38:35.205 > [ESP32] MsgKeys: lfsrSeed=0x76846034 tnk[0..3]=45FAC0E1 trn[0..3]=80FE722F
18:38:35.210 > 1_After_Salt (26): 48522D36372053504F322D3936205354 4550532D323137304D50
18:38:35.216 > 2_After_Padding (32): 48522D36372053504F322D3936205354 4550532D323137304D50000000000000 
18:38:35.225 > [ESP32][LFSR] Initializing - Seed: 0x76846034 SeedBe: 0x34608476 ChaosKey[0..3]: 45FAC0E1 InitialTap: 0x0029 State: 0x76846034
18:38:35.235 > [ESP32][LFSR] Input (first 16 bytes): 48522D36372053504F322D3936205354 Buffer size: 32 bytes
18:38:35.244 > 3_After_LFSR (32): 7C32A940F5A80EA99AD34E217297E1B6 09133734A9FCD1229EFC753DB81CC79A 
18:38:35.252 > [ESP32][LFSR] Keystream (first 16 bytes): 34608476C2885DF9D5E1631844B7B2E2
18:38:35.258 > [ESP32][4D] LFSR keystream (first 32 bytes): 34608476C2885DF9D5E1631844B7B2E24C4364199BCDE612D3AC753DB81CC79A
18:38:35.269 > [ESP32][TINKERBELL] Input (first 16 bytes): 7C32A940F5A80EA99AD34E217297E1B6 Nonce: 0x00000002 Buffer size: 32 bytes
18:38:35.277 > [ESP32][TINKERBELL] Generating keystream block - Nonce: 0x00000002 Counter: 0 (must start at 0) Key[0..3]: 45FAC0E1
18:38:35.288 > [ESP32][TINKERBELL] Keystream block[0] (first 16 bytes): BC16DC7000ABA613ED0EE7A983FAAEE1
18:38:35.297 > 4_After_Tinkerbell (32): C0247530F503A8BA77DDA988F16D4F57 AFB07FD1C2EB36F7A83210AF6B24D0F2 
18:38:35.305 > [ESP32][TINKERBELL] Applied keystream (first 16 bytes): BC16DC7000ABA613ED0EE7A983FAAEE1
18:38:35.313 > [ESP32][4D] Tinkerbell keystream (first 32 bytes): BC16DC7000ABA613ED0EE7A983FAAEE1A6A348E56B17E7D536CE6592D3381768
18:38:35.321 > 5_After_Transposition (32): EBD1C2B07FAF4F57A9DD77C02475F736 0330F5AF6B24BAA81032A8F16D88D0F2 
18:38:35.330 > [ESP32][4B] recipeId=4 (CHAOS_ONLY) nonce=0x00000002
18:38:35.335 > [ESP32] === HMAC DEBUG INFO ===
18:38:35.338 > [ESP32] HMAC Key being used: 61FF1ED643F491454CBC1C1BFF10AAA3DBFA7E14EC40A6381ED35D30BEE608E9
18:38:35.346 > [ESP32] HMAC Input length: 45 bytes
18:38:35.349 > [ESP32] HMAC Input (first 32 bytes): 82021800180004080400000002EBD1C2B07FAF4F57A9DD77C02475F7360330F5
18:38:35.357 > [ESP32] Nonce: 0x00000002
18:38:35.360 > [ESP32] Packet size before HMAC: 61
18:38:35.364 > [ESP32] Computed HMAC Tag: 41D0273C9EBB1871E75ECED79610B6AE
18:38:35.369 > [ESP32] === END HMAC DEBUG ===
18:38:35.372 > 6_Final_Packet (61): 82021800180004080400000002EBD1C2 B07FAF4F57A9DD77C02475F7360330F5 ...
18:38:35.380 > [RETRY] Attempt 1/3 (nonce: 2)
18:38:35.383 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:35.389 > Sending pipeline data to server (659 bytes)
18:38:35.514 > [HTTP] Response code: 400
18:38:35.514 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:35.519 > [HTTP] Request failed with code: 400
18:38:35.521 > [RETRY] Send failed, waiting 100 ms before retry
18:38:35.622 > [RETRY] Attempt 2/3 (nonce: 2)
18:38:35.622 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:35.628 > Sending pipeline data to server (659 bytes)
18:38:36.005 > [HTTP] Response code: 400
18:38:36.005 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:36.010 > [HTTP] Request failed with code: 400
18:38:36.013 > [RETRY] Send failed, waiting 200 ms before retry
18:38:36.213 > [RETRY] Attempt 3/3 (nonce: 2)
18:38:36.213 > POST http://10.249.92.115:8081/health-data with pipeline data
18:38:36.219 > Sending pipeline data to server (659 bytes)
18:38:36.508 > [HTTP] Response code: 400
18:38:36.508 > [HTTP] Error response: {"error":"Decryption failed"}
18:38:36.514 > [HTTP] Request failed with code: 400
18:38:36.517 > [RETRY] All retry attempts failed - rolled back nonce to 1
18:38:36.522 > [RETRY] Consecutive failures: 4
18:38:36.525 > ✗ Auto-recovery failed - restarting key exchange
18:38:38.627 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Failed to send health data","state":7,"success":false,"timestamp":423291,"type":"health_data_error"}
18:38:38.640 > [WebSocket] Processing message type: health_data_error
18:38:38.647 > [430.7] STATE: CHECK_PUBLIC_KEY | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:38.655 > ✓ Public key loaded from NVS
18:38:38.752 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124111270,"threatLevel":0,"type":"heuristics_update"}
18:38:38.777 > [WebSocket] Processing message type: heuristics_update
18:38:38.784 > [430.8] STATE: GENERATE_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:38.886 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Failed to send health data","state":7,"success":false,"timestamp":423546,"type":"health_data_error"}
18:38:38.899 > [WebSocket] Processing message type: health_data_error
18:38:38.906 > [431.0] STATE: ENCRYPT_MASTER_KEY | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:38.914 > Generating fresh master key from entropy...
18:38:38.922 > Generated master key (32): EF527592C790E1A14E33F5534CD415BB B04899DF6D06C80C02D8A2D376EDD5F3 
18:38:38.927 > Using reduced master key (byte % 3) for NTRU encryption only
18:38:38.938 > NTRU encrypted master key (502): 0064005A003F0067001600440006006D 003600030020000E006C00700021000D ...
18:38:38.947 > POST http://10.249.92.115:8081/master-key
18:38:39.267 > ✓ Master key exchange completed
18:38:39.369 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Failed to send health data","state":7,"success":false,"timestamp":424051,"type":"health_data_error"}
18:38:39.383 > [WebSocket] Processing message type: health_data_error
18:38:39.389 > [431.5] STATE: DERIVE_SYMMETRIC | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:39.397 > Loading master key from NVS and deriving symmetric keys...
18:38:39.402 > Loaded master key from NVS (32): EF527592C790E1A14E33F5534CD415BB B04899DF6D06C80C02D8A2D376EDD5F3 
18:38:39.411 > Derived HMAC key (32): 5E0846710FF00A9E5ECA21231D3619C6 34FFE1C2844B774FB13765B69A1EE2F2 
18:38:39.419 > Derived Tinkerbell key (16): 89E1FD2302887654044E770E3910431E 
18:38:39.425 > Derived Transposition key (16): 47DA7B38ABD442AB1865BD76CE3DCA82 
18:38:39.430 > ✓ Symmetric keys derived successfully
18:38:39.433 > Nonce tracker reset - new session started
18:38:39.929 > Waiting for server to process master key...
18:38:39.933 > ✓ Symmetric keys ready - starting health data transmission
18:38:40.035 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124112285,"threatLevel":0,"type":"heuristics_update"}
18:38:40.060 > [WebSocket] Processing message type: heuristics_update
18:38:40.066 > [432.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:40.169 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Failed to send health data","state":7,"success":false,"timestamp":424558,"type":"health_data_error"}
18:38:40.183 > [WebSocket] Processing message type: health_data_error
18:38:40.188 > [432.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:40.291 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Failed to send health data","state":7,"success":false,"timestamp":424806,"type":"health_data_error"}
18:38:40.305 > [WebSocket] Processing message type: health_data_error
18:38:40.310 > [432.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:40.413 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Failed to send health data","state":7,"success":false,"timestamp":425309,"type":"health_data_error"}
18:38:40.426 > [WebSocket] Processing message type: health_data_error
18:38:40.432 > [432.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:40.534 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124113298,"threatLevel":0,"type":"heuristics_update"}
18:38:40.559 > [WebSocket] Processing message type: heuristics_update
18:38:40.565 > [432.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:40.668 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":425502,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:40.704 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:40.709 > [WebSocket] ========================================
18:38:40.715 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:40.721 > [WebSocket] ========================================
18:38:40.726 > [ZTM] Settings saved successfully
18:38:40.729 > [WebSocket] ✓ ZTM activated successfully
18:38:40.732 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:40.736 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:40.740 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:40.743 > [WebSocket] ========================================
18:38:40.748 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":432817,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:40.786 > [432.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:40.893 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":425538,"type":"ztm_activated"}
18:38:40.910 > [WebSocket] Processing message type: ztm_activated
18:38:40.913 > [433.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:41.015 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Failed to send health data","state":7,"success":false,"timestamp":426059,"type":"health_data_error"}
18:38:41.030 > [WebSocket] Processing message type: health_data_error
18:38:41.035 > [433.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:41.138 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124114300,"threatLevel":0,"type":"heuristics_update"}
18:38:41.163 > [WebSocket] Processing message type: heuristics_update
18:38:41.168 > [433.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:41.271 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Failed to send health data","state":7,"success":false,"timestamp":426570,"type":"health_data_error"}
18:38:41.285 > [WebSocket] Processing message type: health_data_error
18:38:41.290 > [433.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:41.393 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Failed to send health data","state":7,"success":false,"timestamp":427084,"type":"health_data_error"}
18:38:41.406 > [WebSocket] Processing message type: health_data_error
18:38:41.412 > [433.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:41.514 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124115315,"threatLevel":0,"type":"heuristics_update"}
18:38:41.540 > [WebSocket] Processing message type: heuristics_update
18:38:41.546 > [433.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:41.647 > [433.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:41.754 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Failed to send health data","state":8,"success":false,"timestamp":427590,"type":"health_data_error"}
18:38:41.767 > [WebSocket] Processing message type: health_data_error
18:38:41.772 > [433.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:41.877 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Failed to send health data","state":8,"success":false,"timestamp":428081,"type":"health_data_error"}
18:38:41.890 > [WebSocket] Processing message type: health_data_error
18:38:41.895 > [434.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:41.999 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124116324,"threatLevel":0,"type":"heuristics_update"}
18:38:42.023 > [WebSocket] Processing message type: heuristics_update
18:38:42.029 > [434.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:42.131 > [WebSocket] Received (155 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Failed to send health data","state":8,"success":false,"timestamp":428584,"type":"health_data_error"}
18:38:42.146 > [WebSocket] Processing message type: health_data_error
18:38:42.151 > [434.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:42.254 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124117338,"threatLevel":0,"type":"heuristics_update"}
18:38:42.279 > [WebSocket] Processing message type: heuristics_update
18:38:42.283 > [434.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:42.387 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124118351,"threatLevel":0,"type":"heuristics_update"}
18:38:42.411 > [WebSocket] Processing message type: heuristics_update
18:38:42.417 > [434.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:42.520 > [WebSocket] Received (126 bytes): {"keySize":32,"message":"Master key successfully received from ESP32","serverTime":1770124119049,"type":"master_key_received"}
18:38:42.533 > [WebSocket] Processing message type: master_key_received
18:38:42.537 > [434.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:42.642 > [WebSocket] Received (176 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Master key successfully exchanged with server","state":5,"success":true,"timestamp":431337,"type":"master_key_exchanged"}
18:38:42.658 > [WebSocket] Processing message type: master_key_exchanged
18:38:42.664 > [434.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:42.764 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124119362,"threatLevel":0,"type":"heuristics_update"}
18:38:42.790 > [WebSocket] Processing message type: heuristics_update
18:38:42.795 > [434.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:42.898 > [WebSocket] Received (168 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Symmetric keys successfully derived","state":6,"success":true,"timestamp":432005,"type":"symmetric_keys_derived"}
18:38:42.915 > [WebSocket] Processing message type: symmetric_keys_derived
18:38:42.920 > [435.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:43.020 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124120374,"threatLevel":0,"type":"heuristics_update"}
18:38:43.045 > [WebSocket] Processing message type: heuristics_update
18:38:43.050 > [435.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:43.153 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":432817,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:43.189 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:43.194 > [WebSocket] ========================================
18:38:43.199 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:43.205 > [WebSocket] ========================================
18:38:43.210 > [ZTM] Settings saved successfully
18:38:43.214 > [WebSocket] ✓ ZTM activated successfully
18:38:43.217 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:43.222 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:43.225 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:43.228 > [WebSocket] ========================================
18:38:43.234 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":435302,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:43.272 > [435.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:43.378 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":432853,"type":"ztm_activated"}
18:38:43.394 > [WebSocket] Processing message type: ztm_activated
18:38:43.397 > [435.5] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:43.502 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124121387,"threatLevel":0,"type":"heuristics_update"}
18:38:43.526 > [WebSocket] Processing message type: heuristics_update
18:38:43.532 > [435.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:43.634 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124122395,"threatLevel":0,"type":"heuristics_update"}
18:38:43.658 > [WebSocket] Processing message type: heuristics_update
18:38:43.665 > [435.7] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:43.766 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":435302,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:43.803 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:43.808 > [WebSocket] ========================================
18:38:43.813 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:43.820 > [WebSocket] ========================================
18:38:43.825 > [ZTM] Settings saved successfully
18:38:43.827 > [WebSocket] ✓ ZTM activated successfully
18:38:43.831 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:43.836 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:43.839 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:43.841 > [WebSocket] ========================================
18:38:43.847 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":435916,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:43.886 > [436.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:43.991 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":435338,"type":"ztm_activated"}
18:38:44.008 > [WebSocket] Processing message type: ztm_activated
18:38:44.011 > [436.1] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:44.117 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124123410,"threatLevel":0,"type":"heuristics_update"}
18:38:44.143 > [WebSocket] Processing message type: heuristics_update
18:38:44.148 > [436.2] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:44.250 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":435916,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:44.286 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:44.292 > [WebSocket] ========================================
18:38:44.298 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:44.303 > [WebSocket] ========================================
18:38:44.308 > [ZTM] Settings saved successfully
18:38:44.311 > [WebSocket] ✓ ZTM activated successfully
18:38:44.314 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:44.320 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:44.323 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:44.325 > [WebSocket] ========================================
18:38:44.331 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":436400,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:44.370 > [436.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:44.477 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":435952,"type":"ztm_activated"}
18:38:44.492 > [WebSocket] Processing message type: ztm_activated
18:38:44.496 > [436.6] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:44.601 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":436400,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:44.636 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:44.642 > [WebSocket] ========================================
18:38:44.648 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:44.653 > [WebSocket] ========================================
18:38:44.659 > [ZTM] Settings saved successfully
18:38:44.661 > [WebSocket] ✓ ZTM activated successfully
18:38:44.664 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:44.670 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:44.673 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:44.675 > [WebSocket] ========================================
18:38:44.680 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":436750,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:44.719 > [436.8] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:44.825 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":436436,"type":"ztm_activated"}
18:38:44.843 > [WebSocket] Processing message type: ztm_activated
18:38:44.845 > [436.9] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:44.948 > [WebSocket] Received (263 bytes): {"currentRecipe":"CHAOS_ONLY","metrics":{"cpuPercent":20.0,"decryptFailures":0,"entropyAfter":7.5,"hmacFailures":0,"latencyMs":45.0,"malformedPackets":0,"replayAttempts":0,"timingAnomalies":0},"serverTime":1770124124420,"threatLevel":0,"type":"heuristics_update"}
18:38:44.973 > [WebSocket] Processing message type: heuristics_update
18:38:44.979 > [437.0] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:45.082 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":436750,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:45.118 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:45.124 > [WebSocket] ========================================
18:38:45.129 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:45.135 > [WebSocket] ========================================
18:38:45.141 > [ZTM] Settings saved successfully
18:38:45.144 > [WebSocket] ✓ ZTM activated successfully
18:38:45.146 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:45.151 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:45.155 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:45.157 > [WebSocket] ========================================
18:38:45.162 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":437232,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","hmacFailures":0,"decryptFailures":0,"replayAttempts":0,"malformedPackets":0,"timingAnomalies":0}
18:38:45.202 > [437.3] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:45.308 > [WebSocket] Received (162 bytes): {"deviceId":"f9641d44","healthSendCount":11,"message":"Zero Trust Mode activated successfully","state":7,"success":true,"timestamp":436785,"type":"ztm_activated"}
18:38:45.325 > [WebSocket] Processing message type: ztm_activated
18:38:45.327 > [437.4] STATE: SEND_HEALTH_DATA | WiFi: OK | MasterKey: READY | HealthSent: 11 | WS: CONNECTED
18:38:45.434 > [WebSocket] Received (393 bytes): {"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","decryptFailures":0,"deviceId":"f9641d44","hmacFailures":0,"malformedPackets":0,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","replayAttempts":0,"success":true,"timestamp":437232,"timingAnomalies":0,"type":"ztm_activation_acknowledged","ztmEnabled":true}
18:38:45.469 > [WebSocket] Processing message type: ztm_activation_acknowledged
18:38:45.475 > [WebSocket] ========================================
18:38:45.481 > [WebSocket] ZTM ACTIVATION RECEIVED (type: ztm_activation_acknowledged)
18:38:45.486 > [WebSocket] ========================================
18:38:45.492 > [ZTM] Settings saved successfully
18:38:45.495 > [WebSocket] ✓ ZTM activated successfully
18:38:45.498 > [WebSocket] ✓ Normal Mode encryption STOPPED
18:38:45.503 > [WebSocket] ✓ ZTM encryption pipeline ACTIVE
18:38:45.506 > [WebSocket] ✓ Current recipe: CHAOS_ONLY
18:38:45.509 > [WebSocket] ========================================
18:38:45.514 > [WebSocket] ZTM activation acknowledged sent: {"type":"ztm_activation_acknowledged","success":true,"mode":"ztm","recipe":"\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000","deviceId":"f9641d44","timestamp":437583,"ztmEnabled":true,"currentMode":"ztm","currentRecipe":"\u0000\u0000\u0000\u000